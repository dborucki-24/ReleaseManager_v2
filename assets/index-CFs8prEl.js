(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function k1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u0={exports:{}},Mo={},c0={exports:{}},ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm;function r2(){if(Nm)return ot;Nm=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.iterator;function v(H){return H===null||typeof H!="object"?null:(H=x&&H[x]||H["@@iterator"],typeof H=="function"?H:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,T={};function E(H,ue,O){this.props=H,this.context=ue,this.refs=T,this.updater=O||_}E.prototype.isReactComponent={},E.prototype.setState=function(H,ue){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ue,"setState")},E.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function A(){}A.prototype=E.prototype;function I(H,ue,O){this.props=H,this.context=ue,this.refs=T,this.updater=O||_}var C=I.prototype=new A;C.constructor=I,k(C,E.prototype),C.isPureReactComponent=!0;var D=Array.isArray,M=Object.prototype.hasOwnProperty,P={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function q(H,ue,O){var J,j={},K=null,le=null;if(ue!=null)for(J in ue.ref!==void 0&&(le=ue.ref),ue.key!==void 0&&(K=""+ue.key),ue)M.call(ue,J)&&!F.hasOwnProperty(J)&&(j[J]=ue[J]);var ye=arguments.length-2;if(ye===1)j.children=O;else if(1<ye){for(var ve=Array(ye),_e=0;_e<ye;_e++)ve[_e]=arguments[_e+2];j.children=ve}if(H&&H.defaultProps)for(J in ye=H.defaultProps,ye)j[J]===void 0&&(j[J]=ye[J]);return{$$typeof:e,type:H,key:K,ref:le,props:j,_owner:P.current}}function z(H,ue){return{$$typeof:e,type:H.type,key:ue,ref:H.ref,props:H.props,_owner:H._owner}}function te(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function Q(H){var ue={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(O){return ue[O]})}var Y=/\/+/g;function xe(H,ue){return typeof H=="object"&&H!==null&&H.key!=null?Q(""+H.key):ue.toString(36)}function De(H,ue,O,J,j){var K=typeof H;(K==="undefined"||K==="boolean")&&(H=null);var le=!1;if(H===null)le=!0;else switch(K){case"string":case"number":le=!0;break;case"object":switch(H.$$typeof){case e:case t:le=!0}}if(le)return le=H,j=j(le),H=J===""?"."+xe(le,0):J,D(j)?(O="",H!=null&&(O=H.replace(Y,"$&/")+"/"),De(j,ue,O,"",function(_e){return _e})):j!=null&&(te(j)&&(j=z(j,O+(!j.key||le&&le.key===j.key?"":(""+j.key).replace(Y,"$&/")+"/")+H)),ue.push(j)),1;if(le=0,J=J===""?".":J+":",D(H))for(var ye=0;ye<H.length;ye++){K=H[ye];var ve=J+xe(K,ye);le+=De(K,ue,O,ve,j)}else if(ve=v(H),typeof ve=="function")for(H=ve.call(H),ye=0;!(K=H.next()).done;)K=K.value,ve=J+xe(K,ye++),le+=De(K,ue,O,ve,j);else if(K==="object")throw ue=String(H),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.");return le}function we(H,ue,O){if(H==null)return H;var J=[],j=0;return De(H,J,"","",function(K){return ue.call(O,K,j++)}),J}function Fe(H){if(H._status===-1){var ue=H._result;ue=ue(),ue.then(function(O){(H._status===0||H._status===-1)&&(H._status=1,H._result=O)},function(O){(H._status===0||H._status===-1)&&(H._status=2,H._result=O)}),H._status===-1&&(H._status=0,H._result=ue)}if(H._status===1)return H._result.default;throw H._result}var Ce={current:null},Se={transition:null},Z={ReactCurrentDispatcher:Ce,ReactCurrentBatchConfig:Se,ReactCurrentOwner:P};return ot.Children={map:we,forEach:function(H,ue,O){we(H,function(){ue.apply(this,arguments)},O)},count:function(H){var ue=0;return we(H,function(){ue++}),ue},toArray:function(H){return we(H,function(ue){return ue})||[]},only:function(H){if(!te(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},ot.Component=E,ot.Fragment=n,ot.Profiler=i,ot.PureComponent=I,ot.StrictMode=r,ot.Suspense=d,ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,ot.cloneElement=function(H,ue,O){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var J=k({},H.props),j=H.key,K=H.ref,le=H._owner;if(ue!=null){if(ue.ref!==void 0&&(K=ue.ref,le=P.current),ue.key!==void 0&&(j=""+ue.key),H.type&&H.type.defaultProps)var ye=H.type.defaultProps;for(ve in ue)M.call(ue,ve)&&!F.hasOwnProperty(ve)&&(J[ve]=ue[ve]===void 0&&ye!==void 0?ye[ve]:ue[ve])}var ve=arguments.length-2;if(ve===1)J.children=O;else if(1<ve){ye=Array(ve);for(var _e=0;_e<ve;_e++)ye[_e]=arguments[_e+2];J.children=ye}return{$$typeof:e,type:H.type,key:j,ref:K,props:J,_owner:le}},ot.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:s,_context:H},H.Consumer=H},ot.createElement=q,ot.createFactory=function(H){var ue=q.bind(null,H);return ue.type=H,ue},ot.createRef=function(){return{current:null}},ot.forwardRef=function(H){return{$$typeof:u,render:H}},ot.isValidElement=te,ot.lazy=function(H){return{$$typeof:m,_payload:{_status:-1,_result:H},_init:Fe}},ot.memo=function(H,ue){return{$$typeof:h,type:H,compare:ue===void 0?null:ue}},ot.startTransition=function(H){var ue=Se.transition;Se.transition={};try{H()}finally{Se.transition=ue}},ot.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},ot.useCallback=function(H,ue){return Ce.current.useCallback(H,ue)},ot.useContext=function(H){return Ce.current.useContext(H)},ot.useDebugValue=function(){},ot.useDeferredValue=function(H){return Ce.current.useDeferredValue(H)},ot.useEffect=function(H,ue){return Ce.current.useEffect(H,ue)},ot.useId=function(){return Ce.current.useId()},ot.useImperativeHandle=function(H,ue,O){return Ce.current.useImperativeHandle(H,ue,O)},ot.useInsertionEffect=function(H,ue){return Ce.current.useInsertionEffect(H,ue)},ot.useLayoutEffect=function(H,ue){return Ce.current.useLayoutEffect(H,ue)},ot.useMemo=function(H,ue){return Ce.current.useMemo(H,ue)},ot.useReducer=function(H,ue,O){return Ce.current.useReducer(H,ue,O)},ot.useRef=function(H){return Ce.current.useRef(H)},ot.useState=function(H){return Ce.current.useState(H)},ot.useSyncExternalStore=function(H,ue,O){return Ce.current.useSyncExternalStore(H,ue,O)},ot.useTransition=function(){return Ce.current.useTransition()},ot.version="18.2.0",ot}var Fm;function ud(){return Fm||(Fm=1,c0.exports=r2()),c0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm;function i2(){if(Rm)return Mo;Rm=1;var e=ud(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(u,d,h){var m,x={},v=null,_=null;h!==void 0&&(v=""+h),d.key!==void 0&&(v=""+d.key),d.ref!==void 0&&(_=d.ref);for(m in d)r.call(d,m)&&!s.hasOwnProperty(m)&&(x[m]=d[m]);if(u&&u.defaultProps)for(m in d=u.defaultProps,d)x[m]===void 0&&(x[m]=d[m]);return{$$typeof:t,type:u,key:v,ref:_,props:x,_owner:i.current}}return Mo.Fragment=n,Mo.jsx=o,Mo.jsxs=o,Mo}var Dm;function a2(){return Dm||(Dm=1,u0.exports=i2()),u0.exports}var y=a2(),pe=ud();const P0=k1(pe);var ku={},f0={exports:{}},nr={},d0={exports:{}},h0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pm;function s2(){return Pm||(Pm=1,function(e){function t(Se,Z){var H=Se.length;Se.push(Z);e:for(;0<H;){var ue=H-1>>>1,O=Se[ue];if(0<i(O,Z))Se[ue]=Z,Se[H]=O,H=ue;else break e}}function n(Se){return Se.length===0?null:Se[0]}function r(Se){if(Se.length===0)return null;var Z=Se[0],H=Se.pop();if(H!==Z){Se[0]=H;e:for(var ue=0,O=Se.length,J=O>>>1;ue<J;){var j=2*(ue+1)-1,K=Se[j],le=j+1,ye=Se[le];if(0>i(K,H))le<O&&0>i(ye,K)?(Se[ue]=ye,Se[le]=H,ue=le):(Se[ue]=K,Se[j]=H,ue=j);else if(le<O&&0>i(ye,H))Se[ue]=ye,Se[le]=H,ue=le;else break e}}return Z}function i(Se,Z){var H=Se.sortIndex-Z.sortIndex;return H!==0?H:Se.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var d=[],h=[],m=1,x=null,v=3,_=!1,k=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(Se){for(var Z=n(h);Z!==null;){if(Z.callback===null)r(h);else if(Z.startTime<=Se)r(h),Z.sortIndex=Z.expirationTime,t(d,Z);else break;Z=n(h)}}function D(Se){if(T=!1,C(Se),!k)if(n(d)!==null)k=!0,Fe(M);else{var Z=n(h);Z!==null&&Ce(D,Z.startTime-Se)}}function M(Se,Z){k=!1,T&&(T=!1,A(q),q=-1),_=!0;var H=v;try{for(C(Z),x=n(d);x!==null&&(!(x.expirationTime>Z)||Se&&!Q());){var ue=x.callback;if(typeof ue=="function"){x.callback=null,v=x.priorityLevel;var O=ue(x.expirationTime<=Z);Z=e.unstable_now(),typeof O=="function"?x.callback=O:x===n(d)&&r(d),C(Z)}else r(d);x=n(d)}if(x!==null)var J=!0;else{var j=n(h);j!==null&&Ce(D,j.startTime-Z),J=!1}return J}finally{x=null,v=H,_=!1}}var P=!1,F=null,q=-1,z=5,te=-1;function Q(){return!(e.unstable_now()-te<z)}function Y(){if(F!==null){var Se=e.unstable_now();te=Se;var Z=!0;try{Z=F(!0,Se)}finally{Z?xe():(P=!1,F=null)}}else P=!1}var xe;if(typeof I=="function")xe=function(){I(Y)};else if(typeof MessageChannel<"u"){var De=new MessageChannel,we=De.port2;De.port1.onmessage=Y,xe=function(){we.postMessage(null)}}else xe=function(){E(Y,0)};function Fe(Se){F=Se,P||(P=!0,xe())}function Ce(Se,Z){q=E(function(){Se(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Se){Se.callback=null},e.unstable_continueExecution=function(){k||_||(k=!0,Fe(M))},e.unstable_forceFrameRate=function(Se){0>Se||125<Se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<Se?Math.floor(1e3/Se):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(Se){switch(v){case 1:case 2:case 3:var Z=3;break;default:Z=v}var H=v;v=Z;try{return Se()}finally{v=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Se,Z){switch(Se){case 1:case 2:case 3:case 4:case 5:break;default:Se=3}var H=v;v=Se;try{return Z()}finally{v=H}},e.unstable_scheduleCallback=function(Se,Z,H){var ue=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?ue+H:ue):H=ue,Se){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=H+O,Se={id:m++,callback:Z,priorityLevel:Se,startTime:H,expirationTime:O,sortIndex:-1},H>ue?(Se.sortIndex=H,t(h,Se),n(d)===null&&Se===n(h)&&(T?(A(q),q=-1):T=!0,Ce(D,H-ue))):(Se.sortIndex=O,t(d,Se),k||_||(k=!0,Fe(M))),Se},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(Se){var Z=v;return function(){var H=v;v=Z;try{return Se.apply(this,arguments)}finally{v=H}}}}(h0)),h0}var Mm;function o2(){return Mm||(Mm=1,d0.exports=s2()),d0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lm;function l2(){if(Lm)return nr;Lm=1;var e=ud(),t=o2();function n(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,p=1;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(i[a]=l,a=0;a<l.length;a++)r.add(l[a])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},x={};function v(a){return d.call(x,a)?!0:d.call(m,a)?!1:h.test(a)?x[a]=!0:(m[a]=!0,!1)}function _(a,l,p,g){if(p!==null&&p.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return g?!1:p!==null?!p.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function k(a,l,p,g){if(l===null||typeof l>"u"||_(a,l,p,g))return!0;if(g)return!1;if(p!==null)switch(p.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function T(a,l,p,g,w,S,N){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=g,this.attributeNamespace=w,this.mustUseProperty=p,this.propertyName=a,this.type=l,this.sanitizeURL=S,this.removeEmptyString=N}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=new T(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];E[l]=new T(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new T(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new T(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=new T(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){E[a]=new T(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){E[a]=new T(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){E[a]=new T(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){E[a]=new T(a,5,!1,a.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function I(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(A,I);E[l]=new T(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(A,I);E[l]=new T(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(A,I);E[l]=new T(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){E[a]=new T(a,1,!1,a.toLowerCase(),null,!1,!1)}),E.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){E[a]=new T(a,1,!1,a.toLowerCase(),null,!0,!0)});function C(a,l,p,g){var w=E.hasOwnProperty(l)?E[l]:null;(w!==null?w.type!==0:g||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(k(l,p,w,g)&&(p=null),g||w===null?v(l)&&(p===null?a.removeAttribute(l):a.setAttribute(l,""+p)):w.mustUseProperty?a[w.propertyName]=p===null?w.type===3?!1:"":p:(l=w.attributeName,g=w.attributeNamespace,p===null?a.removeAttribute(l):(w=w.type,p=w===3||w===4&&p===!0?"":""+p,g?a.setAttributeNS(g,l,p):a.setAttribute(l,p))))}var D=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,M=Symbol.for("react.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),Q=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),De=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),Fe=Symbol.for("react.lazy"),Ce=Symbol.for("react.offscreen"),Se=Symbol.iterator;function Z(a){return a===null||typeof a!="object"?null:(a=Se&&a[Se]||a["@@iterator"],typeof a=="function"?a:null)}var H=Object.assign,ue;function O(a){if(ue===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);ue=l&&l[1]||""}return`
`+ue+a}var J=!1;function j(a,l){if(!a||J)return"";J=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(de){var g=de}Reflect.construct(a,[],l)}else{try{l.call()}catch(de){g=de}a.call(l.prototype)}else{try{throw Error()}catch(de){g=de}a()}}catch(de){if(de&&g&&typeof de.stack=="string"){for(var w=de.stack.split(`
`),S=g.stack.split(`
`),N=w.length-1,W=S.length-1;1<=N&&0<=W&&w[N]!==S[W];)W--;for(;1<=N&&0<=W;N--,W--)if(w[N]!==S[W]){if(N!==1||W!==1)do if(N--,W--,0>W||w[N]!==S[W]){var X=`
`+w[N].replace(" at new "," at ");return a.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",a.displayName)),X}while(1<=N&&0<=W);break}}}finally{J=!1,Error.prepareStackTrace=p}return(a=a?a.displayName||a.name:"")?O(a):""}function K(a){switch(a.tag){case 5:return O(a.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return a=j(a.type,!1),a;case 11:return a=j(a.type.render,!1),a;case 1:return a=j(a.type,!0),a;default:return""}}function le(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case F:return"Fragment";case P:return"Portal";case z:return"Profiler";case q:return"StrictMode";case xe:return"Suspense";case De:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case Q:return(a.displayName||"Context")+".Consumer";case te:return(a._context.displayName||"Context")+".Provider";case Y:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case we:return l=a.displayName||null,l!==null?l:le(a.type)||"Memo";case Fe:l=a._payload,a=a._init;try{return le(a(l))}catch{}}return null}function ye(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(l);case 8:return l===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function _e(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ie(a){var l=_e(a)?"checked":"value",p=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),g=""+a[l];if(!a.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var w=p.get,S=p.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return w.call(this)},set:function(N){g=""+N,S.call(this,N)}}),Object.defineProperty(a,l,{enumerable:p.enumerable}),{getValue:function(){return g},setValue:function(N){g=""+N},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Je(a){a._valueTracker||(a._valueTracker=Ie(a))}function G(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var p=l.getValue(),g="";return a&&(g=_e(a)?a.checked?"true":"false":a.value),a=g,a!==p?(l.setValue(a),!0):!1}function ut(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function it(a,l){var p=l.checked;return H({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??a._wrapperState.initialChecked})}function ht(a,l){var p=l.defaultValue==null?"":l.defaultValue,g=l.checked!=null?l.checked:l.defaultChecked;p=ve(l.value!=null?l.value:p),a._wrapperState={initialChecked:g,initialValue:p,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function et(a,l){l=l.checked,l!=null&&C(a,"checked",l,!1)}function Oe(a,l){et(a,l);var p=ve(l.value),g=l.type;if(p!=null)g==="number"?(p===0&&a.value===""||a.value!=p)&&(a.value=""+p):a.value!==""+p&&(a.value=""+p);else if(g==="submit"||g==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?Jt(a,l.type,p):l.hasOwnProperty("defaultValue")&&Jt(a,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function At(a,l,p){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var g=l.type;if(!(g!=="submit"&&g!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,p||l===a.value||(a.value=l),a.defaultValue=l}p=a.name,p!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,p!==""&&(a.name=p)}function Jt(a,l,p){(l!=="number"||ut(a.ownerDocument)!==a)&&(p==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+p&&(a.defaultValue=""+p))}var Xt=Array.isArray;function Ft(a,l,p,g){if(a=a.options,l){l={};for(var w=0;w<p.length;w++)l["$"+p[w]]=!0;for(p=0;p<a.length;p++)w=l.hasOwnProperty("$"+a[p].value),a[p].selected!==w&&(a[p].selected=w),w&&g&&(a[p].defaultSelected=!0)}else{for(p=""+ve(p),l=null,w=0;w<a.length;w++){if(a[w].value===p){a[w].selected=!0,g&&(a[w].defaultSelected=!0);return}l!==null||a[w].disabled||(l=a[w])}l!==null&&(l.selected=!0)}}function yn(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(n(91));return H({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function $n(a,l){var p=l.value;if(p==null){if(p=l.children,l=l.defaultValue,p!=null){if(l!=null)throw Error(n(92));if(Xt(p)){if(1<p.length)throw Error(n(93));p=p[0]}l=p}l==null&&(l=""),p=l}a._wrapperState={initialValue:ve(p)}}function fn(a,l){var p=ve(l.value),g=ve(l.defaultValue);p!=null&&(p=""+p,p!==a.value&&(a.value=p),l.defaultValue==null&&a.defaultValue!==p&&(a.defaultValue=p)),g!=null&&(a.defaultValue=""+g)}function qn(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function sn(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kn(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?sn(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var gt,wn=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,p,g,w){MSApp.execUnsafeLocalFunction(function(){return a(l,p,g,w)})}:a}(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(gt=gt||document.createElement("div"),gt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=gt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function Qe(a,l){if(l){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=l;return}}a.textContent=l}var xt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cn=["Webkit","ms","Moz","O"];Object.keys(xt).forEach(function(a){Cn.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),xt[l]=xt[a]})});function It(a,l,p){return l==null||typeof l=="boolean"||l===""?"":p||typeof l!="number"||l===0||xt.hasOwnProperty(a)&&xt[a]?(""+l).trim():l+"px"}function vt(a,l){a=a.style;for(var p in l)if(l.hasOwnProperty(p)){var g=p.indexOf("--")===0,w=It(p,l[p],g);p==="float"&&(p="cssFloat"),g?a.setProperty(p,w):a[p]=w}}var es=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fi(a,l){if(l){if(es[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(n(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(n(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(n(61))}if(l.style!=null&&typeof l.style!="object")throw Error(n(62))}}function ha(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ri=null;function Di(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Pi=null,qr=null,Kr=null;function oi(a){if(a=yo(a)){if(typeof Pi!="function")throw Error(n(280));var l=a.stateNode;l&&(l=zl(l),Pi(a.stateNode,a.type,l))}}function ts(a){qr?Kr?Kr.push(a):Kr=[a]:qr=a}function ns(){if(qr){var a=qr,l=Kr;if(Kr=qr=null,oi(a),l)for(a=0;a<l.length;a++)oi(l[a])}}function rs(a,l){return a(l)}function is(){}var pa=!1;function as(a,l,p){if(pa)return a(l,p);pa=!0;try{return rs(a,l,p)}finally{pa=!1,(qr!==null||Kr!==null)&&(is(),ns())}}function li(a,l){var p=a.stateNode;if(p===null)return null;var g=zl(p);if(g===null)return null;p=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(n(231,l,typeof p));return p}var ma=!1;if(u)try{var Mr={};Object.defineProperty(Mr,"passive",{get:function(){ma=!0}}),window.addEventListener("test",Mr,Mr),window.removeEventListener("test",Mr,Mr)}catch{ma=!1}function eo(a,l,p,g,w,S,N,W,X){var de=Array.prototype.slice.call(arguments,3);try{l.apply(p,de)}catch(Ae){this.onError(Ae)}}var ui=!1,Mi=null,R=!1,U=null,L={onError:function(a){ui=!0,Mi=a}};function B(a,l,p,g,w,S,N,W,X){ui=!1,Mi=null,eo.apply(L,arguments)}function b(a,l,p,g,w,S,N,W,X){if(B.apply(this,arguments),ui){if(ui){var de=Mi;ui=!1,Mi=null}else throw Error(n(198));R||(R=!0,U=de)}}function V(a){var l=a,p=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(p=l.return),a=l.return;while(a)}return l.tag===3?p:null}function se(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function ge(a){if(V(a)!==a)throw Error(n(188))}function ie(a){var l=a.alternate;if(!l){if(l=V(a),l===null)throw Error(n(188));return l!==a?null:a}for(var p=a,g=l;;){var w=p.return;if(w===null)break;var S=w.alternate;if(S===null){if(g=w.return,g!==null){p=g;continue}break}if(w.child===S.child){for(S=w.child;S;){if(S===p)return ge(w),a;if(S===g)return ge(w),l;S=S.sibling}throw Error(n(188))}if(p.return!==g.return)p=w,g=S;else{for(var N=!1,W=w.child;W;){if(W===p){N=!0,p=w,g=S;break}if(W===g){N=!0,g=w,p=S;break}W=W.sibling}if(!N){for(W=S.child;W;){if(W===p){N=!0,p=S,g=w;break}if(W===g){N=!0,g=S,p=w;break}W=W.sibling}if(!N)throw Error(n(189))}}if(p.alternate!==g)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?a:l}function ce(a){return a=ie(a),a!==null?fe(a):null}function fe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=fe(a);if(l!==null)return l;a=a.sibling}return null}var ke=t.unstable_scheduleCallback,Le=t.unstable_cancelCallback,ne=t.unstable_shouldYield,ae=t.unstable_requestPaint,he=t.unstable_now,Ue=t.unstable_getCurrentPriorityLevel,lt=t.unstable_ImmediatePriority,tt=t.unstable_UserBlockingPriority,Ct=t.unstable_NormalPriority,Lr=t.unstable_LowPriority,Jn=t.unstable_IdlePriority,Xn=null,Gt=null;function ga(a){if(Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(Xn,a,void 0,(a.current.flags&128)===128)}catch{}}var Ut=Math.clz32?Math.clz32:Ac,Ec=Math.log,Cc=Math.LN2;function Ac(a){return a>>>=0,a===0?32:31-(Ec(a)/Cc|0)|0}var xa=64,va=4194304;function Li(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Jr(a,l){var p=a.pendingLanes;if(p===0)return 0;var g=0,w=a.suspendedLanes,S=a.pingedLanes,N=p&268435455;if(N!==0){var W=N&~w;W!==0?g=Li(W):(S&=N,S!==0&&(g=Li(S)))}else N=p&~w,N!==0?g=Li(N):S!==0&&(g=Li(S));if(g===0)return 0;if(l!==0&&l!==g&&(l&w)===0&&(w=g&-g,S=l&-l,w>=S||w===16&&(S&4194240)!==0))return l;if((g&4)!==0&&(g|=p&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=g;0<l;)p=31-Ut(l),w=1<<p,g|=a[p],l&=~w;return g}function Sl(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ic(a,l){for(var p=a.suspendedLanes,g=a.pingedLanes,w=a.expirationTimes,S=a.pendingLanes;0<S;){var N=31-Ut(S),W=1<<N,X=w[N];X===-1?((W&p)===0||(W&g)!==0)&&(w[N]=Sl(W,l)):X<=l&&(a.expiredLanes|=W),S&=~W}}function Nc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function ah(){var a=xa;return xa<<=1,(xa&4194240)===0&&(xa=64),a}function Fc(a){for(var l=[],p=0;31>p;p++)l.push(a);return l}function to(a,l,p){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-Ut(l),a[l]=p}function kw(a,l){var p=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<p;){var w=31-Ut(p),S=1<<w;l[w]=0,g[w]=-1,a[w]=-1,p&=~S}}function Rc(a,l){var p=a.entangledLanes|=l;for(a=a.entanglements;p;){var g=31-Ut(p),w=1<<g;w&l|a[g]&l&&(a[g]|=l),p&=~w}}var wt=0;function sh(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var oh,Dc,lh,uh,ch,Pc=!1,kl=[],Oi=null,Bi=null,Ui=null,no=new Map,ro=new Map,zi=[],Ew="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fh(a,l){switch(a){case"focusin":case"focusout":Oi=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Ui=null;break;case"pointerover":case"pointerout":no.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ro.delete(l.pointerId)}}function io(a,l,p,g,w,S){return a===null||a.nativeEvent!==S?(a={blockedOn:l,domEventName:p,eventSystemFlags:g,nativeEvent:S,targetContainers:[w]},l!==null&&(l=yo(l),l!==null&&Dc(l)),a):(a.eventSystemFlags|=g,l=a.targetContainers,w!==null&&l.indexOf(w)===-1&&l.push(w),a)}function Cw(a,l,p,g,w){switch(l){case"focusin":return Oi=io(Oi,a,l,p,g,w),!0;case"dragenter":return Bi=io(Bi,a,l,p,g,w),!0;case"mouseover":return Ui=io(Ui,a,l,p,g,w),!0;case"pointerover":var S=w.pointerId;return no.set(S,io(no.get(S)||null,a,l,p,g,w)),!0;case"gotpointercapture":return S=w.pointerId,ro.set(S,io(ro.get(S)||null,a,l,p,g,w)),!0}return!1}function dh(a){var l=ya(a.target);if(l!==null){var p=V(l);if(p!==null){if(l=p.tag,l===13){if(l=se(p),l!==null){a.blockedOn=l,ch(a.priority,function(){lh(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function El(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var p=Lc(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(p===null){p=a.nativeEvent;var g=new p.constructor(p.type,p);Ri=g,p.target.dispatchEvent(g),Ri=null}else return l=yo(p),l!==null&&Dc(l),a.blockedOn=p,!1;l.shift()}return!0}function hh(a,l,p){El(a)&&p.delete(l)}function Aw(){Pc=!1,Oi!==null&&El(Oi)&&(Oi=null),Bi!==null&&El(Bi)&&(Bi=null),Ui!==null&&El(Ui)&&(Ui=null),no.forEach(hh),ro.forEach(hh)}function ao(a,l){a.blockedOn===l&&(a.blockedOn=null,Pc||(Pc=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Aw)))}function so(a){function l(w){return ao(w,a)}if(0<kl.length){ao(kl[0],a);for(var p=1;p<kl.length;p++){var g=kl[p];g.blockedOn===a&&(g.blockedOn=null)}}for(Oi!==null&&ao(Oi,a),Bi!==null&&ao(Bi,a),Ui!==null&&ao(Ui,a),no.forEach(l),ro.forEach(l),p=0;p<zi.length;p++)g=zi[p],g.blockedOn===a&&(g.blockedOn=null);for(;0<zi.length&&(p=zi[0],p.blockedOn===null);)dh(p),p.blockedOn===null&&zi.shift()}var ss=D.ReactCurrentBatchConfig,Cl=!0;function Iw(a,l,p,g){var w=wt,S=ss.transition;ss.transition=null;try{wt=1,Mc(a,l,p,g)}finally{wt=w,ss.transition=S}}function Nw(a,l,p,g){var w=wt,S=ss.transition;ss.transition=null;try{wt=4,Mc(a,l,p,g)}finally{wt=w,ss.transition=S}}function Mc(a,l,p,g){if(Cl){var w=Lc(a,l,p,g);if(w===null)Zc(a,l,g,Al,p),fh(a,g);else if(Cw(w,a,l,p,g))g.stopPropagation();else if(fh(a,g),l&4&&-1<Ew.indexOf(a)){for(;w!==null;){var S=yo(w);if(S!==null&&oh(S),S=Lc(a,l,p,g),S===null&&Zc(a,l,g,Al,p),S===w)break;w=S}w!==null&&g.stopPropagation()}else Zc(a,l,g,null,p)}}var Al=null;function Lc(a,l,p,g){if(Al=null,a=Di(g),a=ya(a),a!==null)if(l=V(a),l===null)a=null;else if(p=l.tag,p===13){if(a=se(l),a!==null)return a;a=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return Al=a,null}function ph(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ue()){case lt:return 1;case tt:return 4;case Ct:case Lr:return 16;case Jn:return 536870912;default:return 16}default:return 16}}var bi=null,Oc=null,Il=null;function mh(){if(Il)return Il;var a,l=Oc,p=l.length,g,w="value"in bi?bi.value:bi.textContent,S=w.length;for(a=0;a<p&&l[a]===w[a];a++);var N=p-a;for(g=1;g<=N&&l[p-g]===w[S-g];g++);return Il=w.slice(a,1<g?1-g:void 0)}function Nl(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Fl(){return!0}function gh(){return!1}function or(a){function l(p,g,w,S,N){this._reactName=p,this._targetInst=w,this.type=g,this.nativeEvent=S,this.target=N,this.currentTarget=null;for(var W in a)a.hasOwnProperty(W)&&(p=a[W],this[W]=p?p(S):S[W]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Fl:gh,this.isPropagationStopped=gh,this}return H(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Fl)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Fl)},persist:function(){},isPersistent:Fl}),l}var os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bc=or(os),oo=H({},os,{view:0,detail:0}),Fw=or(oo),Uc,zc,lo,Rl=H({},oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vc,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==lo&&(lo&&a.type==="mousemove"?(Uc=a.screenX-lo.screenX,zc=a.screenY-lo.screenY):zc=Uc=0,lo=a),Uc)},movementY:function(a){return"movementY"in a?a.movementY:zc}}),xh=or(Rl),Rw=H({},Rl,{dataTransfer:0}),Dw=or(Rw),Pw=H({},oo,{relatedTarget:0}),bc=or(Pw),Mw=H({},os,{animationName:0,elapsedTime:0,pseudoElement:0}),Lw=or(Mw),Ow=H({},os,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Bw=or(Ow),Uw=H({},os,{data:0}),vh=or(Uw),zw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hw(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=Vw[a])?!!l[a]:!1}function Vc(){return Hw}var Ww=H({},oo,{key:function(a){if(a.key){var l=zw[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Nl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?bw[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vc,charCode:function(a){return a.type==="keypress"?Nl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Nl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Gw=or(Ww),jw=H({},Rl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yh=or(jw),$w=H({},oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vc}),qw=or($w),Kw=H({},os,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jw=or(Kw),Xw=H({},Rl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Yw=or(Xw),Zw=[9,13,27,32],Hc=u&&"CompositionEvent"in window,uo=null;u&&"documentMode"in document&&(uo=document.documentMode);var Qw=u&&"TextEvent"in window&&!uo,wh=u&&(!Hc||uo&&8<uo&&11>=uo),_h=" ",Th=!1;function Sh(a,l){switch(a){case"keyup":return Zw.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kh(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ls=!1;function e_(a,l){switch(a){case"compositionend":return kh(l);case"keypress":return l.which!==32?null:(Th=!0,_h);case"textInput":return a=l.data,a===_h&&Th?null:a;default:return null}}function t_(a,l){if(ls)return a==="compositionend"||!Hc&&Sh(a,l)?(a=mh(),Il=Oc=bi=null,ls=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return wh&&l.locale!=="ko"?null:l.data;default:return null}}var n_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Eh(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!n_[a.type]:l==="textarea"}function Ch(a,l,p,g){ts(g),l=Ol(l,"onChange"),0<l.length&&(p=new Bc("onChange","change",null,p,g),a.push({event:p,listeners:l}))}var co=null,fo=null;function r_(a){Gh(a,0)}function Dl(a){var l=hs(a);if(G(l))return a}function i_(a,l){if(a==="change")return l}var Ah=!1;if(u){var Wc;if(u){var Gc="oninput"in document;if(!Gc){var Ih=document.createElement("div");Ih.setAttribute("oninput","return;"),Gc=typeof Ih.oninput=="function"}Wc=Gc}else Wc=!1;Ah=Wc&&(!document.documentMode||9<document.documentMode)}function Nh(){co&&(co.detachEvent("onpropertychange",Fh),fo=co=null)}function Fh(a){if(a.propertyName==="value"&&Dl(fo)){var l=[];Ch(l,fo,a,Di(a)),as(r_,l)}}function a_(a,l,p){a==="focusin"?(Nh(),co=l,fo=p,co.attachEvent("onpropertychange",Fh)):a==="focusout"&&Nh()}function s_(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Dl(fo)}function o_(a,l){if(a==="click")return Dl(l)}function l_(a,l){if(a==="input"||a==="change")return Dl(l)}function u_(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Or=typeof Object.is=="function"?Object.is:u_;function ho(a,l){if(Or(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var p=Object.keys(a),g=Object.keys(l);if(p.length!==g.length)return!1;for(g=0;g<p.length;g++){var w=p[g];if(!d.call(l,w)||!Or(a[w],l[w]))return!1}return!0}function Rh(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Dh(a,l){var p=Rh(a);a=0;for(var g;p;){if(p.nodeType===3){if(g=a+p.textContent.length,a<=l&&g>=l)return{node:p,offset:l-a};a=g}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Rh(p)}}function Ph(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Ph(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Mh(){for(var a=window,l=ut();l instanceof a.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)a=l.contentWindow;else break;l=ut(a.document)}return l}function jc(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function c_(a){var l=Mh(),p=a.focusedElem,g=a.selectionRange;if(l!==p&&p&&p.ownerDocument&&Ph(p.ownerDocument.documentElement,p)){if(g!==null&&jc(p)){if(l=g.start,a=g.end,a===void 0&&(a=l),"selectionStart"in p)p.selectionStart=l,p.selectionEnd=Math.min(a,p.value.length);else if(a=(l=p.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var w=p.textContent.length,S=Math.min(g.start,w);g=g.end===void 0?S:Math.min(g.end,w),!a.extend&&S>g&&(w=g,g=S,S=w),w=Dh(p,S);var N=Dh(p,g);w&&N&&(a.rangeCount!==1||a.anchorNode!==w.node||a.anchorOffset!==w.offset||a.focusNode!==N.node||a.focusOffset!==N.offset)&&(l=l.createRange(),l.setStart(w.node,w.offset),a.removeAllRanges(),S>g?(a.addRange(l),a.extend(N.node,N.offset)):(l.setEnd(N.node,N.offset),a.addRange(l)))}}for(l=[],a=p;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<l.length;p++)a=l[p],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var f_=u&&"documentMode"in document&&11>=document.documentMode,us=null,$c=null,po=null,qc=!1;function Lh(a,l,p){var g=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;qc||us==null||us!==ut(g)||(g=us,"selectionStart"in g&&jc(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),po&&ho(po,g)||(po=g,g=Ol($c,"onSelect"),0<g.length&&(l=new Bc("onSelect","select",null,l,p),a.push({event:l,listeners:g}),l.target=us)))}function Pl(a,l){var p={};return p[a.toLowerCase()]=l.toLowerCase(),p["Webkit"+a]="webkit"+l,p["Moz"+a]="moz"+l,p}var cs={animationend:Pl("Animation","AnimationEnd"),animationiteration:Pl("Animation","AnimationIteration"),animationstart:Pl("Animation","AnimationStart"),transitionend:Pl("Transition","TransitionEnd")},Kc={},Oh={};u&&(Oh=document.createElement("div").style,"AnimationEvent"in window||(delete cs.animationend.animation,delete cs.animationiteration.animation,delete cs.animationstart.animation),"TransitionEvent"in window||delete cs.transitionend.transition);function Ml(a){if(Kc[a])return Kc[a];if(!cs[a])return a;var l=cs[a],p;for(p in l)if(l.hasOwnProperty(p)&&p in Oh)return Kc[a]=l[p];return a}var Bh=Ml("animationend"),Uh=Ml("animationiteration"),zh=Ml("animationstart"),bh=Ml("transitionend"),Vh=new Map,Hh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vi(a,l){Vh.set(a,l),s(l,[a])}for(var Jc=0;Jc<Hh.length;Jc++){var Xc=Hh[Jc],d_=Xc.toLowerCase(),h_=Xc[0].toUpperCase()+Xc.slice(1);Vi(d_,"on"+h_)}Vi(Bh,"onAnimationEnd"),Vi(Uh,"onAnimationIteration"),Vi(zh,"onAnimationStart"),Vi("dblclick","onDoubleClick"),Vi("focusin","onFocus"),Vi("focusout","onBlur"),Vi(bh,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p_=new Set("cancel close invalid load scroll toggle".split(" ").concat(mo));function Wh(a,l,p){var g=a.type||"unknown-event";a.currentTarget=p,b(g,l,void 0,a),a.currentTarget=null}function Gh(a,l){l=(l&4)!==0;for(var p=0;p<a.length;p++){var g=a[p],w=g.event;g=g.listeners;e:{var S=void 0;if(l)for(var N=g.length-1;0<=N;N--){var W=g[N],X=W.instance,de=W.currentTarget;if(W=W.listener,X!==S&&w.isPropagationStopped())break e;Wh(w,W,de),S=X}else for(N=0;N<g.length;N++){if(W=g[N],X=W.instance,de=W.currentTarget,W=W.listener,X!==S&&w.isPropagationStopped())break e;Wh(w,W,de),S=X}}}if(R)throw a=U,R=!1,U=null,a}function Rt(a,l){var p=l[af];p===void 0&&(p=l[af]=new Set);var g=a+"__bubble";p.has(g)||(jh(l,a,2,!1),p.add(g))}function Yc(a,l,p){var g=0;l&&(g|=4),jh(p,a,g,l)}var Ll="_reactListening"+Math.random().toString(36).slice(2);function go(a){if(!a[Ll]){a[Ll]=!0,r.forEach(function(p){p!=="selectionchange"&&(p_.has(p)||Yc(p,!1,a),Yc(p,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[Ll]||(l[Ll]=!0,Yc("selectionchange",!1,l))}}function jh(a,l,p,g){switch(ph(l)){case 1:var w=Iw;break;case 4:w=Nw;break;default:w=Mc}p=w.bind(null,l,p,a),w=void 0,!ma||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(w=!0),g?w!==void 0?a.addEventListener(l,p,{capture:!0,passive:w}):a.addEventListener(l,p,!0):w!==void 0?a.addEventListener(l,p,{passive:w}):a.addEventListener(l,p,!1)}function Zc(a,l,p,g,w){var S=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var W=g.stateNode.containerInfo;if(W===w||W.nodeType===8&&W.parentNode===w)break;if(N===4)for(N=g.return;N!==null;){var X=N.tag;if((X===3||X===4)&&(X=N.stateNode.containerInfo,X===w||X.nodeType===8&&X.parentNode===w))return;N=N.return}for(;W!==null;){if(N=ya(W),N===null)return;if(X=N.tag,X===5||X===6){g=S=N;continue e}W=W.parentNode}}g=g.return}as(function(){var de=S,Ae=Di(p),Ne=[];e:{var Ee=Vh.get(a);if(Ee!==void 0){var Be=Bc,be=a;switch(a){case"keypress":if(Nl(p)===0)break e;case"keydown":case"keyup":Be=Gw;break;case"focusin":be="focus",Be=bc;break;case"focusout":be="blur",Be=bc;break;case"beforeblur":case"afterblur":Be=bc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Be=xh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Be=Dw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Be=qw;break;case Bh:case Uh:case zh:Be=Lw;break;case bh:Be=Jw;break;case"scroll":Be=Fw;break;case"wheel":Be=Yw;break;case"copy":case"cut":case"paste":Be=Bw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Be=yh}var Ve=(l&4)!==0,Yt=!Ve&&a==="scroll",re=Ve?Ee!==null?Ee+"Capture":null:Ee;Ve=[];for(var ee=de,oe;ee!==null;){oe=ee;var Re=oe.stateNode;if(oe.tag===5&&Re!==null&&(oe=Re,re!==null&&(Re=li(ee,re),Re!=null&&Ve.push(xo(ee,Re,oe)))),Yt)break;ee=ee.return}0<Ve.length&&(Ee=new Be(Ee,be,null,p,Ae),Ne.push({event:Ee,listeners:Ve}))}}if((l&7)===0){e:{if(Ee=a==="mouseover"||a==="pointerover",Be=a==="mouseout"||a==="pointerout",Ee&&p!==Ri&&(be=p.relatedTarget||p.fromElement)&&(ya(be)||be[ci]))break e;if((Be||Ee)&&(Ee=Ae.window===Ae?Ae:(Ee=Ae.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,Be?(be=p.relatedTarget||p.toElement,Be=de,be=be?ya(be):null,be!==null&&(Yt=V(be),be!==Yt||be.tag!==5&&be.tag!==6)&&(be=null)):(Be=null,be=de),Be!==be)){if(Ve=xh,Re="onMouseLeave",re="onMouseEnter",ee="mouse",(a==="pointerout"||a==="pointerover")&&(Ve=yh,Re="onPointerLeave",re="onPointerEnter",ee="pointer"),Yt=Be==null?Ee:hs(Be),oe=be==null?Ee:hs(be),Ee=new Ve(Re,ee+"leave",Be,p,Ae),Ee.target=Yt,Ee.relatedTarget=oe,Re=null,ya(Ae)===de&&(Ve=new Ve(re,ee+"enter",be,p,Ae),Ve.target=oe,Ve.relatedTarget=Yt,Re=Ve),Yt=Re,Be&&be)t:{for(Ve=Be,re=be,ee=0,oe=Ve;oe;oe=fs(oe))ee++;for(oe=0,Re=re;Re;Re=fs(Re))oe++;for(;0<ee-oe;)Ve=fs(Ve),ee--;for(;0<oe-ee;)re=fs(re),oe--;for(;ee--;){if(Ve===re||re!==null&&Ve===re.alternate)break t;Ve=fs(Ve),re=fs(re)}Ve=null}else Ve=null;Be!==null&&$h(Ne,Ee,Be,Ve,!1),be!==null&&Yt!==null&&$h(Ne,Yt,be,Ve,!0)}}e:{if(Ee=de?hs(de):window,Be=Ee.nodeName&&Ee.nodeName.toLowerCase(),Be==="select"||Be==="input"&&Ee.type==="file")var He=i_;else if(Eh(Ee))if(Ah)He=l_;else{He=s_;var je=a_}else(Be=Ee.nodeName)&&Be.toLowerCase()==="input"&&(Ee.type==="checkbox"||Ee.type==="radio")&&(He=o_);if(He&&(He=He(a,de))){Ch(Ne,He,p,Ae);break e}je&&je(a,Ee,de),a==="focusout"&&(je=Ee._wrapperState)&&je.controlled&&Ee.type==="number"&&Jt(Ee,"number",Ee.value)}switch(je=de?hs(de):window,a){case"focusin":(Eh(je)||je.contentEditable==="true")&&(us=je,$c=de,po=null);break;case"focusout":po=$c=us=null;break;case"mousedown":qc=!0;break;case"contextmenu":case"mouseup":case"dragend":qc=!1,Lh(Ne,p,Ae);break;case"selectionchange":if(f_)break;case"keydown":case"keyup":Lh(Ne,p,Ae)}var $e;if(Hc)e:{switch(a){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else ls?Sh(a,p)&&(Ze="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(Ze="onCompositionStart");Ze&&(wh&&p.locale!=="ko"&&(ls||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&ls&&($e=mh()):(bi=Ae,Oc="value"in bi?bi.value:bi.textContent,ls=!0)),je=Ol(de,Ze),0<je.length&&(Ze=new vh(Ze,a,null,p,Ae),Ne.push({event:Ze,listeners:je}),$e?Ze.data=$e:($e=kh(p),$e!==null&&(Ze.data=$e)))),($e=Qw?e_(a,p):t_(a,p))&&(de=Ol(de,"onBeforeInput"),0<de.length&&(Ae=new vh("onBeforeInput","beforeinput",null,p,Ae),Ne.push({event:Ae,listeners:de}),Ae.data=$e))}Gh(Ne,l)})}function xo(a,l,p){return{instance:a,listener:l,currentTarget:p}}function Ol(a,l){for(var p=l+"Capture",g=[];a!==null;){var w=a,S=w.stateNode;w.tag===5&&S!==null&&(w=S,S=li(a,p),S!=null&&g.unshift(xo(a,S,w)),S=li(a,l),S!=null&&g.push(xo(a,S,w))),a=a.return}return g}function fs(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function $h(a,l,p,g,w){for(var S=l._reactName,N=[];p!==null&&p!==g;){var W=p,X=W.alternate,de=W.stateNode;if(X!==null&&X===g)break;W.tag===5&&de!==null&&(W=de,w?(X=li(p,S),X!=null&&N.unshift(xo(p,X,W))):w||(X=li(p,S),X!=null&&N.push(xo(p,X,W)))),p=p.return}N.length!==0&&a.push({event:l,listeners:N})}var m_=/\r\n?/g,g_=/\u0000|\uFFFD/g;function qh(a){return(typeof a=="string"?a:""+a).replace(m_,`
`).replace(g_,"")}function Bl(a,l,p){if(l=qh(l),qh(a)!==l&&p)throw Error(n(425))}function Ul(){}var Qc=null,ef=null;function tf(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var nf=typeof setTimeout=="function"?setTimeout:void 0,x_=typeof clearTimeout=="function"?clearTimeout:void 0,Kh=typeof Promise=="function"?Promise:void 0,v_=typeof queueMicrotask=="function"?queueMicrotask:typeof Kh<"u"?function(a){return Kh.resolve(null).then(a).catch(y_)}:nf;function y_(a){setTimeout(function(){throw a})}function rf(a,l){var p=l,g=0;do{var w=p.nextSibling;if(a.removeChild(p),w&&w.nodeType===8)if(p=w.data,p==="/$"){if(g===0){a.removeChild(w),so(l);return}g--}else p!=="$"&&p!=="$?"&&p!=="$!"||g++;p=w}while(p);so(l)}function Hi(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function Jh(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"){if(l===0)return a;l--}else p==="/$"&&l++}a=a.previousSibling}return null}var ds=Math.random().toString(36).slice(2),Xr="__reactFiber$"+ds,vo="__reactProps$"+ds,ci="__reactContainer$"+ds,af="__reactEvents$"+ds,w_="__reactListeners$"+ds,__="__reactHandles$"+ds;function ya(a){var l=a[Xr];if(l)return l;for(var p=a.parentNode;p;){if(l=p[ci]||p[Xr]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(a=Jh(a);a!==null;){if(p=a[Xr])return p;a=Jh(a)}return l}a=p,p=a.parentNode}return null}function yo(a){return a=a[Xr]||a[ci],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function hs(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(n(33))}function zl(a){return a[vo]||null}var sf=[],ps=-1;function Wi(a){return{current:a}}function Dt(a){0>ps||(a.current=sf[ps],sf[ps]=null,ps--)}function Nt(a,l){ps++,sf[ps]=a.current,a.current=l}var Gi={},An=Wi(Gi),Yn=Wi(!1),wa=Gi;function ms(a,l){var p=a.type.contextTypes;if(!p)return Gi;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var w={},S;for(S in p)w[S]=l[S];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=w),w}function Zn(a){return a=a.childContextTypes,a!=null}function bl(){Dt(Yn),Dt(An)}function Xh(a,l,p){if(An.current!==Gi)throw Error(n(168));Nt(An,l),Nt(Yn,p)}function Yh(a,l,p){var g=a.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return p;g=g.getChildContext();for(var w in g)if(!(w in l))throw Error(n(108,ye(a)||"Unknown",w));return H({},p,g)}function Vl(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Gi,wa=An.current,Nt(An,a),Nt(Yn,Yn.current),!0}function Zh(a,l,p){var g=a.stateNode;if(!g)throw Error(n(169));p?(a=Yh(a,l,wa),g.__reactInternalMemoizedMergedChildContext=a,Dt(Yn),Dt(An),Nt(An,a)):Dt(Yn),Nt(Yn,p)}var fi=null,Hl=!1,of=!1;function Qh(a){fi===null?fi=[a]:fi.push(a)}function T_(a){Hl=!0,Qh(a)}function ji(){if(!of&&fi!==null){of=!0;var a=0,l=wt;try{var p=fi;for(wt=1;a<p.length;a++){var g=p[a];do g=g(!0);while(g!==null)}fi=null,Hl=!1}catch(w){throw fi!==null&&(fi=fi.slice(a+1)),ke(lt,ji),w}finally{wt=l,of=!1}}return null}var gs=[],xs=0,Wl=null,Gl=0,xr=[],vr=0,_a=null,di=1,hi="";function Ta(a,l){gs[xs++]=Gl,gs[xs++]=Wl,Wl=a,Gl=l}function ep(a,l,p){xr[vr++]=di,xr[vr++]=hi,xr[vr++]=_a,_a=a;var g=di;a=hi;var w=32-Ut(g)-1;g&=~(1<<w),p+=1;var S=32-Ut(l)+w;if(30<S){var N=w-w%5;S=(g&(1<<N)-1).toString(32),g>>=N,w-=N,di=1<<32-Ut(l)+w|p<<w|g,hi=S+a}else di=1<<S|p<<w|g,hi=a}function lf(a){a.return!==null&&(Ta(a,1),ep(a,1,0))}function uf(a){for(;a===Wl;)Wl=gs[--xs],gs[xs]=null,Gl=gs[--xs],gs[xs]=null;for(;a===_a;)_a=xr[--vr],xr[vr]=null,hi=xr[--vr],xr[vr]=null,di=xr[--vr],xr[vr]=null}var lr=null,ur=null,Bt=!1,Br=null;function tp(a,l){var p=Tr(5,null,null,0);p.elementType="DELETED",p.stateNode=l,p.return=a,l=a.deletions,l===null?(a.deletions=[p],a.flags|=16):l.push(p)}function np(a,l){switch(a.tag){case 5:var p=a.type;return l=l.nodeType!==1||p.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,lr=a,ur=Hi(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,lr=a,ur=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(p=_a!==null?{id:di,overflow:hi}:null,a.memoizedState={dehydrated:l,treeContext:p,retryLane:1073741824},p=Tr(18,null,null,0),p.stateNode=l,p.return=a,a.child=p,lr=a,ur=null,!0):!1;default:return!1}}function cf(a){return(a.mode&1)!==0&&(a.flags&128)===0}function ff(a){if(Bt){var l=ur;if(l){var p=l;if(!np(a,l)){if(cf(a))throw Error(n(418));l=Hi(p.nextSibling);var g=lr;l&&np(a,l)?tp(g,p):(a.flags=a.flags&-4097|2,Bt=!1,lr=a)}}else{if(cf(a))throw Error(n(418));a.flags=a.flags&-4097|2,Bt=!1,lr=a}}}function rp(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;lr=a}function jl(a){if(a!==lr)return!1;if(!Bt)return rp(a),Bt=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!tf(a.type,a.memoizedProps)),l&&(l=ur)){if(cf(a))throw ip(),Error(n(418));for(;l;)tp(a,l),l=Hi(l.nextSibling)}if(rp(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="/$"){if(l===0){ur=Hi(a.nextSibling);break e}l--}else p!=="$"&&p!=="$!"&&p!=="$?"||l++}a=a.nextSibling}ur=null}}else ur=lr?Hi(a.stateNode.nextSibling):null;return!0}function ip(){for(var a=ur;a;)a=Hi(a.nextSibling)}function vs(){ur=lr=null,Bt=!1}function df(a){Br===null?Br=[a]:Br.push(a)}var S_=D.ReactCurrentBatchConfig;function Ur(a,l){if(a&&a.defaultProps){l=H({},l),a=a.defaultProps;for(var p in a)l[p]===void 0&&(l[p]=a[p]);return l}return l}var $l=Wi(null),ql=null,ys=null,hf=null;function pf(){hf=ys=ql=null}function mf(a){var l=$l.current;Dt($l),a._currentValue=l}function gf(a,l,p){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===p)break;a=a.return}}function ws(a,l){ql=a,hf=ys=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(Qn=!0),a.firstContext=null)}function yr(a){var l=a._currentValue;if(hf!==a)if(a={context:a,memoizedValue:l,next:null},ys===null){if(ql===null)throw Error(n(308));ys=a,ql.dependencies={lanes:0,firstContext:a}}else ys=ys.next=a;return l}var Sa=null;function xf(a){Sa===null?Sa=[a]:Sa.push(a)}function ap(a,l,p,g){var w=l.interleaved;return w===null?(p.next=p,xf(l)):(p.next=w.next,w.next=p),l.interleaved=p,pi(a,g)}function pi(a,l){a.lanes|=l;var p=a.alternate;for(p!==null&&(p.lanes|=l),p=a,a=a.return;a!==null;)a.childLanes|=l,p=a.alternate,p!==null&&(p.childLanes|=l),p=a,a=a.return;return p.tag===3?p.stateNode:null}var $i=!1;function vf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sp(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function mi(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function qi(a,l,p){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(ct&2)!==0){var w=g.pending;return w===null?l.next=l:(l.next=w.next,w.next=l),g.pending=l,pi(a,p)}return w=g.interleaved,w===null?(l.next=l,xf(g)):(l.next=w.next,w.next=l),g.interleaved=l,pi(a,p)}function Kl(a,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194240)!==0)){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Rc(a,p)}}function op(a,l){var p=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,p===g)){var w=null,S=null;if(p=p.firstBaseUpdate,p!==null){do{var N={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};S===null?w=S=N:S=S.next=N,p=p.next}while(p!==null);S===null?w=S=l:S=S.next=l}else w=S=l;p={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:S,shared:g.shared,effects:g.effects},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=l:a.next=l,p.lastBaseUpdate=l}function Jl(a,l,p,g){var w=a.updateQueue;$i=!1;var S=w.firstBaseUpdate,N=w.lastBaseUpdate,W=w.shared.pending;if(W!==null){w.shared.pending=null;var X=W,de=X.next;X.next=null,N===null?S=de:N.next=de,N=X;var Ae=a.alternate;Ae!==null&&(Ae=Ae.updateQueue,W=Ae.lastBaseUpdate,W!==N&&(W===null?Ae.firstBaseUpdate=de:W.next=de,Ae.lastBaseUpdate=X))}if(S!==null){var Ne=w.baseState;N=0,Ae=de=X=null,W=S;do{var Ee=W.lane,Be=W.eventTime;if((g&Ee)===Ee){Ae!==null&&(Ae=Ae.next={eventTime:Be,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var be=a,Ve=W;switch(Ee=l,Be=p,Ve.tag){case 1:if(be=Ve.payload,typeof be=="function"){Ne=be.call(Be,Ne,Ee);break e}Ne=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Ve.payload,Ee=typeof be=="function"?be.call(Be,Ne,Ee):be,Ee==null)break e;Ne=H({},Ne,Ee);break e;case 2:$i=!0}}W.callback!==null&&W.lane!==0&&(a.flags|=64,Ee=w.effects,Ee===null?w.effects=[W]:Ee.push(W))}else Be={eventTime:Be,lane:Ee,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Ae===null?(de=Ae=Be,X=Ne):Ae=Ae.next=Be,N|=Ee;if(W=W.next,W===null){if(W=w.shared.pending,W===null)break;Ee=W,W=Ee.next,Ee.next=null,w.lastBaseUpdate=Ee,w.shared.pending=null}}while(!0);if(Ae===null&&(X=Ne),w.baseState=X,w.firstBaseUpdate=de,w.lastBaseUpdate=Ae,l=w.shared.interleaved,l!==null){w=l;do N|=w.lane,w=w.next;while(w!==l)}else S===null&&(w.shared.lanes=0);Ca|=N,a.lanes=N,a.memoizedState=Ne}}function lp(a,l,p){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var g=a[l],w=g.callback;if(w!==null){if(g.callback=null,g=p,typeof w!="function")throw Error(n(191,w));w.call(g)}}}var up=new e.Component().refs;function yf(a,l,p,g){l=a.memoizedState,p=p(g,l),p=p==null?l:H({},l,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var Xl={isMounted:function(a){return(a=a._reactInternals)?V(a)===a:!1},enqueueSetState:function(a,l,p){a=a._reactInternals;var g=Hn(),w=Yi(a),S=mi(g,w);S.payload=l,p!=null&&(S.callback=p),l=qi(a,S,w),l!==null&&(Vr(l,a,w,g),Kl(l,a,w))},enqueueReplaceState:function(a,l,p){a=a._reactInternals;var g=Hn(),w=Yi(a),S=mi(g,w);S.tag=1,S.payload=l,p!=null&&(S.callback=p),l=qi(a,S,w),l!==null&&(Vr(l,a,w,g),Kl(l,a,w))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var p=Hn(),g=Yi(a),w=mi(p,g);w.tag=2,l!=null&&(w.callback=l),l=qi(a,w,g),l!==null&&(Vr(l,a,g,p),Kl(l,a,g))}};function cp(a,l,p,g,w,S,N){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,S,N):l.prototype&&l.prototype.isPureReactComponent?!ho(p,g)||!ho(w,S):!0}function fp(a,l,p){var g=!1,w=Gi,S=l.contextType;return typeof S=="object"&&S!==null?S=yr(S):(w=Zn(l)?wa:An.current,g=l.contextTypes,S=(g=g!=null)?ms(a,w):Gi),l=new l(p,S),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Xl,a.stateNode=l,l._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=w,a.__reactInternalMemoizedMaskedChildContext=S),l}function dp(a,l,p,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,g),l.state!==a&&Xl.enqueueReplaceState(l,l.state,null)}function wf(a,l,p,g){var w=a.stateNode;w.props=p,w.state=a.memoizedState,w.refs=up,vf(a);var S=l.contextType;typeof S=="object"&&S!==null?w.context=yr(S):(S=Zn(l)?wa:An.current,w.context=ms(a,S)),w.state=a.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(yf(a,l,S,p),w.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(l=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),l!==w.state&&Xl.enqueueReplaceState(w,w.state,null),Jl(a,p,w,g),w.state=a.memoizedState),typeof w.componentDidMount=="function"&&(a.flags|=4194308)}function wo(a,l,p){if(a=p.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(n(309));var g=p.stateNode}if(!g)throw Error(n(147,a));var w=g,S=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===S?l.ref:(l=function(N){var W=w.refs;W===up&&(W=w.refs={}),N===null?delete W[S]:W[S]=N},l._stringRef=S,l)}if(typeof a!="string")throw Error(n(284));if(!p._owner)throw Error(n(290,a))}return a}function Yl(a,l){throw a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function hp(a){var l=a._init;return l(a._payload)}function pp(a){function l(re,ee){if(a){var oe=re.deletions;oe===null?(re.deletions=[ee],re.flags|=16):oe.push(ee)}}function p(re,ee){if(!a)return null;for(;ee!==null;)l(re,ee),ee=ee.sibling;return null}function g(re,ee){for(re=new Map;ee!==null;)ee.key!==null?re.set(ee.key,ee):re.set(ee.index,ee),ee=ee.sibling;return re}function w(re,ee){return re=Qi(re,ee),re.index=0,re.sibling=null,re}function S(re,ee,oe){return re.index=oe,a?(oe=re.alternate,oe!==null?(oe=oe.index,oe<ee?(re.flags|=2,ee):oe):(re.flags|=2,ee)):(re.flags|=1048576,ee)}function N(re){return a&&re.alternate===null&&(re.flags|=2),re}function W(re,ee,oe,Re){return ee===null||ee.tag!==6?(ee=r0(oe,re.mode,Re),ee.return=re,ee):(ee=w(ee,oe),ee.return=re,ee)}function X(re,ee,oe,Re){var He=oe.type;return He===F?Ae(re,ee,oe.props.children,Re,oe.key):ee!==null&&(ee.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===Fe&&hp(He)===ee.type)?(Re=w(ee,oe.props),Re.ref=wo(re,ee,oe),Re.return=re,Re):(Re=gu(oe.type,oe.key,oe.props,null,re.mode,Re),Re.ref=wo(re,ee,oe),Re.return=re,Re)}function de(re,ee,oe,Re){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=i0(oe,re.mode,Re),ee.return=re,ee):(ee=w(ee,oe.children||[]),ee.return=re,ee)}function Ae(re,ee,oe,Re,He){return ee===null||ee.tag!==7?(ee=Fa(oe,re.mode,Re,He),ee.return=re,ee):(ee=w(ee,oe),ee.return=re,ee)}function Ne(re,ee,oe){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=r0(""+ee,re.mode,oe),ee.return=re,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case M:return oe=gu(ee.type,ee.key,ee.props,null,re.mode,oe),oe.ref=wo(re,null,ee),oe.return=re,oe;case P:return ee=i0(ee,re.mode,oe),ee.return=re,ee;case Fe:var Re=ee._init;return Ne(re,Re(ee._payload),oe)}if(Xt(ee)||Z(ee))return ee=Fa(ee,re.mode,oe,null),ee.return=re,ee;Yl(re,ee)}return null}function Ee(re,ee,oe,Re){var He=ee!==null?ee.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number")return He!==null?null:W(re,ee,""+oe,Re);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case M:return oe.key===He?X(re,ee,oe,Re):null;case P:return oe.key===He?de(re,ee,oe,Re):null;case Fe:return He=oe._init,Ee(re,ee,He(oe._payload),Re)}if(Xt(oe)||Z(oe))return He!==null?null:Ae(re,ee,oe,Re,null);Yl(re,oe)}return null}function Be(re,ee,oe,Re,He){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return re=re.get(oe)||null,W(ee,re,""+Re,He);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case M:return re=re.get(Re.key===null?oe:Re.key)||null,X(ee,re,Re,He);case P:return re=re.get(Re.key===null?oe:Re.key)||null,de(ee,re,Re,He);case Fe:var je=Re._init;return Be(re,ee,oe,je(Re._payload),He)}if(Xt(Re)||Z(Re))return re=re.get(oe)||null,Ae(ee,re,Re,He,null);Yl(ee,Re)}return null}function be(re,ee,oe,Re){for(var He=null,je=null,$e=ee,Ze=ee=0,pn=null;$e!==null&&Ze<oe.length;Ze++){$e.index>Ze?(pn=$e,$e=null):pn=$e.sibling;var pt=Ee(re,$e,oe[Ze],Re);if(pt===null){$e===null&&($e=pn);break}a&&$e&&pt.alternate===null&&l(re,$e),ee=S(pt,ee,Ze),je===null?He=pt:je.sibling=pt,je=pt,$e=pn}if(Ze===oe.length)return p(re,$e),Bt&&Ta(re,Ze),He;if($e===null){for(;Ze<oe.length;Ze++)$e=Ne(re,oe[Ze],Re),$e!==null&&(ee=S($e,ee,Ze),je===null?He=$e:je.sibling=$e,je=$e);return Bt&&Ta(re,Ze),He}for($e=g(re,$e);Ze<oe.length;Ze++)pn=Be($e,re,Ze,oe[Ze],Re),pn!==null&&(a&&pn.alternate!==null&&$e.delete(pn.key===null?Ze:pn.key),ee=S(pn,ee,Ze),je===null?He=pn:je.sibling=pn,je=pn);return a&&$e.forEach(function(ea){return l(re,ea)}),Bt&&Ta(re,Ze),He}function Ve(re,ee,oe,Re){var He=Z(oe);if(typeof He!="function")throw Error(n(150));if(oe=He.call(oe),oe==null)throw Error(n(151));for(var je=He=null,$e=ee,Ze=ee=0,pn=null,pt=oe.next();$e!==null&&!pt.done;Ze++,pt=oe.next()){$e.index>Ze?(pn=$e,$e=null):pn=$e.sibling;var ea=Ee(re,$e,pt.value,Re);if(ea===null){$e===null&&($e=pn);break}a&&$e&&ea.alternate===null&&l(re,$e),ee=S(ea,ee,Ze),je===null?He=ea:je.sibling=ea,je=ea,$e=pn}if(pt.done)return p(re,$e),Bt&&Ta(re,Ze),He;if($e===null){for(;!pt.done;Ze++,pt=oe.next())pt=Ne(re,pt.value,Re),pt!==null&&(ee=S(pt,ee,Ze),je===null?He=pt:je.sibling=pt,je=pt);return Bt&&Ta(re,Ze),He}for($e=g(re,$e);!pt.done;Ze++,pt=oe.next())pt=Be($e,re,Ze,pt.value,Re),pt!==null&&(a&&pt.alternate!==null&&$e.delete(pt.key===null?Ze:pt.key),ee=S(pt,ee,Ze),je===null?He=pt:je.sibling=pt,je=pt);return a&&$e.forEach(function(n2){return l(re,n2)}),Bt&&Ta(re,Ze),He}function Yt(re,ee,oe,Re){if(typeof oe=="object"&&oe!==null&&oe.type===F&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case M:e:{for(var He=oe.key,je=ee;je!==null;){if(je.key===He){if(He=oe.type,He===F){if(je.tag===7){p(re,je.sibling),ee=w(je,oe.props.children),ee.return=re,re=ee;break e}}else if(je.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===Fe&&hp(He)===je.type){p(re,je.sibling),ee=w(je,oe.props),ee.ref=wo(re,je,oe),ee.return=re,re=ee;break e}p(re,je);break}else l(re,je);je=je.sibling}oe.type===F?(ee=Fa(oe.props.children,re.mode,Re,oe.key),ee.return=re,re=ee):(Re=gu(oe.type,oe.key,oe.props,null,re.mode,Re),Re.ref=wo(re,ee,oe),Re.return=re,re=Re)}return N(re);case P:e:{for(je=oe.key;ee!==null;){if(ee.key===je)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){p(re,ee.sibling),ee=w(ee,oe.children||[]),ee.return=re,re=ee;break e}else{p(re,ee);break}else l(re,ee);ee=ee.sibling}ee=i0(oe,re.mode,Re),ee.return=re,re=ee}return N(re);case Fe:return je=oe._init,Yt(re,ee,je(oe._payload),Re)}if(Xt(oe))return be(re,ee,oe,Re);if(Z(oe))return Ve(re,ee,oe,Re);Yl(re,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"?(oe=""+oe,ee!==null&&ee.tag===6?(p(re,ee.sibling),ee=w(ee,oe),ee.return=re,re=ee):(p(re,ee),ee=r0(oe,re.mode,Re),ee.return=re,re=ee),N(re)):p(re,ee)}return Yt}var _s=pp(!0),mp=pp(!1),_o={},Yr=Wi(_o),To=Wi(_o),So=Wi(_o);function ka(a){if(a===_o)throw Error(n(174));return a}function _f(a,l){switch(Nt(So,l),Nt(To,a),Nt(Yr,_o),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Kn(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=Kn(l,a)}Dt(Yr),Nt(Yr,l)}function Ts(){Dt(Yr),Dt(To),Dt(So)}function gp(a){ka(So.current);var l=ka(Yr.current),p=Kn(l,a.type);l!==p&&(Nt(To,a),Nt(Yr,p))}function Tf(a){To.current===a&&(Dt(Yr),Dt(To))}var zt=Wi(0);function Zl(a){for(var l=a;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Sf=[];function kf(){for(var a=0;a<Sf.length;a++)Sf[a]._workInProgressVersionPrimary=null;Sf.length=0}var Ql=D.ReactCurrentDispatcher,Ef=D.ReactCurrentBatchConfig,Ea=0,bt=null,on=null,dn=null,eu=!1,ko=!1,Eo=0,k_=0;function In(){throw Error(n(321))}function Cf(a,l){if(l===null)return!1;for(var p=0;p<l.length&&p<a.length;p++)if(!Or(a[p],l[p]))return!1;return!0}function Af(a,l,p,g,w,S){if(Ea=S,bt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Ql.current=a===null||a.memoizedState===null?I_:N_,a=p(g,w),ko){S=0;do{if(ko=!1,Eo=0,25<=S)throw Error(n(301));S+=1,dn=on=null,l.updateQueue=null,Ql.current=F_,a=p(g,w)}while(ko)}if(Ql.current=ru,l=on!==null&&on.next!==null,Ea=0,dn=on=bt=null,eu=!1,l)throw Error(n(300));return a}function If(){var a=Eo!==0;return Eo=0,a}function Zr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?bt.memoizedState=dn=a:dn=dn.next=a,dn}function wr(){if(on===null){var a=bt.alternate;a=a!==null?a.memoizedState:null}else a=on.next;var l=dn===null?bt.memoizedState:dn.next;if(l!==null)dn=l,on=a;else{if(a===null)throw Error(n(310));on=a,a={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},dn===null?bt.memoizedState=dn=a:dn=dn.next=a}return dn}function Co(a,l){return typeof l=="function"?l(a):l}function Nf(a){var l=wr(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=a;var g=on,w=g.baseQueue,S=p.pending;if(S!==null){if(w!==null){var N=w.next;w.next=S.next,S.next=N}g.baseQueue=w=S,p.pending=null}if(w!==null){S=w.next,g=g.baseState;var W=N=null,X=null,de=S;do{var Ae=de.lane;if((Ea&Ae)===Ae)X!==null&&(X=X.next={lane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),g=de.hasEagerState?de.eagerState:a(g,de.action);else{var Ne={lane:Ae,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null};X===null?(W=X=Ne,N=g):X=X.next=Ne,bt.lanes|=Ae,Ca|=Ae}de=de.next}while(de!==null&&de!==S);X===null?N=g:X.next=W,Or(g,l.memoizedState)||(Qn=!0),l.memoizedState=g,l.baseState=N,l.baseQueue=X,p.lastRenderedState=g}if(a=p.interleaved,a!==null){w=a;do S=w.lane,bt.lanes|=S,Ca|=S,w=w.next;while(w!==a)}else w===null&&(p.lanes=0);return[l.memoizedState,p.dispatch]}function Ff(a){var l=wr(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=a;var g=p.dispatch,w=p.pending,S=l.memoizedState;if(w!==null){p.pending=null;var N=w=w.next;do S=a(S,N.action),N=N.next;while(N!==w);Or(S,l.memoizedState)||(Qn=!0),l.memoizedState=S,l.baseQueue===null&&(l.baseState=S),p.lastRenderedState=S}return[S,g]}function xp(){}function vp(a,l){var p=bt,g=wr(),w=l(),S=!Or(g.memoizedState,w);if(S&&(g.memoizedState=w,Qn=!0),g=g.queue,Rf(_p.bind(null,p,g,a),[a]),g.getSnapshot!==l||S||dn!==null&&dn.memoizedState.tag&1){if(p.flags|=2048,Ao(9,wp.bind(null,p,g,w,l),void 0,null),hn===null)throw Error(n(349));(Ea&30)!==0||yp(p,l,w)}return w}function yp(a,l,p){a.flags|=16384,a={getSnapshot:l,value:p},l=bt.updateQueue,l===null?(l={lastEffect:null,stores:null},bt.updateQueue=l,l.stores=[a]):(p=l.stores,p===null?l.stores=[a]:p.push(a))}function wp(a,l,p,g){l.value=p,l.getSnapshot=g,Tp(l)&&Sp(a)}function _p(a,l,p){return p(function(){Tp(l)&&Sp(a)})}function Tp(a){var l=a.getSnapshot;a=a.value;try{var p=l();return!Or(a,p)}catch{return!0}}function Sp(a){var l=pi(a,1);l!==null&&Vr(l,a,1,-1)}function kp(a){var l=Zr();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:a},l.queue=a,a=a.dispatch=A_.bind(null,bt,a),[l.memoizedState,a]}function Ao(a,l,p,g){return a={tag:a,create:l,destroy:p,deps:g,next:null},l=bt.updateQueue,l===null?(l={lastEffect:null,stores:null},bt.updateQueue=l,l.lastEffect=a.next=a):(p=l.lastEffect,p===null?l.lastEffect=a.next=a:(g=p.next,p.next=a,a.next=g,l.lastEffect=a)),a}function Ep(){return wr().memoizedState}function tu(a,l,p,g){var w=Zr();bt.flags|=a,w.memoizedState=Ao(1|l,p,void 0,g===void 0?null:g)}function nu(a,l,p,g){var w=wr();g=g===void 0?null:g;var S=void 0;if(on!==null){var N=on.memoizedState;if(S=N.destroy,g!==null&&Cf(g,N.deps)){w.memoizedState=Ao(l,p,S,g);return}}bt.flags|=a,w.memoizedState=Ao(1|l,p,S,g)}function Cp(a,l){return tu(8390656,8,a,l)}function Rf(a,l){return nu(2048,8,a,l)}function Ap(a,l){return nu(4,2,a,l)}function Ip(a,l){return nu(4,4,a,l)}function Np(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Fp(a,l,p){return p=p!=null?p.concat([a]):null,nu(4,4,Np.bind(null,l,a),p)}function Df(){}function Rp(a,l){var p=wr();l=l===void 0?null:l;var g=p.memoizedState;return g!==null&&l!==null&&Cf(l,g[1])?g[0]:(p.memoizedState=[a,l],a)}function Dp(a,l){var p=wr();l=l===void 0?null:l;var g=p.memoizedState;return g!==null&&l!==null&&Cf(l,g[1])?g[0]:(a=a(),p.memoizedState=[a,l],a)}function Pp(a,l,p){return(Ea&21)===0?(a.baseState&&(a.baseState=!1,Qn=!0),a.memoizedState=p):(Or(p,l)||(p=ah(),bt.lanes|=p,Ca|=p,a.baseState=!0),l)}function E_(a,l){var p=wt;wt=p!==0&&4>p?p:4,a(!0);var g=Ef.transition;Ef.transition={};try{a(!1),l()}finally{wt=p,Ef.transition=g}}function Mp(){return wr().memoizedState}function C_(a,l,p){var g=Yi(a);if(p={lane:g,action:p,hasEagerState:!1,eagerState:null,next:null},Lp(a))Op(l,p);else if(p=ap(a,l,p,g),p!==null){var w=Hn();Vr(p,a,g,w),Bp(p,l,g)}}function A_(a,l,p){var g=Yi(a),w={lane:g,action:p,hasEagerState:!1,eagerState:null,next:null};if(Lp(a))Op(l,w);else{var S=a.alternate;if(a.lanes===0&&(S===null||S.lanes===0)&&(S=l.lastRenderedReducer,S!==null))try{var N=l.lastRenderedState,W=S(N,p);if(w.hasEagerState=!0,w.eagerState=W,Or(W,N)){var X=l.interleaved;X===null?(w.next=w,xf(l)):(w.next=X.next,X.next=w),l.interleaved=w;return}}catch{}finally{}p=ap(a,l,w,g),p!==null&&(w=Hn(),Vr(p,a,g,w),Bp(p,l,g))}}function Lp(a){var l=a.alternate;return a===bt||l!==null&&l===bt}function Op(a,l){ko=eu=!0;var p=a.pending;p===null?l.next=l:(l.next=p.next,p.next=l),a.pending=l}function Bp(a,l,p){if((p&4194240)!==0){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Rc(a,p)}}var ru={readContext:yr,useCallback:In,useContext:In,useEffect:In,useImperativeHandle:In,useInsertionEffect:In,useLayoutEffect:In,useMemo:In,useReducer:In,useRef:In,useState:In,useDebugValue:In,useDeferredValue:In,useTransition:In,useMutableSource:In,useSyncExternalStore:In,useId:In,unstable_isNewReconciler:!1},I_={readContext:yr,useCallback:function(a,l){return Zr().memoizedState=[a,l===void 0?null:l],a},useContext:yr,useEffect:Cp,useImperativeHandle:function(a,l,p){return p=p!=null?p.concat([a]):null,tu(4194308,4,Np.bind(null,l,a),p)},useLayoutEffect:function(a,l){return tu(4194308,4,a,l)},useInsertionEffect:function(a,l){return tu(4,2,a,l)},useMemo:function(a,l){var p=Zr();return l=l===void 0?null:l,a=a(),p.memoizedState=[a,l],a},useReducer:function(a,l,p){var g=Zr();return l=p!==void 0?p(l):l,g.memoizedState=g.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},g.queue=a,a=a.dispatch=C_.bind(null,bt,a),[g.memoizedState,a]},useRef:function(a){var l=Zr();return a={current:a},l.memoizedState=a},useState:kp,useDebugValue:Df,useDeferredValue:function(a){return Zr().memoizedState=a},useTransition:function(){var a=kp(!1),l=a[0];return a=E_.bind(null,a[1]),Zr().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,p){var g=bt,w=Zr();if(Bt){if(p===void 0)throw Error(n(407));p=p()}else{if(p=l(),hn===null)throw Error(n(349));(Ea&30)!==0||yp(g,l,p)}w.memoizedState=p;var S={value:p,getSnapshot:l};return w.queue=S,Cp(_p.bind(null,g,S,a),[a]),g.flags|=2048,Ao(9,wp.bind(null,g,S,p,l),void 0,null),p},useId:function(){var a=Zr(),l=hn.identifierPrefix;if(Bt){var p=hi,g=di;p=(g&~(1<<32-Ut(g)-1)).toString(32)+p,l=":"+l+"R"+p,p=Eo++,0<p&&(l+="H"+p.toString(32)),l+=":"}else p=k_++,l=":"+l+"r"+p.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},N_={readContext:yr,useCallback:Rp,useContext:yr,useEffect:Rf,useImperativeHandle:Fp,useInsertionEffect:Ap,useLayoutEffect:Ip,useMemo:Dp,useReducer:Nf,useRef:Ep,useState:function(){return Nf(Co)},useDebugValue:Df,useDeferredValue:function(a){var l=wr();return Pp(l,on.memoizedState,a)},useTransition:function(){var a=Nf(Co)[0],l=wr().memoizedState;return[a,l]},useMutableSource:xp,useSyncExternalStore:vp,useId:Mp,unstable_isNewReconciler:!1},F_={readContext:yr,useCallback:Rp,useContext:yr,useEffect:Rf,useImperativeHandle:Fp,useInsertionEffect:Ap,useLayoutEffect:Ip,useMemo:Dp,useReducer:Ff,useRef:Ep,useState:function(){return Ff(Co)},useDebugValue:Df,useDeferredValue:function(a){var l=wr();return on===null?l.memoizedState=a:Pp(l,on.memoizedState,a)},useTransition:function(){var a=Ff(Co)[0],l=wr().memoizedState;return[a,l]},useMutableSource:xp,useSyncExternalStore:vp,useId:Mp,unstable_isNewReconciler:!1};function Ss(a,l){try{var p="",g=l;do p+=K(g),g=g.return;while(g);var w=p}catch(S){w=`
Error generating stack: `+S.message+`
`+S.stack}return{value:a,source:l,stack:w,digest:null}}function Pf(a,l,p){return{value:a,source:null,stack:p??null,digest:l??null}}function Mf(a,l){try{console.error(l.value)}catch(p){setTimeout(function(){throw p})}}var R_=typeof WeakMap=="function"?WeakMap:Map;function Up(a,l,p){p=mi(-1,p),p.tag=3,p.payload={element:null};var g=l.value;return p.callback=function(){cu||(cu=!0,Jf=g),Mf(a,l)},p}function zp(a,l,p){p=mi(-1,p),p.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var w=l.value;p.payload=function(){return g(w)},p.callback=function(){Mf(a,l)}}var S=a.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(p.callback=function(){Mf(a,l),typeof g!="function"&&(Ji===null?Ji=new Set([this]):Ji.add(this));var N=l.stack;this.componentDidCatch(l.value,{componentStack:N!==null?N:""})}),p}function bp(a,l,p){var g=a.pingCache;if(g===null){g=a.pingCache=new R_;var w=new Set;g.set(l,w)}else w=g.get(l),w===void 0&&(w=new Set,g.set(l,w));w.has(p)||(w.add(p),a=j_.bind(null,a,l,p),l.then(a,a))}function Vp(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function Hp(a,l,p,g,w){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(l=mi(-1,1),l.tag=2,qi(p,l,1))),p.lanes|=1),a):(a.flags|=65536,a.lanes=w,a)}var D_=D.ReactCurrentOwner,Qn=!1;function Vn(a,l,p,g){l.child=a===null?mp(l,null,p,g):_s(l,a.child,p,g)}function Wp(a,l,p,g,w){p=p.render;var S=l.ref;return ws(l,w),g=Af(a,l,p,g,S,w),p=If(),a!==null&&!Qn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~w,gi(a,l,w)):(Bt&&p&&lf(l),l.flags|=1,Vn(a,l,g,w),l.child)}function Gp(a,l,p,g,w){if(a===null){var S=p.type;return typeof S=="function"&&!n0(S)&&S.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(l.tag=15,l.type=S,jp(a,l,S,g,w)):(a=gu(p.type,null,g,l,l.mode,w),a.ref=l.ref,a.return=l,l.child=a)}if(S=a.child,(a.lanes&w)===0){var N=S.memoizedProps;if(p=p.compare,p=p!==null?p:ho,p(N,g)&&a.ref===l.ref)return gi(a,l,w)}return l.flags|=1,a=Qi(S,g),a.ref=l.ref,a.return=l,l.child=a}function jp(a,l,p,g,w){if(a!==null){var S=a.memoizedProps;if(ho(S,g)&&a.ref===l.ref)if(Qn=!1,l.pendingProps=g=S,(a.lanes&w)!==0)(a.flags&131072)!==0&&(Qn=!0);else return l.lanes=a.lanes,gi(a,l,w)}return Lf(a,l,p,g,w)}function $p(a,l,p){var g=l.pendingProps,w=g.children,S=a!==null?a.memoizedState:null;if(g.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(Es,cr),cr|=p;else{if((p&1073741824)===0)return a=S!==null?S.baseLanes|p:p,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,Nt(Es,cr),cr|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=S!==null?S.baseLanes:p,Nt(Es,cr),cr|=g}else S!==null?(g=S.baseLanes|p,l.memoizedState=null):g=p,Nt(Es,cr),cr|=g;return Vn(a,l,w,p),l.child}function qp(a,l){var p=l.ref;(a===null&&p!==null||a!==null&&a.ref!==p)&&(l.flags|=512,l.flags|=2097152)}function Lf(a,l,p,g,w){var S=Zn(p)?wa:An.current;return S=ms(l,S),ws(l,w),p=Af(a,l,p,g,S,w),g=If(),a!==null&&!Qn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~w,gi(a,l,w)):(Bt&&g&&lf(l),l.flags|=1,Vn(a,l,p,w),l.child)}function Kp(a,l,p,g,w){if(Zn(p)){var S=!0;Vl(l)}else S=!1;if(ws(l,w),l.stateNode===null)au(a,l),fp(l,p,g),wf(l,p,g,w),g=!0;else if(a===null){var N=l.stateNode,W=l.memoizedProps;N.props=W;var X=N.context,de=p.contextType;typeof de=="object"&&de!==null?de=yr(de):(de=Zn(p)?wa:An.current,de=ms(l,de));var Ae=p.getDerivedStateFromProps,Ne=typeof Ae=="function"||typeof N.getSnapshotBeforeUpdate=="function";Ne||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(W!==g||X!==de)&&dp(l,N,g,de),$i=!1;var Ee=l.memoizedState;N.state=Ee,Jl(l,g,N,w),X=l.memoizedState,W!==g||Ee!==X||Yn.current||$i?(typeof Ae=="function"&&(yf(l,p,Ae,g),X=l.memoizedState),(W=$i||cp(l,p,W,g,Ee,X,de))?(Ne||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(l.flags|=4194308)):(typeof N.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=X),N.props=g,N.state=X,N.context=de,g=W):(typeof N.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{N=l.stateNode,sp(a,l),W=l.memoizedProps,de=l.type===l.elementType?W:Ur(l.type,W),N.props=de,Ne=l.pendingProps,Ee=N.context,X=p.contextType,typeof X=="object"&&X!==null?X=yr(X):(X=Zn(p)?wa:An.current,X=ms(l,X));var Be=p.getDerivedStateFromProps;(Ae=typeof Be=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(W!==Ne||Ee!==X)&&dp(l,N,g,X),$i=!1,Ee=l.memoizedState,N.state=Ee,Jl(l,g,N,w);var be=l.memoizedState;W!==Ne||Ee!==be||Yn.current||$i?(typeof Be=="function"&&(yf(l,p,Be,g),be=l.memoizedState),(de=$i||cp(l,p,de,g,Ee,be,X)||!1)?(Ae||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(g,be,X),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(g,be,X)),typeof N.componentDidUpdate=="function"&&(l.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof N.componentDidUpdate!="function"||W===a.memoizedProps&&Ee===a.memoizedState||(l.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||W===a.memoizedProps&&Ee===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=be),N.props=g,N.state=be,N.context=X,g=de):(typeof N.componentDidUpdate!="function"||W===a.memoizedProps&&Ee===a.memoizedState||(l.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||W===a.memoizedProps&&Ee===a.memoizedState||(l.flags|=1024),g=!1)}return Of(a,l,p,g,S,w)}function Of(a,l,p,g,w,S){qp(a,l);var N=(l.flags&128)!==0;if(!g&&!N)return w&&Zh(l,p,!1),gi(a,l,S);g=l.stateNode,D_.current=l;var W=N&&typeof p.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,a!==null&&N?(l.child=_s(l,a.child,null,S),l.child=_s(l,null,W,S)):Vn(a,l,W,S),l.memoizedState=g.state,w&&Zh(l,p,!0),l.child}function Jp(a){var l=a.stateNode;l.pendingContext?Xh(a,l.pendingContext,l.pendingContext!==l.context):l.context&&Xh(a,l.context,!1),_f(a,l.containerInfo)}function Xp(a,l,p,g,w){return vs(),df(w),l.flags|=256,Vn(a,l,p,g),l.child}var Bf={dehydrated:null,treeContext:null,retryLane:0};function Uf(a){return{baseLanes:a,cachePool:null,transitions:null}}function Yp(a,l,p){var g=l.pendingProps,w=zt.current,S=!1,N=(l.flags&128)!==0,W;if((W=N)||(W=a!==null&&a.memoizedState===null?!1:(w&2)!==0),W?(S=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(w|=1),Nt(zt,w&1),a===null)return ff(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(N=g.children,a=g.fallback,S?(g=l.mode,S=l.child,N={mode:"hidden",children:N},(g&1)===0&&S!==null?(S.childLanes=0,S.pendingProps=N):S=xu(N,g,0,null),a=Fa(a,g,p,null),S.return=l,a.return=l,S.sibling=a,l.child=S,l.child.memoizedState=Uf(p),l.memoizedState=Bf,a):zf(l,N));if(w=a.memoizedState,w!==null&&(W=w.dehydrated,W!==null))return P_(a,l,N,g,W,w,p);if(S){S=g.fallback,N=l.mode,w=a.child,W=w.sibling;var X={mode:"hidden",children:g.children};return(N&1)===0&&l.child!==w?(g=l.child,g.childLanes=0,g.pendingProps=X,l.deletions=null):(g=Qi(w,X),g.subtreeFlags=w.subtreeFlags&14680064),W!==null?S=Qi(W,S):(S=Fa(S,N,p,null),S.flags|=2),S.return=l,g.return=l,g.sibling=S,l.child=g,g=S,S=l.child,N=a.child.memoizedState,N=N===null?Uf(p):{baseLanes:N.baseLanes|p,cachePool:null,transitions:N.transitions},S.memoizedState=N,S.childLanes=a.childLanes&~p,l.memoizedState=Bf,g}return S=a.child,a=S.sibling,g=Qi(S,{mode:"visible",children:g.children}),(l.mode&1)===0&&(g.lanes=p),g.return=l,g.sibling=null,a!==null&&(p=l.deletions,p===null?(l.deletions=[a],l.flags|=16):p.push(a)),l.child=g,l.memoizedState=null,g}function zf(a,l){return l=xu({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function iu(a,l,p,g){return g!==null&&df(g),_s(l,a.child,null,p),a=zf(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function P_(a,l,p,g,w,S,N){if(p)return l.flags&256?(l.flags&=-257,g=Pf(Error(n(422))),iu(a,l,N,g)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(S=g.fallback,w=l.mode,g=xu({mode:"visible",children:g.children},w,0,null),S=Fa(S,w,N,null),S.flags|=2,g.return=l,S.return=l,g.sibling=S,l.child=g,(l.mode&1)!==0&&_s(l,a.child,null,N),l.child.memoizedState=Uf(N),l.memoizedState=Bf,S);if((l.mode&1)===0)return iu(a,l,N,null);if(w.data==="$!"){if(g=w.nextSibling&&w.nextSibling.dataset,g)var W=g.dgst;return g=W,S=Error(n(419)),g=Pf(S,g,void 0),iu(a,l,N,g)}if(W=(N&a.childLanes)!==0,Qn||W){if(g=hn,g!==null){switch(N&-N){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(g.suspendedLanes|N))!==0?0:w,w!==0&&w!==S.retryLane&&(S.retryLane=w,pi(a,w),Vr(g,a,w,-1))}return t0(),g=Pf(Error(n(421))),iu(a,l,N,g)}return w.data==="$?"?(l.flags|=128,l.child=a.child,l=$_.bind(null,a),w._reactRetry=l,null):(a=S.treeContext,ur=Hi(w.nextSibling),lr=l,Bt=!0,Br=null,a!==null&&(xr[vr++]=di,xr[vr++]=hi,xr[vr++]=_a,di=a.id,hi=a.overflow,_a=l),l=zf(l,g.children),l.flags|=4096,l)}function Zp(a,l,p){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),gf(a.return,l,p)}function bf(a,l,p,g,w){var S=a.memoizedState;S===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:p,tailMode:w}:(S.isBackwards=l,S.rendering=null,S.renderingStartTime=0,S.last=g,S.tail=p,S.tailMode=w)}function Qp(a,l,p){var g=l.pendingProps,w=g.revealOrder,S=g.tail;if(Vn(a,l,g.children,p),g=zt.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Zp(a,p,l);else if(a.tag===19)Zp(a,p,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(Nt(zt,g),(l.mode&1)===0)l.memoizedState=null;else switch(w){case"forwards":for(p=l.child,w=null;p!==null;)a=p.alternate,a!==null&&Zl(a)===null&&(w=p),p=p.sibling;p=w,p===null?(w=l.child,l.child=null):(w=p.sibling,p.sibling=null),bf(l,!1,w,p,S);break;case"backwards":for(p=null,w=l.child,l.child=null;w!==null;){if(a=w.alternate,a!==null&&Zl(a)===null){l.child=w;break}a=w.sibling,w.sibling=p,p=w,w=a}bf(l,!0,p,null,S);break;case"together":bf(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function au(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function gi(a,l,p){if(a!==null&&(l.dependencies=a.dependencies),Ca|=l.lanes,(p&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,p=Qi(a,a.pendingProps),l.child=p,p.return=l;a.sibling!==null;)a=a.sibling,p=p.sibling=Qi(a,a.pendingProps),p.return=l;p.sibling=null}return l.child}function M_(a,l,p){switch(l.tag){case 3:Jp(l),vs();break;case 5:gp(l);break;case 1:Zn(l.type)&&Vl(l);break;case 4:_f(l,l.stateNode.containerInfo);break;case 10:var g=l.type._context,w=l.memoizedProps.value;Nt($l,g._currentValue),g._currentValue=w;break;case 13:if(g=l.memoizedState,g!==null)return g.dehydrated!==null?(Nt(zt,zt.current&1),l.flags|=128,null):(p&l.child.childLanes)!==0?Yp(a,l,p):(Nt(zt,zt.current&1),a=gi(a,l,p),a!==null?a.sibling:null);Nt(zt,zt.current&1);break;case 19:if(g=(p&l.childLanes)!==0,(a.flags&128)!==0){if(g)return Qp(a,l,p);l.flags|=128}if(w=l.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Nt(zt,zt.current),g)break;return null;case 22:case 23:return l.lanes=0,$p(a,l,p)}return gi(a,l,p)}var em,Vf,tm,nm;em=function(a,l){for(var p=l.child;p!==null;){if(p.tag===5||p.tag===6)a.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===l)break;for(;p.sibling===null;){if(p.return===null||p.return===l)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Vf=function(){},tm=function(a,l,p,g){var w=a.memoizedProps;if(w!==g){a=l.stateNode,ka(Yr.current);var S=null;switch(p){case"input":w=it(a,w),g=it(a,g),S=[];break;case"select":w=H({},w,{value:void 0}),g=H({},g,{value:void 0}),S=[];break;case"textarea":w=yn(a,w),g=yn(a,g),S=[];break;default:typeof w.onClick!="function"&&typeof g.onClick=="function"&&(a.onclick=Ul)}Fi(p,g);var N;p=null;for(de in w)if(!g.hasOwnProperty(de)&&w.hasOwnProperty(de)&&w[de]!=null)if(de==="style"){var W=w[de];for(N in W)W.hasOwnProperty(N)&&(p||(p={}),p[N]="")}else de!=="dangerouslySetInnerHTML"&&de!=="children"&&de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(i.hasOwnProperty(de)?S||(S=[]):(S=S||[]).push(de,null));for(de in g){var X=g[de];if(W=w!=null?w[de]:void 0,g.hasOwnProperty(de)&&X!==W&&(X!=null||W!=null))if(de==="style")if(W){for(N in W)!W.hasOwnProperty(N)||X&&X.hasOwnProperty(N)||(p||(p={}),p[N]="");for(N in X)X.hasOwnProperty(N)&&W[N]!==X[N]&&(p||(p={}),p[N]=X[N])}else p||(S||(S=[]),S.push(de,p)),p=X;else de==="dangerouslySetInnerHTML"?(X=X?X.__html:void 0,W=W?W.__html:void 0,X!=null&&W!==X&&(S=S||[]).push(de,X)):de==="children"?typeof X!="string"&&typeof X!="number"||(S=S||[]).push(de,""+X):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&(i.hasOwnProperty(de)?(X!=null&&de==="onScroll"&&Rt("scroll",a),S||W===X||(S=[])):(S=S||[]).push(de,X))}p&&(S=S||[]).push("style",p);var de=S;(l.updateQueue=de)&&(l.flags|=4)}},nm=function(a,l,p,g){p!==g&&(l.flags|=4)};function Io(a,l){if(!Bt)switch(a.tailMode){case"hidden":l=a.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var g=null;p!==null;)p.alternate!==null&&(g=p),p=p.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Nn(a){var l=a.alternate!==null&&a.alternate.child===a.child,p=0,g=0;if(l)for(var w=a.child;w!==null;)p|=w.lanes|w.childLanes,g|=w.subtreeFlags&14680064,g|=w.flags&14680064,w.return=a,w=w.sibling;else for(w=a.child;w!==null;)p|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=a,w=w.sibling;return a.subtreeFlags|=g,a.childLanes=p,l}function L_(a,l,p){var g=l.pendingProps;switch(uf(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(l),null;case 1:return Zn(l.type)&&bl(),Nn(l),null;case 3:return g=l.stateNode,Ts(),Dt(Yn),Dt(An),kf(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(jl(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Br!==null&&(Zf(Br),Br=null))),Vf(a,l),Nn(l),null;case 5:Tf(l);var w=ka(So.current);if(p=l.type,a!==null&&l.stateNode!=null)tm(a,l,p,g,w),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(n(166));return Nn(l),null}if(a=ka(Yr.current),jl(l)){g=l.stateNode,p=l.type;var S=l.memoizedProps;switch(g[Xr]=l,g[vo]=S,a=(l.mode&1)!==0,p){case"dialog":Rt("cancel",g),Rt("close",g);break;case"iframe":case"object":case"embed":Rt("load",g);break;case"video":case"audio":for(w=0;w<mo.length;w++)Rt(mo[w],g);break;case"source":Rt("error",g);break;case"img":case"image":case"link":Rt("error",g),Rt("load",g);break;case"details":Rt("toggle",g);break;case"input":ht(g,S),Rt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!S.multiple},Rt("invalid",g);break;case"textarea":$n(g,S),Rt("invalid",g)}Fi(p,S),w=null;for(var N in S)if(S.hasOwnProperty(N)){var W=S[N];N==="children"?typeof W=="string"?g.textContent!==W&&(S.suppressHydrationWarning!==!0&&Bl(g.textContent,W,a),w=["children",W]):typeof W=="number"&&g.textContent!==""+W&&(S.suppressHydrationWarning!==!0&&Bl(g.textContent,W,a),w=["children",""+W]):i.hasOwnProperty(N)&&W!=null&&N==="onScroll"&&Rt("scroll",g)}switch(p){case"input":Je(g),At(g,S,!0);break;case"textarea":Je(g),qn(g);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(g.onclick=Ul)}g=w,l.updateQueue=g,g!==null&&(l.flags|=4)}else{N=w.nodeType===9?w:w.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=sn(p)),a==="http://www.w3.org/1999/xhtml"?p==="script"?(a=N.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof g.is=="string"?a=N.createElement(p,{is:g.is}):(a=N.createElement(p),p==="select"&&(N=a,g.multiple?N.multiple=!0:g.size&&(N.size=g.size))):a=N.createElementNS(a,p),a[Xr]=l,a[vo]=g,em(a,l,!1,!1),l.stateNode=a;e:{switch(N=ha(p,g),p){case"dialog":Rt("cancel",a),Rt("close",a),w=g;break;case"iframe":case"object":case"embed":Rt("load",a),w=g;break;case"video":case"audio":for(w=0;w<mo.length;w++)Rt(mo[w],a);w=g;break;case"source":Rt("error",a),w=g;break;case"img":case"image":case"link":Rt("error",a),Rt("load",a),w=g;break;case"details":Rt("toggle",a),w=g;break;case"input":ht(a,g),w=it(a,g),Rt("invalid",a);break;case"option":w=g;break;case"select":a._wrapperState={wasMultiple:!!g.multiple},w=H({},g,{value:void 0}),Rt("invalid",a);break;case"textarea":$n(a,g),w=yn(a,g),Rt("invalid",a);break;default:w=g}Fi(p,w),W=w;for(S in W)if(W.hasOwnProperty(S)){var X=W[S];S==="style"?vt(a,X):S==="dangerouslySetInnerHTML"?(X=X?X.__html:void 0,X!=null&&wn(a,X)):S==="children"?typeof X=="string"?(p!=="textarea"||X!=="")&&Qe(a,X):typeof X=="number"&&Qe(a,""+X):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(i.hasOwnProperty(S)?X!=null&&S==="onScroll"&&Rt("scroll",a):X!=null&&C(a,S,X,N))}switch(p){case"input":Je(a),At(a,g,!1);break;case"textarea":Je(a),qn(a);break;case"option":g.value!=null&&a.setAttribute("value",""+ve(g.value));break;case"select":a.multiple=!!g.multiple,S=g.value,S!=null?Ft(a,!!g.multiple,S,!1):g.defaultValue!=null&&Ft(a,!!g.multiple,g.defaultValue,!0);break;default:typeof w.onClick=="function"&&(a.onclick=Ul)}switch(p){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Nn(l),null;case 6:if(a&&l.stateNode!=null)nm(a,l,a.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(n(166));if(p=ka(So.current),ka(Yr.current),jl(l)){if(g=l.stateNode,p=l.memoizedProps,g[Xr]=l,(S=g.nodeValue!==p)&&(a=lr,a!==null))switch(a.tag){case 3:Bl(g.nodeValue,p,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Bl(g.nodeValue,p,(a.mode&1)!==0)}S&&(l.flags|=4)}else g=(p.nodeType===9?p:p.ownerDocument).createTextNode(g),g[Xr]=l,l.stateNode=g}return Nn(l),null;case 13:if(Dt(zt),g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Bt&&ur!==null&&(l.mode&1)!==0&&(l.flags&128)===0)ip(),vs(),l.flags|=98560,S=!1;else if(S=jl(l),g!==null&&g.dehydrated!==null){if(a===null){if(!S)throw Error(n(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Xr]=l}else vs(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Nn(l),S=!1}else Br!==null&&(Zf(Br),Br=null),S=!0;if(!S)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=p,l):(g=g!==null,g!==(a!==null&&a.memoizedState!==null)&&g&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(zt.current&1)!==0?ln===0&&(ln=3):t0())),l.updateQueue!==null&&(l.flags|=4),Nn(l),null);case 4:return Ts(),Vf(a,l),a===null&&go(l.stateNode.containerInfo),Nn(l),null;case 10:return mf(l.type._context),Nn(l),null;case 17:return Zn(l.type)&&bl(),Nn(l),null;case 19:if(Dt(zt),S=l.memoizedState,S===null)return Nn(l),null;if(g=(l.flags&128)!==0,N=S.rendering,N===null)if(g)Io(S,!1);else{if(ln!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(N=Zl(a),N!==null){for(l.flags|=128,Io(S,!1),g=N.updateQueue,g!==null&&(l.updateQueue=g,l.flags|=4),l.subtreeFlags=0,g=p,p=l.child;p!==null;)S=p,a=g,S.flags&=14680066,N=S.alternate,N===null?(S.childLanes=0,S.lanes=a,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=N.childLanes,S.lanes=N.lanes,S.child=N.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=N.memoizedProps,S.memoizedState=N.memoizedState,S.updateQueue=N.updateQueue,S.type=N.type,a=N.dependencies,S.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),p=p.sibling;return Nt(zt,zt.current&1|2),l.child}a=a.sibling}S.tail!==null&&he()>Cs&&(l.flags|=128,g=!0,Io(S,!1),l.lanes=4194304)}else{if(!g)if(a=Zl(N),a!==null){if(l.flags|=128,g=!0,p=a.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),Io(S,!0),S.tail===null&&S.tailMode==="hidden"&&!N.alternate&&!Bt)return Nn(l),null}else 2*he()-S.renderingStartTime>Cs&&p!==1073741824&&(l.flags|=128,g=!0,Io(S,!1),l.lanes=4194304);S.isBackwards?(N.sibling=l.child,l.child=N):(p=S.last,p!==null?p.sibling=N:l.child=N,S.last=N)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=he(),l.sibling=null,p=zt.current,Nt(zt,g?p&1|2:p&1),l):(Nn(l),null);case 22:case 23:return e0(),g=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==g&&(l.flags|=8192),g&&(l.mode&1)!==0?(cr&1073741824)!==0&&(Nn(l),l.subtreeFlags&6&&(l.flags|=8192)):Nn(l),null;case 24:return null;case 25:return null}throw Error(n(156,l.tag))}function O_(a,l){switch(uf(l),l.tag){case 1:return Zn(l.type)&&bl(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Ts(),Dt(Yn),Dt(An),kf(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return Tf(l),null;case 13:if(Dt(zt),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));vs()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return Dt(zt),null;case 4:return Ts(),null;case 10:return mf(l.type._context),null;case 22:case 23:return e0(),null;case 24:return null;default:return null}}var su=!1,Fn=!1,B_=typeof WeakSet=="function"?WeakSet:Set,ze=null;function ks(a,l){var p=a.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(g){jt(a,l,g)}else p.current=null}function Hf(a,l,p){try{p()}catch(g){jt(a,l,g)}}var rm=!1;function U_(a,l){if(Qc=Cl,a=Mh(),jc(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var g=p.getSelection&&p.getSelection();if(g&&g.rangeCount!==0){p=g.anchorNode;var w=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{p.nodeType,S.nodeType}catch{p=null;break e}var N=0,W=-1,X=-1,de=0,Ae=0,Ne=a,Ee=null;t:for(;;){for(var Be;Ne!==p||w!==0&&Ne.nodeType!==3||(W=N+w),Ne!==S||g!==0&&Ne.nodeType!==3||(X=N+g),Ne.nodeType===3&&(N+=Ne.nodeValue.length),(Be=Ne.firstChild)!==null;)Ee=Ne,Ne=Be;for(;;){if(Ne===a)break t;if(Ee===p&&++de===w&&(W=N),Ee===S&&++Ae===g&&(X=N),(Be=Ne.nextSibling)!==null)break;Ne=Ee,Ee=Ne.parentNode}Ne=Be}p=W===-1||X===-1?null:{start:W,end:X}}else p=null}p=p||{start:0,end:0}}else p=null;for(ef={focusedElem:a,selectionRange:p},Cl=!1,ze=l;ze!==null;)if(l=ze,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,ze=a;else for(;ze!==null;){l=ze;try{var be=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(be!==null){var Ve=be.memoizedProps,Yt=be.memoizedState,re=l.stateNode,ee=re.getSnapshotBeforeUpdate(l.elementType===l.type?Ve:Ur(l.type,Ve),Yt);re.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var oe=l.stateNode.containerInfo;oe.nodeType===1?oe.textContent="":oe.nodeType===9&&oe.documentElement&&oe.removeChild(oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Re){jt(l,l.return,Re)}if(a=l.sibling,a!==null){a.return=l.return,ze=a;break}ze=l.return}return be=rm,rm=!1,be}function No(a,l,p){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&a)===a){var S=w.destroy;w.destroy=void 0,S!==void 0&&Hf(l,p,S)}w=w.next}while(w!==g)}}function ou(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var p=l=l.next;do{if((p.tag&a)===a){var g=p.create;p.destroy=g()}p=p.next}while(p!==l)}}function Wf(a){var l=a.ref;if(l!==null){var p=a.stateNode;switch(a.tag){case 5:a=p;break;default:a=p}typeof l=="function"?l(a):l.current=a}}function im(a){var l=a.alternate;l!==null&&(a.alternate=null,im(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Xr],delete l[vo],delete l[af],delete l[w_],delete l[__])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function am(a){return a.tag===5||a.tag===3||a.tag===4}function sm(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||am(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Gf(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?p.nodeType===8?p.parentNode.insertBefore(a,l):p.insertBefore(a,l):(p.nodeType===8?(l=p.parentNode,l.insertBefore(a,p)):(l=p,l.appendChild(a)),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=Ul));else if(g!==4&&(a=a.child,a!==null))for(Gf(a,l,p),a=a.sibling;a!==null;)Gf(a,l,p),a=a.sibling}function jf(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?p.insertBefore(a,l):p.appendChild(a);else if(g!==4&&(a=a.child,a!==null))for(jf(a,l,p),a=a.sibling;a!==null;)jf(a,l,p),a=a.sibling}var _n=null,zr=!1;function Ki(a,l,p){for(p=p.child;p!==null;)om(a,l,p),p=p.sibling}function om(a,l,p){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(Xn,p)}catch{}switch(p.tag){case 5:Fn||ks(p,l);case 6:var g=_n,w=zr;_n=null,Ki(a,l,p),_n=g,zr=w,_n!==null&&(zr?(a=_n,p=p.stateNode,a.nodeType===8?a.parentNode.removeChild(p):a.removeChild(p)):_n.removeChild(p.stateNode));break;case 18:_n!==null&&(zr?(a=_n,p=p.stateNode,a.nodeType===8?rf(a.parentNode,p):a.nodeType===1&&rf(a,p),so(a)):rf(_n,p.stateNode));break;case 4:g=_n,w=zr,_n=p.stateNode.containerInfo,zr=!0,Ki(a,l,p),_n=g,zr=w;break;case 0:case 11:case 14:case 15:if(!Fn&&(g=p.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){w=g=g.next;do{var S=w,N=S.destroy;S=S.tag,N!==void 0&&((S&2)!==0||(S&4)!==0)&&Hf(p,l,N),w=w.next}while(w!==g)}Ki(a,l,p);break;case 1:if(!Fn&&(ks(p,l),g=p.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=p.memoizedProps,g.state=p.memoizedState,g.componentWillUnmount()}catch(W){jt(p,l,W)}Ki(a,l,p);break;case 21:Ki(a,l,p);break;case 22:p.mode&1?(Fn=(g=Fn)||p.memoizedState!==null,Ki(a,l,p),Fn=g):Ki(a,l,p);break;default:Ki(a,l,p)}}function lm(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var p=a.stateNode;p===null&&(p=a.stateNode=new B_),l.forEach(function(g){var w=q_.bind(null,a,g);p.has(g)||(p.add(g),g.then(w,w))})}}function br(a,l){var p=l.deletions;if(p!==null)for(var g=0;g<p.length;g++){var w=p[g];try{var S=a,N=l,W=N;e:for(;W!==null;){switch(W.tag){case 5:_n=W.stateNode,zr=!1;break e;case 3:_n=W.stateNode.containerInfo,zr=!0;break e;case 4:_n=W.stateNode.containerInfo,zr=!0;break e}W=W.return}if(_n===null)throw Error(n(160));om(S,N,w),_n=null,zr=!1;var X=w.alternate;X!==null&&(X.return=null),w.return=null}catch(de){jt(w,l,de)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)um(l,a),l=l.sibling}function um(a,l){var p=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(br(l,a),Qr(a),g&4){try{No(3,a,a.return),ou(3,a)}catch(Ve){jt(a,a.return,Ve)}try{No(5,a,a.return)}catch(Ve){jt(a,a.return,Ve)}}break;case 1:br(l,a),Qr(a),g&512&&p!==null&&ks(p,p.return);break;case 5:if(br(l,a),Qr(a),g&512&&p!==null&&ks(p,p.return),a.flags&32){var w=a.stateNode;try{Qe(w,"")}catch(Ve){jt(a,a.return,Ve)}}if(g&4&&(w=a.stateNode,w!=null)){var S=a.memoizedProps,N=p!==null?p.memoizedProps:S,W=a.type,X=a.updateQueue;if(a.updateQueue=null,X!==null)try{W==="input"&&S.type==="radio"&&S.name!=null&&et(w,S),ha(W,N);var de=ha(W,S);for(N=0;N<X.length;N+=2){var Ae=X[N],Ne=X[N+1];Ae==="style"?vt(w,Ne):Ae==="dangerouslySetInnerHTML"?wn(w,Ne):Ae==="children"?Qe(w,Ne):C(w,Ae,Ne,de)}switch(W){case"input":Oe(w,S);break;case"textarea":fn(w,S);break;case"select":var Ee=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!S.multiple;var Be=S.value;Be!=null?Ft(w,!!S.multiple,Be,!1):Ee!==!!S.multiple&&(S.defaultValue!=null?Ft(w,!!S.multiple,S.defaultValue,!0):Ft(w,!!S.multiple,S.multiple?[]:"",!1))}w[vo]=S}catch(Ve){jt(a,a.return,Ve)}}break;case 6:if(br(l,a),Qr(a),g&4){if(a.stateNode===null)throw Error(n(162));w=a.stateNode,S=a.memoizedProps;try{w.nodeValue=S}catch(Ve){jt(a,a.return,Ve)}}break;case 3:if(br(l,a),Qr(a),g&4&&p!==null&&p.memoizedState.isDehydrated)try{so(l.containerInfo)}catch(Ve){jt(a,a.return,Ve)}break;case 4:br(l,a),Qr(a);break;case 13:br(l,a),Qr(a),w=a.child,w.flags&8192&&(S=w.memoizedState!==null,w.stateNode.isHidden=S,!S||w.alternate!==null&&w.alternate.memoizedState!==null||(Kf=he())),g&4&&lm(a);break;case 22:if(Ae=p!==null&&p.memoizedState!==null,a.mode&1?(Fn=(de=Fn)||Ae,br(l,a),Fn=de):br(l,a),Qr(a),g&8192){if(de=a.memoizedState!==null,(a.stateNode.isHidden=de)&&!Ae&&(a.mode&1)!==0)for(ze=a,Ae=a.child;Ae!==null;){for(Ne=ze=Ae;ze!==null;){switch(Ee=ze,Be=Ee.child,Ee.tag){case 0:case 11:case 14:case 15:No(4,Ee,Ee.return);break;case 1:ks(Ee,Ee.return);var be=Ee.stateNode;if(typeof be.componentWillUnmount=="function"){g=Ee,p=Ee.return;try{l=g,be.props=l.memoizedProps,be.state=l.memoizedState,be.componentWillUnmount()}catch(Ve){jt(g,p,Ve)}}break;case 5:ks(Ee,Ee.return);break;case 22:if(Ee.memoizedState!==null){dm(Ne);continue}}Be!==null?(Be.return=Ee,ze=Be):dm(Ne)}Ae=Ae.sibling}e:for(Ae=null,Ne=a;;){if(Ne.tag===5){if(Ae===null){Ae=Ne;try{w=Ne.stateNode,de?(S=w.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(W=Ne.stateNode,X=Ne.memoizedProps.style,N=X!=null&&X.hasOwnProperty("display")?X.display:null,W.style.display=It("display",N))}catch(Ve){jt(a,a.return,Ve)}}}else if(Ne.tag===6){if(Ae===null)try{Ne.stateNode.nodeValue=de?"":Ne.memoizedProps}catch(Ve){jt(a,a.return,Ve)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===a)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===a)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===a)break e;Ae===Ne&&(Ae=null),Ne=Ne.return}Ae===Ne&&(Ae=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:br(l,a),Qr(a),g&4&&lm(a);break;case 21:break;default:br(l,a),Qr(a)}}function Qr(a){var l=a.flags;if(l&2){try{e:{for(var p=a.return;p!==null;){if(am(p)){var g=p;break e}p=p.return}throw Error(n(160))}switch(g.tag){case 5:var w=g.stateNode;g.flags&32&&(Qe(w,""),g.flags&=-33);var S=sm(a);jf(a,S,w);break;case 3:case 4:var N=g.stateNode.containerInfo,W=sm(a);Gf(a,W,N);break;default:throw Error(n(161))}}catch(X){jt(a,a.return,X)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function z_(a,l,p){ze=a,cm(a)}function cm(a,l,p){for(var g=(a.mode&1)!==0;ze!==null;){var w=ze,S=w.child;if(w.tag===22&&g){var N=w.memoizedState!==null||su;if(!N){var W=w.alternate,X=W!==null&&W.memoizedState!==null||Fn;W=su;var de=Fn;if(su=N,(Fn=X)&&!de)for(ze=w;ze!==null;)N=ze,X=N.child,N.tag===22&&N.memoizedState!==null?hm(w):X!==null?(X.return=N,ze=X):hm(w);for(;S!==null;)ze=S,cm(S),S=S.sibling;ze=w,su=W,Fn=de}fm(a)}else(w.subtreeFlags&8772)!==0&&S!==null?(S.return=w,ze=S):fm(a)}}function fm(a){for(;ze!==null;){var l=ze;if((l.flags&8772)!==0){var p=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Fn||ou(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!Fn)if(p===null)g.componentDidMount();else{var w=l.elementType===l.type?p.memoizedProps:Ur(l.type,p.memoizedProps);g.componentDidUpdate(w,p.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var S=l.updateQueue;S!==null&&lp(l,S,g);break;case 3:var N=l.updateQueue;if(N!==null){if(p=null,l.child!==null)switch(l.child.tag){case 5:p=l.child.stateNode;break;case 1:p=l.child.stateNode}lp(l,N,p)}break;case 5:var W=l.stateNode;if(p===null&&l.flags&4){p=W;var X=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":X.autoFocus&&p.focus();break;case"img":X.src&&(p.src=X.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var de=l.alternate;if(de!==null){var Ae=de.memoizedState;if(Ae!==null){var Ne=Ae.dehydrated;Ne!==null&&so(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Fn||l.flags&512&&Wf(l)}catch(Ee){jt(l,l.return,Ee)}}if(l===a){ze=null;break}if(p=l.sibling,p!==null){p.return=l.return,ze=p;break}ze=l.return}}function dm(a){for(;ze!==null;){var l=ze;if(l===a){ze=null;break}var p=l.sibling;if(p!==null){p.return=l.return,ze=p;break}ze=l.return}}function hm(a){for(;ze!==null;){var l=ze;try{switch(l.tag){case 0:case 11:case 15:var p=l.return;try{ou(4,l)}catch(X){jt(l,p,X)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var w=l.return;try{g.componentDidMount()}catch(X){jt(l,w,X)}}var S=l.return;try{Wf(l)}catch(X){jt(l,S,X)}break;case 5:var N=l.return;try{Wf(l)}catch(X){jt(l,N,X)}}}catch(X){jt(l,l.return,X)}if(l===a){ze=null;break}var W=l.sibling;if(W!==null){W.return=l.return,ze=W;break}ze=l.return}}var b_=Math.ceil,lu=D.ReactCurrentDispatcher,$f=D.ReactCurrentOwner,_r=D.ReactCurrentBatchConfig,ct=0,hn=null,tn=null,Tn=0,cr=0,Es=Wi(0),ln=0,Fo=null,Ca=0,uu=0,qf=0,Ro=null,er=null,Kf=0,Cs=1/0,xi=null,cu=!1,Jf=null,Ji=null,fu=!1,Xi=null,du=0,Do=0,Xf=null,hu=-1,pu=0;function Hn(){return(ct&6)!==0?he():hu!==-1?hu:hu=he()}function Yi(a){return(a.mode&1)===0?1:(ct&2)!==0&&Tn!==0?Tn&-Tn:S_.transition!==null?(pu===0&&(pu=ah()),pu):(a=wt,a!==0||(a=window.event,a=a===void 0?16:ph(a.type)),a)}function Vr(a,l,p,g){if(50<Do)throw Do=0,Xf=null,Error(n(185));to(a,p,g),((ct&2)===0||a!==hn)&&(a===hn&&((ct&2)===0&&(uu|=p),ln===4&&Zi(a,Tn)),tr(a,g),p===1&&ct===0&&(l.mode&1)===0&&(Cs=he()+500,Hl&&ji()))}function tr(a,l){var p=a.callbackNode;Ic(a,l);var g=Jr(a,a===hn?Tn:0);if(g===0)p!==null&&Le(p),a.callbackNode=null,a.callbackPriority=0;else if(l=g&-g,a.callbackPriority!==l){if(p!=null&&Le(p),l===1)a.tag===0?T_(mm.bind(null,a)):Qh(mm.bind(null,a)),v_(function(){(ct&6)===0&&ji()}),p=null;else{switch(sh(g)){case 1:p=lt;break;case 4:p=tt;break;case 16:p=Ct;break;case 536870912:p=Jn;break;default:p=Ct}p=Sm(p,pm.bind(null,a))}a.callbackPriority=l,a.callbackNode=p}}function pm(a,l){if(hu=-1,pu=0,(ct&6)!==0)throw Error(n(327));var p=a.callbackNode;if(As()&&a.callbackNode!==p)return null;var g=Jr(a,a===hn?Tn:0);if(g===0)return null;if((g&30)!==0||(g&a.expiredLanes)!==0||l)l=mu(a,g);else{l=g;var w=ct;ct|=2;var S=xm();(hn!==a||Tn!==l)&&(xi=null,Cs=he()+500,Ia(a,l));do try{W_();break}catch(W){gm(a,W)}while(!0);pf(),lu.current=S,ct=w,tn!==null?l=0:(hn=null,Tn=0,l=ln)}if(l!==0){if(l===2&&(w=Nc(a),w!==0&&(g=w,l=Yf(a,w))),l===1)throw p=Fo,Ia(a,0),Zi(a,g),tr(a,he()),p;if(l===6)Zi(a,g);else{if(w=a.current.alternate,(g&30)===0&&!V_(w)&&(l=mu(a,g),l===2&&(S=Nc(a),S!==0&&(g=S,l=Yf(a,S))),l===1))throw p=Fo,Ia(a,0),Zi(a,g),tr(a,he()),p;switch(a.finishedWork=w,a.finishedLanes=g,l){case 0:case 1:throw Error(n(345));case 2:Na(a,er,xi);break;case 3:if(Zi(a,g),(g&130023424)===g&&(l=Kf+500-he(),10<l)){if(Jr(a,0)!==0)break;if(w=a.suspendedLanes,(w&g)!==g){Hn(),a.pingedLanes|=a.suspendedLanes&w;break}a.timeoutHandle=nf(Na.bind(null,a,er,xi),l);break}Na(a,er,xi);break;case 4:if(Zi(a,g),(g&4194240)===g)break;for(l=a.eventTimes,w=-1;0<g;){var N=31-Ut(g);S=1<<N,N=l[N],N>w&&(w=N),g&=~S}if(g=w,g=he()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*b_(g/1960))-g,10<g){a.timeoutHandle=nf(Na.bind(null,a,er,xi),g);break}Na(a,er,xi);break;case 5:Na(a,er,xi);break;default:throw Error(n(329))}}}return tr(a,he()),a.callbackNode===p?pm.bind(null,a):null}function Yf(a,l){var p=Ro;return a.current.memoizedState.isDehydrated&&(Ia(a,l).flags|=256),a=mu(a,l),a!==2&&(l=er,er=p,l!==null&&Zf(l)),a}function Zf(a){er===null?er=a:er.push.apply(er,a)}function V_(a){for(var l=a;;){if(l.flags&16384){var p=l.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var g=0;g<p.length;g++){var w=p[g],S=w.getSnapshot;w=w.value;try{if(!Or(S(),w))return!1}catch{return!1}}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Zi(a,l){for(l&=~qf,l&=~uu,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var p=31-Ut(l),g=1<<p;a[p]=-1,l&=~g}}function mm(a){if((ct&6)!==0)throw Error(n(327));As();var l=Jr(a,0);if((l&1)===0)return tr(a,he()),null;var p=mu(a,l);if(a.tag!==0&&p===2){var g=Nc(a);g!==0&&(l=g,p=Yf(a,g))}if(p===1)throw p=Fo,Ia(a,0),Zi(a,l),tr(a,he()),p;if(p===6)throw Error(n(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Na(a,er,xi),tr(a,he()),null}function Qf(a,l){var p=ct;ct|=1;try{return a(l)}finally{ct=p,ct===0&&(Cs=he()+500,Hl&&ji())}}function Aa(a){Xi!==null&&Xi.tag===0&&(ct&6)===0&&As();var l=ct;ct|=1;var p=_r.transition,g=wt;try{if(_r.transition=null,wt=1,a)return a()}finally{wt=g,_r.transition=p,ct=l,(ct&6)===0&&ji()}}function e0(){cr=Es.current,Dt(Es)}function Ia(a,l){a.finishedWork=null,a.finishedLanes=0;var p=a.timeoutHandle;if(p!==-1&&(a.timeoutHandle=-1,x_(p)),tn!==null)for(p=tn.return;p!==null;){var g=p;switch(uf(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&bl();break;case 3:Ts(),Dt(Yn),Dt(An),kf();break;case 5:Tf(g);break;case 4:Ts();break;case 13:Dt(zt);break;case 19:Dt(zt);break;case 10:mf(g.type._context);break;case 22:case 23:e0()}p=p.return}if(hn=a,tn=a=Qi(a.current,null),Tn=cr=l,ln=0,Fo=null,qf=uu=Ca=0,er=Ro=null,Sa!==null){for(l=0;l<Sa.length;l++)if(p=Sa[l],g=p.interleaved,g!==null){p.interleaved=null;var w=g.next,S=p.pending;if(S!==null){var N=S.next;S.next=w,g.next=N}p.pending=g}Sa=null}return a}function gm(a,l){do{var p=tn;try{if(pf(),Ql.current=ru,eu){for(var g=bt.memoizedState;g!==null;){var w=g.queue;w!==null&&(w.pending=null),g=g.next}eu=!1}if(Ea=0,dn=on=bt=null,ko=!1,Eo=0,$f.current=null,p===null||p.return===null){ln=1,Fo=l,tn=null;break}e:{var S=a,N=p.return,W=p,X=l;if(l=Tn,W.flags|=32768,X!==null&&typeof X=="object"&&typeof X.then=="function"){var de=X,Ae=W,Ne=Ae.tag;if((Ae.mode&1)===0&&(Ne===0||Ne===11||Ne===15)){var Ee=Ae.alternate;Ee?(Ae.updateQueue=Ee.updateQueue,Ae.memoizedState=Ee.memoizedState,Ae.lanes=Ee.lanes):(Ae.updateQueue=null,Ae.memoizedState=null)}var Be=Vp(N);if(Be!==null){Be.flags&=-257,Hp(Be,N,W,S,l),Be.mode&1&&bp(S,de,l),l=Be,X=de;var be=l.updateQueue;if(be===null){var Ve=new Set;Ve.add(X),l.updateQueue=Ve}else be.add(X);break e}else{if((l&1)===0){bp(S,de,l),t0();break e}X=Error(n(426))}}else if(Bt&&W.mode&1){var Yt=Vp(N);if(Yt!==null){(Yt.flags&65536)===0&&(Yt.flags|=256),Hp(Yt,N,W,S,l),df(Ss(X,W));break e}}S=X=Ss(X,W),ln!==4&&(ln=2),Ro===null?Ro=[S]:Ro.push(S),S=N;do{switch(S.tag){case 3:S.flags|=65536,l&=-l,S.lanes|=l;var re=Up(S,X,l);op(S,re);break e;case 1:W=X;var ee=S.type,oe=S.stateNode;if((S.flags&128)===0&&(typeof ee.getDerivedStateFromError=="function"||oe!==null&&typeof oe.componentDidCatch=="function"&&(Ji===null||!Ji.has(oe)))){S.flags|=65536,l&=-l,S.lanes|=l;var Re=zp(S,W,l);op(S,Re);break e}}S=S.return}while(S!==null)}ym(p)}catch(He){l=He,tn===p&&p!==null&&(tn=p=p.return);continue}break}while(!0)}function xm(){var a=lu.current;return lu.current=ru,a===null?ru:a}function t0(){(ln===0||ln===3||ln===2)&&(ln=4),hn===null||(Ca&268435455)===0&&(uu&268435455)===0||Zi(hn,Tn)}function mu(a,l){var p=ct;ct|=2;var g=xm();(hn!==a||Tn!==l)&&(xi=null,Ia(a,l));do try{H_();break}catch(w){gm(a,w)}while(!0);if(pf(),ct=p,lu.current=g,tn!==null)throw Error(n(261));return hn=null,Tn=0,ln}function H_(){for(;tn!==null;)vm(tn)}function W_(){for(;tn!==null&&!ne();)vm(tn)}function vm(a){var l=Tm(a.alternate,a,cr);a.memoizedProps=a.pendingProps,l===null?ym(a):tn=l,$f.current=null}function ym(a){var l=a;do{var p=l.alternate;if(a=l.return,(l.flags&32768)===0){if(p=L_(p,l,cr),p!==null){tn=p;return}}else{if(p=O_(p,l),p!==null){p.flags&=32767,tn=p;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{ln=6,tn=null;return}}if(l=l.sibling,l!==null){tn=l;return}tn=l=a}while(l!==null);ln===0&&(ln=5)}function Na(a,l,p){var g=wt,w=_r.transition;try{_r.transition=null,wt=1,G_(a,l,p,g)}finally{_r.transition=w,wt=g}return null}function G_(a,l,p,g){do As();while(Xi!==null);if((ct&6)!==0)throw Error(n(327));p=a.finishedWork;var w=a.finishedLanes;if(p===null)return null;if(a.finishedWork=null,a.finishedLanes=0,p===a.current)throw Error(n(177));a.callbackNode=null,a.callbackPriority=0;var S=p.lanes|p.childLanes;if(kw(a,S),a===hn&&(tn=hn=null,Tn=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||fu||(fu=!0,Sm(Ct,function(){return As(),null})),S=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||S){S=_r.transition,_r.transition=null;var N=wt;wt=1;var W=ct;ct|=4,$f.current=null,U_(a,p),um(p,a),c_(ef),Cl=!!Qc,ef=Qc=null,a.current=p,z_(p),ae(),ct=W,wt=N,_r.transition=S}else a.current=p;if(fu&&(fu=!1,Xi=a,du=w),S=a.pendingLanes,S===0&&(Ji=null),ga(p.stateNode),tr(a,he()),l!==null)for(g=a.onRecoverableError,p=0;p<l.length;p++)w=l[p],g(w.value,{componentStack:w.stack,digest:w.digest});if(cu)throw cu=!1,a=Jf,Jf=null,a;return(du&1)!==0&&a.tag!==0&&As(),S=a.pendingLanes,(S&1)!==0?a===Xf?Do++:(Do=0,Xf=a):Do=0,ji(),null}function As(){if(Xi!==null){var a=sh(du),l=_r.transition,p=wt;try{if(_r.transition=null,wt=16>a?16:a,Xi===null)var g=!1;else{if(a=Xi,Xi=null,du=0,(ct&6)!==0)throw Error(n(331));var w=ct;for(ct|=4,ze=a.current;ze!==null;){var S=ze,N=S.child;if((ze.flags&16)!==0){var W=S.deletions;if(W!==null){for(var X=0;X<W.length;X++){var de=W[X];for(ze=de;ze!==null;){var Ae=ze;switch(Ae.tag){case 0:case 11:case 15:No(8,Ae,S)}var Ne=Ae.child;if(Ne!==null)Ne.return=Ae,ze=Ne;else for(;ze!==null;){Ae=ze;var Ee=Ae.sibling,Be=Ae.return;if(im(Ae),Ae===de){ze=null;break}if(Ee!==null){Ee.return=Be,ze=Ee;break}ze=Be}}}var be=S.alternate;if(be!==null){var Ve=be.child;if(Ve!==null){be.child=null;do{var Yt=Ve.sibling;Ve.sibling=null,Ve=Yt}while(Ve!==null)}}ze=S}}if((S.subtreeFlags&2064)!==0&&N!==null)N.return=S,ze=N;else e:for(;ze!==null;){if(S=ze,(S.flags&2048)!==0)switch(S.tag){case 0:case 11:case 15:No(9,S,S.return)}var re=S.sibling;if(re!==null){re.return=S.return,ze=re;break e}ze=S.return}}var ee=a.current;for(ze=ee;ze!==null;){N=ze;var oe=N.child;if((N.subtreeFlags&2064)!==0&&oe!==null)oe.return=N,ze=oe;else e:for(N=ee;ze!==null;){if(W=ze,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:ou(9,W)}}catch(He){jt(W,W.return,He)}if(W===N){ze=null;break e}var Re=W.sibling;if(Re!==null){Re.return=W.return,ze=Re;break e}ze=W.return}}if(ct=w,ji(),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(Xn,a)}catch{}g=!0}return g}finally{wt=p,_r.transition=l}}return!1}function wm(a,l,p){l=Ss(p,l),l=Up(a,l,1),a=qi(a,l,1),l=Hn(),a!==null&&(to(a,1,l),tr(a,l))}function jt(a,l,p){if(a.tag===3)wm(a,a,p);else for(;l!==null;){if(l.tag===3){wm(l,a,p);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ji===null||!Ji.has(g))){a=Ss(p,a),a=zp(l,a,1),l=qi(l,a,1),a=Hn(),l!==null&&(to(l,1,a),tr(l,a));break}}l=l.return}}function j_(a,l,p){var g=a.pingCache;g!==null&&g.delete(l),l=Hn(),a.pingedLanes|=a.suspendedLanes&p,hn===a&&(Tn&p)===p&&(ln===4||ln===3&&(Tn&130023424)===Tn&&500>he()-Kf?Ia(a,0):qf|=p),tr(a,l)}function _m(a,l){l===0&&((a.mode&1)===0?l=1:(l=va,va<<=1,(va&130023424)===0&&(va=4194304)));var p=Hn();a=pi(a,l),a!==null&&(to(a,l,p),tr(a,p))}function $_(a){var l=a.memoizedState,p=0;l!==null&&(p=l.retryLane),_m(a,p)}function q_(a,l){var p=0;switch(a.tag){case 13:var g=a.stateNode,w=a.memoizedState;w!==null&&(p=w.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(n(314))}g!==null&&g.delete(l),_m(a,p)}var Tm;Tm=function(a,l,p){if(a!==null)if(a.memoizedProps!==l.pendingProps||Yn.current)Qn=!0;else{if((a.lanes&p)===0&&(l.flags&128)===0)return Qn=!1,M_(a,l,p);Qn=(a.flags&131072)!==0}else Qn=!1,Bt&&(l.flags&1048576)!==0&&ep(l,Gl,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;au(a,l),a=l.pendingProps;var w=ms(l,An.current);ws(l,p),w=Af(null,l,g,a,w,p);var S=If();return l.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Zn(g)?(S=!0,Vl(l)):S=!1,l.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,vf(l),w.updater=Xl,l.stateNode=w,w._reactInternals=l,wf(l,g,a,p),l=Of(null,l,g,!0,S,p)):(l.tag=0,Bt&&S&&lf(l),Vn(null,l,w,p),l=l.child),l;case 16:g=l.elementType;e:{switch(au(a,l),a=l.pendingProps,w=g._init,g=w(g._payload),l.type=g,w=l.tag=J_(g),a=Ur(g,a),w){case 0:l=Lf(null,l,g,a,p);break e;case 1:l=Kp(null,l,g,a,p);break e;case 11:l=Wp(null,l,g,a,p);break e;case 14:l=Gp(null,l,g,Ur(g.type,a),p);break e}throw Error(n(306,g,""))}return l;case 0:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Ur(g,w),Lf(a,l,g,w,p);case 1:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Ur(g,w),Kp(a,l,g,w,p);case 3:e:{if(Jp(l),a===null)throw Error(n(387));g=l.pendingProps,S=l.memoizedState,w=S.element,sp(a,l),Jl(l,g,null,p);var N=l.memoizedState;if(g=N.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:N.cache,pendingSuspenseBoundaries:N.pendingSuspenseBoundaries,transitions:N.transitions},l.updateQueue.baseState=S,l.memoizedState=S,l.flags&256){w=Ss(Error(n(423)),l),l=Xp(a,l,g,p,w);break e}else if(g!==w){w=Ss(Error(n(424)),l),l=Xp(a,l,g,p,w);break e}else for(ur=Hi(l.stateNode.containerInfo.firstChild),lr=l,Bt=!0,Br=null,p=mp(l,null,g,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(vs(),g===w){l=gi(a,l,p);break e}Vn(a,l,g,p)}l=l.child}return l;case 5:return gp(l),a===null&&ff(l),g=l.type,w=l.pendingProps,S=a!==null?a.memoizedProps:null,N=w.children,tf(g,w)?N=null:S!==null&&tf(g,S)&&(l.flags|=32),qp(a,l),Vn(a,l,N,p),l.child;case 6:return a===null&&ff(l),null;case 13:return Yp(a,l,p);case 4:return _f(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=_s(l,null,g,p):Vn(a,l,g,p),l.child;case 11:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Ur(g,w),Wp(a,l,g,w,p);case 7:return Vn(a,l,l.pendingProps,p),l.child;case 8:return Vn(a,l,l.pendingProps.children,p),l.child;case 12:return Vn(a,l,l.pendingProps.children,p),l.child;case 10:e:{if(g=l.type._context,w=l.pendingProps,S=l.memoizedProps,N=w.value,Nt($l,g._currentValue),g._currentValue=N,S!==null)if(Or(S.value,N)){if(S.children===w.children&&!Yn.current){l=gi(a,l,p);break e}}else for(S=l.child,S!==null&&(S.return=l);S!==null;){var W=S.dependencies;if(W!==null){N=S.child;for(var X=W.firstContext;X!==null;){if(X.context===g){if(S.tag===1){X=mi(-1,p&-p),X.tag=2;var de=S.updateQueue;if(de!==null){de=de.shared;var Ae=de.pending;Ae===null?X.next=X:(X.next=Ae.next,Ae.next=X),de.pending=X}}S.lanes|=p,X=S.alternate,X!==null&&(X.lanes|=p),gf(S.return,p,l),W.lanes|=p;break}X=X.next}}else if(S.tag===10)N=S.type===l.type?null:S.child;else if(S.tag===18){if(N=S.return,N===null)throw Error(n(341));N.lanes|=p,W=N.alternate,W!==null&&(W.lanes|=p),gf(N,p,l),N=S.sibling}else N=S.child;if(N!==null)N.return=S;else for(N=S;N!==null;){if(N===l){N=null;break}if(S=N.sibling,S!==null){S.return=N.return,N=S;break}N=N.return}S=N}Vn(a,l,w.children,p),l=l.child}return l;case 9:return w=l.type,g=l.pendingProps.children,ws(l,p),w=yr(w),g=g(w),l.flags|=1,Vn(a,l,g,p),l.child;case 14:return g=l.type,w=Ur(g,l.pendingProps),w=Ur(g.type,w),Gp(a,l,g,w,p);case 15:return jp(a,l,l.type,l.pendingProps,p);case 17:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Ur(g,w),au(a,l),l.tag=1,Zn(g)?(a=!0,Vl(l)):a=!1,ws(l,p),fp(l,g,w),wf(l,g,w,p),Of(null,l,g,!0,a,p);case 19:return Qp(a,l,p);case 22:return $p(a,l,p)}throw Error(n(156,l.tag))};function Sm(a,l){return ke(a,l)}function K_(a,l,p,g){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tr(a,l,p,g){return new K_(a,l,p,g)}function n0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function J_(a){if(typeof a=="function")return n0(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Y)return 11;if(a===we)return 14}return 2}function Qi(a,l){var p=a.alternate;return p===null?(p=Tr(a.tag,l,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=l,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&14680064,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,l=a.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p}function gu(a,l,p,g,w,S){var N=2;if(g=a,typeof a=="function")n0(a)&&(N=1);else if(typeof a=="string")N=5;else e:switch(a){case F:return Fa(p.children,w,S,l);case q:N=8,w|=8;break;case z:return a=Tr(12,p,l,w|2),a.elementType=z,a.lanes=S,a;case xe:return a=Tr(13,p,l,w),a.elementType=xe,a.lanes=S,a;case De:return a=Tr(19,p,l,w),a.elementType=De,a.lanes=S,a;case Ce:return xu(p,w,S,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case te:N=10;break e;case Q:N=9;break e;case Y:N=11;break e;case we:N=14;break e;case Fe:N=16,g=null;break e}throw Error(n(130,a==null?a:typeof a,""))}return l=Tr(N,p,l,w),l.elementType=a,l.type=g,l.lanes=S,l}function Fa(a,l,p,g){return a=Tr(7,a,g,l),a.lanes=p,a}function xu(a,l,p,g){return a=Tr(22,a,g,l),a.elementType=Ce,a.lanes=p,a.stateNode={isHidden:!1},a}function r0(a,l,p){return a=Tr(6,a,null,l),a.lanes=p,a}function i0(a,l,p){return l=Tr(4,a.children!==null?a.children:[],a.key,l),l.lanes=p,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function X_(a,l,p,g,w){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fc(0),this.expirationTimes=Fc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fc(0),this.identifierPrefix=g,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function a0(a,l,p,g,w,S,N,W,X){return a=new X_(a,l,p,W,X),l===1?(l=1,S===!0&&(l|=8)):l=0,S=Tr(3,null,null,l),a.current=S,S.stateNode=a,S.memoizedState={element:g,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},vf(S),a}function Y_(a,l,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:g==null?null:""+g,children:a,containerInfo:l,implementation:p}}function km(a){if(!a)return Gi;a=a._reactInternals;e:{if(V(a)!==a||a.tag!==1)throw Error(n(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Zn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(n(171))}if(a.tag===1){var p=a.type;if(Zn(p))return Yh(a,p,l)}return l}function Em(a,l,p,g,w,S,N,W,X){return a=a0(p,g,!0,a,w,S,N,W,X),a.context=km(null),p=a.current,g=Hn(),w=Yi(p),S=mi(g,w),S.callback=l??null,qi(p,S,w),a.current.lanes=w,to(a,w,g),tr(a,g),a}function vu(a,l,p,g){var w=l.current,S=Hn(),N=Yi(w);return p=km(p),l.context===null?l.context=p:l.pendingContext=p,l=mi(S,N),l.payload={element:a},g=g===void 0?null:g,g!==null&&(l.callback=g),a=qi(w,l,N),a!==null&&(Vr(a,w,N,S),Kl(a,w,N)),N}function yu(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Cm(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<l?p:l}}function s0(a,l){Cm(a,l),(a=a.alternate)&&Cm(a,l)}function Z_(){return null}var Am=typeof reportError=="function"?reportError:function(a){console.error(a)};function o0(a){this._internalRoot=a}wu.prototype.render=o0.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));vu(a,l,null,null)},wu.prototype.unmount=o0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Aa(function(){vu(null,a,null,null)}),l[ci]=null}};function wu(a){this._internalRoot=a}wu.prototype.unstable_scheduleHydration=function(a){if(a){var l=uh();a={blockedOn:null,target:a,priority:l};for(var p=0;p<zi.length&&l!==0&&l<zi[p].priority;p++);zi.splice(p,0,a),p===0&&dh(a)}};function l0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function _u(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Im(){}function Q_(a,l,p,g,w){if(w){if(typeof g=="function"){var S=g;g=function(){var de=yu(N);S.call(de)}}var N=Em(l,g,a,0,null,!1,!1,"",Im);return a._reactRootContainer=N,a[ci]=N.current,go(a.nodeType===8?a.parentNode:a),Aa(),N}for(;w=a.lastChild;)a.removeChild(w);if(typeof g=="function"){var W=g;g=function(){var de=yu(X);W.call(de)}}var X=a0(a,0,!1,null,null,!1,!1,"",Im);return a._reactRootContainer=X,a[ci]=X.current,go(a.nodeType===8?a.parentNode:a),Aa(function(){vu(l,X,p,g)}),X}function Tu(a,l,p,g,w){var S=p._reactRootContainer;if(S){var N=S;if(typeof w=="function"){var W=w;w=function(){var X=yu(N);W.call(X)}}vu(l,N,a,w)}else N=Q_(p,l,a,w,g);return yu(N)}oh=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var p=Li(l.pendingLanes);p!==0&&(Rc(l,p|1),tr(l,he()),(ct&6)===0&&(Cs=he()+500,ji()))}break;case 13:Aa(function(){var g=pi(a,1);if(g!==null){var w=Hn();Vr(g,a,1,w)}}),s0(a,1)}},Dc=function(a){if(a.tag===13){var l=pi(a,134217728);if(l!==null){var p=Hn();Vr(l,a,134217728,p)}s0(a,134217728)}},lh=function(a){if(a.tag===13){var l=Yi(a),p=pi(a,l);if(p!==null){var g=Hn();Vr(p,a,l,g)}s0(a,l)}},uh=function(){return wt},ch=function(a,l){var p=wt;try{return wt=a,l()}finally{wt=p}},Pi=function(a,l,p){switch(l){case"input":if(Oe(a,p),l=p.name,p.type==="radio"&&l!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<p.length;l++){var g=p[l];if(g!==a&&g.form===a.form){var w=zl(g);if(!w)throw Error(n(90));G(g),Oe(g,w)}}}break;case"textarea":fn(a,p);break;case"select":l=p.value,l!=null&&Ft(a,!!p.multiple,l,!1)}},rs=Qf,is=Aa;var e2={usingClientEntryPoint:!1,Events:[yo,hs,zl,ts,ns,Qf]},Po={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},t2={bundleType:Po.bundleType,version:Po.version,rendererPackageName:Po.rendererPackageName,rendererConfig:Po.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=ce(a),a===null?null:a.stateNode},findFiberByHostInstance:Po.findFiberByHostInstance||Z_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Su.isDisabled&&Su.supportsFiber)try{Xn=Su.inject(t2),Gt=Su}catch{}}return nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e2,nr.createPortal=function(a,l){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l0(l))throw Error(n(200));return Y_(a,l,null,p)},nr.createRoot=function(a,l){if(!l0(a))throw Error(n(299));var p=!1,g="",w=Am;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(w=l.onRecoverableError)),l=a0(a,1,!1,null,null,p,!1,g,w),a[ci]=l.current,go(a.nodeType===8?a.parentNode:a),new o0(l)},nr.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=ce(l),a=a===null?null:a.stateNode,a},nr.flushSync=function(a){return Aa(a)},nr.hydrate=function(a,l,p){if(!_u(l))throw Error(n(200));return Tu(null,a,l,!0,p)},nr.hydrateRoot=function(a,l,p){if(!l0(a))throw Error(n(405));var g=p!=null&&p.hydratedSources||null,w=!1,S="",N=Am;if(p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onRecoverableError!==void 0&&(N=p.onRecoverableError)),l=Em(l,null,a,1,p??null,w,!1,S,N),a[ci]=l.current,go(a),g)for(a=0;a<g.length;a++)p=g[a],w=p._getVersion,w=w(p._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[p,w]:l.mutableSourceEagerHydrationData.push(p,w);return new wu(l)},nr.render=function(a,l,p){if(!_u(l))throw Error(n(200));return Tu(null,a,l,!1,p)},nr.unmountComponentAtNode=function(a){if(!_u(a))throw Error(n(40));return a._reactRootContainer?(Aa(function(){Tu(null,null,a,!1,function(){a._reactRootContainer=null,a[ci]=null})}),!0):!1},nr.unstable_batchedUpdates=Qf,nr.unstable_renderSubtreeIntoContainer=function(a,l,p,g){if(!_u(p))throw Error(n(200));if(a==null||a._reactInternals===void 0)throw Error(n(38));return Tu(a,l,p,!1,g)},nr.version="18.2.0-next-9e3b772b8-20220608",nr}var Om;function u2(){if(Om)return f0.exports;Om=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),f0.exports=l2(),f0.exports}var Bm;function c2(){if(Bm)return ku;Bm=1;var e=u2();return ku.createRoot=e.createRoot,ku.hydrateRoot=e.hydrateRoot,ku}var f2=c2();const d2=k1(f2),h2="ReleaseManagerDB",Ba="releases",ii="packages",Ua="tasks",M0="reviews",vi="backlog",L0="roadmap",O0="reEstimations",B0="withdrawalRequests",Wu="events",Gu=["todo","planning","ready","inProgress","completed"],wi={todo:"Do zaplanowania",planning:"W planowaniu",ready:"Gotowa do realizacji",inProgress:"W realizacji",completed:"Zakończona"},E1={todo:"bg-gray-500 text-white",planning:"bg-blue-600 text-white",ready:"bg-purple-600 text-white",inProgress:"bg-yellow-400 text-yellow-800",completed:"bg-green-600 text-white"},cd=["analysis","development","testing","deployment","stabilization"],ra={analysis:"Analiza",development:"Programowanie",testing:"Testy",deployment:"Wdrożenie",stabilization:"Stabilizacja"},p2={analysis:"bg-indigo-500",development:"bg-sky-500",testing:"bg-amber-500",deployment:"bg-teal-500",stabilization:"bg-rose-500"},m2=["Not Reviewed","Passed","Passed with Conditions","Failed"],C1={"Not Reviewed":"Nieprzeglądnięty",Passed:"Zaliczony","Passed with Conditions":"Zaliczony warunkowo",Failed:"Niezaliczony"},g2={"Not Reviewed":"bg-gray-400 text-white",Passed:"bg-green-500 text-white","Passed with Conditions":"bg-yellow-400 text-yellow-800",Failed:"bg-red-600 text-white"},A1=["wysoki","niski","brak"],I1=["Nowy","Do Oceny","Zaplanowany","Analiza","Decyzja","Wstrzymany","Odrzucona","z roadmapy"],N1=["GO","NO GO","W TOKU"],x2={Nowy:"bg-blue-100 text-blue-800","Do Oceny":"bg-gray-100 text-gray-800",Zaplanowany:"bg-indigo-100 text-indigo-800",Analiza:"bg-purple-100 text-purple-800",Decyzja:"bg-yellow-100 text-yellow-800",Wstrzymany:"bg-orange-100 text-orange-800",Odrzucona:"bg-red-100 text-red-800","z roadmapy":"bg-teal-100 text-teal-800"},v2={GO:"bg-green-100 text-green-800","NO GO":"bg-red-100 text-red-800","W TOKU":"bg-yellow-100 text-yellow-800"},y2=["Niedoszacowane","Przeszacowane","Zmiana okazała się trudniejsza"],p0={create:"Utworzenie",update:"Aktualizacja",delete:"Usunięcie",status_change:"Zmiana statusu",approve:"Zatwierdzenie",start:"Rozpoczęcie",re_estimate:"Reestymacja",withdraw:"Wycofanie"};let uc;const w2=()=>new Promise((e,t)=>{const n=indexedDB.open(h2,11);n.onupgradeneeded=r=>{const i=n.result,s=n.transaction,o=r.oldVersion;if(o<1&&i.createObjectStore(ii,{keyPath:"id",autoIncrement:!0}).createIndex("status","status",{unique:!1}),o<2&&(i.objectStoreNames.contains(Ba)||i.createObjectStore(Ba,{keyPath:"id",autoIncrement:!0}),s)){const u=s.objectStore(ii);u.indexNames.contains("releaseId")||u.createIndex("releaseId","releaseId",{unique:!1})}o<3&&(i.objectStoreNames.contains(Ua)||i.createObjectStore(Ua,{keyPath:"id",autoIncrement:!0}).createIndex("packageId","packageId",{unique:!1})),o<4&&(i.objectStoreNames.contains(vi)||i.createObjectStore(vi,{keyPath:"id",autoIncrement:!0}),i.objectStoreNames.contains(L0)||i.createObjectStore(L0,{keyPath:"id",autoIncrement:!0})),o<6&&(i.objectStoreNames.contains(vi)&&i.deleteObjectStore(vi),i.createObjectStore(vi,{keyPath:"internalId",autoIncrement:!0})),o<7&&(i.objectStoreNames.contains(M0)||i.createObjectStore(M0,{keyPath:"id",autoIncrement:!0}).createIndex("packageId","packageId",{unique:!1})),o<9&&(i.objectStoreNames.contains(O0)||i.createObjectStore(O0,{keyPath:"id",autoIncrement:!0}).createIndex("roadmapItemId","roadmapItemId",{unique:!1})),o<10&&(i.objectStoreNames.contains(B0)||i.createObjectStore(B0,{keyPath:"id",autoIncrement:!0})),o<11&&(i.objectStoreNames.contains(Wu)||i.createObjectStore(Wu,{keyPath:"id",autoIncrement:!0}))},n.onsuccess=()=>{uc=n.result,e(!0)},n.onerror=()=>{console.error("Error initializing database:",n.error),t(n.error)}}),xn=(e,t)=>uc.transaction(e,t).objectStore(e),cc=e=>({add:t=>new Promise((n,r)=>{const s=xn(e,"readwrite").add(t);s.onsuccess=()=>n(s.result),s.onerror=()=>r(s.error)}),getAll:()=>new Promise((t,n)=>{const i=xn(e,"readonly").getAll();i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),update:t=>new Promise((n,r)=>{const s=xn(e,"readwrite").put(t);s.onsuccess=()=>n(t),s.onerror=()=>r(s.error)}),delete:t=>new Promise((n,r)=>{const s=xn(e,"readwrite").delete(t);s.onsuccess=()=>n(),s.onerror=()=>r(s.error)})}),m0=e=>new Promise((t,n)=>{const i=xn(Ba,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),Um=()=>new Promise((e,t)=>{const r=xn(Ba,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),_2=e=>new Promise((t,n)=>{const i=xn(Ba,"readwrite").put(e);i.onsuccess=()=>t(e),i.onerror=()=>n(i.error)}),T2=e=>new Promise((t,n)=>{const r=uc.transaction([Ba,ii,Ua],"readwrite");r.oncomplete=()=>t(),r.onerror=h=>{console.error("Transaction failed during release deletion:",h.target.error),n(h.target.error)};const i=r.objectStore(Ba),s=r.objectStore(ii),o=r.objectStore(Ua),d=s.index("releaseId").getAll(IDBKeyRange.only(e));d.onsuccess=()=>{const m=d.result.map(v=>v.id).filter(v=>v!==void 0);if(m.length===0){i.delete(e);return}let x=0;m.forEach(v=>{const k=o.index("packageId").getAllKeys(IDBKeyRange.only(v));k.onsuccess=()=>{k.result.forEach(E=>{o.delete(E)}),x++,x===m.length&&(m.forEach(E=>{s.delete(E)}),i.delete(e))}})}}),zm=e=>new Promise((t,n)=>{const i=xn(ii,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),bm=()=>new Promise((e,t)=>{const r=xn(ii,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),S2=e=>new Promise((t,n)=>{const s=xn(ii,"readonly").index("status").getAll(e);s.onsuccess=()=>t(s.result),s.onerror=()=>n(s.error)}),Lo=e=>new Promise((t,n)=>{const i=xn(ii,"readwrite").put(e);i.onsuccess=()=>t(e),i.onerror=()=>n(i.error)}),k2=e=>new Promise((t,n)=>{const r=uc.transaction([ii,Ua],"readwrite");r.oncomplete=()=>t(),r.onerror=d=>{console.error("Transaction failed during package deletion:",d.target.error),n(d.target.error)};const i=r.objectStore(ii),s=r.objectStore(Ua),u=s.index("packageId").getAllKeys(IDBKeyRange.only(e));u.onsuccess=()=>{u.result.forEach(h=>{s.delete(h)}),i.delete(e)}}),E2=e=>new Promise((t,n)=>{const s=xn(Ua,"readonly").index("packageId").getAll(e);s.onsuccess=()=>t(s.result),s.onerror=()=>n(s.error)}),fd=cc(M0),C2=fd.getAll,A2=fd.add,I2=fd.update,N2=()=>new Promise((e,t)=>{const r=xn(vi,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),g0=e=>new Promise((t,n)=>{const i=xn(vi,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),F2=e=>new Promise((t,n)=>{const i=xn(vi,"readwrite").put(e);i.onsuccess=()=>t(e),i.onerror=()=>n(i.error)}),Vm=e=>new Promise((t,n)=>{const i=xn(vi,"readwrite").delete(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)}),fc=cc(L0),R2=fc.getAll,Hm=fc.add,Wm=fc.update,Gm=fc.delete,F1=cc(O0),D2=F1.add,P2=F1.getAll,M2=cc(B0),L2=M2.add,O2=e=>new Promise((t,n)=>{const i=xn(Wu,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),B2=()=>new Promise((e,t)=>{const r=xn(Wu,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ju={};ju.version="0.18.5";var R1=1252,U2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},hd=function(e){U2.indexOf(e)!=-1&&(R1=dd[0]=e)};function z2(){hd(1252)}var Wr=function(e){hd(e)};function pd(){Wr(1200),z2()}function jm(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function b2(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function D1(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Uo=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?b2(e.slice(2)):t==254&&n==255?D1(e.slice(2)):t==65279?e.slice(1):e},Eu=function(t){return String.fromCharCode(t)},$m=function(t){return String.fromCharCode(t)},Yo,ia="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zo(e){for(var t="",n=0,r=0,i=0,s=0,o=0,u=0,d=0,h=0;h<e.length;)n=e.charCodeAt(h++),s=n>>2,r=e.charCodeAt(h++),o=(n&3)<<4|r>>4,i=e.charCodeAt(h++),u=(r&15)<<2|i>>6,d=i&63,isNaN(r)?u=d=64:isNaN(i)&&(d=64),t+=ia.charAt(s)+ia.charAt(o)+ia.charAt(u)+ia.charAt(d);return t}function gr(e){var t="",n=0,r=0,i=0,s=0,o=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)s=ia.indexOf(e.charAt(h++)),o=ia.indexOf(e.charAt(h++)),n=s<<2|o>>4,t+=String.fromCharCode(n),u=ia.indexOf(e.charAt(h++)),r=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),d=ia.indexOf(e.charAt(h++)),i=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(i));return t}var at=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ci=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function sa(e){return at?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function qm(e){return at?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var hr=function(t){return at?Ci(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function dc(e){if(typeof ArrayBuffer>"u")return hr(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function ca(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function V2(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function md(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return md(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var gn=at?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ci(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function H2(e){for(var t=[],n=0,r=e.length+250,i=sa(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|u>>6&15|(o&3)<<4,i[n++]=128|u&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(t.push(i.slice(0,n)),n=0,i=sa(65535),r=65530)}return t.push(i.slice(0,n)),gn(t)}var jn=/\u0000/g,zo=/[\u0001-\u0006]/g;function Ms(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Gr(e,t){var n=""+e;return n.length>=t?n:$t("0",t-n.length)+n}function gd(e,t){var n=""+e;return n.length>=t?n:$t(" ",t-n.length)+n}function $u(e,t){var n=""+e;return n.length>=t?n:n+$t(" ",t-n.length)}function W2(e,t){var n=""+Math.round(e);return n.length>=t?n:$t("0",t-n.length)+n}function G2(e,t){var n=""+e;return n.length>=t?n:$t("0",t-n.length)+n}var Km=Math.pow(2,32);function Is(e,t){if(e>Km||e<-Km)return W2(e,t);var n=Math.round(e);return G2(n,t)}function qu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Jm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],x0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function j2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Xm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ku(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,o=1,u=0,d=1,h=0,m=0,x=Math.floor(i);h<t&&(x=Math.floor(i),u=x*o+s,m=x*h+d,!(i-x<5e-8));)i=1/(i-x),s=o,o=u,d=h,h=m;if(m>t&&(h>t?(m=d,u=s):(m=h,u=o)),!n)return[0,r*u,m];var v=Math.floor(r*u/m);return[v,r*u-v*m,m]}function Da(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,o=[],u={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++r,++u.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],s=d.getDay(),r<60&&(s=(s+6)%7),n&&(s=Z2(d,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=s,u}var P1=new Date(1899,11,31,0,0,0),q2=P1.getTime(),K2=new Date(1900,2,1,0,0,0);function M1(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=K2&&(n+=1440*60*1e3),(n-(q2+(e.getTimezoneOffset()-P1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function xd(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function X2(e){var t=e<0?12:11,n=xd(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function Y2(e){var t=xd(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Qo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=X2(e):t===10?n=e.toFixed(10).substr(0,12):n=Y2(e),xd(J2(n.toUpperCase()))}function za(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Qo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dr(14,M1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Z2(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function Q2(e,t,n,r){var i="",s=0,o=0,u=n.y,d,h=0;switch(e){case 98:u=n.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,h=2;break;default:d=u%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:d=n.m,h=t.length;break;case 3:return x0[n.m-1][1];case 5:return x0[n.m-1][0];default:return x0[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=n.d,h=t.length;break;case 3:return Jm[n.q][0];default:return Jm[n.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(n.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=n.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=n.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Gr(n.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Gr(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:d=u,h=1;break}var m=h>0?Gr(d,h):"";return m}function aa(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var L1=/%/g;function eT(e,t,n){var r=t.replace(L1,""),i=t.length-r.length;return _i(e,r,n*Math.pow(10,2*i))+$t("%",i)}function tT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return _i(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function O1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+O1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var B1=/# (\?+)( ?)\/( ?)(\d+)/;function nT(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),o=i-s*r,u=r;return n+(s===0?"":""+s)+" "+(o===0?$t(" ",e[1].length+1+e[4].length):gd(o,e[1].length)+e[2]+"/"+e[3]+Gr(u,e[4].length))}function rT(e,t,n){return n+(t===0?"":""+t)+$t(" ",e[1].length+2+e[4].length)}var U1=/^#*0*\.([0#]+)/,z1=/\).*[0#]/,b1=/\(###\) ###\\?-####/;function Wn(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function Ym(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Zm(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function iT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function aT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function kr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(z1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?kr("n",r,n):"("+kr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return tT(e,t,n);if(t.indexOf("%")!==-1)return eT(e,t,n);if(t.indexOf("E")!==-1)return O1(t,n);if(t.charCodeAt(0)===36)return"$"+kr(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,u,d=Math.abs(n),h=n<0?"-":"";if(t.match(/^00+$/))return h+Is(d,t.length);if(t.match(/^[#?]+$/))return i=Is(n,0),i==="0"&&(i=""),i.length>t.length?i:Wn(t.substr(0,t.length-i.length))+i;if(s=t.match(B1))return nT(s,d,h);if(t.match(/^#+0+$/))return h+Is(d,t.length-t.indexOf("0"));if(s=t.match(U1))return i=Ym(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Wn(s[1])).replace(/\.$/,"."+Wn(s[1])).replace(/\.(\d*)$/,function(k,T){return"."+T+$t("0",Wn(s[1]).length-T.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+Ym(d,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+aa(Is(d,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+kr(e,t,-n):aa(""+(Math.floor(n)+iT(n,s[1].length)))+"."+Gr(Zm(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return kr(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ms(kr(e,t.replace(/[\\-]/g,""),n)),o=0,Ms(Ms(t.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<i.length?i.charAt(o++):k==="0"?"0":""}));if(t.match(b1))return i=kr(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=Ku(d,Math.pow(10,o)-1,!1),i=""+h,m=_i("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=$u(u[2],o),m.length<s[4].length&&(m=Wn(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=Ku(d,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?gd(u[1],o)+s[2]+"/"+s[3]+$u(u[2],o):$t(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Is(n,0),t.length<=i.length?i:Wn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,v=t.length-i.length-x;return Wn(t.substr(0,x)+i+t.substr(t.length-v))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Zm(n,s[1].length),n<0?"-"+kr(e,t,-n):aa(aT(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Gr(0,3-k.length):"")+k})+"."+Gr(o,s[1].length);switch(t){case"###,##0.00":return kr(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var _=aa(Is(d,0));return _!=="0"?h+_:"";case"###,###.00":return kr(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return kr(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function sT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return _i(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function oT(e,t,n){var r=t.replace(L1,""),i=t.length-r.length;return _i(e,r,n*Math.pow(10,2*i))+$t("%",i)}function V1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+V1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function ti(e,t,n){if(e.charCodeAt(0)===40&&!t.match(z1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ti("n",r,n):"("+ti("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return sT(e,t,n);if(t.indexOf("%")!==-1)return oT(e,t,n);if(t.indexOf("E")!==-1)return V1(t,n);if(t.charCodeAt(0)===36)return"$"+ti(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,u,d=Math.abs(n),h=n<0?"-":"";if(t.match(/^00+$/))return h+Gr(d,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:Wn(t.substr(0,t.length-i.length))+i;if(s=t.match(B1))return rT(s,d,h);if(t.match(/^#+0+$/))return h+Gr(d,t.length-t.indexOf("0"));if(s=t.match(U1))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Wn(s[1])).replace(/\.$/,"."+Wn(s[1])),i=i.replace(/\.(\d*)$/,function(k,T){return"."+T+$t("0",Wn(s[1]).length-T.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+aa(""+d);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ti(e,t,-n):aa(""+n)+"."+$t("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ti(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ms(ti(e,t.replace(/[\\-]/g,""),n)),o=0,Ms(Ms(t.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<i.length?i.charAt(o++):k==="0"?"0":""}));if(t.match(b1))return i=ti(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=Ku(d,Math.pow(10,o)-1,!1),i=""+h,m=_i("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=$u(u[2],o),m.length<s[4].length&&(m=Wn(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=Ku(d,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?gd(u[1],o)+s[2]+"/"+s[3]+$u(u[2],o):$t(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:Wn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,v=t.length-i.length-x;return Wn(t.substr(0,x)+i+t.substr(t.length-v))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+ti(e,t,-n):aa(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Gr(0,3-k.length):"")+k})+"."+Gr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=aa(""+d);return _!=="0"?h+_:"";default:if(t.match(/\.[0#?]*$/))return ti(e,t.slice(0,t.lastIndexOf(".")),n)+Wn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _i(e,t,n){return(n|0)===n?ti(e,t,n):kr(e,t,n)}function lT(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var H1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function js(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":qu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(H1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function uT(e,t,n,r){for(var i=[],s="",o=0,u="",d="t",h,m,x,v="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!qu(e,o))throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(x=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(x);i[i.length]={t:"t",v:s},++o;break;case"\\":var _=e.charAt(++o),k=_==="("||_===")"?_:"t";i[i.length]={t:k,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=Da(t,n,e.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},d=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Da(t,n),h==null))return"";for(s=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)s+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),i[i.length]={t:u,v:s},d=u;break;case"A":case"a":case"上":var T={t:u,v:u};if(h==null&&(h=Da(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(T.v=h.H>=12?"P":"A"),T.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(T.v=h.H>=12?"PM":"AM"),T.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(h!=null&&(T.v=h.H>=12?"下午":"上午"),T.t="T",o+=5,v="h"):(T.t="t",++o),h==null&&T.t==="T")return"";i[i.length]=T,d=u;break;case"[":for(s=u;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(H1)){if(h==null&&(h=Da(t,n),h==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},d=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",js(e)||(i[i.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=u;++o<e.length&&(u=e.charAt(o))==="0";)s+=u;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)s+=u;i[i.length]={t:"n",v:s};break;case"?":for(s=u;e.charAt(++o)===u;)s+=u;i[i.length]={t:u,v:s},d=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:u,v:u},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"t",v:u},++o;break}var E=0,A=0,I;for(o=i.length-1,d="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,d="h",E<1&&(E=1);break;case"s":(I=i[o].v.match(/\.0+$/))&&(A=Math.max(A,I[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":d=i[o].t;break;case"m":d==="s"&&(i[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[o].v.match(/[Hh]/)&&(E=1),E<2&&i[o].v.match(/[Mm]/)&&(E=2),E<3&&i[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",D;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Q2(i[o].t.charCodeAt(0),i[o].v,h,A),i[o].t="t";break;case"n":case"?":for(D=o+1;i[D]!=null&&((u=i[D].t)==="?"||u==="D"||(u===" "||u==="t")&&i[D+1]!=null&&(i[D+1].t==="?"||i[D+1].t==="t"&&i[D+1].v==="/")||i[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[D].v==="/"||i[D].v===" "&&i[D+1]!=null&&i[D+1].t=="?"));)i[o].v+=i[D].v,i[D]={v:"",t:";"},++D;C+=i[o].v,o=D-1;break;case"G":i[o].t="t",i[o].v=za(t,n);break}var M="",P,F;if(C.length>0){C.charCodeAt(0)==40?(P=t<0&&C.charCodeAt(0)===45?-t:t,F=_i("n",C,P)):(P=t<0&&r>1?-t:t,F=_i("n",C,P),P<0&&i[0]&&i[0].t=="t"&&(F=F.substr(1),i[0].v="-"+i[0].v)),D=F.length-1;var q=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){q=o;break}var z=i.length;if(q===i.length&&F.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(D>=i[o].v.length-1?(D-=i[o].v.length,i[o].v=F.substr(D+1,i[o].v.length)):D<0?i[o].v="":(i[o].v=F.substr(0,D+1),D=-1),i[o].t="t",z=o);D>=0&&z<i.length&&(i[z].v=F.substr(0,D+1)+i[z].v)}else if(q!==i.length&&F.indexOf("E")===-1){for(D=F.indexOf(".")-1,o=q;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(m=i[o].v.indexOf(".")>-1&&o===q?i[o].v.indexOf(".")-1:i[o].v.length-1,M=i[o].v.substr(m+1);m>=0;--m)D>=0&&(i[o].v.charAt(m)==="0"||i[o].v.charAt(m)==="#")&&(M=F.charAt(D--)+M);i[o].v=M,i[o].t="t",z=o}for(D>=0&&z<i.length&&(i[z].v=F.substr(0,D+1)+i[z].v),D=F.indexOf(".")+1,o=q;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==q)){for(m=i[o].v.indexOf(".")>-1&&o===q?i[o].v.indexOf(".")+1:0,M=i[o].v.substr(0,m);m<i[o].v.length;++m)D<F.length&&(M+=F.charAt(D++));i[o].v=M,i[o].t="t",z=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(P=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=_i(i[o].t,i[o].v,P),i[o].t="t");var te="";for(o=0;o!==i.length;++o)i[o]!=null&&(te+=i[o].v);return te}var Qm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function eg(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function cT(e,t){var n=lT(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(Qm),u=n[1].match(Qm);return eg(t,o)?[r,n[0]]:eg(t,u)?[r,n[1]]:[r,n[o!=null&&u!=null?2:1]]}return[r,s]}function Dr(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:Ke)[e],r==null&&(r=n.table&&n.table[Xm[e]]||Ke[Xm[e]]),r==null&&(r=$2[e]||"General");break}if(qu(r,0))return za(t,n);t instanceof Date&&(t=M1(t,n.date1904));var i=cT(r,t);if(qu(i[1]))return za(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return uT(i[1],t,n,i[0])}function Ti(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(Ke[n]==null){t<0&&(t=n);continue}if(Ke[n]==e){t=n;break}}t<0&&(t=391)}return Ke[t]=e,t}function hc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ti(e[t],t)}function $s(){Ke=j2()}var fT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},W1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dT(e){var t=typeof e=="number"?Ke[e]:e;return t=t.replace(W1,"(\\d+)"),new RegExp("^"+t+"$")}function hT(e,t,n){var r=-1,i=-1,s=-1,o=-1,u=-1,d=-1;(t.match(W1)||[]).forEach(function(x,v){var _=parseInt(n[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":r=_;break;case"d":s=_;break;case"h":o=_;break;case"s":d=_;break;case"m":o>=0?u=_:i=_;break}}),d>=0&&u==-1&&i>=0&&(u=i,i=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&u==-1&&d==-1?h:r==-1&&i==-1&&s==-1?m:h+"T"+m}var pT=function(){var e={};e.version="1.2.0";function t(){for(var F=0,q=new Array(256),z=0;z!=256;++z)F=z,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,q[z]=F;return typeof Int32Array<"u"?new Int32Array(q):q}var n=t();function r(F){var q=0,z=0,te=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)Q[te]=F[te];for(te=0;te!=256;++te)for(z=F[te],q=256+te;q<4096;q+=256)z=Q[q]=z>>>8^F[z&255];var Y=[];for(te=1;te!=16;++te)Y[te-1]=typeof Int32Array<"u"?Q.subarray(te*256,te*256+256):Q.slice(te*256,te*256+256);return Y}var i=r(n),s=i[0],o=i[1],u=i[2],d=i[3],h=i[4],m=i[5],x=i[6],v=i[7],_=i[8],k=i[9],T=i[10],E=i[11],A=i[12],I=i[13],C=i[14];function D(F,q){for(var z=q^-1,te=0,Q=F.length;te<Q;)z=z>>>8^n[(z^F.charCodeAt(te++))&255];return~z}function M(F,q){for(var z=q^-1,te=F.length-15,Q=0;Q<te;)z=C[F[Q++]^z&255]^I[F[Q++]^z>>8&255]^A[F[Q++]^z>>16&255]^E[F[Q++]^z>>>24]^T[F[Q++]]^k[F[Q++]]^_[F[Q++]]^v[F[Q++]]^x[F[Q++]]^m[F[Q++]]^h[F[Q++]]^d[F[Q++]]^u[F[Q++]]^o[F[Q++]]^s[F[Q++]]^n[F[Q++]];for(te+=15;Q<te;)z=z>>>8^n[(z^F[Q++])&255];return~z}function P(F,q){for(var z=q^-1,te=0,Q=F.length,Y=0,xe=0;te<Q;)Y=F.charCodeAt(te++),Y<128?z=z>>>8^n[(z^Y)&255]:Y<2048?(z=z>>>8^n[(z^(192|Y>>6&31))&255],z=z>>>8^n[(z^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,xe=F.charCodeAt(te++)&1023,z=z>>>8^n[(z^(240|Y>>8&7))&255],z=z>>>8^n[(z^(128|Y>>2&63))&255],z=z>>>8^n[(z^(128|xe>>6&15|(Y&3)<<4))&255],z=z>>>8^n[(z^(128|xe&63))&255]):(z=z>>>8^n[(z^(224|Y>>12&15))&255],z=z>>>8^n[(z^(128|Y>>6&63))&255],z=z>>>8^n[(z^(128|Y&63))&255]);return~z}return e.table=n,e.bstr=D,e.buf=M,e.str=P,e}(),Ge=function(){var t={};t.version="1.2.1";function n(R,U){for(var L=R.split("/"),B=U.split("/"),b=0,V=0,se=Math.min(L.length,B.length);b<se;++b){if(V=L[b].length-B[b].length)return V;if(L[b]!=B[b])return L[b]<B[b]?-1:1}return L.length-B.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var U=R.lastIndexOf("/");return U===-1?R:R.slice(0,U+1)}function i(R){if(R.charAt(R.length-1)=="/")return i(R.slice(0,-1));var U=R.lastIndexOf("/");return U===-1?R:R.slice(U+1)}function s(R,U){typeof U=="string"&&(U=new Date(U));var L=U.getHours();L=L<<6|U.getMinutes(),L=L<<5|U.getSeconds()>>>1,R.write_shift(2,L);var B=U.getFullYear()-1980;B=B<<4|U.getMonth()+1,B=B<<5|U.getDate(),R.write_shift(2,B)}function o(R){var U=R.read_shift(2)&65535,L=R.read_shift(2)&65535,B=new Date,b=L&31;L>>>=5;var V=L&15;L>>>=4,B.setMilliseconds(0),B.setFullYear(L+1980),B.setMonth(V-1),B.setDate(b);var se=U&31;U>>>=5;var ge=U&63;return U>>>=6,B.setHours(U),B.setMinutes(ge),B.setSeconds(se<<1),B}function u(R){kn(R,0);for(var U={},L=0;R.l<=R.length-4;){var B=R.read_shift(2),b=R.read_shift(2),V=R.l+b,se={};switch(B){case 21589:L=R.read_shift(1),L&1&&(se.mtime=R.read_shift(4)),b>5&&(L&2&&(se.atime=R.read_shift(4)),L&4&&(se.ctime=R.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}R.l=V,U[B]=se}return U}var d;function h(){return d||(d={})}function m(R,U){if(R[0]==80&&R[1]==75)return Pi(R,U);if((R[0]|32)==109&&(R[1]|32)==105)return as(R,U);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var L=3,B=512,b=0,V=0,se=0,ge=0,ie=0,ce=[],fe=R.slice(0,512);kn(fe,0);var ke=x(fe);switch(L=ke[0],L){case 3:B=512;break;case 4:B=4096;break;case 0:if(ke[1]==0)return Pi(R,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}B!==512&&(fe=R.slice(0,B),kn(fe,28));var Le=R.slice(0,B);v(fe,L);var ne=fe.read_shift(4,"i");if(L===3&&ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ne);fe.l+=4,se=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),ge=fe.read_shift(4,"i"),b=fe.read_shift(4,"i"),ie=fe.read_shift(4,"i"),V=fe.read_shift(4,"i");for(var ae=-1,he=0;he<109&&(ae=fe.read_shift(4,"i"),!(ae<0));++he)ce[he]=ae;var Ue=_(R,B);E(ie,V,Ue,B,ce);var lt=I(Ue,se,ce,B);lt[se].name="!Directory",b>0&&ge!==xe&&(lt[ge].name="!MiniFAT"),lt[ce[0]].name="!FAT",lt.fat_addrs=ce,lt.ssz=B;var tt={},Ct=[],Lr=[],Jn=[];C(se,lt,Ue,Ct,b,tt,Lr,ge),k(Lr,Jn,Ct),Ct.shift();var Xn={FileIndex:Lr,FullPaths:Jn};return U&&U.raw&&(Xn.raw={header:Le,sectors:Ue}),Xn}function x(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(De,"Header Signature: "),R.l+=16;var U=R.read_shift(2,"u");return[R.read_shift(2,"u"),U]}function v(R,U){var L=9;switch(R.l+=2,L=R.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function _(R,U){for(var L=Math.ceil(R.length/U)-1,B=[],b=1;b<L;++b)B[b-1]=R.slice(b*U,(b+1)*U);return B[L-1]=R.slice(L*U),B}function k(R,U,L){for(var B=0,b=0,V=0,se=0,ge=0,ie=L.length,ce=[],fe=[];B<ie;++B)ce[B]=fe[B]=B,U[B]=L[B];for(;ge<fe.length;++ge)B=fe[ge],b=R[B].L,V=R[B].R,se=R[B].C,ce[B]===B&&(b!==-1&&ce[b]!==b&&(ce[B]=ce[b]),V!==-1&&ce[V]!==V&&(ce[B]=ce[V])),se!==-1&&(ce[se]=B),b!==-1&&B!=ce[B]&&(ce[b]=ce[B],fe.lastIndexOf(b)<ge&&fe.push(b)),V!==-1&&B!=ce[B]&&(ce[V]=ce[B],fe.lastIndexOf(V)<ge&&fe.push(V));for(B=1;B<ie;++B)ce[B]===B&&(V!==-1&&ce[V]!==V?ce[B]=ce[V]:b!==-1&&ce[b]!==b&&(ce[B]=ce[b]));for(B=1;B<ie;++B)if(R[B].type!==0){if(ge=B,ge!=ce[ge])do ge=ce[ge],U[B]=U[ge]+"/"+U[B];while(ge!==0&&ce[ge]!==-1&&ge!=ce[ge]);ce[B]=-1}for(U[0]+="/",B=1;B<ie;++B)R[B].type!==2&&(U[B]+="/")}function T(R,U,L){for(var B=R.start,b=R.size,V=[],se=B;L&&b>0&&se>=0;)V.push(U.slice(se*Y,se*Y+Y)),b-=Y,se=Ra(L,se*4);return V.length===0?me(0):gn(V).slice(0,R.size)}function E(R,U,L,B,b){var V=xe;if(R===xe){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var se=L[R],ge=(B>>>2)-1;if(!se)return;for(var ie=0;ie<ge&&(V=Ra(se,ie*4))!==xe;++ie)b.push(V);E(Ra(se,B-4),U-1,L,B,b)}}function A(R,U,L,B,b){var V=[],se=[];b||(b=[]);var ge=B-1,ie=0,ce=0;for(ie=U;ie>=0;){b[ie]=!0,V[V.length]=ie,se.push(R[ie]);var fe=L[Math.floor(ie*4/B)];if(ce=ie*4&ge,B<4+ce)throw new Error("FAT boundary crossed: "+ie+" 4 "+B);if(!R[fe])break;ie=Ra(R[fe],ce)}return{nodes:V,data:dg([se])}}function I(R,U,L,B){var b=R.length,V=[],se=[],ge=[],ie=[],ce=B-1,fe=0,ke=0,Le=0,ne=0;for(fe=0;fe<b;++fe)if(ge=[],Le=fe+U,Le>=b&&(Le-=b),!se[Le]){ie=[];var ae=[];for(ke=Le;ke>=0;){ae[ke]=!0,se[ke]=!0,ge[ge.length]=ke,ie.push(R[ke]);var he=L[Math.floor(ke*4/B)];if(ne=ke*4&ce,B<4+ne)throw new Error("FAT boundary crossed: "+ke+" 4 "+B);if(!R[he]||(ke=Ra(R[he],ne),ae[ke]))break}V[Le]={nodes:ge,data:dg([ie])}}return V}function C(R,U,L,B,b,V,se,ge){for(var ie=0,ce=B.length?2:0,fe=U[R].data,ke=0,Le=0,ne;ke<fe.length;ke+=128){var ae=fe.slice(ke,ke+128);kn(ae,64),Le=ae.read_shift(2),ne=kd(ae,0,Le-ce),B.push(ne);var he={name:ne,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},Ue=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Ue!==0&&(he.ct=D(ae,ae.l-8));var lt=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);lt!==0&&(he.mt=D(ae,ae.l-8)),he.start=ae.read_shift(4,"i"),he.size=ae.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=xe,he.name=""),he.type===5?(ie=he.start,b>0&&ie!==xe&&(U[ie].name="!StreamData")):he.size>=4096?(he.storage="fat",U[he.start]===void 0&&(U[he.start]=A(L,he.start,U.fat_addrs,U.ssz)),U[he.start].name=he.name,he.content=U[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:ie!==xe&&he.start!==xe&&U[ie]&&(he.content=T(he,U[ie].data,(U[ge]||{}).data))),he.content&&kn(he.content,0),V[ne]=he,se.push(he)}}function D(R,U){return new Date((dr(R,U+4)/1e7*Math.pow(2,32)+dr(R,U)/1e7-11644473600)*1e3)}function M(R,U){return h(),m(d.readFileSync(R),U)}function P(R,U){var L=U&&U.type;switch(L||at&&Buffer.isBuffer(R)&&(L="buffer"),L||"base64"){case"file":return M(R,U);case"base64":return m(hr(gr(R)),U);case"binary":return m(hr(R),U)}return m(R,U)}function F(R,U){var L=U||{},B=L.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=B+"/",R.FileIndex[0]={name:B,type:5}),L.CLSID&&(R.FileIndex[0].clsid=L.CLSID),q(R)}function q(R){var U="Sh33tJ5";if(!Ge.find(R,"/"+U)){var L=me(4);L[0]=55,L[1]=L[3]=50,L[2]=54,R.FileIndex.push({name:U,type:2,content:L,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+U),z(R)}}function z(R,U){F(R);for(var L=!1,B=!1,b=R.FullPaths.length-1;b>=0;--b){var V=R.FileIndex[b];switch(V.type){case 0:B?L=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(V.R*V.L*V.C)&&(L=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!U)){var se=new Date(1987,1,19),ge=0,ie=Object.create?Object.create(null):{},ce=[];for(b=0;b<R.FullPaths.length;++b)ie[R.FullPaths[b]]=!0,R.FileIndex[b].type!==0&&ce.push([R.FullPaths[b],R.FileIndex[b]]);for(b=0;b<ce.length;++b){var fe=r(ce[b][0]);B=ie[fe],B||(ce.push([fe,{name:i(fe).replace("/",""),type:1,clsid:Fe,ct:se,mt:se,content:null}]),ie[fe]=!0)}for(ce.sort(function(ne,ae){return n(ne[0],ae[0])}),R.FullPaths=[],R.FileIndex=[],b=0;b<ce.length;++b)R.FullPaths[b]=ce[b][0],R.FileIndex[b]=ce[b][1];for(b=0;b<ce.length;++b){var ke=R.FileIndex[b],Le=R.FullPaths[b];if(ke.name=i(Le).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||Fe,b===0)ke.C=ce.length>1?1:-1,ke.size=0,ke.type=5;else if(Le.slice(-1)=="/"){for(ge=b+1;ge<ce.length&&r(R.FullPaths[ge])!=Le;++ge);for(ke.C=ge>=ce.length?-1:ge,ge=b+1;ge<ce.length&&r(R.FullPaths[ge])!=r(Le);++ge);ke.R=ge>=ce.length?-1:ge,ke.type=1}else r(R.FullPaths[b+1]||"")==r(Le)&&(ke.R=b+1),ke.type=2}}}function te(R,U){var L=U||{};if(L.fileType=="mad")return li(R,L);switch(z(R),L.fileType){case"zip":return Kr(R,L)}var B=function(ne){for(var ae=0,he=0,Ue=0;Ue<ne.FileIndex.length;++Ue){var lt=ne.FileIndex[Ue];if(lt.content){var tt=lt.content.length;tt>0&&(tt<4096?ae+=tt+63>>6:he+=tt+511>>9)}}for(var Ct=ne.FullPaths.length+3>>2,Lr=ae+7>>3,Jn=ae+127>>7,Xn=Lr+he+Ct+Jn,Gt=Xn+127>>7,ga=Gt<=109?0:Math.ceil((Gt-109)/127);Xn+Gt+ga+127>>7>Gt;)ga=++Gt<=109?0:Math.ceil((Gt-109)/127);var Ut=[1,ga,Gt,Jn,Ct,he,ae,0];return ne.FileIndex[0].size=ae<<6,Ut[7]=(ne.FileIndex[0].start=Ut[0]+Ut[1]+Ut[2]+Ut[3]+Ut[4]+Ut[5])+(Ut[6]+7>>3),Ut}(R),b=me(B[7]<<9),V=0,se=0;{for(V=0;V<8;++V)b.write_shift(1,we[V]);for(V=0;V<8;++V)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),V=0;V<3;++V)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,B[2]),b.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:xe),b.write_shift(4,B[3]),b.write_shift(-4,B[1]?B[0]-1:xe),b.write_shift(4,B[1]),V=0;V<109;++V)b.write_shift(-4,V<B[2]?B[1]+V:-1)}if(B[1])for(se=0;se<B[1];++se){for(;V<236+se*127;++V)b.write_shift(-4,V<B[2]?B[1]+V:-1);b.write_shift(-4,se===B[1]-1?xe:se+1)}var ge=function(ne){for(se+=ne;V<se-1;++V)b.write_shift(-4,V+1);ne&&(++V,b.write_shift(-4,xe))};for(se=V=0,se+=B[1];V<se;++V)b.write_shift(-4,Ce.DIFSECT);for(se+=B[2];V<se;++V)b.write_shift(-4,Ce.FATSECT);ge(B[3]),ge(B[4]);for(var ie=0,ce=0,fe=R.FileIndex[0];ie<R.FileIndex.length;++ie)fe=R.FileIndex[ie],fe.content&&(ce=fe.content.length,!(ce<4096)&&(fe.start=se,ge(ce+511>>9)));for(ge(B[6]+7>>3);b.l&511;)b.write_shift(-4,Ce.ENDOFCHAIN);for(se=V=0,ie=0;ie<R.FileIndex.length;++ie)fe=R.FileIndex[ie],fe.content&&(ce=fe.content.length,!(!ce||ce>=4096)&&(fe.start=se,ge(ce+63>>6)));for(;b.l&511;)b.write_shift(-4,Ce.ENDOFCHAIN);for(V=0;V<B[4]<<2;++V){var ke=R.FullPaths[V];if(!ke||ke.length===0){for(ie=0;ie<17;++ie)b.write_shift(4,0);for(ie=0;ie<3;++ie)b.write_shift(4,-1);for(ie=0;ie<12;++ie)b.write_shift(4,0);continue}fe=R.FileIndex[V],V===0&&(fe.start=fe.size?fe.start-1:xe);var Le=V===0&&L.root||fe.name;if(ce=2*(Le.length+1),b.write_shift(64,Le,"utf16le"),b.write_shift(2,ce),b.write_shift(1,fe.type),b.write_shift(1,fe.color),b.write_shift(-4,fe.L),b.write_shift(-4,fe.R),b.write_shift(-4,fe.C),fe.clsid)b.write_shift(16,fe.clsid,"hex");else for(ie=0;ie<4;++ie)b.write_shift(4,0);b.write_shift(4,fe.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,fe.start),b.write_shift(4,fe.size),b.write_shift(4,0)}for(V=1;V<R.FileIndex.length;++V)if(fe=R.FileIndex[V],fe.size>=4096)if(b.l=fe.start+1<<9,at&&Buffer.isBuffer(fe.content))fe.content.copy(b,b.l,0,fe.size),b.l+=fe.size+511&-512;else{for(ie=0;ie<fe.size;++ie)b.write_shift(1,fe.content[ie]);for(;ie&511;++ie)b.write_shift(1,0)}for(V=1;V<R.FileIndex.length;++V)if(fe=R.FileIndex[V],fe.size>0&&fe.size<4096)if(at&&Buffer.isBuffer(fe.content))fe.content.copy(b,b.l,0,fe.size),b.l+=fe.size+63&-64;else{for(ie=0;ie<fe.size;++ie)b.write_shift(1,fe.content[ie]);for(;ie&63;++ie)b.write_shift(1,0)}if(at)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function Q(R,U){var L=R.FullPaths.map(function(ie){return ie.toUpperCase()}),B=L.map(function(ie){var ce=ie.split("/");return ce[ce.length-(ie.slice(-1)=="/"?2:1)]}),b=!1;U.charCodeAt(0)===47?(b=!0,U=L[0].slice(0,-1)+U):b=U.indexOf("/")!==-1;var V=U.toUpperCase(),se=b===!0?L.indexOf(V):B.indexOf(V);if(se!==-1)return R.FileIndex[se];var ge=!V.match(zo);for(V=V.replace(jn,""),ge&&(V=V.replace(zo,"!")),se=0;se<L.length;++se)if((ge?L[se].replace(zo,"!"):L[se]).replace(jn,"")==V||(ge?B[se].replace(zo,"!"):B[se]).replace(jn,"")==V)return R.FileIndex[se];return null}var Y=64,xe=-2,De="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],Fe="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:xe,FREESECT:-1,HEADER_SIGNATURE:De,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(R,U,L){h();var B=te(R,L);d.writeFileSync(U,B)}function Z(R){for(var U=new Array(R.length),L=0;L<R.length;++L)U[L]=String.fromCharCode(R[L]);return U.join("")}function H(R,U){var L=te(R,U);switch(U&&U.type||"buffer"){case"file":return h(),d.writeFileSync(U.filename,L),L;case"binary":return typeof L=="string"?L:Z(L);case"base64":return Zo(typeof L=="string"?L:Z(L));case"buffer":if(at)return Buffer.isBuffer(L)?L:Ci(L);case"array":return typeof L=="string"?hr(L):L}return L}var ue;function O(R){try{var U=R.InflateRaw,L=new U;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)ue=R;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function J(R,U){if(!ue)return Ri(R,U);var L=ue.InflateRaw,B=new L,b=B._processChunk(R.slice(R.l),B._finishFlushFlag);return R.l+=B.bytesRead,b}function j(R){return ue?ue.deflateRawSync(R):Qe(R)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(R){var U=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(U>>16|U>>8|U)&255}for(var _e=typeof Uint8Array<"u",Ie=_e?new Uint8Array(256):[],Je=0;Je<256;++Je)Ie[Je]=ve(Je);function G(R,U){var L=Ie[R&255];return U<=8?L>>>8-U:(L=L<<8|Ie[R>>8&255],U<=16?L>>>16-U:(L=L<<8|Ie[R>>16&255],L>>>24-U))}function ut(R,U){var L=U&7,B=U>>>3;return(R[B]|(L<=6?0:R[B+1]<<8))>>>L&3}function it(R,U){var L=U&7,B=U>>>3;return(R[B]|(L<=5?0:R[B+1]<<8))>>>L&7}function ht(R,U){var L=U&7,B=U>>>3;return(R[B]|(L<=4?0:R[B+1]<<8))>>>L&15}function et(R,U){var L=U&7,B=U>>>3;return(R[B]|(L<=3?0:R[B+1]<<8))>>>L&31}function Oe(R,U){var L=U&7,B=U>>>3;return(R[B]|(L<=1?0:R[B+1]<<8))>>>L&127}function At(R,U,L){var B=U&7,b=U>>>3,V=(1<<L)-1,se=R[b]>>>B;return L<8-B||(se|=R[b+1]<<8-B,L<16-B)||(se|=R[b+2]<<16-B,L<24-B)||(se|=R[b+3]<<24-B),se&V}function Jt(R,U,L){var B=U&7,b=U>>>3;return B<=5?R[b]|=(L&7)<<B:(R[b]|=L<<B&255,R[b+1]=(L&7)>>8-B),U+3}function Xt(R,U,L){var B=U&7,b=U>>>3;return L=(L&1)<<B,R[b]|=L,U+1}function Ft(R,U,L){var B=U&7,b=U>>>3;return L<<=B,R[b]|=L&255,L>>>=8,R[b+1]=L,U+8}function yn(R,U,L){var B=U&7,b=U>>>3;return L<<=B,R[b]|=L&255,L>>>=8,R[b+1]=L&255,R[b+2]=L>>>8,U+16}function $n(R,U){var L=R.length,B=2*L>U?2*L:U+5,b=0;if(L>=U)return R;if(at){var V=qm(B);if(R.copy)R.copy(V);else for(;b<R.length;++b)V[b]=R[b];return V}else if(_e){var se=new Uint8Array(B);if(se.set)se.set(R);else for(;b<L;++b)se[b]=R[b];return se}return R.length=B,R}function fn(R){for(var U=new Array(R),L=0;L<R;++L)U[L]=0;return U}function qn(R,U,L){var B=1,b=0,V=0,se=0,ge=0,ie=R.length,ce=_e?new Uint16Array(32):fn(32);for(V=0;V<32;++V)ce[V]=0;for(V=ie;V<L;++V)R[V]=0;ie=R.length;var fe=_e?new Uint16Array(ie):fn(ie);for(V=0;V<ie;++V)ce[b=R[V]]++,B<b&&(B=b),fe[V]=0;for(ce[0]=0,V=1;V<=B;++V)ce[V+16]=ge=ge+ce[V-1]<<1;for(V=0;V<ie;++V)ge=R[V],ge!=0&&(fe[V]=ce[ge+16]++);var ke=0;for(V=0;V<ie;++V)if(ke=R[V],ke!=0)for(ge=G(fe[V],B)>>B-ke,se=(1<<B+4-ke)-1;se>=0;--se)U[ge|se<<ke]=ke&15|V<<4;return B}var sn=_e?new Uint16Array(512):fn(512),Kn=_e?new Uint16Array(32):fn(32);if(!_e){for(var gt=0;gt<512;++gt)sn[gt]=0;for(gt=0;gt<32;++gt)Kn[gt]=0}(function(){for(var R=[],U=0;U<32;U++)R.push(5);qn(R,Kn,32);var L=[];for(U=0;U<=143;U++)L.push(8);for(;U<=255;U++)L.push(9);for(;U<=279;U++)L.push(7);for(;U<=287;U++)L.push(8);qn(L,sn,288)})();var wn=function(){for(var U=_e?new Uint8Array(32768):[],L=0,B=0;L<ye.length-1;++L)for(;B<ye[L+1];++B)U[B]=L;for(;B<32768;++B)U[B]=29;var b=_e?new Uint8Array(259):[];for(L=0,B=0;L<le.length-1;++L)for(;B<le[L+1];++B)b[B]=L;function V(ge,ie){for(var ce=0;ce<ge.length;){var fe=Math.min(65535,ge.length-ce),ke=ce+fe==ge.length;for(ie.write_shift(1,+ke),ie.write_shift(2,fe),ie.write_shift(2,~fe&65535);fe-- >0;)ie[ie.l++]=ge[ce++]}return ie.l}function se(ge,ie){for(var ce=0,fe=0,ke=_e?new Uint16Array(32768):[];fe<ge.length;){var Le=Math.min(65535,ge.length-fe);if(Le<10){for(ce=Jt(ie,ce,+(fe+Le==ge.length)),ce&7&&(ce+=8-(ce&7)),ie.l=ce/8|0,ie.write_shift(2,Le),ie.write_shift(2,~Le&65535);Le-- >0;)ie[ie.l++]=ge[fe++];ce=ie.l*8;continue}ce=Jt(ie,ce,+(fe+Le==ge.length)+2);for(var ne=0;Le-- >0;){var ae=ge[fe];ne=(ne<<5^ae)&32767;var he=-1,Ue=0;if((he=ke[ne])&&(he|=fe&-32768,he>fe&&(he-=32768),he<fe))for(;ge[he+Ue]==ge[fe+Ue]&&Ue<250;)++Ue;if(Ue>2){ae=b[Ue],ae<=22?ce=Ft(ie,ce,Ie[ae+1]>>1)-1:(Ft(ie,ce,3),ce+=5,Ft(ie,ce,Ie[ae-23]>>5),ce+=3);var lt=ae<8?0:ae-4>>2;lt>0&&(yn(ie,ce,Ue-le[ae]),ce+=lt),ae=U[fe-he],ce=Ft(ie,ce,Ie[ae]>>3),ce-=3;var tt=ae<4?0:ae-2>>1;tt>0&&(yn(ie,ce,fe-he-ye[ae]),ce+=tt);for(var Ct=0;Ct<Ue;++Ct)ke[ne]=fe&32767,ne=(ne<<5^ge[fe])&32767,++fe;Le-=Ue-1}else ae<=143?ae=ae+48:ce=Xt(ie,ce,1),ce=Ft(ie,ce,Ie[ae]),ke[ne]=fe&32767,++fe}ce=Ft(ie,ce,0)-1}return ie.l=(ce+7)/8|0,ie.l}return function(ie,ce){return ie.length<8?V(ie,ce):se(ie,ce)}}();function Qe(R){var U=me(50+Math.floor(R.length*1.1)),L=wn(R,U);return U.slice(0,L)}var xt=_e?new Uint16Array(32768):fn(32768),Cn=_e?new Uint16Array(32768):fn(32768),It=_e?new Uint16Array(128):fn(128),vt=1,es=1;function Fi(R,U){var L=et(R,U)+257;U+=5;var B=et(R,U)+1;U+=5;var b=ht(R,U)+4;U+=4;for(var V=0,se=_e?new Uint8Array(19):fn(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ce=_e?new Uint8Array(8):fn(8),fe=_e?new Uint8Array(8):fn(8),ke=se.length,Le=0;Le<b;++Le)se[K[Le]]=V=it(R,U),ie<V&&(ie=V),ce[V]++,U+=3;var ne=0;for(ce[0]=0,Le=1;Le<=ie;++Le)fe[Le]=ne=ne+ce[Le-1]<<1;for(Le=0;Le<ke;++Le)(ne=se[Le])!=0&&(ge[Le]=fe[ne]++);var ae=0;for(Le=0;Le<ke;++Le)if(ae=se[Le],ae!=0){ne=Ie[ge[Le]]>>8-ae;for(var he=(1<<7-ae)-1;he>=0;--he)It[ne|he<<ae]=ae&7|Le<<3}var Ue=[];for(ie=1;Ue.length<L+B;)switch(ne=It[Oe(R,U)],U+=ne&7,ne>>>=3){case 16:for(V=3+ut(R,U),U+=2,ne=Ue[Ue.length-1];V-- >0;)Ue.push(ne);break;case 17:for(V=3+it(R,U),U+=3;V-- >0;)Ue.push(0);break;case 18:for(V=11+Oe(R,U),U+=7;V-- >0;)Ue.push(0);break;default:Ue.push(ne),ie<ne&&(ie=ne);break}var lt=Ue.slice(0,L),tt=Ue.slice(L);for(Le=L;Le<286;++Le)lt[Le]=0;for(Le=B;Le<30;++Le)tt[Le]=0;return vt=qn(lt,xt,286),es=qn(tt,Cn,30),U}function ha(R,U){if(R[0]==3&&!(R[1]&3))return[sa(U),2];for(var L=0,B=0,b=qm(U||1<<18),V=0,se=b.length>>>0,ge=0,ie=0;(B&1)==0;){if(B=it(R,L),L+=3,B>>>1)B>>1==1?(ge=9,ie=5):(L=Fi(R,L),ge=vt,ie=es);else{L&7&&(L+=8-(L&7));var ce=R[L>>>3]|R[(L>>>3)+1]<<8;if(L+=32,ce>0)for(!U&&se<V+ce&&(b=$n(b,V+ce),se=b.length);ce-- >0;)b[V++]=R[L>>>3],L+=8;continue}for(;;){!U&&se<V+32767&&(b=$n(b,V+32767),se=b.length);var fe=At(R,L,ge),ke=B>>>1==1?sn[fe]:xt[fe];if(L+=ke&15,ke>>>=4,(ke>>>8&255)===0)b[V++]=ke;else{if(ke==256)break;ke-=257;var Le=ke<8?0:ke-4>>2;Le>5&&(Le=0);var ne=V+le[ke];Le>0&&(ne+=At(R,L,Le),L+=Le),fe=At(R,L,ie),ke=B>>>1==1?Kn[fe]:Cn[fe],L+=ke&15,ke>>>=4;var ae=ke<4?0:ke-2>>1,he=ye[ke];for(ae>0&&(he+=At(R,L,ae),L+=ae),!U&&se<ne&&(b=$n(b,ne+100),se=b.length);V<ne;)b[V]=b[V-he],++V}}}return U?[b,L+7>>>3]:[b.slice(0,V),L+7>>>3]}function Ri(R,U){var L=R.slice(R.l||0),B=ha(L,U);return R.l+=B[1],B[0]}function Di(R,U){if(R)typeof console<"u"&&console.error(U);else throw new Error(U)}function Pi(R,U){var L=R;kn(L,0);var B=[],b=[],V={FileIndex:B,FullPaths:b};F(V,{root:U.root});for(var se=L.length-4;(L[se]!=80||L[se+1]!=75||L[se+2]!=5||L[se+3]!=6)&&se>=0;)--se;L.l=se+4,L.l+=4;var ge=L.read_shift(2);L.l+=6;var ie=L.read_shift(4);for(L.l=ie,se=0;se<ge;++se){L.l+=20;var ce=L.read_shift(4),fe=L.read_shift(4),ke=L.read_shift(2),Le=L.read_shift(2),ne=L.read_shift(2);L.l+=8;var ae=L.read_shift(4),he=u(L.slice(L.l+ke,L.l+ke+Le));L.l+=ke+Le+ne;var Ue=L.l;L.l=ae+4,qr(L,ce,fe,V,he),L.l=Ue}return V}function qr(R,U,L,B,b){R.l+=2;var V=R.read_shift(2),se=R.read_shift(2),ge=o(R);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var ie=R.read_shift(4),ce=R.read_shift(4),fe=R.read_shift(4),ke=R.read_shift(2),Le=R.read_shift(2),ne="",ae=0;ae<ke;++ae)ne+=String.fromCharCode(R[R.l++]);if(Le){var he=u(R.slice(R.l,R.l+Le));(he[21589]||{}).mt&&(ge=he[21589].mt),((b||{})[21589]||{}).mt&&(ge=b[21589].mt)}R.l+=Le;var Ue=R.slice(R.l,R.l+ce);switch(se){case 8:Ue=J(R,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var lt=!1;V&8&&(ie=R.read_shift(4),ie==134695760&&(ie=R.read_shift(4),lt=!0),ce=R.read_shift(4),fe=R.read_shift(4)),ce!=U&&Di(lt,"Bad compressed size: "+U+" != "+ce),fe!=L&&Di(lt,"Bad uncompressed size: "+L+" != "+fe),Mr(B,ne,Ue,{unsafe:!0,mt:ge})}function Kr(R,U){var L=U||{},B=[],b=[],V=me(1),se=L.compression?8:0,ge=0,ie=0,ce=0,fe=0,ke=0,Le=R.FullPaths[0],ne=Le,ae=R.FileIndex[0],he=[],Ue=0;for(ie=1;ie<R.FullPaths.length;++ie)if(ne=R.FullPaths[ie].slice(Le.length),ae=R.FileIndex[ie],!(!ae.size||!ae.content||ne=="Sh33tJ5")){var lt=fe,tt=me(ne.length);for(ce=0;ce<ne.length;++ce)tt.write_shift(1,ne.charCodeAt(ce)&127);tt=tt.slice(0,tt.l),he[ke]=pT.buf(ae.content,0);var Ct=ae.content;se==8&&(Ct=j(Ct)),V=me(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,ge),V.write_shift(2,se),ae.mt?s(V,ae.mt):V.write_shift(4,0),V.write_shift(-4,he[ke]),V.write_shift(4,Ct.length),V.write_shift(4,ae.content.length),V.write_shift(2,tt.length),V.write_shift(2,0),fe+=V.length,B.push(V),fe+=tt.length,B.push(tt),fe+=Ct.length,B.push(Ct),V=me(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,ge),V.write_shift(2,se),V.write_shift(4,0),V.write_shift(-4,he[ke]),V.write_shift(4,Ct.length),V.write_shift(4,ae.content.length),V.write_shift(2,tt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,lt),Ue+=V.l,b.push(V),Ue+=tt.length,b.push(tt),++ke}return V=me(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,ke),V.write_shift(2,ke),V.write_shift(4,Ue),V.write_shift(4,fe),V.write_shift(2,0),gn([gn(B),gn(b),V])}var oi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ts(R,U){if(R.ctype)return R.ctype;var L=R.name||"",B=L.match(/\.([^\.]+)$/);return B&&oi[B[1]]||U&&(B=(L=U).match(/[\.\\]([^\.\\])+$/),B&&oi[B[1]])?oi[B[1]]:"application/octet-stream"}function ns(R){for(var U=Zo(R),L=[],B=0;B<U.length;B+=76)L.push(U.slice(B,B+76));return L.join(`\r
`)+`\r
`}function rs(R){var U=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var fe=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],B=U.split(`\r
`),b=0;b<B.length;++b){var V=B[b];if(V.length==0){L.push("");continue}for(var se=0;se<V.length;){var ge=76,ie=V.slice(se,se+ge);ie.charAt(ge-1)=="="?ge--:ie.charAt(ge-2)=="="?ge-=2:ie.charAt(ge-3)=="="&&(ge-=3),ie=V.slice(se,se+ge),se+=ge,se<V.length&&(ie+="="),L.push(ie)}}return L.join(`\r
`)}function is(R){for(var U=[],L=0;L<R.length;++L){for(var B=R[L];L<=R.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+R[++L];U.push(B)}for(var b=0;b<U.length;++b)U[b]=U[b].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return hr(U.join(`\r
`))}function pa(R,U,L){for(var B="",b="",V="",se,ge=0;ge<10;++ge){var ie=U[ge];if(!ie||ie.match(/^\s*$/))break;var ce=ie.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":B=ce[2].trim();break;case"content-type":V=ce[2].trim();break;case"content-transfer-encoding":b=ce[2].trim();break}}switch(++ge,b.toLowerCase()){case"base64":se=hr(gr(U.slice(ge).join("")));break;case"quoted-printable":se=is(U.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var fe=Mr(R,B.slice(L.length),se,{unsafe:!0});V&&(fe.ctype=V)}function as(R,U){if(Z(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=U&&U.root||"",B=(at&&Buffer.isBuffer(R)?R.toString("binary"):Z(R)).split(`\r
`),b=0,V="";for(b=0;b<B.length;++b)if(V=B[b],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),L||(L=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),V.slice(0,L.length)!=L););var se=(B[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ge="--"+(se[1]||""),ie=[],ce=[],fe={FileIndex:ie,FullPaths:ce};F(fe);var ke,Le=0;for(b=0;b<B.length;++b){var ne=B[b];ne!==ge&&ne!==ge+"--"||(Le++&&pa(fe,B.slice(ke,b),L),ke=b)}return fe}function li(R,U){var L=U||{},B=L.boundary||"SheetJS";B="------="+B;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],V=R.FullPaths[0],se=V,ge=R.FileIndex[0],ie=1;ie<R.FullPaths.length;++ie)if(se=R.FullPaths[ie].slice(V.length),ge=R.FileIndex[ie],!(!ge.size||!ge.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var ce=ge.content,fe=at&&Buffer.isBuffer(ce)?ce.toString("binary"):Z(ce),ke=0,Le=Math.min(1024,fe.length),ne=0,ae=0;ae<=Le;++ae)(ne=fe.charCodeAt(ae))>=32&&ne<128&&++ke;var he=ke>=Le*4/5;b.push(B),b.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+se),b.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),b.push("Content-Type: "+ts(ge,se)),b.push(""),b.push(he?rs(fe):ns(fe))}return b.push(B+`--\r
`),b.join(`\r
`)}function ma(R){var U={};return F(U,R),U}function Mr(R,U,L,B){var b=B&&B.unsafe;b||F(R);var V=!b&&Ge.find(R,U);if(!V){var se=R.FullPaths[0];U.slice(0,se.length)==se?se=U:(se.slice(-1)!="/"&&(se+="/"),se=(se+U).replace("//","/")),V={name:i(U),type:2},R.FileIndex.push(V),R.FullPaths.push(se),b||Ge.utils.cfb_gc(R)}return V.content=L,V.size=L?L.length:0,B&&(B.CLSID&&(V.clsid=B.CLSID),B.mt&&(V.mt=B.mt),B.ct&&(V.ct=B.ct)),V}function eo(R,U){F(R);var L=Ge.find(R,U);if(L){for(var B=0;B<R.FileIndex.length;++B)if(R.FileIndex[B]==L)return R.FileIndex.splice(B,1),R.FullPaths.splice(B,1),!0}return!1}function ui(R,U,L){F(R);var B=Ge.find(R,U);if(B){for(var b=0;b<R.FileIndex.length;++b)if(R.FileIndex[b]==B)return R.FileIndex[b].name=i(L),R.FullPaths[b]=L,!0}return!1}function Mi(R){z(R,!0)}return t.find=Q,t.read=P,t.parse=m,t.write=H,t.writeFile=Se,t.utils={cfb_new:ma,cfb_add:Mr,cfb_del:eo,cfb_mov:ui,cfb_gc:Mi,ReadShift:Vo,CheckField:fv,prep_blob:kn,bconcat:gn,use_zlib:O,_deflateRaw:Qe,_inflateRaw:Ri,consts:Ce},t}();function mT(e){return typeof e=="string"?dc(e):Array.isArray(e)?V2(e):e}function fl(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=dc(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?ri(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([mT(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=ca(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function gT(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Kt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function tg(e,t){for(var n=[],r=Kt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function pc(e){for(var t=[],n=Kt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function mc(e){for(var t=[],n=Kt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function xT(e){for(var t=[],n=Kt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var Ju=new Date(1899,11,30,0,0,0);function cn(e,t){var n=e.getTime(),r=Ju.getTime()+(e.getTimezoneOffset()-Ju.getTimezoneOffset())*6e4;return(n-r)/(1440*60*1e3)}var G1=new Date,vT=Ju.getTime()+(G1.getTimezoneOffset()-Ju.getTimezoneOffset())*6e4,ng=G1.getTimezoneOffset();function gc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+vT),t.getTimezoneOffset()!==ng&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ng)*6e4),t}function yT(e){var t=0,n=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(n=1,s>3&&(r=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(i[s],10)}return t}var rg=new Date("2017-02-19T19:06:09.000Z"),j1=isNaN(rg.getFullYear())?new Date("2/19/17"):rg,wT=j1.getFullYear()==2017;function Lt(e,t){var n=new Date(e);if(wT)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(j1.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ba(e,t){if(at&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ri(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ri(D1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ri(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ri(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function Ot(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Ot(e[n]));return t}function $t(e,t){for(var n="";n.length<t;)n+=e;return n}function jr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var _T=["january","february","march","april","may","june","july","august","september","october","november","december"];function Hs(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&_T.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var TT=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,i){if(e||typeof r=="string")return n.split(r);for(var s=n.split(r),o=[s[0]],u=1;u<s.length;++u)o.push(i),o.push(s[u]);return o}}();function $1(e){return e?e.content&&e.type?ba(e.content,!0):e.data?Uo(e.data):e.asNodeBuffer&&at?Uo(e.asNodeBuffer().toString("binary")):e.asBinary?Uo(e.asBinary()):e._data&&e._data.getContent?Uo(ba(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function q1(e){if(!e)return null;if(e.data)return jm(e.data);if(e.asNodeBuffer&&at)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?jm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ST(e){return e&&e.name.slice(-4)===".bin"?q1(e):$1(e)}function Ar(e,t){for(var n=e.FullPaths||Kt(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),s=0;s<n.length;++s){var o=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||i==o)return e.files?e.files[n[s]]:e.FileIndex[s]}return null}function vd(e,t){var n=Ar(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function rn(e,t,n){if(!n)return ST(vd(e,t));if(!t)return null;try{return rn(e,t)}catch{return null}}function pr(e,t,n){if(!n)return $1(vd(e,t));if(!t)return null;try{return pr(e,t)}catch{return null}}function kT(e,t,n){return q1(vd(e,t))}function ig(e){for(var t=e.FullPaths||Kt(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function rt(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return at?r=Ci(n):r=H2(n),Ge.utils.cfb_add(e,t,r)}Ge.utils.cfb_add(e,t,n)}else e.file(t,n)}function yd(){return Ge.utils.cfb_new()}function K1(e,t){switch(t.type){case"base64":return Ge.read(e,{type:"base64"});case"binary":return Ge.read(e,{type:"binary"});case"buffer":case"array":return Ge.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function bo(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var i=r.shift();i===".."?n.pop():i!=="."&&n.push(i)}return n.join("/")}var en=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ET=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ag=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,CT=/<[^>]*>/g,bn=en.match(ag)?ag:CT,AT=/<\w*:/,IT=/<(\/?)\w+:/;function Ye(e,t,n){for(var r={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(r[0]=e.slice(0,i)),i===e.length)return r;var o=e.match(ET),u=0,d="",h=0,m="",x="",v=1;if(o)for(h=0;h!=o.length;++h){for(x=o[h],s=0;s!=x.length&&x.charCodeAt(s)!==61;++s);for(m=x.slice(0,s).trim();x.charCodeAt(s+1)==32;)++s;for(v=(i=x.charCodeAt(s+1))==34||i==39?1:0,d=x.slice(s+1+v,x.length-v),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=d,r[m.toLowerCase()]=d;else{var _=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(r[_]&&m.slice(u-3,u)=="ext")continue;r[_]=d,r[_.toLowerCase()]=d}}return r}function ai(e){return e.replace(IT,"<$1")}var J1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},wd=pc(J1),ft=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var i=r+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(u,d){return J1[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var o=i.indexOf("]]>");return n(i.slice(0,s))+i.slice(s+9,o)+n(i.slice(o+3))}}(),_d=/[&<>'"]/g,NT=/[\u0000-\u0008\u000b-\u001f]/g;function kt(e){var t=e+"";return t.replace(_d,function(n){return wd[n]}).replace(NT,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function sg(e){return kt(e).replace(/ /g,"_x0020_")}var X1=/[\u0000-\u001f]/g;function Td(e){var t=e+"";return t.replace(_d,function(n){return wd[n]}).replace(/\n/g,"<br/>").replace(X1,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function FT(e){var t=e+"";return t.replace(_d,function(n){return wd[n]}).replace(X1,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var og=function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}}();function RT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function v0(e){for(var t="",n=0,r=0,i=0,s=0,o=0,u=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(n++),u=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function lg(e){var t=sa(2*e.length),n,r,i=1,s=0,o=0,u;for(r=0;r<e.length;r+=i)i=1,(u=e.charCodeAt(r))<128?n=u:u<224?(n=(u&31)*64+(e.charCodeAt(r+1)&63),i=2):u<240?(n=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function ug(e){return Ci(e,"binary").toString("utf8")}var Cu="foo bar bazâð£",Et=at&&(ug(Cu)==v0(Cu)&&ug||lg(Cu)==v0(Cu)&&lg)||v0,ri=at?function(e){return Ci(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},el=function(){var e={};return function(n,r){var i=n+"|"+(r||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),Y1=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),DT=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),PT=/<\/?(?:vt:)?variant>/g,MT=/<(?:vt:)([^>]*)>([\s\S]*)</;function cg(e,t){var n=Ye(e),r=e.match(DT(n.baseType))||[],i=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return i}return r.forEach(function(s){var o=s.replace(PT,"").match(MT);o&&i.push({v:Et(o[2]),t:o[1]})}),i}var Z1=/(^\s|\s$|\n)/;function En(e,t){return"<"+e+(t.match(Z1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function tl(e){return Kt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Pe(e,t,n){return"<"+e+(n!=null?tl(n):"")+(t!=null?(t.match(Z1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function U0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function LT(e,t){switch(typeof e){case"string":var n=Pe("vt:lpwstr",kt(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Pe((e|0)==e?"vt:i4":"vt:r8",kt(String(e)));case"boolean":return Pe("vt:bool",e?"true":"false")}if(e instanceof Date)return Pe("vt:filetime",U0(e));throw new Error("Unable to serialize "+e)}function Sd(e){if(at&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Et(ca(md(e)));throw new Error("Bad input format: expected Buffer or string")}var nl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,un={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$a=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function OT(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function BT(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=r?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var u=0;u<=5;++u,s/=256)e[n+u]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var fg=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},dg=at?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ci(t)})):fg(e)}:fg,hg=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(yi(e,i)));return r.join("").replace(jn,"")},kd=at?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(jn,""):hg(e,t,n)}:hg,pg=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},Q1=at?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):pg(e,t,n)}:pg,mg=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(Rs(e,i)));return r.join("")},dl=at?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):mg(t,n,r)}:mg,ev=function(e,t){var n=dr(e,t);return n>0?dl(e,t+4,t+4+n-1):""},tv=ev,nv=function(e,t){var n=dr(e,t);return n>0?dl(e,t+4,t+4+n-1):""},rv=nv,iv=function(e,t){var n=2*dr(e,t);return n>0?dl(e,t+4,t+4+n-1):""},av=iv,sv=function(t,n){var r=dr(t,n);return r>0?kd(t,n+4,n+4+r):""},ov=sv,lv=function(e,t){var n=dr(e,t);return n>0?dl(e,t+4,t+4+n):""},uv=lv,cv=function(e,t){return OT(e,t)},Xu=cv,Ed=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};at&&(tv=function(t,n){if(!Buffer.isBuffer(t))return ev(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},rv=function(t,n){if(!Buffer.isBuffer(t))return nv(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},av=function(t,n){if(!Buffer.isBuffer(t))return iv(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},ov=function(t,n){if(!Buffer.isBuffer(t))return sv(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},uv=function(t,n){if(!Buffer.isBuffer(t))return lv(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Xu=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):cv(t,n)},Ed=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Rs=function(e,t){return e[t]},yi=function(e,t){return e[t+1]*256+e[t]},UT=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},dr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ra=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},zT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Vo(e,t){var n="",r,i,s=[],o,u,d,h;switch(t){case"dbcs":if(h=this.l,at&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)n+=String.fromCharCode(yi(this,h)),h+=2;e*=2;break;case"utf8":n=dl(this,this.l,this.l+e);break;case"utf16le":e*=2,n=kd(this,this.l,this.l+e);break;case"wstr":return Vo.call(this,e,"dbcs");case"lpstr-ansi":n=tv(this,this.l),e=4+dr(this,this.l);break;case"lpstr-cp":n=rv(this,this.l),e=4+dr(this,this.l);break;case"lpwstr":n=av(this,this.l),e=4+2*dr(this,this.l);break;case"lpp4":e=4+dr(this,this.l),n=ov(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+dr(this,this.l),n=uv(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=Rs(this,this.l+e++))!==0;)s.push(Eu(o));n=s.join("");break;case"_wstr":for(e=0,n="";(o=yi(this,this.l+e))!==0;)s.push(Eu(o)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Rs(this,h),this.l=h+1,u=Vo.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Eu(yi(this,h))),h+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Rs(this,h),this.l=h+1,u=Vo.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Eu(Rs(this,h))),h+=1}n=s.join("");break;default:switch(e){case 1:return r=Rs(this,this.l),this.l++,r;case 2:return r=(t==="i"?UT:yi)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?Ra:zT)(this,this.l),this.l+=4,r):(i=dr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Xu(this,this.l):i=Xu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=Q1(this,this.l,e);break}}return this.l+=e,n}var bT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},VT=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},HT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function WT(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)HT(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,bT(this,t,this.l);break;case 8:if(r=8,n==="f"){BT(this,t,this.l);break}case 16:break;case-4:r=4,VT(this,t,this.l);break}return this.l+=r,this}function fv(e,t){var n=Q1(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function kn(e,t){e.l=t,e.read_shift=Vo,e.chk=fv,e.write_shift=WT}function zn(e,t){e.l+=t}function me(e){var t=sa(e);return kn(t,0),t}function Ai(e,t,n){if(e){var r,i,s;kn(e,e.l||0);for(var o=e.length,u=0,d=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=ll[u]||ll[65535];for(r=e.read_shift(1),s=r&127,i=1;i<4&&r&128;++i)s+=((r=e.read_shift(1))&127)<<7*i;d=e.l+s;var m=h.f&&h.f(e,s,n);if(e.l=d,t(m,h,u))return}}}function ir(){var e=[],t=at?256:2048,n=function(h){var m=me(h);return kn(m,0),m},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(h){return r&&h<r.length-r.l?r:(i(),r=n(Math.max(h+1,t)))},o=function(){return i(),gn(e)},u=function(h){i(),r=h,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:u,end:o,_bufs:e}}function Te(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=ll[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Ed(n)&&e.push(n)}}function Ho(e,t,n){var r=Ot(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function gg(e,t,n){var r=Ot(e);return r.s=Ho(r.s,t.s,n),r.e=Ho(r.e,t.s,n),r}function Wo(e,t){if(e.cRel&&e.c<0)for(e=Ot(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ot(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Xe(e);return!e.cRel&&e.cRel!=null&&(n=$T(n)),!e.rRel&&e.rRel!=null&&(n=GT(n)),n}function y0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Qt(e.s.r)+":"+(e.e.rRel?"":"$")+Qt(e.e.r):Wo(e.s,t.biff)+":"+Wo(e.e,t.biff)}function Cd(e){return parseInt(jT(e),10)-1}function Qt(e){return""+(e+1)}function GT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jT(e){return e.replace(/\$(\d+)$/,"$1")}function Ad(e){for(var t=qT(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function $T(e){return e.replace(/^([A-Z])/,"$$$1")}function qT(e){return e.replace(/^\$([A-Z])/,"$1")}function KT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wt(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function Xe(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function ar(e){var t=e.indexOf(":");return t==-1?{s:Wt(e),e:Wt(e)}:{s:Wt(e.slice(0,t)),e:Wt(e.slice(t+1))}}function nt(e,t){return typeof t>"u"||typeof t=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=Xe(e)),typeof t!="string"&&(t=Xe(t)),e==t?e:e+":"+t)}function dt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function xg(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dr(e.z,n?cn(t):t)}catch{}try{return e.w=Dr((e.XF||{}).numFmtId||(n?14:0),n?cn(t):t)}catch{return""+t}}function ki(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Ii[e.v]||e.v:t==null?xg(e,e.v):xg(e,t))}function fa(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function dv(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),o=0,u=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var d=typeof r.origin=="string"?Wt(r.origin):r.origin;o=d.r,u=d.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=dt(s["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(h.e.r=o=m.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[x].length;++v)if(!(typeof t[x][v]>"u")){var _={v:t[x][v]},k=o+x,T=u+v;if(h.s.r>k&&(h.s.r=k),h.s.c>T&&(h.s.c=T),h.e.r<k&&(h.e.r=k),h.e.c<T&&(h.e.c=T),t[x][v]&&typeof t[x][v]=="object"&&!Array.isArray(t[x][v])&&!(t[x][v]instanceof Date))_=t[x][v];else if(Array.isArray(_.v)&&(_.f=t[x][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(r.nullError)_.t="e",_.v=0;else if(r.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=r.dateNF||Ke[14],r.cellDates?(_.t="d",_.w=Dr(_.z,cn(_.v))):(_.t="n",_.v=cn(_.v),_.w=Dr(_.z,_.v))):_.t="s";if(i)s[k]||(s[k]=[]),s[k][T]&&s[k][T].z&&(_.z=s[k][T].z),s[k][T]=_;else{var E=Xe({c:T,r:k});s[E]&&s[E].z&&(_.z=s[E].z),s[E]=_}}}return h.s.c<1e7&&(s["!ref"]=nt(h)),s}function qs(e,t){return dv(null,e,t)}function JT(e){return e.read_shift(4,"i")}function $r(e,t){return t||(t=me(4)),t.write_shift(4,e),t}function Un(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function vn(e,t){var n=!1;return t==null&&(n=!0,t=me(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function XT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function YT(e,t){return t||(t=me(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Id(e,t){var n=e.l,r=e.read_shift(1),i=Un(e),s=[],o={t:i,h:i};if((r&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)s.push(XT(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function ZT(e,t){var n=!1;return t==null&&(n=!0,t=me(15+4*e.t.length)),t.write_shift(1,0),vn(e.t,t),n?t.slice(0,t.l):t}var QT=Id;function eS(e,t){var n=!1;return t==null&&(n=!0,t=me(23+4*e.t.length)),t.write_shift(1,1),vn(e.t,t),t.write_shift(4,1),YT({},t),n?t.slice(0,t.l):t}function Pr(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function qa(e,t){return t==null&&(t=me(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ka(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ja(e,t){return t==null&&(t=me(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var tS=Un,hv=vn;function Nd(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Yu(e,t){var n=!1;return t==null&&(n=!0,t=me(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var nS=Un,z0=Nd,Fd=Yu;function Rd(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?Xu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ra(t,0)>>2;return n?i/100:i}function pv(e,t){t==null&&(t=me(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function mv(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function rS(e,t){return t||(t=me(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Xa=mv,Ks=rS;function Ln(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Va(e,t){return(t||me(8)).write_shift(8,e,"f")}function iS(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var h=Pa[i];h&&(t.rgb=il(h));break;case 2:t.rgb=il([o,u,d]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Zu(e,t){if(t||(t=me(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function aS(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function sS(e,t){t||(t=me(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}function gv(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function oS(e){return gv(e,1)}function lS(e){return gv(e,2)}var Dd=2,rr=3,Au=11,vg=12,Qu=19,Iu=64,uS=65,cS=71,fS=4108,dS=4126,mn=80,xv=81,hS=[mn,xv],b0={1:{n:"CodePage",t:Dd},2:{n:"Category",t:mn},3:{n:"PresentationFormat",t:mn},4:{n:"ByteCount",t:rr},5:{n:"LineCount",t:rr},6:{n:"ParagraphCount",t:rr},7:{n:"SlideCount",t:rr},8:{n:"NoteCount",t:rr},9:{n:"HiddenCount",t:rr},10:{n:"MultimediaClipCount",t:rr},11:{n:"ScaleCrop",t:Au},12:{n:"HeadingPairs",t:fS},13:{n:"TitlesOfParts",t:dS},14:{n:"Manager",t:mn},15:{n:"Company",t:mn},16:{n:"LinksUpToDate",t:Au},17:{n:"CharacterCount",t:rr},19:{n:"SharedDoc",t:Au},22:{n:"HyperlinksChanged",t:Au},23:{n:"AppVersion",t:rr,p:"version"},24:{n:"DigSig",t:uS},26:{n:"ContentType",t:mn},27:{n:"ContentStatus",t:mn},28:{n:"Language",t:mn},29:{n:"Version",t:mn},255:{},2147483648:{n:"Locale",t:Qu},2147483651:{n:"Behavior",t:Qu},1919054434:{}},V0={1:{n:"CodePage",t:Dd},2:{n:"Title",t:mn},3:{n:"Subject",t:mn},4:{n:"Author",t:mn},5:{n:"Keywords",t:mn},6:{n:"Comments",t:mn},7:{n:"Template",t:mn},8:{n:"LastAuthor",t:mn},9:{n:"RevNumber",t:mn},10:{n:"EditTime",t:Iu},11:{n:"LastPrinted",t:Iu},12:{n:"CreatedDate",t:Iu},13:{n:"ModifiedDate",t:Iu},14:{n:"PageCount",t:rr},15:{n:"WordCount",t:rr},16:{n:"CharCount",t:rr},17:{n:"Thumbnail",t:cS},18:{n:"Application",t:mn},19:{n:"DocSecurity",t:rr},255:{},2147483648:{n:"Locale",t:Qu},2147483651:{n:"Behavior",t:Qu},1919054434:{}},yg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},pS=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mS(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var gS=mS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pa=Ot(gS),Ii={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},H0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Pd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xS(e){var t=Pd();if(!e||!e.match)return t;var n={};if((e.match(bn)||[]).forEach(function(r){var i=Ye(r);switch(i[0].replace(AT,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[i.Extension]=i.ContentType;break;case"<Override":t[H0[i.ContentType]]!==void 0&&t[H0[i.ContentType]].push(i.PartName);break}}),t.xmlns!==un.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}function yv(e,t){var n=xT(H0),r=[],i;r[r.length]=en,r[r.length]=Pe("Types",null,{xmlns:un.CT,"xmlns:xsd":un.xsd,"xmlns:xsi":un.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Pe("Default",null,{Extension:d[0],ContentType:d[1]})}));var s=function(d){e[d]&&e[d].length>0&&(i=e[d][0],r[r.length]=Pe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Nu[d][t.bookType]||Nu[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(h){r[r.length]=Pe("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Nu[d][t.bookType]||Nu[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(h){r[r.length]=Pe("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:n[d][0]})})};return s("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var st={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Go(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(bn)||[]).forEach(function(i){var s=Ye(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:bo(s.Target,t);n[u]=o,r[s.Id]=o}}),n["!id"]=r,n}function Ls(e){var t=[en,Pe("Relationships",null,{xmlns:un.RELS})];return Kt(e["!id"]).forEach(function(n){t[t.length]=Pe("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Tt(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[st.HLINK,st.XPATH,st.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var vS="application/vnd.oasis.opendocument.spreadsheet";function yS(e,t){for(var n=Sd(e),r,i;r=nl.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(i=Ye(r[0],!1),i.path=="/"&&i.type!==vS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}function wS(e){var t=[en];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function wg(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function _S(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function TS(e){var t=[en];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(wg(e[n][0],e[n][1])),t.push(_S("",e[n][0]));return t.push(wg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function wv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ju.version+"</meta:generator></office:meta></office:document-meta>"}var Fr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],SS=function(){for(var e=new Array(Fr.length),t=0;t<Fr.length;++t){var n=Fr[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function _v(e){var t={};e=Et(e);for(var n=0;n<Fr.length;++n){var r=Fr[n],i=e.match(SS[n]);i!=null&&i.length>0&&(t[r[1]]=ft(i[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=Lt(t[r[1]]))}return t}function w0(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=kt(t),r[r.length]=n?Pe(e,t,n):En(e,t))}function Tv(e,t){var n=t||{},r=[en,Pe("cp:coreProperties",null,{"xmlns:cp":un.CORE_PROPS,"xmlns:dc":un.dc,"xmlns:dcterms":un.dcterms,"xmlns:dcmitype":un.dcmitype,"xmlns:xsi":un.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&w0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:U0(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&w0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:U0(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Fr.length;++s){var o=Fr[s],u=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&w0(o[0],u,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ma=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Sv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function kv(e,t,n,r){var i=[];if(typeof e=="string")i=cg(e,r);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(m){return{v:m}}));var o=typeof t=="string"?cg(t,r).map(function(m){return m.v}):t,u=0,d=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(d=+i[h+1].v,i[h].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=o.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=d,n.DefinedNames=o.slice(u,u+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=o.slice(u,u+d);break}u+=d}}function kS(e,t,n){var r={};return t||(t={}),e=Et(e),Ma.forEach(function(i){var s=(e.match(el(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=ft(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(r[i[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&kv(r.HeadingPairs,r.TitlesOfParts,t,n),t}function Ev(e){var t=[],n=Pe;return e||(e={}),e.Application="SheetJS",t[t.length]=en,t[t.length]=Pe("Properties",null,{xmlns:un.EXT_PROPS,"xmlns:vt":un.vt}),Ma.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=kt(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+kt(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ES=/<[^>]+>[^<]*/g;function CS(e,t){var n={},r="",i=e.match(ES);if(i)for(var s=0;s!=i.length;++s){var o=i[s],u=Ye(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=ft(u.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var d=o.split(">"),h=d[0].slice(4),m=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":n[r]=ft(m);break;case"bool":n[r]=Mt(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(m);break;case"filetime":case"date":n[r]=Lt(m);break;case"cy":case"error":n[r]=ft(m);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,d)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return n}function Cv(e){var t=[en,Pe("Properties",null,{xmlns:un.CUST_PROPS,"xmlns:vt":un.vt})];if(!e)return t.join("");var n=1;return Kt(e).forEach(function(i){++n,t[t.length]=Pe("property",LT(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:kt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var W0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_0;function AS(e,t,n){_0||(_0=pc(W0)),t=_0[t]||t,e[t]=n}function IS(e,t){var n=[];return Kt(W0).map(function(r){for(var i=0;i<Fr.length;++i)if(Fr[i][1]==r)return Fr[i];for(i=0;i<Ma.length;++i)if(Ma[i][1]==r)return Ma[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(En(W0[r[1]]||r[1],i))}}),Pe("DocumentProperties",n.join(""),{xmlns:fr.o})}function NS(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&Kt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Fr.length;++o)if(s==Fr[o][1])return;for(o=0;o<Ma.length;++o)if(s==Ma[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var u=e[s],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),i.push(Pe(sg(s),u,{"dt:dt":d}))}}),t&&Kt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Pe(sg(s),o,{"dt:dt":u}))}}),"<"+r+' xmlns="'+fr.o+'">'+i.join("")+"</"+r+">"}function Md(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function FS(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=me(8);return o.write_shift(4,r),o.write_shift(4,i),o}function Av(e,t,n){var r=e.l,i=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return i}function Iv(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function Nv(e,t,n){return t===31?Iv(e):Av(e,t,n)}function G0(e,t,n){return Nv(e,t,n===!1?0:4)}function RS(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Nv(e,t,0)}function DS(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var i=e.l;n[r]=e.read_shift(0,"lpwstr").replace(jn,""),e.l-i&2&&(e.l+=2)}return n}function PS(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(jn,"");return n}function MS(e){var t=e.l,n=ec(e,xv);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=ec(e,rr);return[n,r]}function LS(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(MS(e));return n}function _g(e,t){for(var n=e.read_shift(4),r={},i=0;i!=n;++i){var s=e.read_shift(4),o=e.read_shift(4);r[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(jn,"").replace(zo,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function Fv(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function OS(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ec(e,t,n){var r=e.read_shift(2),i,s=n||{};if(e.l+=2,t!==vg&&r!==t&&hS.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===vg?r:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Av(e,r,4).replace(jn,"");case 31:return Iv(e);case 64:return Md(e);case 65:return Fv(e);case 71:return OS(e);case 80:return G0(e,r,!s.raw).replace(jn,"");case 81:return RS(e,r).replace(jn,"");case 4108:return LS(e);case 4126:case 4127:return r==4127?DS(e):PS(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function Tg(e,t){var n=me(4),r=me(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=me(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=FS(t);break;case 31:case 80:for(r=me(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return gn([n,r])}function Sg(e,t){var n=e.l,r=e.read_shift(4),i=e.read_shift(4),s=[],o=0,u=0,d=-1,h={};for(o=0;o!=i;++o){var m=e.read_shift(4),x=e.read_shift(4);s[o]=[m,x+n]}s.sort(function(I,C){return I[1]-C[1]});var v={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var _=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,_=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],_=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],_=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(_=!1,e.l=s[o][1]),_)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var k=t[s[o][0]];if(v[k.n]=ec(e,k.t,{raw:!0}),k.p==="version"&&(v[k.n]=String(v[k.n]>>16)+"."+("0000"+String(v[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(v[k.n]){case 0:v[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Wr(u=v[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[k.n])}}else if(s[o][0]===1){if(u=v.CodePage=ec(e,Dd),Wr(u),d!==-1){var T=e.l;e.l=s[d][1],h=_g(e,u),e.l=T}}else if(s[o][0]===0){if(u===0){d=o,e.l=s[o+1][1];continue}h=_g(e,u)}else{var E=h[s[o][0]],A;switch(e[e.l]){case 65:e.l+=4,A=Fv(e);break;case 30:e.l+=4,A=G0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,A=G0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,A=e.read_shift(4,"i");break;case 19:e.l+=4,A=e.read_shift(4);break;case 5:e.l+=4,A=e.read_shift(8,"f");break;case 11:e.l+=4,A=Zt(e,4);break;case 64:e.l+=4,A=Lt(Md(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[E]=A}}return e.l=n+r,v}var Rv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function BS(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function kg(e,t,n){var r=me(8),i=[],s=[],o=8,u=0,d=me(8),h=me(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),s.push(d),i.push(h),o+=8+d.length,!t){h=me(8),h.write_shift(4,0),i.unshift(h);var m=[me(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(d=me(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=gn(m),s.unshift(d),o+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(Rv.indexOf(e[u][0])>-1||Sv.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],_=0;if(t){_=+t[e[u][0]];var k=n[_];if(k.p=="version"&&typeof v=="string"){var T=v.split(".");v=(+T[0]<<16)+(+T[1]||0)}d=Tg(k.t,v)}else{var E=BS(v);E==-1&&(E=31,v=String(v)),d=Tg(E,v)}s.push(d),h=me(8),h.write_shift(4,t?_:2+u),i.push(h),o+=8+d.length}var A=8*(s.length+1);for(u=0;u<s.length;++u)i[u].write_shift(4,A),A+=s[u].length;return r.write_shift(4,o),r.write_shift(4,s.length),gn([r].concat(i).concat(s))}function Eg(e,t,n){var r=e.content;if(!r)return{};kn(r,0);var i,s,o,u,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),m=r.read_shift(16);if(m!==Ge.utils.consts.HEADER_CLSID&&m!==n)throw new Error("Bad PropertySet CLSID "+m);if(i=r.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=r.read_shift(16),u=r.read_shift(4),i===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);i===2&&(o=r.read_shift(16),d=r.read_shift(4));var x=Sg(r,t),v={SystemIdentifier:h};for(var _ in x)v[_]=x[_];if(v.FMTID=s,i===1)return v;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var k;try{k=Sg(r,null)}catch{}for(_ in k)v[_]=k[_];return v.FMTID=[s,o],v}function Cg(e,t,n,r,i,s){var o=me(i?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ge.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var d=kg(e,n,r);if(u.push(d),i){var h=kg(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+d.length),u.push(h)}return gn(u)}function ta(e,t){return e.read_shift(t),null}function US(e,t){t||(t=me(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function zS(e,t,n){for(var r=[],i=e.l+t;e.l<i;)r.push(n(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}function Zt(e,t){return e.read_shift(t)===1}function Gn(e,t){return t||(t=me(2)),t.write_shift(2,+!!e),t}function an(e){return e.read_shift(2,"u")}function Ir(e,t){return t||(t=me(2)),t.write_shift(2,e),t}function Dv(e,t){return zS(e,t,an)}function bS(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function Pv(e,t,n){return n||(n=me(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function hl(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?e.read_shift(r,i):"";return o}function VS(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,i=n&8,s=1+(n&1),o=0,u,d={};i&&(o=e.read_shift(2)),r&&(u=e.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,h);return i&&(e.l+=4*o),r&&(e.l+=u),d.t=m,i||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function HS(e){var t=e.t||"",n=me(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=me(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return gn(i)}function Ha(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function pl(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):Ha(e,r,n)}function Ya(e,t,n){if(n.biff>5)return pl(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Mv(e,t,n){return n||(n=me(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function WS(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function GS(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var i=e.read_shift((r?t-24:t)>>1,"utf16le").replace(jn,"");return r&&(e.l+=24),i}function jS(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return n+r.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(jn,"");return n+o}function $S(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return GS(e);case"0303000000000000c000000000000046":return jS(e);default:throw new Error("Unsupported Moniker "+n)}}function Fu(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(jn,""):"";return n}function Ag(e,t){t||(t=me(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function qS(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var i=e.read_shift(2);e.l+=2;var s,o,u,d,h="",m,x;i&16&&(s=Fu(e,n-e.l)),i&128&&(o=Fu(e,n-e.l)),(i&257)===257&&(u=Fu(e,n-e.l)),(i&257)===1&&(d=$S(e,n-e.l)),i&8&&(h=Fu(e,n-e.l)),i&32&&(m=e.read_shift(16)),i&64&&(x=Md(e)),e.l=n;var v=o||u||d||"";v&&h&&(v+="#"+h),v||(v="#"+h),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return m&&(_.guid=m),x&&(_.time=x),s&&(_.Tooltip=s),_}function KS(e){var t=me(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(s==28)r=r.slice(1),Ag(r,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var u=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(u.length+1)),n=0;n<u.length;++n)t.write_shift(2,u.charCodeAt(n));t.write_shift(2,0),s&8&&Ag(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var d=0;r.slice(d*3,d*3+3)=="../"||r.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,r.length-3*d+1),n=0;n<r.length-3*d;++n)t.write_shift(1,r.charCodeAt(n+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Lv(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),i=e.read_shift(1);return[t,n,r,i]}function Ov(e,t){var n=Lv(e);return n[3]=0,n}function si(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function Wa(e,t,n,r){return r||(r=me(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function JS(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function XS(e,t,n){return t===0?"":Ya(e,t,n)}function YS(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[i,s,o]}function Bv(e){var t=e.read_shift(2),n=Rd(e);return[t,n]}function ZS(e,t,n){e.l+=4,t-=4;var r=e.l+t,i=hl(e,t,n),s=e.read_shift(2);if(r-=e.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,i}function xc(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function Uv(e,t){return t||(t=me(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function zv(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),i=e.read_shift(1);return{s:{c:r,r:t},e:{c:i,r:n}}}var QS=zv;function bv(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function ek(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function tk(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Rn(e){e.l+=2,e.l+=e.read_shift(2)}var nk={0:Rn,4:Rn,5:Rn,6:Rn,7:tk,8:Rn,9:Rn,10:Rn,11:Rn,12:Rn,13:ek,14:Rn,15:Rn,16:Rn,17:Rn,18:Rn,19:Rn,20:Rn,21:bv};function rk(e,t){for(var n=e.l+t,r=[];e.l<n;){var i=e.read_shift(2);e.l-=2;try{r.push(nk[i](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function Ru(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function Ld(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=me(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function ik(e,t){return t===0||e.read_shift(2),1200}function ak(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,i=Ya(e,0,n);return e.read_shift(t+r-e.l),i}function sk(e,t){var n=!t||t.biff==8,r=me(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function ok(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function lk(e,t,n){var r=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=hl(e,0,n);return o.length===0&&(o="Sheet1"),{pos:r,hs:i,dt:s,name:o}}function uk(e,t){var n=!t||t.biff>=8?2:1,r=me(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function ck(e,t){for(var n=e.l+t,r=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<n;++o)s.push(VS(e));return s.Count=r,s.Unique=i,s}function fk(e,t){var n=me(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=HS(e[i]);var s=gn([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function dk(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function hk(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function pk(e){var t=JS(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function mk(e){return e.read_shift(2),e.read_shift(4)}function Ig(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var i=e.read_shift(2);n&&n.biff==2&&(r=1-(i>>15),i&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,i]}function gk(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,n],Dim:[r,i],Flags:s,CurTab:o,FirstTab:u,Selected:d,TabRatio:h}}function xk(){var e=me(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function vk(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function yk(e){var t=me(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function wk(){}function _k(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=hl(e,0,n),r}function Tk(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=me(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function Sk(e){var t=si(e);return t.isst=e.read_shift(4),t}function kk(e,t,n,r){var i=me(10);return Wa(e,t,r,i),i.write_shift(4,n),i}function Ek(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,i=si(e);n.biff==2&&e.l++;var s=pl(e,r-e.l,n);return i.val=s,i}function Ck(e,t,n,r,i){var s=!i||i.biff==8,o=me(8+ +s+(1+s)*n.length);return Wa(e,t,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function Ak(e,t,n){var r=e.read_shift(2),i=Ya(e,0,n);return[r,i]}function Ik(e,t,n,r){var i=n&&n.biff==5;r||(r=me(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}var Nk=Ya;function Ng(e,t,n){var r=e.l+t,i=n.biff==8||!n.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),u=e.read_shift(2),d=e.read_shift(2);return e.l=r,{s:{r:s,c:u},e:{r:o,c:d}}}function Fk(e,t){var n=t.biff==8||!t.biff?4:2,r=me(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function Rk(e){var t=e.read_shift(2),n=e.read_shift(2),r=Bv(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function Dk(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(Bv(e));if(e.l!==n)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:o,rkrec:s}}function Pk(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:o,ixfe:s}}function Mk(e,t,n,r){var i={},s=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return i.patternType=pS[u>>26],r.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=d&127,i.icvBack=d>>7&127,i.fsxButton=d>>14&1),i}function Lk(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=Mk(e,t,r.fStyle,n),r}function Fg(e,t,n,r){var i=n&&n.biff==5;r||(r=me(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Ok(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Bk(e){var t=me(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Rg(e,t,n){var r=si(e);(n.biff==2||t==9)&&++e.l;var i=bS(e);return r.val=i,r.t=i===!0||i===!1?"b":"e",r}function Uk(e,t,n,r,i,s){var o=me(8);return Wa(e,t,r,o),Pv(n,s,o),o}function zk(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=si(e),i=Ln(e);return r.val=i,r}function bk(e,t,n,r){var i=me(14);return Wa(e,t,r,i),Va(n,i),i}var Dg=XS;function Vk(e,t,n){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(n.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Ha(e,s),u=[];r>e.l;)u.push(pl(e));return[s,i,o,u]}function Pg(e,t,n){var r=e.read_shift(2),i,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(i=ZS(e,t-2,n)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var Hk=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Mg(e,t,n){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),d=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var h=Ha(e,o,n);i&32&&(h=Hk[h.charCodeAt(0)]);var m=r-e.l;n&&n.biff==2&&--m;var x=r==e.l||u===0||!(m>0)?[]:rI(e,m,n,u);return{chKey:s,Name:h,itab:d,rgce:x}}function Vv(e,t,n){if(n.biff<8)return Wk(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(YS(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function Wk(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=hl(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function Gk(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),i=e.read_shift(2),s=Ha(e,r,n),o=Ha(e,i,n);return[s,o]}function jk(e,t,n){var r=zv(e);e.l++;var i=e.read_shift(1);return t-=8,[iI(e,t,n),i,r]}function Lg(e,t,n){var r=QS(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,tI(e,t,n)]}function $k(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function qk(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=Ya(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:i},u,o,s]}}function Kk(e,t,n){return qk(e,t,n)}function Jk(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(xc(e));return n}function Xk(e){var t=me(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Uv(e[n],t);return t}function Yk(e,t,n){if(n&&n.biff<8)return Qk(e,t,n);var r=bv(e),i=rk(e,t-22,r[1]);return{cmo:r,ft:i}}var Zk={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=n,{fmt:r}}};function Qk(e,t,n){e.l+=4;var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Zk[r]||zn)(e,t,n)),{cmo:[i,r,s],ft:o}}function eE(e,t,n){var r=e.l,i="";try{e.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=WS(e,6,n);var u=e.read_shift(2);e.read_shift(2),an(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var m=e[e.l],x=Ha(e,e.lens[h+1]-e.lens[h]-1);if(i+=x,i.length>=(m?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return e.l=r+t,{t:i}}catch{return e.l=r+t,{t:i}}}function tE(e,t){var n=xc(e);e.l+=16;var r=qS(e,t-24);return[n,r]}function nE(e){var t=me(24),n=Wt(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return gn([t,KS(e[1])])}function rE(e,t){e.read_shift(2);var n=xc(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(jn,""),[n,r]}function iE(e){var t=e[1].Tooltip,n=me(10+2*(t.length+1));n.write_shift(2,2048);var r=Wt(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function aE(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=yg[n]||n,n=e.read_shift(2),t[1]=yg[n]||n,t}function sE(e){return e||(e=me(4)),e.write_shift(2,1),e.write_shift(2,1),e}function oE(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Ov(e));return n}function lE(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Ov(e));return n}function uE(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Hv(e,t,n){if(!n.cellStyles)return zn(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),u=e.read_shift(r),d=e.read_shift(2);r==2&&(e.l+=2);var h={s:i,e:s,w:o,ixfe:u,flags:d};return(n.biff>=5||!n.biff)&&(h.level=d>>8&7),h}function cE(e,t){var n=me(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function fE(e,t){var n={};return t<32||(e.l+=16,n.header=Ln(e),n.footer=Ln(e),e.l+=2),n}function dE(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var i=e.read_shift(1);return e.l+=3,i&16&&(r.area=!0),r}function hE(e){for(var t=me(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}var pE=si,mE=Dv,gE=pl;function xE(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}function vE(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=si(e);++e.l;var i=Ya(e,t-7,n);return r.t="str",r.val=i,r}function yE(e){var t=si(e);++e.l;var n=Ln(e);return t.t="n",t.val=n,t}function wE(e,t,n){var r=me(15);return vl(r,e,t),r.write_shift(8,n,"f"),r}function _E(e){var t=si(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function TE(e,t,n){var r=me(9);return vl(r,e,t),r.write_shift(2,n),r}function SE(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function kE(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function EE(e,t,n){var r=e.l+t,i=si(e),s=e.read_shift(2),o=Ha(e,s,n);return e.l=r,i.t="str",i.val=o,i}var CE=[2,3,48,49,131,139,140,245],j0=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=pc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(u,d){var h=[],m=sa(1);switch(d.type){case"base64":m=hr(gr(u));break;case"binary":m=hr(u);break;case"buffer":case"array":m=u;break}kn(m,0);var x=m.read_shift(1),v=!!(x&136),_=!1,k=!1;switch(x){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var T=0,E=521;x==2&&(T=m.read_shift(2)),m.l+=3,x!=2&&(T=m.read_shift(4)),T>1048576&&(T=1e6),x!=2&&(E=m.read_shift(2));var A=m.read_shift(2),I=d.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(I=e[m[m.l]]),m.l+=1,m.l+=2),k&&(m.l+=36);for(var C=[],D={},M=Math.min(m.length,x==2?521:E-10-(_?264:0)),P=k?32:11;m.l<M&&m[m.l]!=13;)switch(D={},D.name=Yo.utils.decode(I,m.slice(m.l,m.l+P)).replace(/[\u0000\r\n].*$/g,""),m.l+=P,D.type=String.fromCharCode(m.read_shift(1)),x!=2&&!k&&(D.offset=m.read_shift(4)),D.len=m.read_shift(1),x==2&&(D.offset=m.read_shift(2)),D.dec=m.read_shift(1),D.name.length&&C.push(D),x!=2&&(m.l+=k?13:14),D.type){case"B":(!_||D.len!=8)&&d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var F=0,q=0;for(h[0]=[],q=0;q!=C.length;++q)h[0][q]=C[q].name;for(;T-- >0;){if(m[m.l]===42){m.l+=A;continue}for(++m.l,h[++F]=[],q=0,q=0;q!=C.length;++q){var z=m.slice(m.l,m.l+C[q].len);m.l+=C[q].len,kn(z,0);var te=Yo.utils.decode(I,z);switch(C[q].type){case"C":te.trim().length&&(h[F][q]=te.replace(/\s+$/,""));break;case"D":te.length===8?h[F][q]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):h[F][q]=te;break;case"F":h[F][q]=parseFloat(te.trim());break;case"+":case"I":h[F][q]=k?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":h[F][q]=!0;break;case"N":case"F":h[F][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[F][q]="##MEMO##"+(k?parseInt(te.trim(),10):z.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(h[F][q]=+te||0);break;case"@":h[F][q]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":h[F][q]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":h[F][q]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[F][q]=-z.read_shift(-8,"f");break;case"B":if(_&&C[q].len==8){h[F][q]=z.read_shift(8,"f");break}case"G":case"P":z.l+=C[q].len;break;case"0":if(C[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[q].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=C,h}function r(u,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var m=qs(n(u,h),h);return m["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,m}function i(u,d){try{return fa(r(u,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,d){var h=d||{};if(+h.codepage>=0&&Wr(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=ir(),x=rc(u,{header:1,raw:!0,cellDates:!0}),v=x[0],_=x.slice(1),k=u["!cols"]||[],T=0,E=0,A=0,I=1;for(T=0;T<v.length;++T){if(((k[T]||{}).DBF||{}).name){v[T]=k[T].DBF.name,++A;continue}if(v[T]!=null){if(++A,typeof v[T]=="number"&&(v[T]=v[T].toString(10)),typeof v[T]!="string")throw new Error("DBF Invalid column name "+v[T]+" |"+typeof v[T]+"|");if(v.indexOf(v[T])!==T){for(E=0;E<1024;++E)if(v.indexOf(v[T]+"_"+E)==-1){v[T]+="_"+E;break}}}}var C=dt(u["!ref"]),D=[],M=[],P=[];for(T=0;T<=C.e.c-C.s.c;++T){var F="",q="",z=0,te=[];for(E=0;E<_.length;++E)_[E][T]!=null&&te.push(_[E][T]);if(te.length==0||v[T]==null){D[T]="?";continue}for(E=0;E<te.length;++E){switch(typeof te[E]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=te[E]instanceof Date?"D":"C";break;default:q="C"}z=Math.max(z,String(te[E]).length),F=F&&F!=q?"C":q}z>250&&(z=250),q=((k[T]||{}).DBF||{}).type,q=="C"&&k[T].DBF.len>z&&(z=k[T].DBF.len),F=="B"&&q=="N"&&(F="N",P[T]=k[T].DBF.dec,z=k[T].DBF.len),M[T]=F=="C"||q=="N"?z:s[F]||0,I+=M[T],D[T]=F}var Q=m.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,_.length),Q.write_shift(2,296+32*A),Q.write_shift(2,I),T=0;T<4;++T)Q.write_shift(4,0);for(Q.write_shift(4,0|(+t[R1]||3)<<8),T=0,E=0;T<v.length;++T)if(v[T]!=null){var Y=m.next(32),xe=(v[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,xe,"sbcs"),Y.write_shift(1,D[T]=="?"?"C":D[T],"sbcs"),Y.write_shift(4,E),Y.write_shift(1,M[T]||s[D[T]]||0),Y.write_shift(1,P[T]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),E+=M[T]||s[D[T]]||0}var De=m.next(264);for(De.write_shift(4,13),T=0;T<65;++T)De.write_shift(4,0);for(T=0;T<_.length;++T){var we=m.next(I);for(we.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(D[E]){case"L":we.write_shift(1,_[T][E]==null?63:_[T][E]?84:70);break;case"B":we.write_shift(8,_[T][E]||0,"f");break;case"N":var Fe="0";for(typeof _[T][E]=="number"&&(Fe=_[T][E].toFixed(P[E]||0)),A=0;A<M[E]-Fe.length;++A)we.write_shift(1,32);we.write_shift(1,Fe,"sbcs");break;case"D":_[T][E]?(we.write_shift(4,("0000"+_[T][E].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(_[T][E].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+_[T][E].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(_[T][E]!=null?_[T][E]:"").slice(0,M[E]);for(we.write_shift(1,Ce,"sbcs"),A=0;A<M[E]-Ce.length;++A)we.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),Wv=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Kt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(v,_){var k=e[_];return typeof k=="number"?$m(k):k},r=function(v,_,k){var T=_.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return T==59?v:$m(T)};e["|"]=254;function i(v,_){switch(_.type){case"base64":return s(gr(v),_);case"binary":return s(v,_);case"buffer":return s(at&&Buffer.isBuffer(v)?v.toString("binary"):ca(v),_);case"array":return s(ba(v),_)}throw new Error("Unrecognized type "+_.type)}function s(v,_){var k=v.split(/[\n\r]+/),T=-1,E=-1,A=0,I=0,C=[],D=[],M=null,P={},F=[],q=[],z=[],te=0,Q;for(+_.codepage>=0&&Wr(+_.codepage);A!==k.length;++A){te=0;var Y=k[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),xe=Y.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),De=xe[0],we;if(Y.length>0)switch(De){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":xe[1].charAt(0)=="P"&&D.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var Fe=!1,Ce=!1,Se=!1,Z=!1,H=-1,ue=-1;for(I=1;I<xe.length;++I)switch(xe[I].charAt(0)){case"A":break;case"X":E=parseInt(xe[I].slice(1))-1,Ce=!0;break;case"Y":for(T=parseInt(xe[I].slice(1))-1,Ce||(E=0),Q=C.length;Q<=T;++Q)C[Q]=[];break;case"K":we=xe[I].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(jr(we))?isNaN(Hs(we).getDate())||(we=Lt(we)):(we=jr(we),M!==null&&js(M)&&(we=gc(we))),Fe=!0;break;case"E":Z=!0;var O=Os(xe[I].slice(1),{r:T,c:E});C[T][E]=[C[T][E],O];break;case"S":Se=!0,C[T][E]=[C[T][E],"S5S"];break;case"G":break;case"R":H=parseInt(xe[I].slice(1))-1;break;case"C":ue=parseInt(xe[I].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Y)}if(Fe&&(C[T][E]&&C[T][E].length==2?C[T][E][0]=we:C[T][E]=we,M=null),Se){if(Z)throw new Error("SYLK shared formula cannot have own formula");var J=H>-1&&C[H][ue];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");C[T][E][1]=oy(J[1],{r:T-H,c:E-ue})}break;case"F":var j=0;for(I=1;I<xe.length;++I)switch(xe[I].charAt(0)){case"X":E=parseInt(xe[I].slice(1))-1,++j;break;case"Y":for(T=parseInt(xe[I].slice(1))-1,Q=C.length;Q<=T;++Q)C[Q]=[];break;case"M":te=parseInt(xe[I].slice(1))/20;break;case"F":break;case"G":break;case"P":M=D[parseInt(xe[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=xe[I].slice(1).split(" "),Q=parseInt(z[0],10);Q<=parseInt(z[1],10);++Q)te=parseInt(z[2],10),q[Q-1]=te===0?{hidden:!0}:{wch:te},oa(q[Q-1]);break;case"C":E=parseInt(xe[I].slice(1))-1,q[E]||(q[E]={});break;case"R":T=parseInt(xe[I].slice(1))-1,F[T]||(F[T]={}),te>0?(F[T].hpt=te,F[T].hpx=Gs(te)):te===0&&(F[T].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Y)}j<1&&(M=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Y)}}return F.length>0&&(P["!rows"]=F),q.length>0&&(P["!cols"]=q),_&&_.sheetRows&&(C=C.slice(0,_.sheetRows)),[C,P]}function o(v,_){var k=i(v,_),T=k[0],E=k[1],A=qs(T,_);return Kt(E).forEach(function(I){A[I]=E[I]}),A}function u(v,_){return fa(o(v,_),_)}function d(v,_,k,T){var E="C;Y"+(k+1)+";X"+(T+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+Vd(v.f,{r:k,c:T}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function h(v,_){_.forEach(function(k,T){var E="F;W"+(T+1)+" "+(T+1)+" ";k.hidden?E+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=al(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=sl(k.wpx)),typeof k.wch=="number"&&(E+=Math.round(k.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function m(v,_){_.forEach(function(k,T){var E="F;";k.hidden?E+="M0;":k.hpt?E+="M"+20*k.hpt+";":k.hpx&&(E+="M"+20*ol(k.hpx)+";"),E.length>2&&v.push(E+"R"+(T+1))})}function x(v,_){var k=["ID;PWXL;N;E"],T=[],E=dt(v["!ref"]),A,I=Array.isArray(v),C=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),v["!cols"]&&h(k,v["!cols"]),v["!rows"]&&m(k,v["!rows"]),k.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var D=E.s.r;D<=E.e.r;++D)for(var M=E.s.c;M<=E.e.c;++M){var P=Xe({r:D,c:M});A=I?(v[D]||[])[M]:v[P],!(!A||A.v==null&&(!A.f||A.F))&&T.push(d(A,v,D,M))}return k.join(C)+C+T.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:o,from_sheet:x}}(),Gv=function(){function e(s,o){switch(o.type){case"base64":return t(gr(s),o);case"binary":return t(s,o);case"buffer":return t(at&&Buffer.isBuffer(s)?s.toString("binary"):ca(s),o);case"array":return t(ba(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var u=s.split(`
`),d=-1,h=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++d]=[],h=0;continue}if(!(d<0)){var v=u[m].trim().split(","),_=v[0],k=v[1];++m;for(var T=u[m]||"";(T.match(/["]/g)||[]).length&1&&m<u.length-1;)T+=`
`+u[++m];switch(T=T.trim(),+_){case-1:if(T==="BOT"){x[++d]=[],h=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?x[d][h]=!0:T==="FALSE"?x[d][h]=!1:isNaN(jr(k))?isNaN(Hs(k).getDate())?x[d][h]=k:x[d][h]=Lt(k):x[d][h]=jr(k),++h;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),x[d][h++]=T!==""?T:null;break}if(T==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function n(s,o){return qs(e(s,o),o)}function r(s,o){return fa(n(s,o),o)}var i=function(){var s=function(d,h,m,x,v){d.push(h),d.push(m+","+x),d.push('"'+v.replace(/"/g,'""')+'"')},o=function(d,h,m,x){d.push(h+","+m),d.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var h=[],m=dt(d["!ref"]),x,v=Array.isArray(d);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,m.e.r-m.s.r+1,""),s(h,"TUPLES",0,m.e.c-m.s.c+1,""),s(h,"DATA",0,0,"");for(var _=m.s.r;_<=m.e.r;++_){o(h,-1,0,"BOT");for(var k=m.s.c;k<=m.e.c;++k){var T=Xe({r:_,c:k});if(x=v?(d[_]||[])[k]:d[T],!x){o(h,1,0,"");continue}switch(x.t){case"n":var E=x.w;!E&&x.v!=null&&(E=x.v),E==null?x.f&&!x.F?o(h,1,0,"="+x.f):o(h,1,0,""):o(h,0,E,"V");break;case"b":o(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Dr(x.z||Ke[14],cn(Lt(x.v)))),o(h,0,x.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var A=`\r
`,I=h.join(A);return I}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),jv=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(x,v){for(var _=x.split(`
`),k=-1,T=-1,E=0,A=[];E!==_.length;++E){var I=_[E].trim().split(":");if(I[0]==="cell"){var C=Wt(I[1]);if(A.length<=C.r)for(k=A.length;k<=C.r;++k)A[k]||(A[k]=[]);switch(k=C.r,T=C.c,I[2]){case"t":A[k][T]=e(I[3]);break;case"v":A[k][T]=+I[3];break;case"vtf":var D=I[I.length-1];case"vtc":switch(I[3]){case"nl":A[k][T]=!!+I[4];break;default:A[k][T]=+I[4];break}I[2]=="vtf"&&(A[k][T]=[A[k][T],D])}}}return v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),A}function r(x,v){return qs(n(x,v),v)}function i(x,v){return fa(r(x,v),v)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var v=[],_=[],k,T="",E=ar(x["!ref"]),A=Array.isArray(x),I=E.s.r;I<=E.e.r;++I)for(var C=E.s.c;C<=E.e.c;++C)if(T=Xe({r:I,c:C}),k=A?(x[I]||[])[C]:x[T],!(!k||k.v==null||k.t==="z")){switch(_=["cell",T,"t"],k.t){case"s":case"str":_.push(t(k.v));break;case"n":k.f?(_[2]="vtf",_[3]="n",_[4]=k.v,_[5]=t(k.f)):(_[2]="v",_[3]=k.v);break;case"b":_[2]="vt"+(k.f?"f":"c"),_[3]="nl",_[4]=k.v?"1":"0",_[5]=t(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var D=cn(Lt(k.v));_[2]="vtc",_[3]="nd",_[4]=""+D,_[5]=k.w||Dr(k.z||Ke[14],D);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(x){return[s,o,u,o,h(x),d].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:m}}(),Ws=function(){function e(m,x,v,_,k){k.raw?x[v][_]=m:m===""||(m==="TRUE"?x[v][_]=!0:m==="FALSE"?x[v][_]=!1:isNaN(jr(m))?isNaN(Hs(m).getDate())?x[v][_]=m:x[v][_]=Lt(m):x[v][_]=jr(m))}function t(m,x){var v=x||{},_=[];if(!m||m.length===0)return _;for(var k=m.split(/[\r\n]/),T=k.length-1;T>=0&&k[T].length===0;)--T;for(var E=10,A=0,I=0;I<=T;++I)A=k[I].indexOf(" "),A==-1?A=k[I].length:A++,E=Math.max(E,A);for(I=0;I<=T;++I){_[I]=[];var C=0;for(e(k[I].slice(0,E).trim(),_,I,C,v),C=1;C<=(k[I].length-E)/10+1;++C)e(k[I].slice(E+(C-1)*10,E+C*10).trim(),_,I,C,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(m){for(var x={},v=!1,_=0,k=0;_<m.length;++_)(k=m.charCodeAt(_))==34?v=!v:!v&&k in n&&(x[k]=(x[k]||0)+1);k=[];for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&k.push([x[_],_]);if(!k.length){x=r;for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&k.push([x[_],_])}return k.sort(function(T,E){return T[0]-E[0]||r[T[1]]-r[E[1]]}),n[k.pop()[1]]||44}function s(m,x){var v=x||{},_="",k=v.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(_=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(_=m.charAt(4),m=m.slice(6)):_=i(m.slice(0,1024)):v&&v.FS?_=v.FS:_=i(m.slice(0,1024));var E=0,A=0,I=0,C=0,D=0,M=_.charCodeAt(0),P=!1,F=0,q=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var z=v.dateNF!=null?dT(v.dateNF):null;function te(){var Q=m.slice(C,D),Y={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)Y.t="z";else if(v.raw)Y.t="s",Y.v=Q;else if(Q.trim().length===0)Y.t="s",Y.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(Y.t="s",Y.v=Q.slice(2,-1).replace(/""/g,'"')):VA(Q)?(Y.t="n",Y.f=Q.slice(1)):(Y.t="s",Y.v=Q);else if(Q=="TRUE")Y.t="b",Y.v=!0;else if(Q=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(I=jr(Q)))Y.t="n",v.cellText!==!1&&(Y.w=Q),Y.v=I;else if(!isNaN(Hs(Q).getDate())||z&&Q.match(z)){Y.z=v.dateNF||Ke[14];var xe=0;z&&Q.match(z)&&(Q=hT(Q,v.dateNF,Q.match(z)||[]),xe=1),v.cellDates?(Y.t="d",Y.v=Lt(Q,xe)):(Y.t="n",Y.v=cn(Lt(Q,xe))),v.cellText!==!1&&(Y.w=Dr(Y.z,Y.v instanceof Date?cn(Y.v):Y.v)),v.cellNF||delete Y.z}else Y.t="s",Y.v=Q;if(Y.t=="z"||(v.dense?(k[E]||(k[E]=[]),k[E][A]=Y):k[Xe({c:A,r:E})]=Y),C=D+1,q=m.charCodeAt(C),T.e.c<A&&(T.e.c=A),T.e.r<E&&(T.e.r=E),F==M)++A;else if(A=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}e:for(;D<m.length;++D)switch(F=m.charCodeAt(D)){case 34:q===34&&(P=!P);break;case M:case 10:case 13:if(!P&&te())break e;break}return D-C>0&&te(),k["!ref"]=nt(T),k}function o(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,x):qs(t(m,x),x)}function u(m,x){var v="",_=x.type=="string"?[0,0,0,0]:Jd(m,x);switch(x.type){case"base64":v=gr(m);break;case"binary":v=m;break;case"buffer":x.codepage==65001?v=m.toString("utf8"):x.codepage&&typeof Yo<"u"||(v=at&&Buffer.isBuffer(m)?m.toString("binary"):ca(m));break;case"array":v=ba(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+x.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Et(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=Et(v):x.type=="binary"&&typeof Yo<"u",v.slice(0,19)=="socialcalc:version:"?jv.to_sheet(x.type=="string"?v:Et(v),x):o(v,x)}function d(m,x){return fa(u(m,x),x)}function h(m){for(var x=[],v=dt(m["!ref"]),_,k=Array.isArray(m),T=v.s.r;T<=v.e.r;++T){for(var E=[],A=v.s.c;A<=v.e.c;++A){var I=Xe({r:T,c:A});if(_=k?(m[T]||[])[A]:m[I],!_||_.v==null){E.push("          ");continue}for(var C=(_.w||(ki(_),_.w)||"").slice(0,10);C.length<10;)C+=" ";E.push(C+(A===0?" ":""))}x.push(E.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:h}}();function AE(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var i=Wv.to_workbook(e,n);return n.WTF=r,i}catch(s){if(n.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return Ws.to_workbook(e,t)}}var La=function(){function e(O,J,j){if(O){kn(O,O.l||0);for(var K=j.Enum||H;O.l<O.length;){var le=O.read_shift(2),ye=K[le]||K[65535],ve=O.read_shift(2),_e=O.l+ve,Ie=ye.f&&ye.f(O,ve,j);if(O.l=_e,J(Ie,ye,le))return}}}function t(O,J){switch(J.type){case"base64":return n(hr(gr(O)),J);case"binary":return n(hr(O),J);case"buffer":case"array":return n(O,J)}throw"Unsupported type "+J.type}function n(O,J){if(!O)return O;var j=J||{},K=j.dense?[]:{},le="Sheet1",ye="",ve=0,_e={},Ie=[],Je=[],G={s:{r:0,c:0},e:{r:0,c:0}},ut=j.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)j.Enum=H,e(O,function(Oe,At,Jt){switch(Jt){case 0:j.vers=Oe,Oe>=4096&&(j.qpro=!0);break;case 6:G=Oe;break;case 204:Oe&&(ye=Oe);break;case 222:ye=Oe;break;case 15:case 51:j.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:Jt==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=j.dateNF||Ke[14],j.cellDates&&(Oe[1].t="d",Oe[1].v=gc(Oe[1].v))),j.qpro&&Oe[3]>ve&&(K["!ref"]=nt(G),_e[le]=K,Ie.push(le),K=j.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ve=Oe[3],le=ye||"Sheet"+(ve+1),ye="");var Xt=j.dense?(K[Oe[0].r]||[])[Oe[0].c]:K[Xe(Oe[0])];if(Xt){Xt.t=Oe[1].t,Xt.v=Oe[1].v,Oe[1].z!=null&&(Xt.z=Oe[1].z),Oe[1].f!=null&&(Xt.f=Oe[1].f);break}j.dense?(K[Oe[0].r]||(K[Oe[0].r]=[]),K[Oe[0].r][Oe[0].c]=Oe[1]):K[Xe(Oe[0])]=Oe[1];break}},j);else if(O[2]==26||O[2]==14)j.Enum=ue,O[2]==14&&(j.qpro=!0,O.l=0),e(O,function(Oe,At,Jt){switch(Jt){case 204:le=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>ve&&(K["!ref"]=nt(G),_e[le]=K,Ie.push(le),K=j.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ve=Oe[3],le="Sheet"+(ve+1)),ut>0&&Oe[0].r>=ut)break;j.dense?(K[Oe[0].r]||(K[Oe[0].r]=[]),K[Oe[0].r][Oe[0].c]=Oe[1]):K[Xe(Oe[0])]=Oe[1],G.e.c<Oe[0].c&&(G.e.c=Oe[0].c),G.e.r<Oe[0].r&&(G.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Je[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Je[Oe[0]]=Oe[1],Oe[0]==ve&&(le=Oe[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(K["!ref"]=nt(G),_e[ye||le]=K,Ie.push(ye||le),!Je.length)return{SheetNames:Ie,Sheets:_e};for(var it={},ht=[],et=0;et<Je.length;++et)_e[Ie[et]]?(ht.push(Je[et]||Ie[et]),it[Je[et]]=_e[Je[et]]||_e[Ie[et]]):(ht.push(Je[et]),it[Je[et]]={"!ref":"A1"});return{SheetNames:ht,Sheets:it}}function r(O,J){var j=J||{};if(+j.codepage>=0&&Wr(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var K=ir(),le=dt(O["!ref"]),ye=Array.isArray(O),ve=[];Me(K,0,s(1030)),Me(K,6,d(le));for(var _e=Math.min(le.e.r,8191),Ie=le.s.r;Ie<=_e;++Ie)for(var Je=Qt(Ie),G=le.s.c;G<=le.e.c;++G){Ie===le.s.r&&(ve[G]=Ht(G));var ut=ve[G]+Je,it=ye?(O[Ie]||[])[G]:O[ut];if(!(!it||it.t=="z"))if(it.t=="n")(it.v|0)==it.v&&it.v>=-32768&&it.v<=32767?Me(K,13,_(Ie,G,it.v)):Me(K,14,T(Ie,G,it.v));else{var ht=ki(it);Me(K,15,x(Ie,G,ht.slice(0,239)))}}return Me(K,1),K.end()}function i(O,J){var j=J||{};if(+j.codepage>=0&&Wr(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var K=ir();Me(K,0,o(O));for(var le=0,ye=0;le<O.SheetNames.length;++le)(O.Sheets[O.SheetNames[le]]||{})["!ref"]&&Me(K,27,Z(O.SheetNames[le],ye++));var ve=0;for(le=0;le<O.SheetNames.length;++le){var _e=O.Sheets[O.SheetNames[le]];if(!(!_e||!_e["!ref"])){for(var Ie=dt(_e["!ref"]),Je=Array.isArray(_e),G=[],ut=Math.min(Ie.e.r,8191),it=Ie.s.r;it<=ut;++it)for(var ht=Qt(it),et=Ie.s.c;et<=Ie.e.c;++et){it===Ie.s.r&&(G[et]=Ht(et));var Oe=G[et]+ht,At=Je?(_e[it]||[])[et]:_e[Oe];if(!(!At||At.t=="z"))if(At.t=="n")Me(K,23,te(it,et,ve,At.v));else{var Jt=ki(At);Me(K,22,F(it,et,ve,Jt.slice(0,239)))}}++ve}}return Me(K,1),K.end()}function s(O){var J=me(2);return J.write_shift(2,O),J}function o(O){var J=me(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var j=0,K=0,le=0,ye=0;ye<O.SheetNames.length;++ye){var ve=O.SheetNames[ye],_e=O.Sheets[ve];if(!(!_e||!_e["!ref"])){++le;var Ie=ar(_e["!ref"]);j<Ie.e.r&&(j=Ie.e.r),K<Ie.e.c&&(K=Ie.e.c)}}return j>8191&&(j=8191),J.write_shift(2,j),J.write_shift(1,le),J.write_shift(1,K),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(O,J,j){var K={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&j.qpro?(K.s.c=O.read_shift(1),O.l++,K.s.r=O.read_shift(2),K.e.c=O.read_shift(1),O.l++,K.e.r=O.read_shift(2),K):(K.s.c=O.read_shift(2),K.s.r=O.read_shift(2),J==12&&j.qpro&&(O.l+=2),K.e.c=O.read_shift(2),K.e.r=O.read_shift(2),J==12&&j.qpro&&(O.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function d(O){var J=me(8);return J.write_shift(2,O.s.c),J.write_shift(2,O.s.r),J.write_shift(2,O.e.c),J.write_shift(2,O.e.r),J}function h(O,J,j){var K=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(K[0].c=O.read_shift(1),K[3]=O.read_shift(1),K[0].r=O.read_shift(2),O.l+=2):(K[2]=O.read_shift(1),K[0].c=O.read_shift(2),K[0].r=O.read_shift(2)),K}function m(O,J,j){var K=O.l+J,le=h(O,J,j);if(le[1].t="s",j.vers==20768){O.l++;var ye=O.read_shift(1);return le[1].v=O.read_shift(ye,"utf8"),le}return j.qpro&&O.l++,le[1].v=O.read_shift(K-O.l,"cstr"),le}function x(O,J,j){var K=me(7+j.length);K.write_shift(1,255),K.write_shift(2,J),K.write_shift(2,O),K.write_shift(1,39);for(var le=0;le<K.length;++le){var ye=j.charCodeAt(le);K.write_shift(1,ye>=128?95:ye)}return K.write_shift(1,0),K}function v(O,J,j){var K=h(O,J,j);return K[1].v=O.read_shift(2,"i"),K}function _(O,J,j){var K=me(7);return K.write_shift(1,255),K.write_shift(2,J),K.write_shift(2,O),K.write_shift(2,j,"i"),K}function k(O,J,j){var K=h(O,J,j);return K[1].v=O.read_shift(8,"f"),K}function T(O,J,j){var K=me(13);return K.write_shift(1,255),K.write_shift(2,J),K.write_shift(2,O),K.write_shift(8,j,"f"),K}function E(O,J,j){var K=O.l+J,le=h(O,J,j);if(le[1].v=O.read_shift(8,"f"),j.qpro)O.l=K;else{var ye=O.read_shift(2);D(O.slice(O.l,O.l+ye),le),O.l+=ye}return le}function A(O,J,j){var K=J&32768;return J&=-32769,J=(K?O:0)+(J>=8192?J-16384:J),(K?"":"$")+(j?Ht(J):Qt(J))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(O,J){kn(O,0);for(var j=[],K=0,le="",ye="",ve="",_e="";O.l<O.length;){var Ie=O[O.l++];switch(Ie){case 0:j.push(O.read_shift(8,"f"));break;case 1:ye=A(J[0].c,O.read_shift(2),!0),le=A(J[0].r,O.read_shift(2),!1),j.push(ye+le);break;case 2:{var Je=A(J[0].c,O.read_shift(2),!0),G=A(J[0].r,O.read_shift(2),!1);ye=A(J[0].c,O.read_shift(2),!0),le=A(J[0].r,O.read_shift(2),!1),j.push(Je+G+":"+ye+le)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(O.read_shift(2));break;case 6:{for(var ut="";Ie=O[O.l++];)ut+=String.fromCharCode(Ie);j.push('"'+ut.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:_e=j.pop(),ve=j.pop(),j.push(["AND","OR"][Ie-20]+"("+ve+","+_e+")");break;default:if(Ie<32&&C[Ie])_e=j.pop(),ve=j.pop(),j.push(ve+C[Ie]+_e);else if(I[Ie]){if(K=I[Ie][1],K==69&&(K=O[O.l++]),K>j.length){console.error("WK1 bad formula parse 0x"+Ie.toString(16)+":|"+j.join("|")+"|");return}var it=j.slice(-K);j.length-=K,j.push(I[Ie][0]+"("+it.join(",")+")")}else return Ie<=7?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=24?console.error("WK1 unsupported op "+Ie.toString(16)):Ie<=30?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=115?console.error("WK1 unsupported function opcode "+Ie.toString(16)):console.error("WK1 unrecognized opcode "+Ie.toString(16))}}j.length==1?J[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function M(O){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=O.read_shift(2),J[3]=O[O.l++],J[0].c=O[O.l++],J}function P(O,J){var j=M(O);return j[1].t="s",j[1].v=O.read_shift(J-4,"cstr"),j}function F(O,J,j,K){var le=me(6+K.length);le.write_shift(2,O),le.write_shift(1,j),le.write_shift(1,J),le.write_shift(1,39);for(var ye=0;ye<K.length;++ye){var ve=K.charCodeAt(ye);le.write_shift(1,ve>=128?95:ve)}return le.write_shift(1,0),le}function q(O,J){var j=M(O);j[1].v=O.read_shift(2);var K=j[1].v>>1;if(j[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return j[1].v=K,j}function z(O,J){var j=M(O),K=O.read_shift(4),le=O.read_shift(4),ye=O.read_shift(2);if(ye==65535)return K===0&&le===3221225472?(j[1].t="e",j[1].v=15):K===0&&le===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var ve=ye&32768;return ye=(ye&32767)-16446,j[1].v=(1-ve*2)*(le*Math.pow(2,ye+32)+K*Math.pow(2,ye)),j}function te(O,J,j,K){var le=me(14);if(le.write_shift(2,O),le.write_shift(1,j),le.write_shift(1,J),K==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var ye=0,ve=0,_e=0,Ie=0;return K<0&&(ye=1,K=-K),ve=Math.log2(K)|0,K/=Math.pow(2,ve-31),Ie=K>>>0,(Ie&2147483648)==0&&(K/=2,++ve,Ie=K>>>0),K-=Ie,Ie|=2147483648,Ie>>>=0,K*=Math.pow(2,32),_e=K>>>0,le.write_shift(4,_e),le.write_shift(4,Ie),ve+=16383+(ye?32768:0),le.write_shift(2,ve),le}function Q(O,J){var j=z(O);return O.l+=J-14,j}function Y(O,J){var j=M(O),K=O.read_shift(4);return j[1].v=K>>6,j}function xe(O,J){var j=M(O),K=O.read_shift(8,"f");return j[1].v=K,j}function De(O,J){var j=xe(O);return O.l+=J-10,j}function we(O,J){return O[O.l+J-1]==0?O.read_shift(J,"cstr"):""}function Fe(O,J){var j=O[O.l++];j>J-1&&(j=J-1);for(var K="";K.length<j;)K+=String.fromCharCode(O[O.l++]);return K}function Ce(O,J,j){if(!(!j.qpro||J<21)){var K=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var le=O.read_shift(J-21,"cstr");return[K,le]}}function Se(O,J){for(var j={},K=O.l+J;O.l<K;){var le=O.read_shift(2);if(le==14e3){for(j[le]=[0,""],j[le][0]=O.read_shift(2);O[O.l];)j[le][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return j}function Z(O,J){var j=me(5+O.length);j.write_shift(2,14e3),j.write_shift(2,J);for(var K=0;K<O.length;++K){var le=O.charCodeAt(K);j[j.l++]=le>127?95:le}return j[j.l++]=0,j}var H={0:{n:"BOF",f:an},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:Fe},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:xe},40:{n:"FORMULA28",f:De},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}();function IE(e){var t={},n=e.match(bn),r=0,i=!1;if(n)for(;r!=n.length;++r){var s=Ye(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=dd[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var NE=function(){var e=el("t"),t=el("rPr");function n(s){var o=s.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:ft(o[1])},d=s.match(t);return d&&(u.s=IE(d[1])),u}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(i).map(n).filter(function(u){return u.v})}}(),FE=function(){var t=/(\r\n|\n)/g;function n(i,s,o){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var d=i.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(s.push("<"+d+">"),o.push("</"+d+">")),o.push("</span>"),i}function r(i){var s=[[],i.v,[]];return i.v?(i.s&&n(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),RE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,DE=/<(?:\w+:)?r>/,PE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Od(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=ft(Et(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Et(e),n&&(r.h=Td(r.t))):e.match(DE)&&(r.r=Et(e),r.t=ft(Et((e.replace(PE,"").match(RE)||[]).join("").replace(bn,""))),n&&(r.h=FE(NE(r.r)))),r):{t:""}}var ME=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,LE=/<(?:\w+:)?(?:si|sstItem)>/g,OE=/<\/(?:\w+:)?(?:si|sstItem)>/;function BE(e,t){var n=[],r="";if(!e)return n;var i=e.match(ME);if(i){r=i[2].replace(LE,"").split(OE);for(var s=0;s!=r.length;++s){var o=Od(r[s].trim(),t);o!=null&&(n[n.length]=o)}i=Ye(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}var UE=/^\s|\s$|[\t\n\r]/;function $v(e,t){if(!t.bookSST)return"";var n=[en];n[n.length]=Pe("sst",null,{xmlns:$a[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(UE)&&(s+=' xml:space="preserve"'),s+=">"+kt(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function zE(e){return[e.read_shift(4),e.read_shift(4)]}function bE(e,t){var n=[],r=!1;return Ai(e,function(s,o,u){switch(u){case 159:n.Count=s[0],n.Unique=s[1];break;case 19:n.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function VE(e,t){return t||(t=me(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var HE=ZT;function WE(e){var t=ir();Te(t,159,VE(e));for(var n=0;n<e.length;++n)Te(t,19,HE(e[n]));return Te(t,160),t.end()}function qv(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Si(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function GE(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Si(e,4),t.U=Si(e,4),t.W=Si(e,4),t}function jE(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function $E(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(jE(e));return t}function qE(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function KE(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Si(e,4),t.U=Si(e,4),t.W=Si(e,4),t}function JE(e){var t=KE(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Kv(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=r.Flags==36;break;case 26625:i=r.Flags==4;break;case 0:i=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function Jv(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function XE(e){var t=Si(e);switch(t.Minor){case 2:return[t.Minor,YE(e)];case 3:return[t.Minor,ZE()];case 4:return[t.Minor,QE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function YE(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=Kv(e,n),i=Jv(e,e.length-e.l);return{t:"Std",h:r,v:i}}function ZE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function QE(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(bn,function(s){var o=Ye(s);switch(ai(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=o[u]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function eC(e,t){var n={},r=n.EncryptionVersionInfo=Si(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,n.EncryptionHeader=Kv(e,i),t-=i,n.EncryptionVerifier=Jv(e,t),n}function tC(e){var t={},n=t.EncryptionVersionInfo=Si(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Bd(e){var t=0,n,r=qv(e),i=r.length+1,s,o,u,d,h;for(n=sa(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],u=(t&16384)===0?0:1,d=t<<1&32767,h=u|d,t=h^o;return t^52811}var Xv=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},i=function(o,u){return r(o^u)},s=function(o){for(var u=t[o.length-1],d=104,h=o.length-1;h>=0;--h)for(var m=o[h],x=0;x!=7;++x)m&64&&(u^=n[d]),m*=2,--d;return u};return function(o){for(var u=qv(o),d=s(u),h=u.length,m=sa(16),x=0;x!=16;++x)m[x]=0;var v,_,k;for((h&1)===1&&(v=d>>8,m[h]=i(e[0],v),--h,v=d&255,_=u[u.length-1],m[h]=i(_,v));h>0;)--h,v=d>>8,m[h]=i(u[h],v),--h,v=d&255,m[h]=i(u[h],v);for(h=15,k=15-u.length;k>0;)v=d>>8,m[h]=i(e[k],v),--h,--k,v=d&255,m[h]=i(u[h],v),--h,--k;return m}}(),nC=function(e,t,n,r,i){i||(i=t),r||(r=Xv(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=r[n],o=(o>>5|o<<3)&255,i[s]=o,++n;return[i,n,r]},rC=function(e){var t=0,n=Xv(e);return function(r){var i=nC("",r,t,n);return t=i[1],i[0]}};function iC(e,t,n,r){var i={key:an(e),verificationBytes:an(e)};return n.password&&(i.verifier=Bd(n.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=rC(n.password)),i}function aC(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=tC(e):r.Data=eC(e,t),r}function sC(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?aC(e,t-2,r):iC(e,n.biff>=8?t:t-2,n,r),r}var Yv=function(){function e(i,s){switch(s.type){case"base64":return t(gr(i),s);case"binary":return t(i,s);case"buffer":return t(at&&Buffer.isBuffer(i)?i.toString("binary"):ca(i),s);case"array":return t(ba(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},u=o.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,_=0,k,T=-1;k=v.exec(m);){switch(k[0]){case"\\cell":var E=m.slice(_,v.lastIndex-k[0].length);if(E[0]==" "&&(E=E.slice(1)),++T,E.length){var A={v:E,t:"s"};Array.isArray(u)?u[x][T]=A:u[Xe({r:x,c:T})]=A}break}_=v.lastIndex}T>h.e.c&&(h.e.c=T)}),u["!ref"]=nt(h),u}function n(i,s){return fa(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=dt(i["!ref"]),u,d=Array.isArray(i),h=o.s.r;h<=o.e.r;++h){s.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var x=Xe({r:h,c:m});u=d?(i[h]||[])[m]:i[x],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(ki(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function oC(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function il(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function lC(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(t,n,r),s=Math.min(t,n,r),o=i-s;if(o===0)return[0,0,t];var u=0,d=0,h=i+s;switch(d=o/(h>1?2-h:h),i){case t:u=((n-r)/o+6)%6;break;case n:u=(r-t)/o+2;break;case r:u=(t-n)/o+4;break}return[u/6,d,h/2]}function uC(e){var t=e[0],n=e[1],r=e[2],i=n*2*(r<.5?r:1-r),s=r-i/2,o=[s,s,s],u=6*t,d;if(n!==0)switch(u|0){case 0:case 6:d=i*u,o[0]+=i,o[1]+=d;break;case 1:d=i*(2-u),o[0]+=d,o[1]+=i;break;case 2:d=i*(u-2),o[1]+=i,o[2]+=d;break;case 3:d=i*(4-u),o[1]+=d,o[2]+=i;break;case 4:d=i*(u-4),o[2]+=i,o[0]+=d;break;case 5:d=i*(6-u),o[2]+=d,o[0]+=i;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function tc(e,t){if(t===0)return e;var n=lC(oC(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),il(uC(n))}var Zv=6,cC=15,fC=1,Mn=Zv;function al(e){return Math.floor((e+Math.round(128/Mn)/256)*Mn)}function sl(e){return Math.floor((e-5)/Mn*100+.5)/100}function nc(e){return Math.round((e*Mn+5)/Mn*256)/256}function T0(e){return nc(sl(al(e)))}function Ud(e){var t=Math.abs(e-T0(e)),n=Mn;if(t>.005)for(Mn=fC;Mn<cC;++Mn)Math.abs(e-T0(e))<=t&&(t=Math.abs(e-T0(e)),n=Mn);Mn=n}function oa(e){e.width?(e.wpx=al(e.width),e.wch=sl(e.wpx),e.MDW=Mn):e.wpx?(e.wch=sl(e.wpx),e.width=nc(e.wch),e.MDW=Mn):typeof e.wch=="number"&&(e.width=nc(e.wch),e.wpx=al(e.width),e.MDW=Mn),e.customWidth&&delete e.customWidth}var dC=96,Qv=dC;function ol(e){return e*96/Qv}function Gs(e){return e*Qv/96}var hC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function pC(e,t,n,r){t.Borders=[];var i={},s=!1;(e[0].match(bn)||[]).forEach(function(o){var u=Ye(o);switch(ai(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=Mt(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=Mt(u.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function mC(e,t,n,r){t.Fills=[];var i={},s=!1;(e[0].match(bn)||[]).forEach(function(o){var u=Ye(o);switch(ai(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function gC(e,t,n,r){t.Fonts=[];var i={},s=!1;(e[0].match(bn)||[]).forEach(function(o){var u=Ye(o);switch(ai(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Et(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?Mt(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?Mt(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?Mt(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?Mt(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?Mt(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?Mt(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?Mt(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=dd[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=Mt(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var d=Pa[i.color.index];i.color.index==81&&(d=Pa[1]),d||(d=Pa[1]),i.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=tc(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function xC(e,t,n){t.NumberFmt=[];for(var r=Kt(Ke),i=0;i<r.length;++i)t.NumberFmt[r[i]]=Ke[r[i]];var s=e[0].match(bn);if(s)for(i=0;i<s.length;++i){var o=Ye(s[i]);switch(ai(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=ft(Et(o.formatCode)),d=parseInt(o.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}Ti(u,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function vC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=Pe("numFmt",null,{numFmtId:r,formatCode:kt(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Du=["numFmtId","fillId","fontId","borderId","xfId"],Pu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function yC(e,t,n){t.CellXf=[];var r,i=!1;(e[0].match(bn)||[]).forEach(function(s){var o=Ye(s),u=0;switch(ai(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],u=0;u<Du.length;++u)r[Du[u]]&&(r[Du[u]]=parseInt(r[Du[u]],10));for(u=0;u<Pu.length;++u)r[Pu[u]]&&(r[Pu[u]]=Mt(r[Pu[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};o.vertical&&(d.vertical=o.vertical),o.horizontal&&(d.horizontal=o.horizontal),o.textRotation!=null&&(d.textRotation=o.textRotation),o.indent&&(d.indent=o.indent),o.wrapText&&(d.wrapText=Mt(o.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function wC(e){var t=[];return t[t.length]=Pe("cellXfs",null),e.forEach(function(n){t[t.length]=Pe("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var _C=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&xC(x,m,h),(x=u.match(i))&&gC(x,m,d,h),(x=u.match(r))&&mC(x,m,d,h),(x=u.match(s))&&pC(x,m,d,h),(x=u.match(n))&&yC(x,m,h),m}}();function ey(e,t){var n=[en,Pe("styleSheet",null,{xmlns:$a[0],"xmlns:vt":un.vt})],r;return e.SSF&&(r=vC(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=wC(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function TC(e,t){var n=e.read_shift(2),r=Un(e);return[n,r]}function SC(e,t,n){n||(n=me(6+4*t.length)),n.write_shift(2,e),vn(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function kC(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=aS(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var u=e.read_shift(1);u>0&&(r.family=u);var d=e.read_shift(1);switch(d>0&&(r.charset=d),e.l++,r.color=iS(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Un(e),r}function EC(e,t){t||(t=me(153)),t.write_shift(2,e.sz*20),sS(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Zu(e.color,t);var r=0;return r=2,t.write_shift(1,r),vn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var CC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],S0,AC=zn;function Og(e,t){t||(t=me(84)),S0||(S0=pc(CC));var n=S0[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(Zu({auto:1},t),Zu({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function IC(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function ty(e,t,n){n||(n=me(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Oo(e,t){return t||(t=me(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var NC=zn;function FC(e,t){return t||(t=me(51)),t.write_shift(1,0),Oo(null,t),Oo(null,t),Oo(null,t),Oo(null,t),Oo(null,t),t.length>t.l?t.slice(0,t.l):t}function RC(e,t){return t||(t=me(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Yu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function DC(e,t,n){var r=me(2052);return r.write_shift(4,e),Yu(t,r),Yu(n,r),r.length>r.l?r.slice(0,r.l):r}function PC(e,t,n){var r={};r.NumberFmt=[];for(var i in Ke)r.NumberFmt[i]=Ke[i];r.CellXf=[],r.Fonts=[];var s=[],o=!1;return Ai(e,function(d,h,m){switch(m){case 44:r.NumberFmt[d[0]]=d[1],Ti(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=tc(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(m),o=!0;break;case 38:s.pop(),o=!1;break;default:if(h.T>0)s.push(m);else if(h.T<0)s.pop();else if(!o||n.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function MC(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(Te(e,615,$r(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Te(e,44,SC(i,t[i]))}),Te(e,616))}}function LC(e){var t=1;Te(e,611,$r(t)),Te(e,43,EC({sz:12,color:{theme:1},name:"Calibri",family:2})),Te(e,612)}function OC(e){var t=2;Te(e,603,$r(t)),Te(e,45,Og({patternType:"none"})),Te(e,45,Og({patternType:"gray125"})),Te(e,604)}function BC(e){var t=1;Te(e,613,$r(t)),Te(e,46,FC()),Te(e,614)}function UC(e){var t=1;Te(e,626,$r(t)),Te(e,47,ty({numFmtId:0},65535)),Te(e,627)}function zC(e,t){Te(e,617,$r(t.length)),t.forEach(function(n){Te(e,47,ty(n,0))}),Te(e,618)}function bC(e){var t=1;Te(e,619,$r(t)),Te(e,48,RC({xfId:0,name:"Normal"})),Te(e,620)}function VC(e){var t=0;Te(e,505,$r(t)),Te(e,506)}function HC(e){var t=0;Te(e,508,DC(t,"TableStyleMedium9","PivotStyleMedium4")),Te(e,509)}function WC(e,t){var n=ir();return Te(n,278),MC(n,e.SSF),LC(n),OC(n),BC(n),UC(n),zC(n,t.cellXfs),bC(n),VC(n),HC(n),Te(n,279),n.end()}var GC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function jC(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(bn)||[]).forEach(function(i){var s=Ye(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[GC.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function $C(){}function qC(){}var KC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,XC=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function YC(e,t,n){t.themeElements={};var r;[["clrScheme",KC,jC],["fontScheme",JC,$C],["fmtScheme",XC,qC]].forEach(function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,t,n)})}var ZC=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ny(e,t){(!e||e.length===0)&&(e=zd());var n,r={};if(!(n=e.match(ZC)))throw new Error("themeElements not found in theme");return YC(n[0],r,t),r.raw=e,r}function zd(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[en];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function QC(e,t,n){var r=e.l+t,i=e.read_shift(4);if(i!==124226){if(!n.cellStyles){e.l=r;return}var s=e.slice(e.l);e.l=r;var o;try{o=K1(s,{type:"array"})}catch{return}var u=pr(o,"theme/theme/theme1.xml",!0);if(u)return ny(u,n)}}function eA(e){return e.read_shift(4)}function tA(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=nA(e,4);break;case 2:t.xclrValue=Lv(e);break;case 3:t.xclrValue=eA(e);break;case 4:e.l+=4;break}return e.l+=8,t}function nA(e,t){return zn(e,t)}function rA(e,t){return zn(e,t)}function iA(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=tA(e);break;case 6:r[1]=rA(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function aA(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(iA(e,n-e.l));return{ixfe:r,ext:s}}function sA(e,t){t.forEach(function(n){n[0]})}function oA(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Un(e)}}function lA(e){var t=me(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),vn(e.name,t),t.slice(0,t.l)}function uA(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function cA(e){var t=me(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function fA(e,t){var n=me(8+2*t.length);return n.write_shift(4,e),vn(t,n),n.slice(0,n.l)}function dA(e){return e.l+=4,e.read_shift(4)!=0}function hA(e,t){var n=me(8);return n.write_shift(4,e),n.write_shift(4,1),n}function pA(e,t,n){var r={Types:[],Cell:[],Value:[]},i=n||{},s=[],o=!1,u=2;return Ai(e,function(d,h,m){switch(m){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(x){u==1?r.Cell.push({type:r.Types[x[0]-1].name,index:x[1]}):u==0&&r.Value.push({type:r.Types[x[0]-1].name,index:x[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:s.push(m),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!h.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function mA(){var e=ir();return Te(e,332),Te(e,334,$r(1)),Te(e,335,lA({name:"XLDAPR",version:12e4,flags:3496657072})),Te(e,336),Te(e,339,fA(1,"XLDAPR")),Te(e,52),Te(e,35,$r(514)),Te(e,4096,$r(0)),Te(e,4097,Ir(1)),Te(e,36),Te(e,53),Te(e,340),Te(e,337,hA(1)),Te(e,51,cA([[1,0]])),Te(e,338),Te(e,333),e.end()}function gA(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var i=!1,s=2,o;return e.replace(bn,function(u){var d=Ye(u);switch(ai(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==d.name&&(o=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):s==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+d.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),r}function ry(){var e=[en];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function xA(e){var t=[];if(!e)return t;var n=1;return(e.match(bn)||[]).forEach(function(r){var i=Ye(r);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?n=i.i:i.i=n,t.push(i);break}}),t}function vA(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Xe(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function yA(e,t,n){var r=[];return Ai(e,function(s,o,u){switch(u){case 63:r.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function wA(e,t,n,r){if(!e)return e;var i=r||{},s=!1;Ai(e,function(u,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!d.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function _A(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}var Ds=1024;function iy(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Pe("xml",null,{"xmlns:v":fr.v,"xmlns:o":fr.o,"xmlns:x":fr.x,"xmlns:mv":fr.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Ds<e*1e3;)Ds+=1e3;return t.forEach(function(s){var o=Wt(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Pe("v:fill",d,u),m={on:"t",obscured:"t"};++Ds,i=i.concat(["<v:shape"+tl({id:"_x0000_s"+Ds,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Pe("v:shadow",null,m),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",En("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),En("x:AutoFill","False"),En("x:Row",String(o.r)),En("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Bg(e,t,n,r){var i=Array.isArray(e),s;t.forEach(function(o){var u=Wt(o.ref);if(i?(e[u.r]||(e[u.r]=[]),s=e[u.r][u.c]):s=e[o.ref],!s){s={t:"z"},i?e[u.r][u.c]=s:e[o.ref]=s;var d=dt(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var h=nt(d);h!==e["!ref"]&&(e["!ref"]=h)}s.c||(s.c=[]);var m={a:o.author,t:o.t,r:o.r,T:n};o.h&&(m.h=o.h);for(var x=s.c.length-1;x>=0;--x){if(!n&&s.c[x].T)return;n&&!s.c[x].T&&s.c.splice(x,1)}if(n&&r){for(x=0;x<r.length;++x)if(m.a==r[x].id){m.a=r[x].name||m.a;break}}s.c.push(m)})}function TA(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&n.push(u[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=Ye(u[0]),h={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=Wt(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&Od(x[1])||{r:"",t:"",h:""};h.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),h.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=v.h),r.push(h)}}}}),r}function ay(e){var t=[en,Pe("comments",null,{xmlns:$a[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=kt(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(d){d.a&&(i=n.indexOf(kt(d.a))),s.push(d.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(En("t",kt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)o+=`Reply:
    `+s[u]+`
`;t.push(En("t",kt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function SA(e,t){var n=[],r=!1,i={},s=0;return e.replace(bn,function(u,d){var h=Ye(u);switch(ai(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&n.push(i);break;case"<text>":case"<text":s=d+u.length;break;case"</text>":i.t=e.slice(s,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),n}function kA(e,t,n){var r=[en,Pe("ThreadedComments",null,{xmlns:un.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};u==0?s=d.id:d.parentId=s,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(Pe("threadedComment",En("text",o.t||""),d))})}),r.push("</ThreadedComments>"),r.join("")}function EA(e,t){var n=[],r=!1;return e.replace(bn,function(s){var o=Ye(s);switch(ai(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),n}function CA(e){var t=[en,Pe("personList",null,{xmlns:un.TCMNT,"xmlns:x":$a[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(Pe("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function AA(e){var t={};t.iauthor=e.read_shift(4);var n=Xa(e);return t.rfx=n.s,t.ref=Xe(n.s),e.l+=16,t}function IA(e,t){return t==null&&(t=me(36)),t.write_shift(4,e[1].iauthor),Ks(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var NA=Un;function FA(e){return vn(e.slice(0,54))}function RA(e,t){var n=[],r=[],i={},s=!1;return Ai(e,function(u,d,h){switch(h){case 632:r.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function DA(e){var t=ir(),n=[];return Te(t,628),Te(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),Te(t,632,FA(i.a)))})}),Te(t,631),Te(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:Wt(r[0]),e:Wt(r[0])};Te(t,635,IA([s,i])),i.t&&i.t.length>0&&Te(t,637,eS(i)),Te(t,636),delete i.iauthor})}),Te(t,634),Te(t,629),t.end()}var PA="application/vnd.ms-office.vbaProject";function MA(e){var t=Ge.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ge.utils.cfb_add(t,i,e.FileIndex[r].content)}}),Ge.write(t)}function LA(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ge.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var sy=["xlsb","xlsm","xlam","biff8","xla"];function OA(){return{"!type":"dialog"}}function BA(){return{"!type":"dialog"}}function UA(){return{"!type":"macro"}}function zA(){return{"!type":"macro"}}var Os=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,o){var u=!1,d=!1;s.length==0?d=!0:s.charAt(0)=="["&&(d=!0,s=s.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return u?m+=t.c:--m,d?h+=t.r:--h,i+(u?"":"$")+Ht(m)+(d?"":"$")+Qt(h)}return function(i,s){return t=s,i.replace(e,n)}}(),bd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Vd=function(){return function(t,n){return t.replace(bd,function(r,i,s,o,u,d){var h=Ad(o)-(s?0:n.c),m=Cd(d)-(u?0:n.r),x=m==0?"":u?m+1:"["+m+"]",v=h==0?"":s?h+1:"["+h+"]";return i+"R"+x+"C"+v})}}();function oy(e,t){return e.replace(bd,function(n,r,i,s,o,u){return r+(i=="$"?i+s:Ht(Ad(s)+t.c))+(o=="$"?o+u:Qt(Cd(u)+t.r))})}function bA(e,t,n){var r=ar(t),i=r.s,s=Wt(n),o={r:s.r-i.r,c:s.c-i.c};return oy(e,o)}function VA(e){return e.length!=1}function Ug(e){return e.replace(/_xlfn\./g,"")}function nn(e){e.l+=1}function la(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function ly(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return uy(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),o=la(e),u=la(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function uy(e){var t=la(e),n=la(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function HA(e,t,n){if(n.biff<8)return uy(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=la(e),o=la(e);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function cy(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return WA(e);var r=e.read_shift(n&&n.biff==12?4:2),i=la(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function WA(e){var t=la(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function GA(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function jA(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return $A(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:u}}function $A(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function qA(e,t,n){var r=(e[e.l++]&96)>>5,i=ly(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function KA(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=ly(e,s,n);return[r,i,o]}function JA(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function XA(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function YA(e,t,n){var r=(e[e.l++]&96)>>5,i=HA(e,t-1,n);return[r,i]}function ZA(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function zg(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function QA(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function e4(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function t4(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function n4(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function r4(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function fy(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function i4(e){return e.read_shift(2),fy(e)}function a4(e){return e.read_shift(2),fy(e)}function s4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=cy(e,0,n);return[r,i]}function o4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=jA(e,0,n);return[r,i]}function l4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=cy(e,0,n);return[r,i,s]}function u4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[dI[i],py[i],r]}function c4(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:f4(e);return[i,(s[0]===0?py:fI)[s[1]]]}function f4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function d4(e,t,n){e.l+=n&&n.biff==2?3:4}function h4(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function p4(e){return e.l++,Ii[e.read_shift(1)]}function m4(e){return e.l++,e.read_shift(2)}function g4(e){return e.l++,e.read_shift(1)!==0}function x4(e){return e.l++,Ln(e)}function v4(e,t,n){return e.l++,hl(e,t-1,n)}function y4(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=Zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=Ii[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Ln(e);break;case 2:n[1]=Ya(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function w4(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?Xa:xc)(e));return i}function _4(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var u=0;u!=i;++u)o[s][u]=y4(e,n.biff);return o}function T4(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function S4(e,t,n){if(n.biff==5)return k4(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function k4(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function E4(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function C4(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function A4(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function I4(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var N4=zn,F4=zn,R4=zn;function ml(e,t,n){return e.l+=2,[GA(e)]}function Hd(e){return e.l+=6,[]}var D4=ml,P4=Hd,M4=Hd,L4=ml;function dy(e){return e.l+=2,[an(e),e.read_shift(2)&1]}var O4=ml,B4=dy,U4=Hd,z4=ml,b4=ml,V4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function H4(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=V4[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:r,c:i,C:s}}function W4(e){return e.l+=2,[e.read_shift(4)]}function G4(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function j4(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function $4(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function q4(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function K4(e){return e.l+=4,[0,0]}var bg={1:{n:"PtgExp",f:h4},2:{n:"PtgTbl",f:R4},3:{n:"PtgAdd",f:nn},4:{n:"PtgSub",f:nn},5:{n:"PtgMul",f:nn},6:{n:"PtgDiv",f:nn},7:{n:"PtgPower",f:nn},8:{n:"PtgConcat",f:nn},9:{n:"PtgLt",f:nn},10:{n:"PtgLe",f:nn},11:{n:"PtgEq",f:nn},12:{n:"PtgGe",f:nn},13:{n:"PtgGt",f:nn},14:{n:"PtgNe",f:nn},15:{n:"PtgIsect",f:nn},16:{n:"PtgUnion",f:nn},17:{n:"PtgRange",f:nn},18:{n:"PtgUplus",f:nn},19:{n:"PtgUminus",f:nn},20:{n:"PtgPercent",f:nn},21:{n:"PtgParen",f:nn},22:{n:"PtgMissArg",f:nn},23:{n:"PtgStr",f:v4},26:{n:"PtgSheet",f:G4},27:{n:"PtgEndSheet",f:j4},28:{n:"PtgErr",f:p4},29:{n:"PtgBool",f:g4},30:{n:"PtgInt",f:m4},31:{n:"PtgNum",f:x4},32:{n:"PtgArray",f:ZA},33:{n:"PtgFunc",f:u4},34:{n:"PtgFuncVar",f:c4},35:{n:"PtgName",f:T4},36:{n:"PtgRef",f:s4},37:{n:"PtgArea",f:qA},38:{n:"PtgMemArea",f:E4},39:{n:"PtgMemErr",f:N4},40:{n:"PtgMemNoMem",f:F4},41:{n:"PtgMemFunc",f:C4},42:{n:"PtgRefErr",f:A4},43:{n:"PtgAreaErr",f:JA},44:{n:"PtgRefN",f:o4},45:{n:"PtgAreaN",f:YA},46:{n:"PtgMemAreaN",f:$4},47:{n:"PtgMemNoMemN",f:q4},57:{n:"PtgNameX",f:S4},58:{n:"PtgRef3d",f:l4},59:{n:"PtgArea3d",f:KA},60:{n:"PtgRefErr3d",f:I4},61:{n:"PtgAreaErr3d",f:XA},255:{}},J4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X4={1:{n:"PtgElfLel",f:dy},2:{n:"PtgElfRw",f:z4},3:{n:"PtgElfCol",f:D4},6:{n:"PtgElfRwV",f:b4},7:{n:"PtgElfColV",f:L4},10:{n:"PtgElfRadical",f:O4},11:{n:"PtgElfRadicalS",f:U4},13:{n:"PtgElfColS",f:P4},15:{n:"PtgElfColSV",f:M4},16:{n:"PtgElfRadicalLel",f:B4},25:{n:"PtgList",f:H4},29:{n:"PtgSxName",f:W4},255:{}},Y4={0:{n:"PtgAttrNoop",f:K4},1:{n:"PtgAttrSemi",f:r4},2:{n:"PtgAttrIf",f:t4},4:{n:"PtgAttrChoose",f:QA},8:{n:"PtgAttrGoto",f:e4},16:{n:"PtgAttrSum",f:d4},32:{n:"PtgAttrBaxcel",f:zg},33:{n:"PtgAttrBaxcel",f:zg},64:{n:"PtgAttrSpace",f:i4},65:{n:"PtgAttrSpaceSemi",f:a4},128:{n:"PtgAttrIfError",f:n4},255:{}};function gl(e,t,n,r){if(r.biff<8)return zn(e,t);for(var i=e.l+t,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=_4(e,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=w4(e,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=e.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=i-e.l,t!==0&&s.push(zn(e,t)),s}function xl(e,t,n){for(var r=e.l+t,i,s,o=[];r!=e.l;)t=r-e.l,s=e[e.l],i=bg[s]||bg[J4[s]],(s===24||s===25)&&(i=(s===24?X4:Y4)[e[e.l+1]]),!i||!i.f?zn(e,t):o.push([i.n,i.f(e,t,n)]);return o}function Z4(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Q4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function eI(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function hy(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Vg(e,t,n){var r=hy(e,t,n);return r=="#REF"?r:eI(r,n)}function Pn(e,t,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},u=[],d,h,m,x=0,v=0,_,k="";if(!e[0]||!e[0][0])return"";for(var T=-1,E="",A=0,I=e[0].length;A<I;++A){var C=e[0][A];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),h=u.pop(),T>=0){switch(e[0][T][1][0]){case 0:E=$t(" ",e[0][T][1][1]);break;case 1:E=$t("\r",e[0][T][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][T][1][0])}h=h+E,T=-1}u.push(h+Q4[C[0]]+d);break;case"PtgIsect":d=u.pop(),h=u.pop(),u.push(h+" "+d);break;case"PtgUnion":d=u.pop(),h=u.pop(),u.push(h+","+d);break;case"PtgRange":d=u.pop(),h=u.pop(),u.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Ho(C[1][1],o,i),u.push(Wo(m,s));break;case"PtgRefN":m=n?Ho(C[1][1],n,i):C[1][1],u.push(Wo(m,s));break;case"PtgRef3d":x=C[1][1],m=Ho(C[1][2],o,i),k=Vg(r,x,i),u.push(k+"!"+Wo(m,s));break;case"PtgFunc":case"PtgFuncVar":var D=C[1][0],M=C[1][1];D||(D=0),D&=127;var P=D==0?[]:u.slice(-D);u.length-=D,M==="User"&&(M=P.shift()),u.push(M+"("+P.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":_=gg(C[1][1],n?{s:n}:o,i),u.push(y0(_,i));break;case"PtgArea":_=gg(C[1][1],o,i),u.push(y0(_,i));break;case"PtgArea3d":x=C[1][1],_=C[1][2],k=Vg(r,x,i),u.push(k+"!"+y0(_,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var F=(r.names||[])[v-1]||(r[0]||[])[v],q=F?F.Name:"SH33TJSNAME"+String(v);q&&q.slice(0,6)=="_xlfn."&&!i.xlfn&&(q=q.slice(6)),u.push(q);break;case"PtgNameX":var z=C[1][1];v=C[1][2];var te;if(i.biff<=5)z<0&&(z=-z),r[z]&&(te=r[z][v]);else{var Q="";if(((r[z]||[])[0]||[])[0]==14849||(((r[z]||[])[0]||[])[0]==1025?r[z][v]&&r[z][v].itab>0&&(Q=r.SheetNames[r[z][v].itab-1]+"!"):Q=r.SheetNames[v-1]+"!"),r[z]&&r[z][v])Q+=r[z][v].Name;else if(r[0]&&r[0][v])Q+=r[0][v].Name;else{var Y=(hy(r,z,i)||"").split(";;");Y[v-1]?Q=Y[v-1]:Q+="SH33TJSERRX"}u.push(Q);break}te||(te={Name:"SH33TJSERRY"}),u.push(te.Name);break;case"PtgParen":var xe="(",De=")";if(T>=0){switch(E="",e[0][T][1][0]){case 2:xe=$t(" ",e[0][T][1][1])+xe;break;case 3:xe=$t("\r",e[0][T][1][1])+xe;break;case 4:De=$t(" ",e[0][T][1][1])+De;break;case 5:De=$t("\r",e[0][T][1][1])+De;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][T][1][0])}T=-1}u.push(xe+u.pop()+De);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:C[1][1],r:C[1][0]};var we={c:n.c,r:n.r};if(r.sharedf[Xe(m)]){var Fe=r.sharedf[Xe(m)];u.push(Pn(Fe,o,we,r,i))}else{var Ce=!1;for(d=0;d!=r.arrayf.length;++d)if(h=r.arrayf[d],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(Pn(h[1],o,we,r,i)),Ce=!0;break}Ce||u.push(C[1])}break;case"PtgArray":u.push("{"+Z4(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&T>=0&&Se.indexOf(e[0][A][0])==-1){C=e[0][T];var Z=!0;switch(C[1][0]){case 4:Z=!1;case 0:E=$t(" ",C[1][1]);break;case 5:Z=!1;case 1:E=$t("\r",C[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((Z?E:"")+u.pop()+(Z?"":E)),T=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function tI(e,t,n){var r=e.l+t,i=n.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],zn(e,t-2)];var u=xl(e,o,n);return t!==o+i&&(s=gl(e,t-o-i,u,n)),e.l=r,[u,s]}function nI(e,t,n){var r=e.l+t,i=n.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],zn(e,t-2)];var u=xl(e,o,n);return t!==o+i&&(s=gl(e,t-o-i,u,n)),e.l=r,[u,s]}function rI(e,t,n,r){var i=e.l+t,s=xl(e,r,n),o;return i!==e.l&&(o=gl(e,i-e.l,s,n)),[s,o]}function iI(e,t,n){var r=e.l+t,i,s=e.read_shift(2),o=xl(e,s,n);return s==65535?[[],zn(e,t-2)]:(t!==s+2&&(i=gl(e,r-s-2,o,n)),[o,i])}function aI(e){var t;if(yi(e,e.l+6)!==65535)return[Ln(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function sI(e){if(e==null){var t=me(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Va(e);return Va(0)}function k0(e,t,n){var r=e.l+t,i=si(e);n.biff==2&&++e.l;var s=aI(e),o=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var u=nI(e,r-e.l,n);return{cell:i,val:s[0],formula:u,shared:o>>3&1,tt:s[1]}}function oI(e,t,n,r,i){var s=Wa(t,n,i),o=sI(e.v),u=me(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var h=me(e.bf.length),m=0;m<e.bf.length;++m)h[m]=e.bf[m];var x=gn([s,o,u,h]);return x}function vc(e,t,n){var r=e.read_shift(4),i=xl(e,r,n),s=e.read_shift(4),o=s>0?gl(e,s,i,n):null;return[i,o]}var lI=vc,yc=vc,uI=vc,cI=vc,fI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},py={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Hg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function hI(e){var t="of:="+e.replace(bd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function E0(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function pI(e){return e.replace(/\./,"!")}var jo={},Bs={},$o=typeof Map<"u";function Wd(e,t,n){var r=0,i=e.length;if(n){if($o?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=$o?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&($o?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function wc(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Mn=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=sl(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=nc(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function Oa(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function da(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){Ti(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function my(e,t,n,r,i,s){try{r.cellNF&&(e.z=Ke[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Lt(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(Ke[t]==null&&Ti(fT[t]||"General",t),e.t==="e")e.w=e.w||Ii[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qo(e.v);else if(e.t==="d"){var o=cn(e.v);(o|0)===o?e.w=o.toString(10):e.w=Qo(o)}else{if(e.v===void 0)return"";e.w=za(e.v,Bs)}else e.t==="d"?e.w=Dr(t,cn(e.v),Bs):e.w=Dr(t,e.v,Bs)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&n!=null)try{e.s=s.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=tc(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=tc(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&s.Fills)throw u}}}function mI(e,t,n){if(e&&e["!ref"]){var r=dt(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function gI(e,t){var n=dt(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=nt(n))}var xI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,vI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,yI=/<(?:\w:)?hyperlink [^>]*>/mg,wI=/"(\w*:\w*)"/,_I=/<(?:\w:)?col\b[^>]*[\/]?>/g,TI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,SI=/<(?:\w:)?pageMargins[^>]*\/>/g,gy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,EI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function CI(e,t,n,r,i,s,o){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",x=e.match(vI);x?(h=e.slice(0,x.index),m=e.slice(x.index+x[0].length)):h=m=e;var v=h.match(gy);v?Gd(v[0],u,i,n):(v=h.match(kI))&&II(v[0],v[1]||"",u,i,n);var _=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var k=h.slice(_,_+50).match(wI);k&&gI(u,k[1])}var T=h.match(EI);T&&T[1]&&VI(T[1],i);var E=[];if(t.cellStyles){var A=h.match(_I);A&&OI(E,A)}x&&GI(x[1],u,t,d,s,o);var I=m.match(TI);I&&(u["!autofilter"]=UI(I[0]));var C=[],D=m.match(xI);if(D)for(_=0;_!=D.length;++_)C[_]=dt(D[_].slice(D[_].indexOf('"')+1));var M=m.match(yI);M&&PI(u,M,r);var P=m.match(SI);if(P&&(u["!margins"]=MI(Ye(P[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=nt(d)),t.sheetRows>0&&u["!ref"]){var F=dt(u["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>d.e.r&&(F.e.r=d.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>d.e.c&&(F.e.c=d.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),u["!fullref"]=u["!ref"],u["!ref"]=nt(F))}return E.length>0&&(u["!cols"]=E),C.length>0&&(u["!merges"]=C),u}function AI(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+nt(e[n])+'"/>';return t+"</mergeCells>"}function Gd(e,t,n,r){var i=Ye(e);n.Sheets[r]||(n.Sheets[r]={}),i.codeName&&(n.Sheets[r].CodeName=ft(Et(i.codeName)))}function II(e,t,n,r,i){Gd(e.slice(0,e.indexOf(">")),n,r,i)}function NI(e,t,n,r,i){var s=!1,o={},u=null;if(r.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[n];try{t.Workbook&&(d=t.Workbook.Sheets[n].CodeName||d)}catch{}s=!0,o.codeName=ri(kt(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+Pe("outlinePr",null,h)}!s&&!u||(i[i.length]=Pe("sheetPr",u,o))}var FI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],RI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function DI(e){var t={sheet:1};return FI.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),RI.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=Bd(e.password).toString(16).toUpperCase()),Pe("sheetProtection",null,t)}function PI(e,t,n){for(var r=Array.isArray(e),i=0;i!=t.length;++i){var s=Ye(Et(t[i]),!0);if(!s.ref)return;var o=((n||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ft(s.location))):(s.Target="#"+ft(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=dt(s.ref),d=u.s.r;d<=u.e.r;++d)for(var h=u.s.c;h<=u.e.c;++h){var m=Xe({c:h,r:d});r?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=s):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=s)}}}function MI(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function LI(e){return Oa(e),Pe("pageMargins",null,e)}function OI(e,t){for(var n=!1,r=0;r!=t.length;++r){var i=Ye(t[r],!0);i.hidden&&(i.hidden=Mt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,Ud(i.width)),oa(i);s<=o;)e[s++]=Ot(i)}}function BI(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=Pe("col",null,wc(i,r)));return n[n.length]="</cols>",n.join("")}function UI(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function zI(e,t,n,r){var i=typeof e.ref=="string"?e.ref:nt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=ar(i);o.s.r==o.e.r&&(o.e.r=ar(t["!ref"]).e.r,i=nt(o));for(var u=0;u<s.length;++u){var d=s[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Pe("autoFilter",null,{ref:i})}var bI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function VI(e,t){t.Views||(t.Views=[{}]),(e.match(bI)||[]).forEach(function(n,r){var i=Ye(n);t.Views[r]||(t.Views[r]={}),+i.zoomScale&&(t.Views[r].zoom=+i.zoomScale),Mt(i.rightToLeft)&&(t.Views[r].RTL=!0)})}function HI(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,i),{})}function WI(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ii[e.v];break;case"d":r&&r.cellDates?i=Lt(e.v,-1).toISOString():(e=Ot(e),e.t="n",i=""+(e.v=cn(Lt(e.v)))),typeof e.z>"u"&&(e.z=Ke[14]);break;default:i=e.v;break}var u=En("v",kt(i)),d={r:t},h=da(r.cellXfs,e,r);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){u=En("v",""+Wd(r.Strings,e.v,r.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Pe("f",kt(e.f),m)+(e.v!=null?u:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(d.cm=1),Pe("c",u,d)}var GI=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=el("v"),o=el("f");return function(d,h,m,x,v,_){for(var k=0,T="",E=[],A=[],I=0,C=0,D=0,M="",P,F,q=0,z=0,te,Q,Y=0,xe=0,De=Array.isArray(_.CellXf),we,Fe=[],Ce=[],Se=Array.isArray(h),Z=[],H={},ue=!1,O=!!m.sheetStubs,J=d.split(t),j=0,K=J.length;j!=K;++j){T=J[j].trim();var le=T.length;if(le!==0){var ye=0;e:for(k=0;k<le;++k)switch(T[k]){case">":if(T[k-1]!="/"){++k;break e}if(m&&m.cellStyles){if(F=Ye(T.slice(ye,k),!0),q=F.r!=null?parseInt(F.r,10):q+1,z=-1,m.sheetRows&&m.sheetRows<q)continue;H={},ue=!1,F.ht&&(ue=!0,H.hpt=parseFloat(F.ht),H.hpx=Gs(H.hpt)),F.hidden=="1"&&(ue=!0,H.hidden=!0),F.outlineLevel!=null&&(ue=!0,H.level=+F.outlineLevel),ue&&(Z[q-1]=H)}break;case"<":ye=k;break}if(ye>=k)break;if(F=Ye(T.slice(ye,k),!0),q=F.r!=null?parseInt(F.r,10):q+1,z=-1,!(m.sheetRows&&m.sheetRows<q)){x.s.r>q-1&&(x.s.r=q-1),x.e.r<q-1&&(x.e.r=q-1),m&&m.cellStyles&&(H={},ue=!1,F.ht&&(ue=!0,H.hpt=parseFloat(F.ht),H.hpx=Gs(H.hpt)),F.hidden=="1"&&(ue=!0,H.hidden=!0),F.outlineLevel!=null&&(ue=!0,H.level=+F.outlineLevel),ue&&(Z[q-1]=H)),E=T.slice(k).split(e);for(var ve=0;ve!=E.length&&E[ve].trim().charAt(0)=="<";++ve);for(E=E.slice(ve),k=0;k!=E.length;++k)if(T=E[k].trim(),T.length!==0){if(A=T.match(n),I=k,C=0,D=0,T="<c "+(T.slice(0,1)=="<"?">":"")+T,A!=null&&A.length===2){for(I=0,M=A[1],C=0;C!=M.length&&!((D=M.charCodeAt(C)-64)<1||D>26);++C)I=26*I+D;--I,z=I}else++z;for(C=0;C!=T.length&&T.charCodeAt(C)!==62;++C);if(++C,F=Ye(T.slice(0,C),!0),F.r||(F.r=Xe({r:q-1,c:z})),M=T.slice(C),P={t:""},(A=M.match(s))!=null&&A[1]!==""&&(P.v=ft(A[1])),m.cellFormula){if((A=M.match(o))!=null&&A[1]!==""){if(P.f=ft(Et(A[1])).replace(/\r\n/g,`
`),m.xlfn||(P.f=Ug(P.f)),A[0].indexOf('t="array"')>-1)P.F=(M.match(i)||[])[1],P.F.indexOf(":")>-1&&Fe.push([dt(P.F),P.F]);else if(A[0].indexOf('t="shared"')>-1){Q=Ye(A[0]);var _e=ft(Et(A[1]));m.xlfn||(_e=Ug(_e)),Ce[parseInt(Q.si,10)]=[Q,_e,F.r]}}else(A=M.match(/<f[^>]*\/>/))&&(Q=Ye(A[0]),Ce[Q.si]&&(P.f=bA(Ce[Q.si][1],Ce[Q.si][2],F.r)));var Ie=Wt(F.r);for(C=0;C<Fe.length;++C)Ie.r>=Fe[C][0].s.r&&Ie.r<=Fe[C][0].e.r&&Ie.c>=Fe[C][0].s.c&&Ie.c<=Fe[C][0].e.c&&(P.F=Fe[C][1])}if(F.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(O)P.t="z";else continue;else P.t=F.t||"n";switch(x.s.c>z&&(x.s.c=z),x.e.c<z&&(x.e.c=z),P.t){case"n":if(P.v==""||P.v==null){if(!O)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!O)continue;P.t="z"}else te=jo[parseInt(P.v,10)],P.v=te.t,P.r=te.r,m.cellHTML&&(P.h=te.h);break;case"str":P.t="s",P.v=P.v!=null?Et(P.v):"",m.cellHTML&&(P.h=Td(P.v));break;case"inlineStr":A=M.match(r),P.t="s",A!=null&&(te=Od(A[1]))?(P.v=te.t,m.cellHTML&&(P.h=te.h)):P.v="";break;case"b":P.v=Mt(P.v);break;case"d":m.cellDates?P.v=Lt(P.v,1):(P.v=cn(Lt(P.v,1)),P.t="n");break;case"e":(!m||m.cellText!==!1)&&(P.w=P.v),P.v=vv[P.v];break}if(Y=xe=0,we=null,De&&F.s!==void 0&&(we=_.CellXf[F.s],we!=null&&(we.numFmtId!=null&&(Y=we.numFmtId),m.cellStyles&&we.fillId!=null&&(xe=we.fillId))),my(P,Y,xe,m,v,_),m.cellDates&&De&&P.t=="n"&&js(Ke[Y])&&(P.t="d",P.v=gc(P.v)),F.cm&&m.xlmeta){var Je=(m.xlmeta.Cell||[])[+F.cm-1];Je&&Je.type=="XLDAPR"&&(P.D=!0)}if(Se){var G=Wt(F.r);h[G.r]||(h[G.r]=[]),h[G.r][G.c]=P}else h[F.r]=P}}}}Z.length>0&&(h["!rows"]=Z)}}();function jI(e,t,n,r){var i=[],s=[],o=dt(e["!ref"]),u="",d,h="",m=[],x=0,v=0,_=e["!rows"],k=Array.isArray(e),T={r:h},E,A=-1;for(v=o.s.c;v<=o.e.c;++v)m[v]=Ht(v);for(x=o.s.r;x<=o.e.r;++x){for(s=[],h=Qt(x),v=o.s.c;v<=o.e.c;++v){d=m[v]+h;var I=k?(e[x]||[])[v]:e[d];I!==void 0&&(u=WI(I,d,e,t))!=null&&s.push(u)}(s.length>0||_&&_[x])&&(T={r:h},_&&_[x]&&(E=_[x],E.hidden&&(T.hidden=1),A=-1,E.hpx?A=ol(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(T.ht=A,T.customHeight=1),E.level&&(T.outlineLevel=E.level)),i[i.length]=Pe("row",s.join(""),T))}if(_)for(;x<_.length;++x)_&&_[x]&&(T={r:x+1},E=_[x],E.hidden&&(T.hidden=1),A=-1,E.hpx?A=ol(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(T.ht=A,T.customHeight=1),E.level&&(T.outlineLevel=E.level),i[i.length]=Pe("row","",T));return i.join("")}function xy(e,t,n,r){var i=[en,Pe("worksheet",null,{xmlns:$a[0],"xmlns:r":un.r})],s=n.SheetNames[e],o=0,u="",d=n.Sheets[s];d==null&&(d={});var h=d["!ref"]||"A1",m=dt(h);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=nt(m)}r||(r={}),d["!comments"]=[];var x=[];NI(d,n,e,t,i),i[i.length]=Pe("dimension",null,{ref:h}),i[i.length]=HI(d,t,e,n),t.sheetFormat&&(i[i.length]=Pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(i[i.length]=BI(d,d["!cols"])),i[o=i.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=jI(d,t),u.length>0&&(i[i.length]=u)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),d["!protect"]&&(i[i.length]=DI(d["!protect"])),d["!autofilter"]!=null&&(i[i.length]=zI(d["!autofilter"],d,n,e)),d["!merges"]!=null&&d["!merges"].length>0&&(i[i.length]=AI(d["!merges"]));var v=-1,_,k=-1;return d["!links"].length>0&&(i[i.length]="<hyperlinks>",d["!links"].forEach(function(T){T[1].Target&&(_={ref:T[0]},T[1].Target.charAt(0)!="#"&&(k=Tt(r,-1,kt(T[1].Target).replace(/#.*$/,""),st.HLINK),_["r:id"]="rId"+k),(v=T[1].Target.indexOf("#"))>-1&&(_.location=kt(T[1].Target.slice(v+1))),T[1].Tooltip&&(_.tooltip=kt(T[1].Tooltip)),i[i.length]=Pe("hyperlink",null,_))}),i[i.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(i[i.length]=LI(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=En("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(k=Tt(r,-1,"../drawings/drawing"+(e+1)+".xml",st.DRAW),i[i.length]=Pe("drawing",null,{"r:id":"rId"+k}),d["!drawing"]=x),d["!comments"].length>0&&(k=Tt(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",st.VML),i[i.length]=Pe("legacyDrawing",null,{"r:id":"rId"+k}),d["!legacy"]=k),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function $I(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function qI(e,t,n){var r=me(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=ol(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var u=0,d=r.l;r.l+=4;for(var h={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var x=-1,v=-1,_=m<<10;_<m+1<<10;++_){h.c=_;var k=Array.isArray(n)?(n[h.r]||[])[h.c]:n[Xe(h)];k&&(x<0&&(x=_),v=_)}x<0||(++u,r.write_shift(4,x),r.write_shift(4,v))}var T=r.l;return r.l=d,r.write_shift(4,u),r.l=T,r.length>r.l?r.slice(0,r.l):r}function KI(e,t,n,r){var i=qI(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&Te(e,0,i)}var JI=Xa,XI=Ks;function YI(){}function ZI(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=tS(e),n}function QI(e,t,n){n==null&&(n=me(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return Zu({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),hv(e,n),n.slice(0,n.l)}function eN(e){var t=Pr(e);return[t]}function tN(e,t,n){return n==null&&(n=me(8)),qa(t,n)}function nN(e){var t=Ka(e);return[t]}function rN(e,t,n){return n==null&&(n=me(4)),Ja(t,n)}function iN(e){var t=Pr(e),n=e.read_shift(1);return[t,n,"b"]}function aN(e,t,n){return n==null&&(n=me(9)),qa(t,n),n.write_shift(1,e.v?1:0),n}function sN(e){var t=Ka(e),n=e.read_shift(1);return[t,n,"b"]}function oN(e,t,n){return n==null&&(n=me(5)),Ja(t,n),n.write_shift(1,e.v?1:0),n}function lN(e){var t=Pr(e),n=e.read_shift(1);return[t,n,"e"]}function uN(e,t,n){return n==null&&(n=me(9)),qa(t,n),n.write_shift(1,e.v),n}function cN(e){var t=Ka(e),n=e.read_shift(1);return[t,n,"e"]}function fN(e,t,n){return n==null&&(n=me(8)),Ja(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function dN(e){var t=Pr(e),n=e.read_shift(4);return[t,n,"s"]}function hN(e,t,n){return n==null&&(n=me(12)),qa(t,n),n.write_shift(4,t.v),n}function pN(e){var t=Ka(e),n=e.read_shift(4);return[t,n,"s"]}function mN(e,t,n){return n==null&&(n=me(8)),Ja(t,n),n.write_shift(4,t.v),n}function gN(e){var t=Pr(e),n=Ln(e);return[t,n,"n"]}function xN(e,t,n){return n==null&&(n=me(16)),qa(t,n),Va(e.v,n),n}function vy(e){var t=Ka(e),n=Ln(e);return[t,n,"n"]}function vN(e,t,n){return n==null&&(n=me(12)),Ja(t,n),Va(e.v,n),n}function yN(e){var t=Pr(e),n=Rd(e);return[t,n,"n"]}function wN(e,t,n){return n==null&&(n=me(12)),qa(t,n),pv(e.v,n),n}function _N(e){var t=Ka(e),n=Rd(e);return[t,n,"n"]}function TN(e,t,n){return n==null&&(n=me(8)),Ja(t,n),pv(e.v,n),n}function SN(e){var t=Pr(e),n=Id(e);return[t,n,"is"]}function kN(e){var t=Pr(e),n=Un(e);return[t,n,"str"]}function EN(e,t,n){return n==null&&(n=me(12+4*e.v.length)),qa(t,n),vn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function CN(e){var t=Ka(e),n=Un(e);return[t,n,"str"]}function AN(e,t,n){return n==null&&(n=me(8+4*e.v.length)),Ja(t,n),vn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function IN(e,t,n){var r=e.l+t,i=Pr(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(n.cellFormula){e.l+=2;var u=yc(e,r-e.l,n);o[3]=Pn(u,null,i,n.supbooks,n)}else e.l=r;return o}function NN(e,t,n){var r=e.l+t,i=Pr(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(n.cellFormula){e.l+=2;var u=yc(e,r-e.l,n);o[3]=Pn(u,null,i,n.supbooks,n)}else e.l=r;return o}function FN(e,t,n){var r=e.l+t,i=Pr(e);i.r=n["!row"];var s=Ln(e),o=[i,s,"n"];if(n.cellFormula){e.l+=2;var u=yc(e,r-e.l,n);o[3]=Pn(u,null,i,n.supbooks,n)}else e.l=r;return o}function RN(e,t,n){var r=e.l+t,i=Pr(e);i.r=n["!row"];var s=Un(e),o=[i,s,"str"];if(n.cellFormula){e.l+=2;var u=yc(e,r-e.l,n);o[3]=Pn(u,null,i,n.supbooks,n)}else e.l=r;return o}var DN=Xa,PN=Ks;function MN(e,t){return t==null&&(t=me(4)),t.write_shift(4,e),t}function LN(e,t){var n=e.l+t,r=Xa(e),i=Nd(e),s=Un(e),o=Un(e),u=Un(e);e.l=n;var d={rfx:r,relId:i,loc:s,display:u};return o&&(d.Tooltip=o),d}function ON(e,t){var n=me(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ks({s:Wt(e[0]),e:Wt(e[0])},n),Fd("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return vn(i||"",n),vn(e[1].Tooltip||"",n),vn("",n),n.slice(0,n.l)}function BN(){}function UN(e,t,n){var r=e.l+t,i=mv(e),s=e.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var u=lI(e,r-e.l,n);o[1]=u}else e.l=r;return o}function zN(e,t,n){var r=e.l+t,i=Xa(e),s=[i];if(n.cellFormula){var o=cI(e,r-e.l,n);s[1]=o,e.l=r}else e.l=r;return s}function bN(e,t,n){n==null&&(n=me(18));var r=wc(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var yy=["left","right","top","bottom","header","footer"];function VN(e){var t={};return yy.forEach(function(n){t[n]=Ln(e)}),t}function HN(e,t){return t==null&&(t=me(48)),Oa(e),yy.forEach(function(n){Va(e[n],t)}),t}function WN(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function GN(e,t,n){n==null&&(n=me(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function jN(e){var t=me(24);return t.write_shift(4,4),t.write_shift(4,1),Ks(e,t),t}function $N(e,t){return t==null&&(t=me(66)),t.write_shift(2,e.password?Bd(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function qN(){}function KN(){}function JN(e,t,n,r,i,s,o){if(!e)return e;var u=t||{};r||(r={"!id":{}});var d=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,_,k,T,E,A,I,C,D,M,P=[];u.biff=12,u["!row"]=0;var F=0,q=!1,z=[],te={},Q=u.supbooks||i.supbooks||[[]];if(Q.sharedf=te,Q.arrayf=z,Q.SheetNames=i.SheetNames||i.Sheets.map(function(Se){return Se.name}),!u.supbooks&&(u.supbooks=Q,i.Names))for(var Y=0;Y<i.Names.length;++Y)Q[0][Y+1]=i.Names[Y];var xe=[],De=[],we=!1;ll[16]={n:"BrtShortReal",f:vy};var Fe;if(Ai(e,function(Z,H,ue){if(!v)switch(ue){case 148:h=Z;break;case 0:_=Z,u.sheetRows&&u.sheetRows<=_.r&&(v=!0),D=Qt(E=_.r),u["!row"]=_.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Gs(Z.hpt)),De[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:Z[2]},Z[2]){case"n":k.v=Z[1];break;case"s":C=jo[Z[1]],k.v=C.t,k.r=C.r;break;case"b":k.v=!!Z[1];break;case"e":k.v=Z[1],u.cellText!==!1&&(k.w=Ii[k.v]);break;case"str":k.t="s",k.v=Z[1];break;case"is":k.t="s",k.v=Z[1].t;break}if((T=o.CellXf[Z[0].iStyleRef])&&my(k,T.numFmtId,null,u,s,o),A=Z[0].c==-1?A+1:Z[0].c,u.dense?(d[E]||(d[E]=[]),d[E][A]=k):d[Ht(A)+D]=k,u.cellFormula){for(q=!1,F=0;F<z.length;++F){var O=z[F];_.r>=O[0].s.r&&_.r<=O[0].e.r&&A>=O[0].s.c&&A<=O[0].e.c&&(k.F=nt(O[0]),q=!0)}!q&&Z.length>3&&(k.f=Z[3])}if(m.s.r>_.r&&(m.s.r=_.r),m.s.c>A&&(m.s.c=A),m.e.r<_.r&&(m.e.r=_.r),m.e.c<A&&(m.e.c=A),u.cellDates&&T&&k.t=="n"&&js(Ke[T.numFmtId])){var J=Da(k.v);J&&(k.t="d",k.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Fe&&(Fe.type=="XLDAPR"&&(k.D=!0),Fe=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;k={t:"z",v:void 0},A=Z[0].c==-1?A+1:Z[0].c,u.dense?(d[E]||(d[E]=[]),d[E][A]=k):d[Ht(A)+D]=k,m.s.r>_.r&&(m.s.r=_.r),m.s.c>A&&(m.s.c=A),m.e.r<_.r&&(m.e.r=_.r),m.e.c<A&&(m.e.c=A),Fe&&(Fe.type=="XLDAPR"&&(k.D=!0),Fe=void 0);break;case 176:P.push(Z);break;case 49:Fe=((u.xlmeta||{}).Cell||[])[Z-1];break;case 494:var j=r["!id"][Z.relId];for(j?(Z.Target=j.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=j):Z.relId==""&&(Z.Target="#"+Z.loc),E=Z.rfx.s.r;E<=Z.rfx.e.r;++E)for(A=Z.rfx.s.c;A<=Z.rfx.e.c;++A)u.dense?(d[E]||(d[E]=[]),d[E][A]||(d[E][A]={t:"z",v:void 0}),d[E][A].l=Z):(I=Xe({c:A,r:E}),d[I]||(d[I]={t:"z",v:void 0}),d[I].l=Z);break;case 426:if(!u.cellFormula)break;z.push(Z),M=u.dense?d[E][A]:d[Ht(A)+D],M.f=Pn(Z[1],m,{r:_.r,c:A},Q,u),M.F=nt(Z[0]);break;case 427:if(!u.cellFormula)break;te[Xe(Z[0].s)]=Z[1],M=u.dense?d[E][A]:d[Ht(A)+D],M.f=Pn(Z[1],m,{r:_.r,c:A},Q,u);break;case 60:if(!u.cellStyles)break;for(;Z.e>=Z.s;)xe[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},we||(we=!0,Ud(Z.w/256)),oa(xe[Z.e+1]);break;case 161:d["!autofilter"]={ref:nt(Z)};break;case 476:d["!margins"]=Z;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),Z.name&&(i.Sheets[n].CodeName=Z.name),(Z.above||Z.left)&&(d["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!H.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+ue.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=nt(h||m)),u.sheetRows&&d["!ref"]){var Ce=dt(d["!ref"]);u.sheetRows<=+Ce.e.r&&(Ce.e.r=u.sheetRows-1,Ce.e.r>m.e.r&&(Ce.e.r=m.e.r),Ce.e.r<Ce.s.r&&(Ce.s.r=Ce.e.r),Ce.e.c>m.e.c&&(Ce.e.c=m.e.c),Ce.e.c<Ce.s.c&&(Ce.s.c=Ce.e.c),d["!fullref"]=d["!ref"],d["!ref"]=nt(Ce))}return P.length>0&&(d["!merges"]=P),xe.length>0&&(d["!cols"]=xe),De.length>0&&(d["!rows"]=De),d}function XN(e,t,n,r,i,s,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Ot(t),t.z=t.z||Ke[14],t.v=cn(Lt(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r:n,c:r};switch(d.s=da(i.cellXfs,t,i),t.l&&s["!links"].push([Xe(d),t.l]),t.c&&s["!comments"].push([Xe(d),t.c]),t.t){case"s":case"str":return i.bookSST?(u=Wd(i.Strings,t.v,i.revStrings),d.t="s",d.v=u,o?Te(e,18,mN(t,d)):Te(e,7,hN(t,d))):(d.t="str",o?Te(e,17,AN(t,d)):Te(e,6,EN(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Te(e,13,TN(t,d)):Te(e,2,wN(t,d)):o?Te(e,16,vN(t,d)):Te(e,5,xN(t,d)),!0;case"b":return d.t="b",o?Te(e,15,oN(t,d)):Te(e,4,aN(t,d)),!0;case"e":return d.t="e",o?Te(e,14,fN(t,d)):Te(e,3,uN(t,d)),!0}return o?Te(e,12,rN(t,d)):Te(e,1,tN(t,d)),!0}function YN(e,t,n,r){var i=dt(t["!ref"]||"A1"),s,o="",u=[];Te(e,145);var d=Array.isArray(t),h=i.e.r;t["!rows"]&&(h=Math.max(i.e.r,t["!rows"].length-1));for(var m=i.s.r;m<=h;++m){o=Qt(m),KI(e,t,i,m);var x=!1;if(m<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){m===i.s.r&&(u[v]=Ht(v)),s=u[v]+o;var _=d?(t[m]||[])[v]:t[s];if(!_){x=!1;continue}x=XN(e,_,m,v,r,t,x)}}Te(e,146)}function ZN(e,t){!t||!t["!merges"]||(Te(e,177,MN(t["!merges"].length)),t["!merges"].forEach(function(n){Te(e,176,PN(n))}),Te(e,178))}function QN(e,t){!t||!t["!cols"]||(Te(e,390),t["!cols"].forEach(function(n,r){n&&Te(e,60,bN(r,n))}),Te(e,391))}function eF(e,t){!t||!t["!ref"]||(Te(e,648),Te(e,649,jN(dt(t["!ref"]))),Te(e,650))}function tF(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Tt(n,-1,r[1].Target.replace(/#.*$/,""),st.HLINK);Te(e,494,ON(r,i))}}),delete t["!links"]}function nF(e,t,n,r){if(t["!comments"].length>0){var i=Tt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",st.VML);Te(e,551,Fd("rId"+i)),t["!legacy"]=i}}function rF(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:nt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,u=ar(s);u.s.r==u.e.r&&(u.e.r=ar(t["!ref"]).e.r,s=nt(u));for(var d=0;d<o.length;++d){var h=o[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref="'"+n.SheetNames[r]+"'!"+s;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),Te(e,161,Ks(dt(s))),Te(e,162)}}function iF(e,t,n){Te(e,133),Te(e,137,GN(t,n)),Te(e,138),Te(e,134)}function aF(e,t){t["!protect"]&&Te(e,535,$N(t["!protect"]))}function sF(e,t,n,r){var i=ir(),s=n.SheetNames[e],o=n.Sheets[s]||{},u=s;try{n&&n.Workbook&&(u=n.Workbook.Sheets[e].CodeName||u)}catch{}var d=dt(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Te(i,129),(n.vbaraw||o["!outline"])&&Te(i,147,QI(u,o["!outline"])),Te(i,148,XI(d)),iF(i,o,n.Workbook),QN(i,o),YN(i,o,e,t),aF(i,o),rF(i,o,n,e),ZN(i,o),tF(i,o,r),o["!margins"]&&Te(i,476,HN(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&eF(i,o),nF(i,o,e,r),Te(i,130),i.end()}function oF(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=n?+o[2]:o[2])});var i=ft((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[t,i,r]}function lF(e,t,n,r,i,s){var o=s||{"!type":"chart"};if(!e)return s;var u=0,d=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=oF(x);m.s.r=m.s.c=0,m.e.c=u,h=Ht(u),v[0].forEach(function(_,k){o[h+Qt(k)]={t:"n",v:_,z:v[1]},d=k}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(o["!ref"]=nt(m)),o}function uF(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(gy);return u&&Gd(u[0],s,i,n),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function cF(e,t){e.l+=10;var n=Un(e);return{name:n}}function fF(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ai(e,function(d,h,m){switch(m){case 550:s["!rel"]=d;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),d.name&&(i.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var jd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hF=[],pF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Wg(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],i=0;i!=t.length;++i){var s=t[i];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=Mt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function Gg(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=Mt(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function wy(e){Gg(e.WBProps,jd),Gg(e.CalcPr,pF),Wg(e.WBView,dF),Wg(e.Sheets,hF),Bs.date1904=Mt(e.WBProps.date1904)}function mF(e){return!e.Workbook||!e.Workbook.WBProps?"false":Mt(e.Workbook.WBProps.date1904)?"true":"false"}var gF="][*?/\\".split("");function _y(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return gF.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function xF(e,t,n){e.forEach(function(r,i){_y(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function vF(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];xF(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)mI(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var yF=/<\w+:workbook/;function wF(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",s={},o=0;if(e.replace(bn,function(d,h){var m=Ye(d);switch(ai(m[0])){case"<?xml":break;case"<workbook":d.match(yF)&&(i="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=m[i];break;case"</workbook>":break;case"<fileVersion":delete m[0],n.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jd.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":n.WBProps[x[0]]=Mt(m[x[0]]);break;case"int":n.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:n.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(n.WBProps.CodeName=Et(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],n.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=ft(Et(m.name)),delete m[0],n.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=Et(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),Mt(m.hidden||"0")&&(s.Hidden=!0),o=h+d.length;break;case"</definedName>":s.Ref=ft(Et(e.slice(o,h))),n.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],n.CalcPr=m;break;case"<calcPr/>":delete m[0],n.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),$a.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return wy(n),n}function Ty(e){var t=[en];t[t.length]=Pe("workbook",null,{xmlns:$a[0],"xmlns:r":un.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jd.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(r[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Pe("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:kt(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Pe("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=Pe("definedName",kt(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function _F(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=z0(e),n.name=Un(e),n}function TF(e,t){return t||(t=me(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Fd(e.strRelID,t),vn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function SF(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Un(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function kF(e,t){t||(t=me(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),hv(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function EF(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function CF(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=nS(e),o=uI(e,0,n),u=Nd(e);e.l=r;var d={Name:s,Ptg:o};return i<268435455&&(d.Sheet=i),u&&(d.Comment=u),d}function AF(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],ll[16]={n:"BrtFRTArchID$",f:EF},Ai(e,function(d,h,m){switch(m){case 156:o.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=Pn(d.Ptg,null,null,o,t),delete t.SID,delete d.Ptg,s.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,d]):o[0]=[m,d],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(d),o.XTI=o.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(m),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),wy(n),n.Names=s,n.supbooks=o,n}function IF(e,t){Te(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};Te(e,156,TF(i))}Te(e,144)}function NF(e,t){t||(t=me(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return vn("SheetJS",t),vn(ju.version,t),vn(ju.version,t),vn("7262",t),t.length>t.l?t.slice(0,t.l):t}function FF(e,t){t||(t=me(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function RF(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(Te(e,135),Te(e,158,FF(i)),Te(e,136))}}function DF(e,t){var n=ir();return Te(n,131),Te(n,128,NF()),Te(n,153,kF(e.Workbook&&e.Workbook.WBProps||null)),RF(n,e),IF(n,e),Te(n,132),n.end()}function PF(e,t,n){return t.slice(-4)===".bin"?AF(e,n):wF(e,n)}function MF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?JN(e,r,n,i,s,o,u):CI(e,r,n,i,s,o,u)}function LF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?fF(e,r,n,i,s):uF(e,r,n,i,s)}function OF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?UA():zA()}function BF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?OA():BA()}function UF(e,t,n,r){return t.slice(-4)===".bin"?PC(e,n,r):_C(e,n,r)}function zF(e,t,n){return ny(e,n)}function bF(e,t,n){return t.slice(-4)===".bin"?bE(e,n):BE(e,n)}function VF(e,t,n){return t.slice(-4)===".bin"?RA(e,n):TA(e,n)}function HF(e,t,n){return t.slice(-4)===".bin"?yA(e):xA(e)}function WF(e,t,n,r){return n.slice(-4)===".bin"?wA(e,t,n,r):void 0}function GF(e,t,n){return t.slice(-4)===".bin"?pA(e,t,n):gA(e,t,n)}function jF(e,t,n){return(t.slice(-4)===".bin"?DF:Ty)(e)}function $F(e,t,n,r,i){return(t.slice(-4)===".bin"?sF:xy)(e,n,r,i)}function qF(e,t,n){return(t.slice(-4)===".bin"?WC:ey)(e,n)}function KF(e,t,n){return(t.slice(-4)===".bin"?WE:$v)(e,n)}function JF(e,t,n){return(t.slice(-4)===".bin"?DA:ay)(e)}function XF(e){return(e.slice(-4)===".bin"?mA:ry)()}var Sy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ky=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hr(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var i=e.match(Sy),s,o,u,d;if(i)for(d=0;d!=i.length;++d)s=i[d].match(ky),(o=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(o+1),r[u]=s[2].slice(1,s[2].length-1));return r}function YF(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(Sy),i,s,o,u;if(r)for(u=0;u!=r.length;++u)i=r[u].match(ky),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}var qo;function ZF(e,t){var n=qo[e]||ft(e);return n==="General"?za(t):Dr(n,t)}function QF(e,t,n,r){var i=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Mt(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=Lt(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[ft(t)]=i}function e3(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Ii[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qo(e.v):e.w=za(e.v):e.w=ZF(t||"General",e.v)}catch(s){if(n.WTF)throw s}try{var r=qo[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&js(r)){var i=Da(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(n.WTF)throw s}}}function t3(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=hC[r.Pattern]||r.Pattern)}e[t.ID]=t}function n3(e,t,n,r,i,s,o,u,d,h){var m="General",x=r.StyleID,v={};h=h||{};var _=[],k=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);s[x]!==void 0&&(s[x].nf&&(m=s[x].nf),s[x].Interior&&_.push(s[x].Interior),!!s[x].Parent);)x=s[x].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Mt(e);break;case"String":r.t="s",r.r=og(ft(e)),r.v=e.indexOf("<")>-1?ft(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Lt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=ft(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=vv[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=og(t||e));break}if(e3(r,m,h),h.cellFormula!==!1)if(r.Formula){var T=ft(r.Formula);T.charCodeAt(0)==61&&(T=T.slice(1)),r.f=Os(T,i),delete r.Formula,r.ArrayRange=="RC"?r.F=Os("RC:RC",i):r.ArrayRange&&(r.F=Os(r.ArrayRange,i),d.push([dt(r.F),r.F]))}else for(k=0;k<d.length;++k)i.r>=d[k][0].s.r&&i.r<=d[k][0].e.r&&i.c>=d[k][0].s.c&&i.c<=d[k][0].e.c&&(r.F=d[k][1]);h.cellStyles&&(_.forEach(function(E){!v.patternType&&E.patternType&&(v.patternType=E.patternType)}),r.s=v),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function r3(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function C0(e,t){var n=t||{};$s();var r=Uo(Sd(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Et(r));var i=r.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Ot(n);return o.type="string",Ws.to_workbook(r,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(At){i.indexOf("<"+At)>=0&&(s=!0)}),s)return H3(r,n);qo={"General Number":"General","General Date":Ke[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ke[15],"Short Date":Ke[14],"Long Time":Ke[19],"Medium Time":Ke[18],"Short Time":Ke[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ke[2],Standard:Ke[4],Percent:Ke[10],Scientific:Ke[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],h,m={},x=[],v=n.dense?[]:{},_="",k={},T={},E=Hr('<Data ss:Type="String">'),A=0,I=0,C=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},P={},F="",q=0,z=[],te={},Q={},Y=0,xe=[],De=[],we={},Fe=[],Ce,Se=!1,Z=[],H=[],ue={},O=0,J=0,j={Sheets:[],WBProps:{date1904:!1}},K={};nl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";u=nl.exec(r);)switch(u[3]=(le=u[3]).toLowerCase()){case"data":if(le=="data"){if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?n3(r.slice(A,u.index),F,E,d[d.length-1][0]=="comment"?we:k,{c:I,r:C},M,Fe[I],T,Z,n):(F="",E=Hr(u[0]),A=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(De.length>0&&(k.c=De),(!n.sheetRows||n.sheetRows>C)&&k.v!==void 0&&(n.dense?(v[C]||(v[C]=[]),v[C][I]=k):v[Ht(I)+Qt(C)]=k),k.HRef&&(k.l={Target:ft(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(O=I+(parseInt(k.MergeAcross,10)|0),J=C+(parseInt(k.MergeDown,10)|0),z.push({s:{c:I,r:C},e:{c:O,r:J}})),!n.sheetStubs)k.MergeAcross?I=O+1:++I;else if(k.MergeAcross||k.MergeDown){for(var ye=I;ye<=O;++ye)for(var ve=C;ve<=J;++ve)(ye>I||ve>C)&&(n.dense?(v[ve]||(v[ve]=[]),v[ve][ye]={t:"z"}):v[Ht(ye)+Qt(ve)]={t:"z"});I=O+1}else++I;else k=YF(u[0]),k.Index&&(I=+k.Index-1),I<D.s.c&&(D.s.c=I),I>D.e.c&&(D.e.c=I),u[0].slice(-2)==="/>"&&++I,De=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<D.s.r&&(D.s.r=C),C>D.e.r&&(D.e.r=C),u[0].slice(-2)==="/>"&&(T=Hr(u[0]),T.Index&&(C=+T.Index-1)),I=0,++C):(T=Hr(u[0]),T.Index&&(C=+T.Index-1),ue={},(T.AutoFitHeight=="0"||T.Height)&&(ue.hpx=parseInt(T.Height,10),ue.hpt=ol(ue.hpx),H[C]=ue),T.Hidden=="1"&&(ue.hidden=!0,H[C]=ue));break;case"worksheet":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));x.push(_),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(v["!ref"]=nt(D),n.sheetRows&&n.sheetRows<=D.e.r&&(v["!fullref"]=v["!ref"],D.e.r=n.sheetRows-1,v["!ref"]=nt(D))),z.length&&(v["!merges"]=z),Fe.length>0&&(v["!cols"]=Fe),H.length>0&&(v["!rows"]=H),m[_]=v}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=I=0,d.push([u[3],!1]),h=Hr(u[0]),_=ft(h.Name),v=n.dense?[]:{},z=[],Z=[],H=[],K={name:_,Hidden:0},j.Sheets.push(K);break;case"table":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),Fe=[],Se=!1}break;case"style":u[1]==="/"?t3(M,P,n):P=Hr(u[0]);break;case"numberformat":P.nf=ft(Hr(u[0]).Format||"General"),qo[P.nf]&&(P.nf=qo[P.nf]);for(var _e=0;_e!=392&&Ke[_e]!=P.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if(Ke[_e]==null){Ti(P.nf,_e);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(Ce=Hr(u[0]),Ce.Hidden&&(Ce.hidden=!0,delete Ce.Hidden),Ce.Width&&(Ce.wpx=parseInt(Ce.Width,10)),!Se&&Ce.wpx>10){Se=!0,Mn=Zv;for(var Ie=0;Ie<Fe.length;++Ie)Fe[Ie]&&oa(Fe[Ie])}Se&&oa(Ce),Fe[Ce.Index-1||Fe.length]=Ce;for(var Je=0;Je<+Ce.Span;++Je)Fe[Fe.length]=Ot(Ce);break;case"namedrange":if(u[1]==="/")break;j.Names||(j.Names=[]);var G=Ye(u[0]),ut={Name:G.Name,Ref:Os(G.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(ut.Sheet=j.Sheets.length-1),j.Names.push(ut);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?F+=r.slice(q,u.index):q=u.index+u[0].length;break;case"interior":if(!n.cellStyles)break;P.Interior=Hr(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?AS(te,le,r.slice(Y,u.index)):Y=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));r3(we),De.push(we)}else d.push([u[3],!1]),h=Hr(u[0]),we={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var it=Hr(u[0]);v["!autofilter"]={ref:Os(it.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return Jg(r,n);var ht=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ht=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ht=!1}break;case"excelworkbook":switch(u[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ht=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ht=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(Y,u.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else Y=u.index+u[0].length;break;case"header":v["!margins"]||Oa(v["!margins"]={},"xlml"),isNaN(+Ye(u[0]).Margin)||(v["!margins"].header=+Ye(u[0]).Margin);break;case"footer":v["!margins"]||Oa(v["!margins"]={},"xlml"),isNaN(+Ye(u[0]).Margin)||(v["!margins"].footer=+Ye(u[0]).Margin);break;case"pagemargins":var et=Ye(u[0]);v["!margins"]||Oa(v["!margins"]={},"xlml"),isNaN(+et.Top)||(v["!margins"].top=+et.Top),isNaN(+et.Left)||(v["!margins"].left=+et.Left),isNaN(+et.Right)||(v["!margins"].right=+et.Right),isNaN(+et.Bottom)||(v["!margins"].bottom=+et.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ht=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ht=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ht=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ht=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ht=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ht=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ht=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ht=!1}break;case"smarttags":break;default:ht=!1;break}if(ht||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?QF(Q,le,xe,r.slice(Y,u.index)):(xe=u,Y=u.index+u[0].length);break}if(n.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var Oe={};return!n.bookSheets&&!n.bookProps&&(Oe.Sheets=m),Oe.SheetNames=x,Oe.Workbook=j,Oe.SSF=Ot(Ke),Oe.Props=te,Oe.Custprops=Q,Oe}function $0(e,t){switch(qd(t=t||{}),t.type||"base64"){case"base64":return C0(gr(e),t);case"binary":case"buffer":case"file":return C0(e,t);case"array":return C0(ca(e),t)}}function i3(e,t){var n=[];return e.Props&&n.push(IS(e.Props,t)),e.Custprops&&n.push(NS(e.Props,e.Custprops)),n.join("")}function a3(){return""}function s3(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(Pe("NumberFormat",null,{"ss:Format":kt(Ke[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(Pe("Style",s.join(""),o))}),Pe("Styles",n.join(""))}function Ey(e){return Pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Vd(e.Ref,{r:0,c:0})})}function o3(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(Ey(i)))}return Pe("Names",n.join(""))}function l3(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var u=i[o];u.Sheet==n&&(u.Name.match(/^_xlfn\./)||s.push(Ey(u)))}return s.join("")}function u3(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Pe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(Pe("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(En("ProtectContents","True")),e["!protect"].objects&&i.push(En("ProtectObjects","True")),e["!protect"].scenarios&&i.push(En("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(En("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(En("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Pe("WorksheetOptions",i.join(""),{xmlns:fr.x})}function c3(e){return e.map(function(t){var n=RT(t.t||""),r=Pe("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",r,{"ss:Author":t.a})}).join("")}function f3(e,t,n,r,i,s,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+kt(Vd(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=Wt(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=kt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=kt(e.l.Tooltip))),n["!merges"])for(var h=n["!merges"],m=0;m!=h.length;++m)h[m].s.c!=o.c||h[m].s.r!=o.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var x="",v="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":x="Number",v=String(e.v);break;case"b":x="Boolean",v=e.v?"1":"0";break;case"e":x="Error",v=Ii[e.v];break;case"d":x="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ke[14]);break;case"s":x="String",v=FT(e.v||"");break}var _=da(r.cellXfs,e,r);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=o.c+1;var k=e.v!=null?v:"",T=e.t=="z"?"":'<Data ss:Type="'+x+'">'+k+"</Data>";return(e.c||[]).length>0&&(T+=c3(e.c)),Pe("Cell",T,u)}function d3(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Gs(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function h3(e,t,n,r){if(!e["!ref"])return"";var i=dt(e["!ref"]),s=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(E,A){oa(E);var I=!!E.width,C=wc(A,E),D={"ss:Index":A+1};I&&(D["ss:Width"]=al(C.width)),E.hidden&&(D["ss:Hidden"]="1"),u.push(Pe("Column",null,D))});for(var d=Array.isArray(e),h=i.s.r;h<=i.e.r;++h){for(var m=[d3(h,(e["!rows"]||[])[h])],x=i.s.c;x<=i.e.c;++x){var v=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>x)&&!(s[o].s.r>h)&&!(s[o].e.c<x)&&!(s[o].e.r<h)){(s[o].s.c!=x||s[o].s.r!=h)&&(v=!0);break}if(!v){var _={r:h,c:x},k=Xe(_),T=d?(e[h]||[])[x]:e[k];m.push(f3(T,k,e,t,n,r,_))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function p3(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],o=s?l3(s,t,e,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?h3(s,t,e,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(u3(s,t,e,n)),r.join("")}function m3(e,t){t||(t={}),e.SSF||(e.SSF=Ot(Ke)),e.SSF&&($s(),hc(e.SSF),t.revssf=mc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],da(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(i3(e,t)),n.push(a3()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Pe("Worksheet",p3(r,t,e),{"ss:Name":kt(e.SheetNames[r])}));return n[2]=s3(e,t),n[3]=o3(e),en+Pe("Workbook",n.join(""),{xmlns:fr.ss,"xmlns:o":fr.o,"xmlns:x":fr.x,"xmlns:ss":fr.ss,"xmlns:dt":fr.dt,"xmlns:html":fr.html})}function g3(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=oS(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=lS(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var x3=[60,1084,2066,2165,2175];function v3(e,t,n,r,i){var s=r,o=[],u=n.slice(n.l,n.l+s);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}o.push(u),n.l+=s;for(var d=yi(n,n.l),h=q0[d],m=0;h!=null&&x3.indexOf(d)>-1;)s=yi(n,n.l+2),m=n.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=n.slice(m,n.l+4+s),o.push(u),n.l+=4+s,h=q0[d=yi(n,n.l)];var x=gn(o);kn(x,0);var v=0;x.lens=[];for(var _=0;_<o.length;++_)x.lens.push(v),v+=o[_].length;if(x.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+r;return t.f(x,x.length,i)}function ei(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ke[r])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ii[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qo(e.v):e.w=za(e.v):e.w=Dr(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&r&&e.t=="n"&&js(Ke[r]||String(r))){var i=Da(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Mu(e,t,n){return{v:e,ixfe:t,t:n}}function y3(e,t){var n={opts:{}},r={},i=t.dense?[]:{},s={},o={},u=null,d=[],h="",m={},x,v="",_,k,T,E,A={},I=[],C,D,M=[],P=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},q={},z=function(Qe){return Qe<8?Pa[Qe]:Qe<64&&P[Qe-8]||Pa[Qe]},te=function(Qe,xt,Cn){var It=xt.XF.data;if(!(!It||!It.patternType||!Cn||!Cn.cellStyles)){xt.s={},xt.s.patternType=It.patternType;var vt;(vt=il(z(It.icvFore)))&&(xt.s.fgColor={rgb:vt}),(vt=il(z(It.icvBack)))&&(xt.s.bgColor={rgb:vt})}},Q=function(Qe,xt,Cn){if(!(ue>1)&&!(Cn.sheetRows&&Qe.r>=Cn.sheetRows)){if(Cn.cellStyles&&xt.XF&&xt.XF.data&&te(Qe,xt,Cn),delete xt.ixfe,delete xt.XF,x=Qe,v=Xe(Qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<o.s.r&&(o.s.r=Qe.r),Qe.c<o.s.c&&(o.s.c=Qe.c),Qe.r+1>o.e.r&&(o.e.r=Qe.r+1),Qe.c+1>o.e.c&&(o.e.c=Qe.c+1),Cn.cellFormula&&xt.f){for(var It=0;It<I.length;++It)if(!(I[It][0].s.c>Qe.c||I[It][0].s.r>Qe.r)&&!(I[It][0].e.c<Qe.c||I[It][0].e.r<Qe.r)){xt.F=nt(I[It][0]),(I[It][0].s.c!=Qe.c||I[It][0].s.r!=Qe.r)&&delete xt.f,xt.f&&(xt.f=""+Pn(I[It][1],o,Qe,Z,Y));break}}Cn.dense?(i[Qe.r]||(i[Qe.r]=[]),i[Qe.r][Qe.c]=xt):i[v]=xt}},Y={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var xe,De=[],we=[],Fe=[],Ce=[],Se=!1,Z=[];Z.SheetNames=Y.snames,Z.sharedf=Y.sharedf,Z.arrayf=Y.arrayf,Z.names=[],Z.XTI=[];var H=0,ue=0,O=0,J=[],j=[],K;Y.codepage=1200,Wr(1200);for(var le=!1;e.l<e.length-1;){var ye=e.l,ve=e.read_shift(2);if(ve===0&&H===10)break;var _e=e.l===e.length?0:e.read_shift(2),Ie=q0[ve];if(Ie&&Ie.f){if(t.bookSheets&&H===133&&ve!==133)break;if(H=ve,Ie.r===2||Ie.r==12){var Je=e.read_shift(2);if(_e-=2,!Y.enc&&Je!==ve&&((Je&255)<<8|Je>>8)!==ve)throw new Error("rt mismatch: "+Je+"!="+ve);Ie.r==12&&(e.l+=10,_e-=10)}var G={};if(ve===10?G=Ie.f(e,_e,Y):G=v3(ve,Ie,e,_e,Y),ue==0&&[9,521,1033,2057].indexOf(H)===-1)continue;switch(ve){case 34:n.opts.Date1904=F.WBProps.date1904=G;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=G;break;case 66:var ut=Number(G);switch(ut){case 21010:ut=1200;break;case 32768:ut=1e4;break;case 32769:ut=1252;break}Wr(Y.codepage=ut),le=!0;break;case 317:Y.rrtabid=G;break;case 25:Y.winlocked=G;break;case 439:n.opts.RefreshAll=G;break;case 12:n.opts.CalcCount=G;break;case 16:n.opts.CalcDelta=G;break;case 17:n.opts.CalcIter=G;break;case 13:n.opts.CalcMode=G;break;case 14:n.opts.CalcPrecision=G;break;case 95:n.opts.CalcSaveRecalc=G;break;case 15:Y.CalcRefMode=G;break;case 2211:n.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:M.push(G);break;case 430:Z.push([G]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(G);break;case 24:case 536:K={Name:G.Name,Ref:Pn(G.rgce,o,null,Z,Y)},G.itab>0&&(K.Sheet=G.itab-1),Z.names.push(K),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(j[G.itab-1]={ref:nt(G.rgce[0][0][1][2])});break;case 22:Y.ExternCount=G;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(G),Z.XTI=Z.XTI.concat(G);break;case 2196:if(Y.biff<8)break;K!=null&&(K.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&Y.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,Y.snames.push(G.name);break;case 10:{if(--ue)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=nt(o),t.sheetRows&&t.sheetRows<=o.e.r){var it=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=nt(o),o.e.r=it}o.e.r++,o.e.c++}De.length>0&&(i["!merges"]=De),we.length>0&&(i["!objects"]=we),Fe.length>0&&(i["!cols"]=Fe),Ce.length>0&&(i["!rows"]=Ce),F.Sheets.push(q)}h===""?m=i:r[h]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),Y.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(Y.biff=5,le=!0,Wr(Y.codepage=28591)),Y.biff==8&&G.BIFFVer==0&&G.dt==16&&(Y.biff=2),ue++)break;if(i=t.dense?[]:{},Y.biff<8&&!le&&(le=!0,Wr(Y.codepage=t.codepage||1252)),Y.biff<5||G.BIFFVer==0&&G.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ht={pos:e.l-_e,name:h};s[ht.pos]=ht,Y.snames.push(h)}else h=(s[ye]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),De=[],we=[],Y.arrayf=I=[],Fe=[],Ce=[],Se=!1,q={Hidden:(s[ye]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[G.r]||[])[G.c]:i[Xe({c:G.c,r:G.r})])&&++G.c,C={ixfe:G.ixfe,XF:M[G.ixfe]||{},v:G.val,t:"n"},O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:G.c,r:G.r},C,t);break;case 5:case 517:C={ixfe:G.ixfe,XF:M[G.ixfe],v:G.val,t:G.t},O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:G.c,r:G.r},C,t);break;case 638:C={ixfe:G.ixfe,XF:M[G.ixfe],v:G.rknum,t:"n"},O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:G.c,r:G.r},C,t);break;case 189:for(var et=G.c;et<=G.C;++et){var Oe=G.rkrec[et-G.c][0];C={ixfe:Oe,XF:M[Oe],v:G.rkrec[et-G.c][1],t:"n"},O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:et,r:G.r},C,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){u=G;break}if(C=Mu(G.val,G.cell.ixfe,G.tt),C.XF=M[C.ixfe],t.cellFormula){var At=G.formula;if(At&&At[0]&&At[0][0]&&At[0][0][0]=="PtgExp"){var Jt=At[0][0][1][0],Xt=At[0][0][1][1],Ft=Xe({r:Jt,c:Xt});A[Ft]?C.f=""+Pn(G.formula,o,G.cell,Z,Y):C.F=((t.dense?(i[Jt]||[])[Xt]:i[Ft])||{}).F}else C.f=""+Pn(G.formula,o,G.cell,Z,Y)}O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q(G.cell,C,t),u=G}break;case 7:case 519:if(u)u.val=G,C=Mu(G,u.cell.ixfe,"s"),C.XF=M[C.ixfe],t.cellFormula&&(C.f=""+Pn(u.formula,o,u.cell,Z,Y)),O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q(u.cell,C,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(G);var yn=Xe(G[0].s);if(_=t.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[yn],t.cellFormula&&_){if(!u||!yn||!_)break;_.f=""+Pn(G[1],o,G[0],Z,Y),_.F=nt(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;A[Xe(u.cell)]=G[0],_=t.dense?(i[u.cell.r]||[])[u.cell.c]:i[Xe(u.cell)],(_||{}).f=""+Pn(G[0],o,x,Z,Y)}}break;case 253:C=Mu(d[G.isst].t,G.ixfe,"s"),d[G.isst].h&&(C.h=d[G.isst].h),C.XF=M[C.ixfe],O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:G.c,r:G.r},C,t);break;case 513:t.sheetStubs&&(C={ixfe:G.ixfe,XF:M[G.ixfe],t:"z"},O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:G.c,r:G.r},C,t));break;case 190:if(t.sheetStubs)for(var $n=G.c;$n<=G.C;++$n){var fn=G.ixfe[$n-G.c];C={ixfe:fn,XF:M[fn],t:"z"},O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:$n,r:G.r},C,t)}break;case 214:case 516:case 4:C=Mu(G.val,G.ixfe,"s"),C.XF=M[C.ixfe],O>0&&(C.z=J[C.ixfe>>8&63]),ei(C,t,n.opts.Date1904),Q({c:G.c,r:G.r},C,t);break;case 0:case 512:ue===1&&(o=G);break;case 252:d=G;break;case 1054:if(Y.biff==4){J[O++]=G[1];for(var qn=0;qn<O+163&&Ke[qn]!=G[1];++qn);qn>=163&&Ti(G[1],O+163)}else Ti(G[1],G[0]);break;case 30:{J[O++]=G;for(var sn=0;sn<O+163&&Ke[sn]!=G;++sn);sn>=163&&Ti(G,O+163)}break;case 229:De=De.concat(G);break;case 93:we[G.cmo[0]]=Y.lastobj=G;break;case 438:Y.lastobj.TxO=G;break;case 127:Y.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(T=G[0].s.c;T<=G[0].e.c;++T)_=t.dense?(i[E]||[])[T]:i[Xe({c:T,r:E})],_&&(_.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(T=G[0].s.c;T<=G[0].e.c;++T)_=t.dense?(i[E]||[])[T]:i[Xe({c:T,r:E})],_&&_.l&&(_.l.Tooltip=G[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;_=t.dense?(i[G[0].r]||[])[G[0].c]:i[Xe(G[0])];var Kn=we[G[2]];_||(t.dense?(i[G[0].r]||(i[G[0].r]=[]),_=i[G[0].r][G[0].c]={t:"z"}):_=i[Xe(G[0])]={t:"z"},o.e.r=Math.max(o.e.r,G[0].r),o.s.r=Math.min(o.s.r,G[0].r),o.e.c=Math.max(o.e.c,G[0].c),o.s.c=Math.min(o.s.c,G[0].c)),_.c||(_.c=[]),k={a:G[1],t:Kn.TxO.t},_.c.push(k)}break;case 2173:sA(M[G.ixfe],G.ext);break;case 125:{if(!Y.cellStyles)break;for(;G.e>=G.s;)Fe[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},Se||(Se=!0,Ud(G.w/256)),oa(Fe[G.e+1])}break;case 520:{var gt={};G.level!=null&&(Ce[G.r]=gt,gt.level=G.level),G.hidden&&(Ce[G.r]=gt,gt.hidden=!0),G.hpt&&(Ce[G.r]=gt,gt.hpt=G.hpt,gt.hpx=Gs(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Oa(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=G;break;case 161:i["!margins"]||Oa(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(F.Views[0].RTL=!0);break;case 146:P=G;break;case 2198:xe=G;break;case 140:D=G;break;case 442:h?q.CodeName=G||q.name:F.WBProps.CodeName=G||"ThisWorkbook";break}}else Ie||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=_e}return n.SheetNames=Kt(s).sort(function(wn,Qe){return Number(wn)-Number(Qe)}).map(function(wn){return s[wn].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&m["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=m)):n.Preamble=m,n.Sheets&&j.forEach(function(wn,Qe){n.Sheets[n.SheetNames[Qe]]["!autofilter"]=wn}),n.Strings=d,n.SSF=Ot(Ke),Y.enc&&(n.Encryption=Y.enc),xe&&(n.Themes=xe),n.Metadata={},D!==void 0&&(n.Metadata.Country=D),Z.names.length>0&&(F.Names=Z.names),n.Workbook=F,n}var Ko={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function w3(e,t,n){var r=Ge.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=Eg(r,b0,Ko.DSI);for(var s in i)t[s]=i[s]}catch(h){if(n.WTF)throw h}var o=Ge.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=Eg(o,V0,Ko.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(h){if(n.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(kv(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function _3(e,t){var n=[],r=[],i=[],s=0,o,u=tg(b0,"n"),d=tg(V0,"n");if(e.Props)for(o=Kt(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(u,o[s])?n:Object.prototype.hasOwnProperty.call(d,o[s])?r:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Kt(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(u,o[s])?n:Object.prototype.hasOwnProperty.call(d,o[s])?r:i).push([o[s],e.Custprops[o[s]]]);var h=[];for(s=0;s<i.length;++s)Rv.indexOf(i[s][0])>-1||Sv.indexOf(i[s][0])>-1||i[s][1]!=null&&h.push(i[s]);r.length&&Ge.utils.cfb_add(t,"/SummaryInformation",Cg(r,Ko.SI,d,V0)),(n.length||h.length)&&Ge.utils.cfb_add(t,"/DocumentSummaryInformation",Cg(n,Ko.DSI,u,b0,h.length?h:null,Ko.UDI))}function Cy(e,t){t||(t={}),qd(t),pd(),t.codepage&&hd(t.codepage);var n,r;if(e.FullPaths){if(Ge.find(e,"/encryption"))throw new Error("File is password-protected");n=Ge.find(e,"!CompObj"),r=Ge.find(e,"/Workbook")||Ge.find(e,"/Book")}else{switch(t.type){case"base64":e=hr(gr(e));break;case"binary":e=hr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}kn(e,0),r={content:e}}var i,s;if(n&&g3(n),t.bookProps&&!t.bookSheets)i={};else{var o=at?"buffer":"array";if(r&&r.content)i=y3(r.content,t);else if((s=Ge.find(e,"PerfectOffice_MAIN"))&&s.content)i=La.to_workbook(s.content,(t.type=o,t));else if((s=Ge.find(e,"NativeContent_MAIN"))&&s.content)i=La.to_workbook(s.content,(t.type=o,t));else throw(s=Ge.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ge.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=MA(e))}var u={};return e.FullPaths&&w3(e,u,t),i.Props=i.Custprops=u,t.bookFiles&&(i.cfb=e),i}function T3(e,t){var n=t||{},r=Ge.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Ge.utils.cfb_add(r,i,Ay(e,n)),n.biff==8&&(e.Props||e.Custprops)&&_3(e,r),n.biff==8&&e.vbaraw&&LA(r,Ge.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var ll={0:{f:$I},1:{f:eN},2:{f:yN},3:{f:lN},4:{f:iN},5:{f:gN},6:{f:kN},7:{f:dN},8:{f:RN},9:{f:FN},10:{f:IN},11:{f:NN},12:{f:nN},13:{f:_N},14:{f:cN},15:{f:sN},16:{f:vy},17:{f:CN},18:{f:pN},19:{f:Id},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:CF},40:{},42:{},43:{f:kC},44:{f:TC},45:{f:AC},46:{f:NC},47:{f:IC},48:{},49:{f:JT},50:{},51:{f:uA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Hv},62:{f:SN},63:{f:vA},64:{f:qN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:WN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ZI},148:{f:JI,p:16},151:{f:BN},152:{},153:{f:SF},154:{},155:{},156:{f:_F},157:{},158:{},159:{T:1,f:zE},160:{T:-1},161:{T:1,f:Xa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:DN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:oA},336:{T:-1},337:{f:dA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:z0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Vv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:UN},427:{f:zN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:VN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:YI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:LN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:z0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:NA},633:{T:1},634:{T:-1},635:{T:1,f:AA},636:{T:-1},637:{f:QT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:KN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},q0={6:{f:k0},10:{f:ta},12:{f:an},13:{f:an},14:{f:Zt},15:{f:Zt},16:{f:Ln},17:{f:Zt},18:{f:Zt},19:{f:an},20:{f:Dg},21:{f:Dg},23:{f:Vv},24:{f:Mg},25:{f:Zt},26:{},27:{},28:{f:Kk},29:{},34:{f:Zt},35:{f:Pg},38:{f:Ln},39:{f:Ln},40:{f:Ln},41:{f:Ln},42:{f:Zt},43:{f:Zt},47:{f:sC},49:{f:_k},51:{f:an},60:{},61:{f:gk},64:{f:Zt},65:{f:wk},66:{f:an},77:{},80:{},81:{},82:{},85:{f:an},89:{},90:{},91:{},92:{f:ak},93:{f:Yk},94:{},95:{f:Zt},96:{},97:{},99:{f:Zt},125:{f:Hv},128:{f:Ok},129:{f:ok},130:{f:an},131:{f:Zt},132:{f:Zt},133:{f:lk},134:{},140:{f:aE},141:{f:an},144:{},146:{f:lE},151:{},152:{},153:{},154:{},155:{},156:{f:an},157:{},158:{},160:{f:mE},161:{f:fE},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Dk},190:{f:Pk},193:{f:ta},197:{},198:{},199:{},200:{},201:{},202:{f:Zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:an},220:{},221:{f:Zt},222:{},224:{f:Lk},225:{f:ik},226:{f:ta},227:{},229:{f:Jk},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ck},253:{f:Sk},255:{f:dk},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Dv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zt},353:{f:ta},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Vk},431:{f:Zt},432:{},433:{},434:{},437:{},438:{f:eE},439:{f:Zt},440:{f:tE},441:{},442:{f:pl},443:{},444:{f:an},445:{},446:{},448:{f:ta},449:{f:mk,r:2},450:{f:ta},512:{f:Ng},513:{f:pE},515:{f:zk},516:{f:Ek},517:{f:Rg},519:{f:gE},520:{f:hk},523:{},545:{f:Lg},549:{f:Ig},566:{},574:{f:vk},638:{f:Rk},659:{},1048:{},1054:{f:Ak},1084:{},1212:{f:jk},2048:{f:rE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ru},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ta},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:uE,r:12},2173:{f:aA,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Gk,r:12},2197:{},2198:{f:QC,r:12},2199:{},2200:{},2201:{},2202:{f:$k,r:12},2203:{f:ta},2204:{},2205:{},2206:{},2207:{},2211:{f:pk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:an},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:dE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:oE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ng},1:{},2:{f:_E},3:{f:yE},4:{f:vE},5:{f:Rg},7:{f:SE},8:{},9:{f:Ru},11:{},22:{f:an},30:{f:Nk},31:{},32:{},33:{f:Lg},36:{},37:{f:Ig},50:{f:kE},62:{},52:{},67:{},68:{f:an},69:{},86:{},126:{},127:{f:xE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:EE},223:{},234:{},354:{},421:{},518:{f:k0},521:{f:Ru},536:{f:Mg},547:{f:Pg},561:{},579:{},1030:{f:k0},1033:{f:Ru},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Me(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Ed(n)&&e.push(n)}}function S3(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return Me(e,t,n,i);var s=t;if(!isNaN(s)){for(var o=n.parts||[],u=0,d=0,h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,s),m.write_shift(2,h),e.push(n.slice(d,d+h)),d+=h;d<i;){for(m=e.next(4),m.write_shift(2,60),h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;m.write_shift(2,h),e.push(n.slice(d,d+h)),d+=h}}}function vl(e,t,n){return e||(e=me(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function k3(e,t,n,r){var i=me(9);return vl(i,e,t),Pv(n,r||"b",i),i}function E3(e,t,n){var r=me(8+2*n.length);return vl(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function C3(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?cn(Lt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Me(e,2,TE(n,r,i)):Me(e,3,wE(n,r,i));return;case"b":case"e":Me(e,5,k3(n,r,t.v,t.t));return;case"s":case"str":Me(e,4,E3(n,r,(t.v||"").slice(0,255)));return}Me(e,1,vl(null,n,r))}function A3(e,t,n,r){var i=Array.isArray(t),s=dt(t["!ref"]||"A1"),o,u="",d=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=nt(s)}for(var h=s.s.r;h<=s.e.r;++h){u=Qt(h);for(var m=s.s.c;m<=s.e.c;++m){h===s.s.r&&(d[m]=Ht(m)),o=d[m]+u;var x=i?(t[h]||[])[m]:t[o];x&&C3(e,x,h,m)}}}function I3(e,t){for(var n=t||{},r=ir(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Me(r,n.biff==4?1033:n.biff==3?521:9,Ld(e,16,n)),A3(r,e.Sheets[e.SheetNames[i]],i,n),Me(r,10),r.end()}function N3(e,t,n){Me(e,49,Tk({sz:12,name:"Arial"},n))}function F3(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Me(e,1054,Ik(i,t[i],n))})}function R3(e,t){var n=me(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Me(e,2151,n),n=me(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Uv(dt(t["!ref"]||"A1"),n),n.write_shift(4,4),Me(e,2152,n)}function D3(e,t){for(var n=0;n<16;++n)Me(e,224,Fg({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){Me(e,224,Fg(r,0,t))})}function P3(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];Me(e,440,nE(r)),r[1].Tooltip&&Me(e,2048,iE(r))}delete t["!links"]}function M3(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&Me(e,125,cE(wc(i,r),i))})}}function L3(e,t,n,r,i){var s=16+da(i.cellXfs,t,i);if(t.v==null&&!t.bf){Me(e,513,Wa(n,r,s));return}if(t.bf)Me(e,6,oI(t,n,r,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?cn(Lt(t.v)):t.v;Me(e,515,bk(n,r,o,s));break;case"b":case"e":Me(e,517,Uk(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var u=Wd(i.Strings,t.v,i.revStrings);Me(e,253,kk(n,r,u,s))}else Me(e,516,Ck(n,r,(t.v||"").slice(0,255),s,i));break;default:Me(e,513,Wa(n,r,s))}}function O3(e,t,n){var r=ir(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},u=(o.Sheets||[])[e]||{},d=Array.isArray(s),h=t.biff==8,m,x="",v=[],_=dt(s["!ref"]||"A1"),k=h?65536:16384;if(_.e.c>255||_.e.r>=k){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,k-1)}Me(r,2057,Ld(n,16,t)),Me(r,13,Ir(1)),Me(r,12,Ir(100)),Me(r,15,Gn(!0)),Me(r,17,Gn(!1)),Me(r,16,Va(.001)),Me(r,95,Gn(!0)),Me(r,42,Gn(!1)),Me(r,43,Gn(!1)),Me(r,130,Ir(1)),Me(r,128,Bk()),Me(r,131,Gn(!1)),Me(r,132,Gn(!1)),h&&M3(r,s["!cols"]),Me(r,512,Fk(_,t)),h&&(s["!links"]=[]);for(var T=_.s.r;T<=_.e.r;++T){x=Qt(T);for(var E=_.s.c;E<=_.e.c;++E){T===_.s.r&&(v[E]=Ht(E)),m=v[E]+x;var A=d?(s[T]||[])[E]:s[m];A&&(L3(r,A,T,E,t),h&&A.l&&s["!links"].push([m,A.l]))}}var I=u.CodeName||u.name||i;return h&&Me(r,574,yk((o.Views||[])[0])),h&&(s["!merges"]||[]).length&&Me(r,229,Xk(s["!merges"])),h&&P3(r,s),Me(r,442,Mv(I)),h&&R3(r,s),Me(r,10),r.end()}function B3(e,t,n){var r=ir(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},u=n.biff==8,d=n.biff==5;if(Me(r,2057,Ld(e,5,n)),n.bookType=="xla"&&Me(r,135),Me(r,225,u?Ir(1200):null),Me(r,193,US(2)),d&&Me(r,191),d&&Me(r,192),Me(r,226),Me(r,92,sk("SheetJS",n)),Me(r,66,Ir(u?1200:1252)),u&&Me(r,353,Ir(0)),u&&Me(r,448),Me(r,317,hE(e.SheetNames.length)),u&&e.vbaraw&&Me(r,211),u&&e.vbaraw){var h=o.CodeName||"ThisWorkbook";Me(r,442,Mv(h))}Me(r,156,Ir(17)),Me(r,25,Gn(!1)),Me(r,18,Gn(!1)),Me(r,19,Ir(0)),u&&Me(r,431,Gn(!1)),u&&Me(r,444,Ir(0)),Me(r,61,xk()),Me(r,64,Gn(!1)),Me(r,141,Ir(0)),Me(r,34,Gn(mF(e)=="true")),Me(r,14,Gn(!0)),u&&Me(r,439,Gn(!1)),Me(r,218,Ir(0)),N3(r,e,n),F3(r,e.SSF,n),D3(r,n),u&&Me(r,352,Gn(!1));var m=r.end(),x=ir();u&&Me(x,140,sE()),u&&n.Strings&&S3(x,252,fk(n.Strings)),Me(x,10);var v=x.end(),_=ir(),k=0,T=0;for(T=0;T<e.SheetNames.length;++T)k+=(u?12:11)+(u?2:1)*e.SheetNames[T].length;var E=m.length+k+v.length;for(T=0;T<e.SheetNames.length;++T){var A=s[T]||{};Me(_,133,uk({pos:E,hs:A.Hidden||0,dt:0,name:e.SheetNames[T]},n)),E+=t[T].length}var I=_.end();if(k!=I.length)throw new Error("BS8 "+k+" != "+I.length);var C=[];return m.length&&C.push(m),I.length&&C.push(I),v.length&&C.push(v),gn(C)}function U3(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Ot(Ke)),e&&e.SSF&&($s(),hc(e.SSF),n.revssf=mc(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Kd(n),n.cellXfs=[],da(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=O3(i,n,e);return r.unshift(B3(e,r,n)),gn(r)}function Ay(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=ar(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return U3(e,t);case 4:case 3:case 2:return I3(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function jg(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,u=s&&s.index||e.length,d=TT(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,x=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(o=0;o<d.length;++o){var T=d[o].trim(),E=T.slice(0,3).toLowerCase();if(E=="<tr"){if(++h,n.sheetRows&&n.sheetRows<=h){--h;break}m=0;continue}if(!(E!="<td"&&E!="<th")){var A=T.split(/<\/t[dh]>/i);for(u=0;u<A.length;++u){var I=A[u].trim();if(I.match(/<t[dh]/i)){for(var C=I,D=0;C.charAt(0)=="<"&&(D=C.indexOf(">"))>-1;)C=C.slice(D+1);for(var M=0;M<k.length;++M){var P=k[M];P.s.c==m&&P.s.r<h&&h<=P.e.r&&(m=P.e.c+1,M=-1)}var F=Ye(I.slice(0,I.indexOf(">")));v=F.colspan?+F.colspan:1,((x=+F.rowspan)>1||v>1)&&k.push({s:{r:h,c:m},e:{r:h+(x||1)-1,c:m+v-1}});var q=F.t||F["data-t"]||"";if(!C.length){m+=v;continue}if(C=Y1(C),_.s.r>h&&(_.s.r=h),_.e.r<h&&(_.e.r=h),_.s.c>m&&(_.s.c=m),_.e.c<m&&(_.e.c=m),!C.length){m+=v;continue}var z={t:"s",v:C};n.raw||!C.trim().length||q=="s"||(C==="TRUE"?z={t:"b",v:!0}:C==="FALSE"?z={t:"b",v:!1}:isNaN(jr(C))?isNaN(Hs(C).getDate())||(z={t:"d",v:Lt(C)},n.cellDates||(z={t:"n",v:cn(z.v)}),z.z=n.dateNF||Ke[14]):z={t:"n",v:jr(C)}),n.dense?(r[h]||(r[h]=[]),r[h][m]=z):r[Xe({r:h,c:m})]=z,m+=v}}}}return r["!ref"]=nt(_),k.length&&(r["!merges"]=k),r}function z3(e,t,n,r){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,d=0,h=0;h<i.length;++h)if(!(i[h].s.r>n||i[h].s.c>o)&&!(i[h].e.r<n||i[h].e.c<o)){if(i[h].s.r<n||i[h].s.c<o){u=-1;break}u=i[h].e.r-i[h].s.r+1,d=i[h].e.c-i[h].s.c+1;break}if(!(u<0)){var m=Xe({r:n,c:o}),x=r.dense?(e[n]||[])[o]:e[m],v=x&&x.v!=null&&(x.h||Td(x.w||(ki(x),x.w)||""))||"",_={};u>1&&(_.rowspan=u),d>1&&(_.colspan=d),r.editable?v='<span contenteditable="true">'+v+"</span>":x&&(_["data-t"]=x&&x.t||"z",x.v!=null&&(_["data-v"]=x.v),x.z!=null&&(_["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),_.id=(r.id||"sjs")+"-"+m,s.push(Pe("td",v,_))}}var k="<tr>";return k+s.join("")+"</tr>"}var b3='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',V3="</body></html>";function H3(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return fa(jg(n[0],t),t);var r=Yd();return n.forEach(function(i,s){Zd(r,jg(i,t),"Sheet"+(s+1))}),r}function W3(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Iy(e,t){var n=t||{},r=n.header!=null?n.header:b3,i=n.footer!=null?n.footer:V3,s=[r],o=ar(e["!ref"]);n.dense=Array.isArray(e),s.push(W3(e,o,n));for(var u=o.s.r;u<=o.e.r;++u)s.push(z3(e,o,u,n));return s.push("</table>"+i),s.join("")}function Ny(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?Wt(r.origin):r.origin;i=o.r,s=o.c}var u=t.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var m=ar(e["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),i==-1&&(h.e.r=i=m.e.r+1)}var x=[],v=0,_=e["!rows"]||(e["!rows"]=[]),k=0,T=0,E=0,A=0,I=0,C=0;for(e["!cols"]||(e["!cols"]=[]);k<u.length&&T<d;++k){var D=u[k];if($g(D)){if(r.display)continue;_[T]={hidden:!0}}var M=D.children;for(E=A=0;E<M.length;++E){var P=M[E];if(!(r.display&&$g(P))){var F=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):Y1(P.innerHTML),q=P.getAttribute("data-z")||P.getAttribute("z");for(v=0;v<x.length;++v){var z=x[v];z.s.c==A+s&&z.s.r<T+i&&T+i<=z.e.r&&(A=z.e.c+1-s,v=-1)}C=+P.getAttribute("colspan")||1,((I=+P.getAttribute("rowspan")||1)>1||C>1)&&x.push({s:{r:T+i,c:A+s},e:{r:T+i+(I||1)-1,c:A+s+(C||1)-1}});var te={t:"s",v:F},Q=P.getAttribute("data-t")||P.getAttribute("t")||"";F!=null&&(F.length==0?te.t=Q||"z":r.raw||F.trim().length==0||Q=="s"||(F==="TRUE"?te={t:"b",v:!0}:F==="FALSE"?te={t:"b",v:!1}:isNaN(jr(F))?isNaN(Hs(F).getDate())||(te={t:"d",v:Lt(F)},r.cellDates||(te={t:"n",v:cn(te.v)}),te.z=r.dateNF||Ke[14]):te={t:"n",v:jr(F)})),te.z===void 0&&q!=null&&(te.z=q);var Y="",xe=P.getElementsByTagName("A");if(xe&&xe.length)for(var De=0;De<xe.length&&!(xe[De].hasAttribute("href")&&(Y=xe[De].getAttribute("href"),Y.charAt(0)!="#"));++De);Y&&Y.charAt(0)!="#"&&(te.l={Target:Y}),r.dense?(e[T+i]||(e[T+i]=[]),e[T+i][A+s]=te):e[Xe({c:A+s,r:T+i})]=te,h.e.c<A+s&&(h.e.c=A+s),A+=C}}++T}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,T-1+i),e["!ref"]=nt(h),T>=d&&(e["!fullref"]=nt((h.e.r=u.length-k+T-1+i,h))),e}function Fy(e,t){var n=t||{},r=n.dense?[]:{};return Ny(r,e,t)}function G3(e,t){return fa(Fy(e,t),t)}function $g(e){var t="",n=j3(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function j3(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $3(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=ft(t.replace(/<[^>]*>/g,""));return[n]}var qg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ry(e,t){var n=t||{},r=Sd(e),i=[],s,o,u={name:""},d="",h=0,m,x,v={},_=[],k=n.dense?[]:{},T,E,A={value:""},I="",C=0,D=[],M=-1,P=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},q=0,z={},te=[],Q={},Y=0,xe=0,De=[],we=1,Fe=1,Ce=[],Se={Names:[]},Z={},H=["",""],ue=[],O={},J="",j=0,K=!1,le=!1,ye=0;for(nl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=nl.exec(r);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"工作表":T[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?k["!ref"]=nt(F):k["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(k["!fullref"]=k["!ref"],F.e.r=n.sheetRows-1,k["!ref"]=nt(F)),te.length&&(k["!merges"]=te),De.length&&(k["!rows"]=De),m.name=m.名称||m.name,typeof JSON<"u"&&JSON.stringify(m),_.push(m.name),v[m.name]=k,le=!1):T[0].charAt(T[0].length-2)!=="/"&&(m=Ye(T[0],!1),M=P=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,k=n.dense?[]:{},te=[],De=[],le=!0);break;case"table-row-group":T[1]==="/"?--q:++q;break;case"table-row":case"行":if(T[1]==="/"){M+=we,we=1;break}if(x=Ye(T[0],!1),x.行号?M=x.行号-1:M==-1&&(M=0),we=+x["number-rows-repeated"]||1,we<10)for(ye=0;ye<we;++ye)q>0&&(De[M+ye]={level:q});P=-1;break;case"covered-table-cell":T[1]!=="/"&&++P,n.sheetStubs&&(n.dense?(k[M]||(k[M]=[]),k[M][P]={t:"z"}):k[Xe({r:M,c:P})]={t:"z"}),I="",D=[];break;case"table-cell":case"数据":if(T[0].charAt(T[0].length-2)==="/")++P,A=Ye(T[0],!1),Fe=parseInt(A["number-columns-repeated"]||"1",10),E={t:"z",v:null},A.formula&&n.cellFormula!=!1&&(E.f=Hg(ft(A.formula))),(A.数据类型||A["value-type"])=="string"&&(E.t="s",E.v=ft(A["string-value"]||""),n.dense?(k[M]||(k[M]=[]),k[M][P]=E):k[Xe({r:M,c:P})]=E),P+=Fe-1;else if(T[1]!=="/"){++P,I="",C=0,D=[],Fe=1;var ve=we?M+we-1:M;if(P>F.e.c&&(F.e.c=P),P<F.s.c&&(F.s.c=P),M<F.s.r&&(F.s.r=M),ve>F.e.r&&(F.e.r=ve),A=Ye(T[0],!1),ue=[],O={},E={t:A.数据类型||A["value-type"],v:null},n.cellFormula)if(A.formula&&(A.formula=ft(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(Y=parseInt(A["number-matrix-rows-spanned"],10)||0,xe=parseInt(A["number-matrix-columns-spanned"],10)||0,Q={s:{r:M,c:P},e:{r:M+Y-1,c:P+xe-1}},E.F=nt(Q),Ce.push([Q,E.F])),A.formula)E.f=Hg(A.formula);else for(ye=0;ye<Ce.length;++ye)M>=Ce[ye][0].s.r&&M<=Ce[ye][0].e.r&&P>=Ce[ye][0].s.c&&P<=Ce[ye][0].e.c&&(E.F=Ce[ye][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(Y=parseInt(A["number-rows-spanned"],10)||0,xe=parseInt(A["number-columns-spanned"],10)||0,Q={s:{r:M,c:P},e:{r:M+Y-1,c:P+xe-1}},te.push(Q)),A["number-columns-repeated"]&&(Fe=parseInt(A["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Mt(A["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(A.value);break;case"percentage":E.t="n",E.v=parseFloat(A.value);break;case"currency":E.t="n",E.v=parseFloat(A.value);break;case"date":E.t="d",E.v=Lt(A["date-value"]),n.cellDates||(E.t="n",E.v=cn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=yT(A["time-value"])/86400,n.cellDates&&(E.t="d",E.v=gc(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(A.数据数值);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",A["string-value"]!=null&&(I=ft(A["string-value"]),D=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(K=!1,E.t==="s"&&(E.v=I||"",D.length&&(E.R=D),K=C==0),Z.Target&&(E.l=Z),ue.length>0&&(E.c=ue,ue=[]),I&&n.cellText!==!1&&(E.w=I),K&&(E.t="z",delete E.v),(!K||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=M))for(var _e=0;_e<we;++_e){if(Fe=parseInt(A["number-columns-repeated"]||"1",10),n.dense)for(k[M+_e]||(k[M+_e]=[]),k[M+_e][P]=_e==0?E:Ot(E);--Fe>0;)k[M+_e][P+Fe]=Ot(E);else for(k[Xe({r:M+_e,c:P})]=E;--Fe>0;)k[Xe({r:M+_e,c:P+Fe})]=Ot(E);F.e.c<=P&&(F.e.c=P)}Fe=parseInt(A["number-columns-repeated"]||"1",10),P+=Fe-1,Fe=0,E={},I="",D=[]}Z={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(T[1]==="/"){if((s=i.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!0]);break;case"annotation":if(T[1]==="/"){if((s=i.pop())[0]!==T[3])throw"Bad state: "+s;O.t=I,D.length&&(O.R=D),O.a=J,ue.push(O)}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!1]);J="",j=0,I="",C=0,D=[];break;case"creator":T[1]==="/"?J=r.slice(j,T.index):j=T.index+T[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(T[1]==="/"){if((s=i.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!1]);I="",C=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(T[1]==="/"){if(z[u.name]=d,(s=i.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&(d="",u=Ye(T[0],!1),i.push([T[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ye(T[0],!1),d+=qg[T[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ye(T[0],!1),d+=qg[T[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(T[0].slice(-2)==="/>")break;if(T[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(h,T.index);break}else h=T.index+T[0].length;break;case"named-range":o=Ye(T[0],!1),H=E0(o["cell-range-address"]);var Ie={Name:o.name,Ref:H[0]+"!"+H[1]};le&&(Ie.Sheet=_.length),Se.Names.push(Ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(T[1]==="/"&&(!A||!A["string-value"])){var Je=$3(r.slice(C,T.index));I=(I.length>0?I+`
`:"")+Je[0]}else Ye(T[0],!1),C=T.index+T[0].length;break;case"s":break;case"database-range":if(T[1]==="/")break;try{H=E0(Ye(T[0])["target-range-address"]),v[H[0]]["!autofilter"]={ref:H[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(T[1]!=="/"){if(Z=Ye(T[0],!1),!Z.href)break;Z.Target=ft(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(H=E0(Z.Target.slice(1)),Z.Target="#"+H[0]+"!"+H[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(n.WTF)throw new Error(T)}}var G={Sheets:v,SheetNames:_,Workbook:Se};return n.bookSheets&&delete G.Sheets,G}function Kg(e,t){t=t||{},Ar(e,"META-INF/manifest.xml")&&yS(rn(e,"META-INF/manifest.xml"),t);var n=pr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=Ry(Et(n),t);return Ar(e,"meta.xml")&&(r.Props=_v(rn(e,"meta.xml"))),r}function Jg(e,t){return Ry(e,t)}var q3=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+tl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return en+t}}(),Xg=function(){var e=function(s){return kt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,u){var d=[];d.push('      <table:table table:name="'+kt(o.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,x=ar(s["!ref"]||"A1"),v=s["!merges"]||[],_=0,k=Array.isArray(s);if(s["!cols"])for(m=0;m<=x.e.c;++m)d.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var T="",E=s["!rows"]||[];for(h=0;h<x.s.r;++h)T=E[h]?' table:style-name="ro'+E[h].ods+'"':"",d.push("        <table:table-row"+T+`></table:table-row>
`);for(;h<=x.e.r;++h){for(T=E[h]?' table:style-name="ro'+E[h].ods+'"':"",d.push("        <table:table-row"+T+`>
`),m=0;m<x.s.c;++m)d.push(t);for(;m<=x.e.c;++m){var A=!1,I={},C="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>m)&&!(v[_].s.r>h)&&!(v[_].e.c<m)&&!(v[_].e.r<h)){(v[_].s.c!=m||v[_].s.r!=h)&&(A=!0),I["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,I["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(A){d.push(n);continue}var D=Xe({r:h,c:m}),M=k?(s[h]||[])[m]:s[D];if(M&&M.f&&(I["table:formula"]=kt(hI(M.f)),M.F&&M.F.slice(0,D.length)==D)){var P=ar(M.F);I["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,I["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!M){d.push(t);continue}switch(M.t){case"b":C=M.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=M.v?"true":"false";break;case"n":C=M.w||String(M.v||0),I["office:value-type"]="float",I["office:value"]=M.v||0;break;case"s":case"str":C=M.v==null?"":M.v,I["office:value-type"]="string";break;case"d":C=M.w||Lt(M.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Lt(M.v).toISOString(),I["table:style-name"]="ce1";break;default:d.push(t);continue}var F=e(C);if(M.l&&M.l.Target){var q=M.l.Target;q=q.charAt(0)=="#"?"#"+pI(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),F=Pe("text:a",F,{"xlink:href":q.replace(/&/g,"&amp;")})}d.push("          "+Pe("table:table-cell",Pe("text:p",F,{}),I)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var x=h["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;oa(x),x.ods=u;var v=h["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),s.push(`  </style:style>
`),++u}}});var d=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=d;var x=h["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),s.push(`  </style:style>
`),++d}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,u){var d=[en],h=tl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=tl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+h+m+`>
`),d.push(wv().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),i(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)d.push(r(o.Sheets[o.SheetNames[x]],o,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function Dy(e,t){if(t.bookType=="fods")return Xg(e,t);var n=yd(),r="",i=[],s=[];return r="mimetype",rt(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",rt(n,r,Xg(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",rt(n,r,q3(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",rt(n,r,en+wv()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",rt(n,r,TS(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",rt(n,r,wS(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ga(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function K0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Et(ca(e))}function K3(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):hr(ri(e))}function J3(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function ua(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function Yg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function X3(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,i=t+13;i>=t;--i)r=r*256+e[i];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function Y3(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function ul(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function _t(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function qt(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function mt(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=ul(e,n),s=i&7;i=Math.floor(i/8);var o=0,u;if(i==0)break;switch(s){case 0:{for(var d=n[0];e[n[0]++]>=128;);u=e.slice(d,n[0])}break;case 5:o=4,u=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,u=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=ul(e,n),u=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var h={data:u,type:s};t[i]==null?t[i]=[h]:t[i].push(h)}return t}function Sn(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(_t(r*8+i.type)),i.type==2&&t.push(_t(i.data.length)),t.push(i.data))})}),ua(t)}function $d(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function Er(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=ul(e,r),s=mt(e.slice(r[0],r[0]+i));r[0]+=i;var o={id:qt(s[1][0].data),messages:[]};s[2].forEach(function(u){var d=mt(u.data),h=qt(d[3][0].data);o.messages.push({meta:d,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(t=s[3])!=null&&t[0]&&(o.merge=qt(s[3][0].data)>>>0>0),n.push(o)}return n}function Ns(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:_t(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:_t(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:_t(o.data.length)}],r[2].push({data:Sn(o.meta),type:2})});var s=Sn(r);t.push(_t(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),ua(t)}function Z3(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=ul(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[n[0]],u>1&&(o|=t[n[0]+1]<<8),u>2&&(o|=t[n[0]+2]<<16),u>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=u}i.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var d=0,h=0;if(s==1?(h=(t[n[0]]>>2&7)+4,d=(t[n[0]++]&224)<<3,d|=t[n[0]++]):(h=(t[n[0]++]>>2)+1,s==2?(d=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(d=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[ua(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(i.push(i[0].slice(-d)),h-=d;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-d,-d+h))}}var m=ua(i);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function Cr(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(Z3(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return ua(t)}function Fs(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=_t(r),o=s.length;t.push(s),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return ua(t)}function Q3(e,t,n,r){var i=Ga(e),s=i.getUint32(4,!0),o=(r>1?12:8)+Yg(s&(r>1?3470:398))*4,u=-1,d=-1,h=NaN,m=new Date(2001,0,1);s&512&&(u=i.getUint32(o,!0),o+=4),o+=Yg(s&(r>1?12288:4096))*4,s&16&&(d=i.getUint32(o,!0),o+=4),s&32&&(h=i.getFloat64(o,!0),o+=8),s&64&&(m.setTime(m.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[d]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:n[u]};else if(d>-1)x={t:"s",v:t[d]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function eR(e,t,n){var r=Ga(e),i=r.getUint32(8,!0),s=12,o=-1,u=-1,d=NaN,h=NaN,m=new Date(2001,0,1);i&1&&(d=X3(e,s),s+=16),i&2&&(h=r.getFloat64(s,!0),s+=8),i&4&&(m.setTime(m.getTime()+r.getFloat64(s,!0)*1e3),s+=8),i&8&&(u=r.getUint32(s,!0),s+=4),i&16&&(o=r.getUint32(s,!0),s+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:n[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return x}function A0(e,t){var n=new Uint8Array(32),r=Ga(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,Y3(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function I0(e,t){var n=new Uint8Array(32),r=Ga(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function tR(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return Q3(e,t,n,e[0]);case 5:return eR(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Dn(e){var t=mt(e);return ul(t[1][0].data)}function Zg(e,t){var n=mt(t.data),r=qt(n[1][0].data),i=n[3],s=[];return(i||[]).forEach(function(o){var u=mt(o.data),d=qt(u[1][0].data)>>>0;switch(r){case 1:s[d]=K0(u[3][0].data);break;case 8:{var h=e[Dn(u[9][0].data)][0],m=mt(h.data),x=e[Dn(m[1][0].data)][0],v=qt(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=mt(x.data);s[d]=_[3].map(function(k){return K0(k.data)}).join("")}break}}),s}function nR(e,t){var n,r,i,s,o,u,d,h,m,x,v,_,k,T,E=mt(e),A=qt(E[1][0].data)>>>0,I=qt(E[2][0].data)>>>0,C=((r=(n=E[8])==null?void 0:n[0])==null?void 0:r.data)&&qt(E[8][0].data)>0||!1,D,M;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&t!=0)D=(u=(o=E[7])==null?void 0:o[0])==null?void 0:u.data,M=(h=(d=E[6])==null?void 0:d[0])==null?void 0:h.data;else if((x=(m=E[4])==null?void 0:m[0])!=null&&x.data&&t!=1)D=(_=(v=E[4])==null?void 0:v[0])==null?void 0:_.data,M=(T=(k=E[3])==null?void 0:k[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=C?4:1,F=Ga(D),q=[],z=0;z<D.length/2;++z){var te=F.getUint16(z*2,!0);te<65535&&q.push([z,te])}if(q.length!=I)throw"Expected ".concat(I," cells, found ").concat(q.length);var Q=[];for(z=0;z<q.length-1;++z)Q[q[z][0]]=M.subarray(q[z][1]*P,q[z+1][1]*P);return q.length>=1&&(Q[q[q.length-1][0]]=M.subarray(q[q.length-1][1]*P)),{R:A,cells:Q}}function rR(e,t){var n,r=mt(t.data),i=(n=r==null?void 0:r[7])!=null&&n[0]?qt(r[7][0].data)>>>0>0?1:0:-1,s=$d(r[5],function(o){return nR(o,i)});return{nrows:qt(r[4][0].data)>>>0,data:s.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(d,h){if(o[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));o[u.R][h]=d}),o},[])}}function iR(e,t,n){var r,i=mt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(qt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(qt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));n["!ref"]=nt(s);var o=mt(i[4][0].data),u=Zg(e,e[Dn(o[4][0].data)][0]),d=(r=o[17])!=null&&r[0]?Zg(e,e[Dn(o[17][0].data)][0]):[],h=mt(o[3][0].data),m=0;h[1].forEach(function(x){var v=mt(x.data),_=e[Dn(v[2][0].data)][0],k=qt(_.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var T=rR(e,_);T.data.forEach(function(E,A){E.forEach(function(I,C){var D=Xe({r:m+A,c:C}),M=tR(I,u,d);M&&(n[D]=M)})}),m+=T.nrows})}function aR(e,t){var n=mt(t.data),r={"!ref":"A1"},i=e[Dn(n[2][0].data)],s=qt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return iR(e,i[0],r),r}function sR(e,t){var n,r=mt(t.data),i={name:(n=r[1])!=null&&n[0]?K0(r[1][0].data):"",sheets:[]},s=$d(r[2],Dn);return s.forEach(function(o){e[o].forEach(function(u){var d=qt(u.meta[1][0].data);d==6e3&&i.sheets.push(aR(e,u))})}),i}function oR(e,t){var n=Yd(),r=mt(t.data),i=$d(r[1],Dn);if(i.forEach(function(s){e[s].forEach(function(o){var u=qt(o.meta[1][0].data);if(u==2){var d=sR(e,o);d.sheets.forEach(function(h,m){Zd(n,h,m==0?d.name:d.name+"_"+m,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function N0(e){var t,n,r,i,s={},o=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=Cr(d.content)}catch(x){return console.log("?? "+d.content.length+" "+(x.message||x))}var m;try{m=Er(h)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){s[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((i=(r=(n=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:i[0].data)&&qt(s[1][0].meta[1][0].data)==1&&s[1][0];if(u||o.forEach(function(d){s[d].forEach(function(h){var m=qt(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return oR(s,u)}function lR(e,t,n){var r,i,s,o;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&qt(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,h=Ga(e[7][0].data),m=0,x=[],v=Ga(e[4][0].data),_=0,k=[],T=0;T<t.length;++T){if(t[T]==null){h.setUint16(T*2,65535,!0),v.setUint16(T*2,65535);continue}h.setUint16(T*2,m,!0),v.setUint16(T*2,_,!0);var E,A;switch(typeof t[T]){case"string":E=A0({t:"s",v:t[T]},n),A=I0({t:"s",v:t[T]},n);break;case"number":E=A0({t:"n",v:t[T]},n),A=I0({t:"n",v:t[T]},n);break;case"boolean":E=A0({t:"b",v:t[T]},n),A=I0({t:"b",v:t[T]},n);break;default:throw new Error("Unsupported value "+t[T])}x.push(E),m+=E.length,k.push(A),_+=A.length,++d}for(e[2][0].data=_t(d);T<e[7][0].data.length/2;++T)h.setUint16(T*2,65535,!0),v.setUint16(T*2,65535,!0);return e[6][0].data=ua(x),e[3][0].data=ua(k),d}function uR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ar(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(nt(r)));var s=rc(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(J){return J.forEach(function(j){typeof j=="string"&&o.push(j)})});var u={},d=[],h=Ge.read(t.numbers,{type:"base64"});h.FileIndex.map(function(J,j){return[J,h.FullPaths[j]]}).forEach(function(J){var j=J[0],K=J[1];if(j.type==2&&j.name.match(/\.iwa/)){var le=j.content,ye=Cr(le),ve=Er(ye);ve.forEach(function(_e){d.push(_e.id),u[_e.id]={deps:[],location:K,type:qt(_e.messages[0].meta[1][0].data)}})}}),d.sort(function(J,j){return J-j});var m=d.filter(function(J){return J>1}).map(function(J){return[J,_t(J)]});h.FileIndex.map(function(J,j){return[J,h.FullPaths[j]]}).forEach(function(J){var j=J[0];if(J[1],!!j.name.match(/\.iwa/)){var K=Er(Cr(j.content));K.forEach(function(le){le.messages.forEach(function(ye){m.forEach(function(ve){le.messages.some(function(_e){return qt(_e.meta[1][0].data)!=11006&&J3(_e.data,ve[1])})&&u[ve[0]].deps.push(le.id)})})})}});for(var x=Ge.find(h,u[1].location),v=Er(Cr(x.content)),_,k=0;k<v.length;++k){var T=v[k];T.id==1&&(_=T)}var E=Dn(mt(_.messages[0].data)[1][0].data);for(x=Ge.find(h,u[E].location),v=Er(Cr(x.content)),k=0;k<v.length;++k)T=v[k],T.id==E&&(_=T);for(E=Dn(mt(_.messages[0].data)[2][0].data),x=Ge.find(h,u[E].location),v=Er(Cr(x.content)),k=0;k<v.length;++k)T=v[k],T.id==E&&(_=T);for(E=Dn(mt(_.messages[0].data)[2][0].data),x=Ge.find(h,u[E].location),v=Er(Cr(x.content)),k=0;k<v.length;++k)T=v[k],T.id==E&&(_=T);var A=mt(_.messages[0].data);{A[6][0].data=_t(r.e.r+1),A[7][0].data=_t(r.e.c+1);var I=Dn(A[46][0].data),C=Ge.find(h,u[I].location),D=Er(Cr(C.content));{for(var M=0;M<D.length&&D[M].id!=I;++M);if(D[M].id!=I)throw"Bad ColumnRowUIDMapArchive";var P=mt(D[M].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var F=0;F<=r.e.c;++F){var q=[];q[1]=q[2]=[{type:0,data:_t(F+420690)}],P[1].push({type:2,data:Sn(q)}),P[2].push({type:0,data:_t(F)}),P[3].push({type:0,data:_t(F)})}P[4]=[],P[5]=[],P[6]=[];for(var z=0;z<=r.e.r;++z)q=[],q[1]=q[2]=[{type:0,data:_t(z+726270)}],P[4].push({type:2,data:Sn(q)}),P[5].push({type:0,data:_t(z)}),P[6].push({type:0,data:_t(z)});D[M].messages[0].data=Sn(P)}C.content=Fs(Ns(D)),C.size=C.content.length,delete A[46];var te=mt(A[4][0].data);{te[7][0].data=_t(r.e.r+1);var Q=mt(te[1][0].data),Y=Dn(Q[2][0].data);C=Ge.find(h,u[Y].location),D=Er(Cr(C.content));{if(D[0].id!=Y)throw"Bad HeaderStorageBucket";var xe=mt(D[0].messages[0].data);for(z=0;z<s.length;++z){var De=mt(xe[2][0].data);De[1][0].data=_t(z),De[4][0].data=_t(s[z].length),xe[2][z]={type:xe[2][0].type,data:Sn(De)}}D[0].messages[0].data=Sn(xe)}C.content=Fs(Ns(D)),C.size=C.content.length;var we=Dn(te[2][0].data);C=Ge.find(h,u[we].location),D=Er(Cr(C.content));{if(D[0].id!=we)throw"Bad HeaderStorageBucket";for(xe=mt(D[0].messages[0].data),F=0;F<=r.e.c;++F)De=mt(xe[2][0].data),De[1][0].data=_t(F),De[4][0].data=_t(r.e.r+1),xe[2][F]={type:xe[2][0].type,data:Sn(De)};D[0].messages[0].data=Sn(xe)}C.content=Fs(Ns(D)),C.size=C.content.length;var Fe=Dn(te[4][0].data);(function(){for(var J=Ge.find(h,u[Fe].location),j=Er(Cr(J.content)),K,le=0;le<j.length;++le){var ye=j[le];ye.id==Fe&&(K=ye)}var ve=mt(K.messages[0].data);{ve[3]=[];var _e=[];o.forEach(function(G,ut){_e[1]=[{type:0,data:_t(ut)}],_e[2]=[{type:0,data:_t(1)}],_e[3]=[{type:2,data:K3(G)}],ve[3].push({type:2,data:Sn(_e)})})}K.messages[0].data=Sn(ve);var Ie=Ns(j),Je=Fs(Ie);J.content=Je,J.size=J.content.length})();var Ce=mt(te[3][0].data);{var Se=Ce[1][0];delete Ce[2];var Z=mt(Se.data);{var H=Dn(Z[2][0].data);(function(){for(var J=Ge.find(h,u[H].location),j=Er(Cr(J.content)),K,le=0;le<j.length;++le){var ye=j[le];ye.id==H&&(K=ye)}var ve=mt(K.messages[0].data);{delete ve[6],delete Ce[7];var _e=new Uint8Array(ve[5][0].data);ve[5]=[];for(var Ie=0,Je=0;Je<=r.e.r;++Je){var G=mt(_e);Ie+=lR(G,s[Je],o),G[1][0].data=_t(Je),ve[5].push({data:Sn(G),type:2})}ve[1]=[{type:0,data:_t(r.e.c+1)}],ve[2]=[{type:0,data:_t(r.e.r+1)}],ve[3]=[{type:0,data:_t(Ie)}],ve[4]=[{type:0,data:_t(r.e.r+1)}]}K.messages[0].data=Sn(ve);var ut=Ns(j),it=Fs(ut);J.content=it,J.size=J.content.length})()}Se.data=Sn(Z)}te[3][0].data=Sn(Ce)}A[4][0].data=Sn(te)}_.messages[0].data=Sn(A);var ue=Ns(v),O=Fs(ue);return x.content=O,x.size=x.content.length,h}function Py(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function qd(e){Py([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Kd(e){Py([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function cR(e){return st.WS.indexOf(e)>-1?"sheet":e==st.CS?"chart":e==st.DS?"dialog":e==st.MS?"macro":e&&e.length?e:"sheet"}function fR(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,cR(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dR(e,t,n,r,i,s,o,u,d,h,m,x){try{s[r]=Go(pr(e,n,!0),t);var v=rn(e,t),_;switch(u){case"sheet":_=MF(v,t,i,d,s[r],h,m,x);break;case"chart":if(_=LF(v,t,i,d,s[r],h,m,x),!_||!_["!drawel"])break;var k=bo(_["!drawel"].Target,t),T=rl(k),E=_A(pr(e,k,!0),Go(pr(e,T,!0),k)),A=bo(E,k),I=rl(A);_=lF(pr(e,A,!0),A,d,Go(pr(e,I,!0),A),h,_);break;case"macro":_=OF(v,t,i,d,s[r],h,m,x);break;case"dialog":_=BF(v,t,i,d,s[r],h,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[r]=_;var C=[];s&&s[r]&&Kt(s[r]).forEach(function(D){var M="";if(s[r][D].Type==st.CMNT){M=bo(s[r][D].Target,t);var P=VF(rn(e,M,!0),M,d);if(!P||!P.length)return;Bg(_,P,!1)}s[r][D].Type==st.TCMNT&&(M=bo(s[r][D].Target,t),C=C.concat(SA(rn(e,M,!0),d)))}),C&&C.length&&Bg(_,C,!0,d.people||[])}catch(D){if(d.WTF)throw D}}function Sr(e){return e.charAt(0)=="/"?e.slice(1):e}function hR(e,t){if($s(),t=t||{},qd(t),Ar(e,"META-INF/manifest.xml")||Ar(e,"objectdata.xml"))return Kg(e,t);if(Ar(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof N0<"u"){if(e.FileIndex)return N0(e);var n=Ge.utils.cfb_new();return ig(e).forEach(function(De){rt(n,De,kT(e,De))}),N0(n)}throw new Error("Unsupported NUMBERS file")}if(!Ar(e,"[Content_Types].xml"))throw Ar(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ar(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=ig(e),i=xS(pr(e,"[Content_Types].xml")),s=!1,o,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",rn(e,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!rn(e,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var d={},h={};if(!t.bookSheets&&!t.bookProps){if(jo=[],i.sst)try{jo=bF(rn(e,Sr(i.sst)),i.sst,t)}catch(De){if(t.WTF)throw De}t.cellStyles&&i.themes.length&&(d=zF(pr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(h=UF(rn(e,Sr(i.style)),i.style,d,t))}i.links.map(function(De){try{var we=Go(pr(e,rl(Sr(De))),De);return WF(rn(e,Sr(De)),we,De,t)}catch{}});var m=PF(rn(e,Sr(i.workbooks[0])),i.workbooks[0],t),x={},v="";i.coreprops.length&&(v=rn(e,Sr(i.coreprops[0]),!0),v&&(x=_v(v)),i.extprops.length!==0&&(v=rn(e,Sr(i.extprops[0]),!0),v&&kS(v,x,t)));var _={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(v=pr(e,Sr(i.custprops[0]),!0),v&&(_=CS(v,t)));var k={};if((t.bookSheets||t.bookProps)&&(m.Sheets?o=m.Sheets.map(function(we){return we.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),t.bookProps&&(k.Props=x,k.Custprops=_),t.bookSheets&&typeof o<"u"&&(k.SheetNames=o),t.bookSheets?k.SheetNames:t.bookProps))return k;o={};var T={};t.bookDeps&&i.calcchain&&(T=HF(rn(e,Sr(i.calcchain)),i.calcchain));var E=0,A={},I,C;{var D=m.Sheets;x.Worksheets=D.length,x.SheetNames=[];for(var M=0;M!=D.length;++M)x.SheetNames[M]=D[M].name}var P=s?"bin":"xml",F=i.workbooks[0].lastIndexOf("/"),q=(i.workbooks[0].slice(0,F+1)+"_rels/"+i.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Ar(e,q)||(q="xl/_rels/workbook."+P+".rels");var z=Go(pr(e,q,!0),q.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=GF(rn(e,Sr(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=EA(rn(e,Sr(i.people[0])),t)),z&&(z=fR(z,m.Sheets));var te=rn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=x.Worksheets;++E){var Q="sheet";if(z&&z[E]?(I="xl/"+z[E][1].replace(/[\/]?xl\//,""),Ar(e,I)||(I=z[E][1]),Ar(e,I)||(I=q.replace(/_rels\/.*$/,"")+z[E][1]),Q=z[E][2]):(I="xl/worksheets/sheet"+(E+1-te)+"."+P,I=I.replace(/sheet0\./,"sheet.")),C=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(x.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,xe=0;xe!=t.sheets.length;++xe)typeof t.sheets[xe]=="number"&&t.sheets[xe]==E&&(Y=1),typeof t.sheets[xe]=="string"&&t.sheets[xe].toLowerCase()==x.SheetNames[E].toLowerCase()&&(Y=1);if(!Y)continue e}}dR(e,I,C,x.SheetNames[E],E,A,o,Q,t,m,d,h)}return k={Directory:i,Workbook:m,Props:x,Custprops:_,Deps:T,Sheets:o,SheetNames:x.SheetNames,Strings:jo,Styles:h,Themes:d,SSF:Ot(Ke)},t&&t.bookFiles&&(e.files?(k.keys=r,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(De,we){De=De.replace(/^Root Entry[\/]/,""),k.keys.push(De),k.files[De]=e.FileIndex[we]}))),t&&t.bookVBA&&(i.vba.length>0?k.vbaraw=rn(e,Sr(i.vba[0]),!0):i.defaults&&i.defaults.bin===PA&&(k.vbaraw=rn(e,"xl/vbaProject.bin",!0))),k}function pR(e,t){var n=t||{},r="Workbook",i=Ge.find(e,r);try{if(r="/!DataSpaces/Version",i=Ge.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(GE(i.content),r="/!DataSpaces/DataSpaceMap",i=Ge.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=$E(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ge.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=qE(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ge.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);JE(i.content)}catch{}if(r="/EncryptionInfo",i=Ge.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=XE(i.content);if(r="/EncryptedPackage",i=Ge.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,n.password||"",n);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function mR(e,t){return t.bookType=="ods"?Dy(e,t):t.bookType=="numbers"?uR(e,t):t.bookType=="xlsb"?gR(e,t):xR(e,t)}function gR(e,t){Ds=1024,e&&!e.SSF&&(e.SSF=Ot(Ke)),e&&e.SSF&&($s(),hc(e.SSF),t.revssf=mc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$o?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=sy.indexOf(t.bookType)>-1,i=Pd();Kd(t=t||{});var s=yd(),o="",u=0;if(t.cellXfs=[],da(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rt(s,o,Tv(e.Props,t)),i.coreprops.push(o),Tt(t.rels,2,o,st.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,rt(s,o,Ev(e.Props)),i.extprops.push(o),Tt(t.rels,3,o,st.EXT_PROPS),e.Custprops!==e.Props&&Kt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rt(s,o,Cv(e.Custprops)),i.custprops.push(o),Tt(t.rels,4,o,st.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+u+"."+n,rt(s,o,$F(u-1,o,t,e,m)),i.sheets.push(o),Tt(t.wbrels,-1,"worksheets/sheet"+u+"."+n,st.WS[0])}if(x){var _=x["!comments"],k=!1,T="";_&&_.length>0&&(T="xl/comments"+u+"."+n,rt(s,T,JF(_,T)),i.comments.push(T),Tt(m,-1,"../comments"+u+"."+n,st.CMNT),k=!0),x["!legacy"]&&k&&rt(s,"xl/drawings/vmlDrawing"+u+".vml",iy(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&rt(s,rl(o),Ls(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,rt(s,o,KF(t.Strings,o,t)),i.strs.push(o),Tt(t.wbrels,-1,"sharedStrings."+n,st.SST)),o="xl/workbook."+n,rt(s,o,jF(e,o)),i.workbooks.push(o),Tt(t.rels,1,o,st.WB),o="xl/theme/theme1.xml",rt(s,o,zd(e.Themes,t)),i.themes.push(o),Tt(t.wbrels,-1,"theme/theme1.xml",st.THEME),o="xl/styles."+n,rt(s,o,qF(e,o,t)),i.styles.push(o),Tt(t.wbrels,-1,"styles."+n,st.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",rt(s,o,e.vbaraw),i.vba.push(o),Tt(t.wbrels,-1,"vbaProject.bin",st.VBA)),o="xl/metadata."+n,rt(s,o,XF(o)),i.metadata.push(o),Tt(t.wbrels,-1,"metadata."+n,st.XLMETA),rt(s,"[Content_Types].xml",yv(i,t)),rt(s,"_rels/.rels",Ls(t.rels)),rt(s,"xl/_rels/workbook."+n+".rels",Ls(t.wbrels)),delete t.revssf,delete t.ssf,s}function xR(e,t){Ds=1024,e&&!e.SSF&&(e.SSF=Ot(Ke)),e&&e.SSF&&($s(),hc(e.SSF),t.revssf=mc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$o?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=sy.indexOf(t.bookType)>-1,i=Pd();Kd(t=t||{});var s=yd(),o="",u=0;if(t.cellXfs=[],da(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rt(s,o,Tv(e.Props,t)),i.coreprops.push(o),Tt(t.rels,2,o,st.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,rt(s,o,Ev(e.Props)),i.extprops.push(o),Tt(t.rels,3,o,st.EXT_PROPS),e.Custprops!==e.Props&&Kt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rt(s,o,Cv(e.Custprops)),i.custprops.push(o),Tt(t.rels,4,o,st.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+u+"."+n,rt(s,o,xy(u-1,t,e,x)),i.sheets.push(o),Tt(t.wbrels,-1,"worksheets/sheet"+u+"."+n,st.WS[0])}if(v){var k=v["!comments"],T=!1,E="";if(k&&k.length>0){var A=!1;k.forEach(function(I){I[1].forEach(function(C){C.T==!0&&(A=!0)})}),A&&(E="xl/threadedComments/threadedComment"+u+"."+n,rt(s,E,kA(k,m,t)),i.threadedcomments.push(E),Tt(x,-1,"../threadedComments/threadedComment"+u+"."+n,st.TCMNT)),E="xl/comments"+u+"."+n,rt(s,E,ay(k)),i.comments.push(E),Tt(x,-1,"../comments"+u+"."+n,st.CMNT),T=!0}v["!legacy"]&&T&&rt(s,"xl/drawings/vmlDrawing"+u+".vml",iy(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&rt(s,rl(o),Ls(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,rt(s,o,$v(t.Strings,t)),i.strs.push(o),Tt(t.wbrels,-1,"sharedStrings."+n,st.SST)),o="xl/workbook."+n,rt(s,o,Ty(e)),i.workbooks.push(o),Tt(t.rels,1,o,st.WB),o="xl/theme/theme1.xml",rt(s,o,zd(e.Themes,t)),i.themes.push(o),Tt(t.wbrels,-1,"theme/theme1.xml",st.THEME),o="xl/styles."+n,rt(s,o,ey(e,t)),i.styles.push(o),Tt(t.wbrels,-1,"styles."+n,st.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",rt(s,o,e.vbaraw),i.vba.push(o),Tt(t.wbrels,-1,"vbaProject.bin",st.VBA)),o="xl/metadata."+n,rt(s,o,ry()),i.metadata.push(o),Tt(t.wbrels,-1,"metadata."+n,st.XLMETA),m.length>1&&(o="xl/persons/person.xml",rt(s,o,CA(m)),i.people.push(o),Tt(t.wbrels,-1,"persons/person.xml",st.PEOPLE)),rt(s,"[Content_Types].xml",yv(i,t)),rt(s,"_rels/.rels",Ls(t.rels)),rt(s,"xl/_rels/workbook."+n+".rels",Ls(t.wbrels)),delete t.revssf,delete t.ssf,s}function Jd(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=gr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function vR(e,t){return Ge.find(e,"EncryptedPackage")?pR(e,t):Cy(e,t)}function yR(e,t){var n,r=e,i=t||{};return i.type||(i.type=at&&Buffer.isBuffer(e)?"buffer":"base64"),n=K1(r,i),hR(n,i)}function My(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return $0(e.slice(n),t);default:break e}return Ws.to_workbook(e,t)}function wR(e,t){var n="",r=Jd(e,t);switch(t.type){case"base64":n=gr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=ba(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Et(n)),t.type="binary",My(n,t)}function _R(e,t){var n=e;return t.type=="base64"&&(n=gr(n)),n=Yo.utils.decode(1200,n.slice(2),"str"),t.type="binary",My(n,t)}function TR(e){return e.match(/[^\x00-\x7F]/)?ri(e):e}function F0(e,t,n,r){return r?(n.type="string",Ws.to_workbook(e,n)):Ws.to_workbook(t,n)}function J0(e,t){pd();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return J0(new Uint8Array(e),(n=Ot(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,i=[0,0,0,0],s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Bs={},n.dateNF&&(Bs.dateNF=n.dateNF),n.type||(n.type=at&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=at?"buffer":"binary",r=gT(e),typeof Uint8Array<"u"&&!at&&(n.type="array")),n.type=="string"&&(s=!0,n.type="binary",n.codepage=65001,r=TR(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return n=Ot(n),n.type="array",J0(md(r),n)}switch((i=Jd(r,n))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return vR(Ge.read(r,n),n);break;case 9:if(i[1]<=8)return Cy(r,n);break;case 60:return $0(r,n);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return AE(r,n);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Gv.to_workbook(r,n);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?yR(r,n):F0(e,r,n,s);case 239:return i[3]===60?$0(r,n):F0(e,r,n,s);case 255:if(i[1]===254)return _R(r,n);if(i[1]===0&&i[2]===2&&i[3]===0)return La.to_workbook(r,n);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return La.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return j0.to_workbook(r,n);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Yv.to_workbook(r,n);break;case 10:case 13:case 32:return wR(r,n);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return CE.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?j0.to_workbook(r,n):F0(e,r,n,s)}function Ly(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return fl(t.file,Ge.write(e,{type:at?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ge.write(e,t)}function SR(e,t){var n=Ot(t||{}),r=mR(e,n);return kR(r,n)}function kR(e,t){var n={},r=at?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ge.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(dc(i))}return t.password&&typeof encrypt_agile<"u"?Ly(encrypt_agile(i,t.password),t):t.type==="file"?fl(t.file,i):t.type=="string"?Et(i):i}function ER(e,t){var n=t||{},r=T3(e,n);return Ly(r,n)}function ni(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Zo(ri(r));case"binary":return ri(r);case"string":return e;case"file":return fl(t.file,r,"utf8");case"buffer":return at?Ci(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):ni(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function CR(e,t){switch(t.type){case"base64":return Zo(e);case"binary":return e;case"string":return e;case"file":return fl(t.file,e,"binary");case"buffer":return at?Ci(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Lu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?Zo(n):t.type=="string"?Et(n):n;case"file":return fl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Oy(e,t){pd(),vF(e);var n=Ot(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=Oy(e,n);return n.type="array",dc(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return ni(m3(e,n),n);case"slk":case"sylk":return ni(Wv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return ni(Iy(e.Sheets[e.SheetNames[i]],n),n);case"txt":return CR(By(e.Sheets[e.SheetNames[i]],n),n);case"csv":return ni(Xd(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return ni(Gv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return Lu(j0.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return ni(Ws.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return ni(Yv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return ni(jv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return ni(Dy(e,n),n);case"wk1":return Lu(La.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return Lu(La.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Lu(Ay(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),ER(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return SR(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function AR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function IR(e,t,n){var r={};return r.type="file",r.file=t,AR(r),Oy(e,r)}function NR(e,t,n,r,i,s,o,u){var d=Qt(n),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:n,enumerable:!1})}catch{v.__rowNum__=n}else v.__rowNum__=n;if(!o||e[n])for(var _=t.s.c;_<=t.e.c;++_){var k=o?e[n][_]:e[r[_]+d];if(k===void 0||k.t===void 0){if(h===void 0)continue;s[_]!=null&&(v[s[_]]=h);continue}var T=k.v;switch(k.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(s[_]!=null){if(T==null)if(k.t=="e"&&T===null)v[s[_]]=null;else if(h!==void 0)v[s[_]]=h;else if(m&&T===null)v[s[_]]=null;else continue;else v[s[_]]=m&&(k.t!=="n"||k.t==="n"&&u.rawNumbers!==!1)?T:ki(k,T,u);T!=null&&(x=!1)}}return{row:v,isempty:x}}function rc(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},m=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof m){case"string":d=dt(m);break;case"number":d=dt(e["!ref"]),d.s.r=m;break;default:d=m}r>0&&(i=0);var x=Qt(d.s.r),v=[],_=[],k=0,T=0,E=Array.isArray(e),A=d.s.r,I=0,C={};E&&!e[A]&&(e[A]=[]);var D=h.skipHidden&&e["!cols"]||[],M=h.skipHidden&&e["!rows"]||[];for(I=d.s.c;I<=d.e.c;++I)if(!(D[I]||{}).hidden)switch(v[I]=Ht(I),n=E?e[A][I]:e[v[I]+x],r){case 1:s[I]=I-d.s.c;break;case 2:s[I]=v[I];break;case 3:s[I]=h.header[I-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=o=ki(n,null,h),T=C[o]||0,!T)C[o]=1;else{do u=o+"_"+T++;while(C[u]);C[o]=T,C[u]=1}s[I]=u}for(A=d.s.r+i;A<=d.e.r;++A)if(!(M[A]||{}).hidden){var P=NR(e,d,A,v,r,s,E,h);(P.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(_[k++]=P.row)}return _.length=k,_}var Qg=/"/g;function FR(e,t,n,r,i,s,o,u){for(var d=!0,h=[],m="",x=Qt(n),v=t.s.c;v<=t.e.c;++v)if(r[v]){var _=u.dense?(e[n]||[])[v]:e[r[v]+x];if(_==null)m="";else if(_.v!=null){d=!1,m=""+(u.rawNumbers&&_.t=="n"?_.v:ki(_,null,u));for(var k=0,T=0;k!==m.length;++k)if((T=m.charCodeAt(k))===i||T===s||T===34||u.forceQuotes){m='"'+m.replace(Qg,'""')+'"';break}m=="ID"&&(m='"ID"')}else _.f!=null&&!_.F?(d=!1,m="="+_.f,m.indexOf(",")>=0&&(m='"'+m.replace(Qg,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&d?null:h.join(o)}function Xd(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=dt(e["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,d=u.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),m="",x=[];r.dense=Array.isArray(e);for(var v=r.skipHidden&&e["!cols"]||[],_=r.skipHidden&&e["!rows"]||[],k=i.s.c;k<=i.e.c;++k)(v[k]||{}).hidden||(x[k]=Ht(k));for(var T=0,E=i.s.r;E<=i.e.r;++E)(_[E]||{}).hidden||(m=FR(e,i,E,x,o,d,s,r),m!=null&&(r.strip&&(m=m.replace(h,"")),(m||r.blankrows!==!1)&&n.push((T++?u:"")+m)));return delete r.dense,n.join("")}function By(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Xd(e,t);return n}function RR(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=dt(e["!ref"]),s="",o=[],u,d=[],h=Array.isArray(e);for(u=i.s.c;u<=i.e.c;++u)o[u]=Ht(u);for(var m=i.s.r;m<=i.e.r;++m)for(s=Qt(m),u=i.s.c;u<=i.e.c;++u)if(t=o[u]+s,n=h?(e[m]||[])[u]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=t+"="+r}return d}function Uy(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},o=0,u=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var d=typeof r.origin=="string"?Wt(r.origin):r.origin;o=d.r,u=d.c}var h,m={s:{c:0,r:0},e:{c:u,r:o+t.length-1+i}};if(s["!ref"]){var x=dt(s["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),o==-1&&(o=x.e.r+1,m.e.r=o+t.length-1+i)}else o==-1&&(o=0,m.e.r=t.length-1+i);var v=r.header||[],_=0;t.forEach(function(T,E){Kt(T).forEach(function(A){(_=v.indexOf(A))==-1&&(v[_=v.length]=A);var I=T[A],C="z",D="",M=Xe({c:u+_,r:o+E+i});h=cl(s,M),I&&typeof I=="object"&&!(I instanceof Date)?s[M]=I:(typeof I=="number"?C="n":typeof I=="boolean"?C="b":typeof I=="string"?C="s":I instanceof Date?(C="d",r.cellDates||(C="n",I=cn(I)),D=r.dateNF||Ke[14]):I===null&&r.nullError&&(C="e",I=0),h?(h.t=C,h.v=I,delete h.w,delete h.R,D&&(h.z=D)):s[M]=h={t:C,v:I},D&&(h.z=D))})}),m.e.c=Math.max(m.e.c,u+v.length-1);var k=Qt(o);if(i)for(_=0;_<v.length;++_)s[Ht(_+u)+k]={t:"s",v:v[_]};return s["!ref"]=nt(m),s}function DR(e,t){return Uy(null,e,t)}function cl(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=Wt(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?cl(e,Xe(t)):cl(e,Xe({r:t,c:n||0}))}function PR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Yd(){return{SheetNames:[],Sheets:{}}}function Zd(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=o+i)!=-1;++i);}if(_y(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function MR(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=PR(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function LR(e,t){return e.z=t,e}function zy(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function OR(e,t,n){return zy(e,"#"+t,n)}function BR(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function UR(e,t,n,r){for(var i=typeof t!="string"?t:dt(t),s=typeof t=="string"?t:nt(t),o=i.s.r;o<=i.e.r;++o)for(var u=i.s.c;u<=i.e.c;++u){var d=cl(e,o,u);d.t="n",d.F=s,delete d.v,o==i.s.r&&u==i.s.c&&(d.f=n,r&&(d.D=!0))}return e}var bu={encode_col:Ht,encode_row:Qt,encode_cell:Xe,encode_range:nt,decode_col:Ad,decode_row:Cd,split_cell:KT,decode_cell:Wt,decode_range:ar,format_cell:ki,sheet_add_aoa:dv,sheet_add_json:Uy,sheet_add_dom:Ny,aoa_to_sheet:qs,json_to_sheet:DR,table_to_sheet:Fy,table_to_book:G3,sheet_to_csv:Xd,sheet_to_txt:By,sheet_to_json:rc,sheet_to_html:Iy,sheet_to_formulae:RR,sheet_to_row_object_array:rc,sheet_get_cell:cl,book_new:Yd,book_append_sheet:Zd,book_set_sheet_visibility:MR,cell_set_number_format:LR,cell_set_hyperlink:zy,cell_set_internal_link:OR,cell_add_comment:BR,sheet_set_array_formula:UR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const zR={releases:["name","details"],roadmap:["jira","orderName","packageName","analysisHours","devITHours","devLFHours","testingHours","deploymentHours","stabilizationLFHours","totalITHoursWithBuffer","workLFHours","totalHours","comment"],backlog:["ticketId","description","foz","plannedDate","analyst","status","decision","comment"]},bR=e=>{const t=Math.floor(e-25569),n=new Date(t*86400*1e3),r=e-Math.floor(e)+1e-7;let i=Math.floor(86400*r);const s=i%60;i-=s;const o=Math.floor(i/3600),u=Math.floor(i/60)%60;return new Date(n.getFullYear(),n.getMonth(),n.getDate(),o,u,s)},VR=(e,t)=>new Promise((n,r)=>{const i=new FileReader;i.onload=s=>{var o;try{if(!((o=s.target)!=null&&o.result))return r(new Error("Nie można odczytać pliku."));const u=new Uint8Array(s.target.result),d=J0(u,{type:"array"}),h=d.SheetNames[0];if(!h)return r(new Error("Plik Excel jest pusty lub nie zawiera arkuszy."));const m=d.Sheets[h],x=bu.sheet_to_json(m,{header:1});if(x.length<2)return r(new Error("Plik Excel musi zawierać co najmniej wiersz nagłówka i jeden wiersz danych."));const v=zR[t],_=x[0].map(I=>String(I).trim()),k=v.filter(I=>!_.includes(I));if(k.length>0)return r(new Error(`Brakujące nagłówki w pliku Excel: ${k.join(", ")}.
Oczekiwano: ${v.join(", ")}`));const T=_.reduce((I,C,D)=>(I[C]=D,I),{}),A=x.slice(1).map((I,C)=>{const D={};if(v.forEach(M=>{const P=T[M];let F=I[P];if(F==null){D[M]=void 0;return}if(M.toLowerCase().includes("date")&&typeof F=="number")try{D[M]=bR(F).toISOString()}catch{D[M]=new Date(F).toISOString()}else if(M.toLowerCase().includes("date")&&typeof F=="string"){const q=new Date(F);isNaN(q.getTime())?D[M]=void 0:D[M]=q.toISOString()}else D[M]=F}),t==="releases"&&!D.name)throw new Error(`Brak wymaganej wartości 'name' w wierszu ${C+2}.`);if(t==="backlog"&&!D.description)throw new Error(`Brak wymaganej wartości 'description' w wierszu ${C+2}.`);return D});n(A)}catch(u){console.error("Błąd podczas parsowania pliku XLSX:",u),r(u)}},i.onerror=s=>{r(new Error("Nie udało się odczytać pliku."))},i.readAsArrayBuffer(e)}),R0=e=>{const{filename:t,headers:n,data:r}=e,i=n.map(m=>m.label),s=r.map(m=>n.map(x=>{const v=m[x.key];if(x.key.toString().toLowerCase().includes("date")&&v){const _=new Date(v);if(!isNaN(_.getTime()))return _}return v})),o=[i,...s],u=bu.aoa_to_sheet(o),d=i.map((m,x)=>({wch:Math.max(m.length,...s.map(v=>v[x]?String(v[x]).length:0))+2}));u["!cols"]=d;const h=bu.book_new();bu.book_append_sheet(h,u,"Dane"),IR(h,t)};var X0=(e=>(e.DELAYED_STAGE="DELAYED_STAGE",e.GO_LIVE_SHIFT="GO_LIVE_SHIFT",e))(X0||{});const HR=(e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n},WR=(e,t)=>e.reduce((n,r)=>{const i=cd.reduce((s,o)=>{const u=r.plannedTime[o]||0,d=r.actualTime[o]||0;return s+Math.max(u,d)},0);return n+i},0),GR=async()=>{const e=[],t=await S2("inProgress");for(const n of t){if(!n.id)continue;const r=await E2(n.id);r.forEach(d=>{cd.forEach(h=>{d.actualTime[h]>d.plannedTime[h]&&e.push({id:`task-${d.id}-stage-${h}-delay`,packageId:n.id,taskId:d.id,type:X0.DELAYED_STAGE,message:`Zadanie "${d.name}": Etap "${h}" jest opóźniony o ${d.actualTime[h]-d.plannedTime[h]} dni.`,timestamp:new Date().toISOString()})})});const i=new Date(n.createdAt),s=WR(r),o=HR(i,s),u=new Date(n.currentGoLiveDate);if(o.getTime()>u.getTime()){const d=Math.ceil((o.getTime()-u.getTime())/864e5);e.push({id:`package-${n.id}-golive-shift`,packageId:n.id,type:X0.GO_LIVE_SHIFT,message:`Data Go Live dla paczki "${n.name}" przesunęła się o ${d} dni. Nowa prognozowana data: ${o.toLocaleDateString()}.`,timestamp:new Date().toISOString()})}}return e},jR=7,Ou=(e,t)=>{let n=new Date(e.getTime()),r=t;for(;r>0;)n.setDate(n.getDate()-1),n.getDay()!==0&&n.getDay()!==6&&r--;return n},$R=(e,t)=>{let n=new Date(e.getTime()),r=t;for(;r>0;)n.setDate(n.getDate()+1),n.getDay()!==0&&n.getDay()!==6&&r--;return n},Bu=e=>{let t=new Date(e.getTime());do t.setDate(t.getDate()-1);while(t.getDay()===0||t.getDay()===6);return t},na=e=>!e||e<=0?0:Math.ceil(e/jR),ic=(e,t)=>{const n=na(e);return na(t)-n},ac=(e,t)=>{if(!t)return{schedule:[],overallStartDate:null,overallEndDate:null};const n=[],r=new Date(e.currentGoLiveDate);r.setHours(0,0,0,0);const i=t.stabilizationLFHours||0,s=na(i);if(s>0){const P=new Date(r),F=$R(new Date(P),s-1);n.push({key:"stabilization",name:ra.stabilization,startDate:P,stopDate:F,durationDays:s,durationHours:i})}let o=Bu(r);const u=t.deploymentHours||0,d=na(u);if(d>0){const P=new Date(o),F=Ou(new Date(P),d-1);n.push({key:"deployment",name:ra.deployment,startDate:F,stopDate:P,durationDays:d,durationHours:u}),o=Bu(F)}const h=t.testingHours||0,m=na(h);if(m>0){const P=new Date(o),F=Ou(new Date(P),m-1);n.push({key:"testing",name:ra.testing,startDate:F,stopDate:P,durationDays:m,durationHours:h}),o=Bu(F)}const x=t.devITHours||0,v=t.devLFHours||0,_=na(x),k=na(v),T=Math.max(_,k);if(T>0){const P=new Date(o),F=Ou(new Date(P),T-1);n.push({key:"development",name:`${ra.development} (IT/LF)`,startDate:F,stopDate:P,durationDays:T,itHours:x,lfHours:v}),o=Bu(F)}const E=t.analysisHours||0,A=na(E);if(A>0){const P=new Date(o),F=Ou(new Date(P),A-1);n.push({key:"analysis",name:ra.analysis,startDate:F,stopDate:P,durationDays:A,durationHours:E})}if(n.sort((P,F)=>P.startDate.getTime()-F.startDate.getTime()),n.length===0)return{schedule:[],overallStartDate:null,overallEndDate:null};const I=n.map(P=>P.startDate.getTime()),C=n.map(P=>P.stopDate.getTime()),D=new Date(Math.min(...I)),M=new Date(Math.max(...C));return{schedule:n,overallStartDate:D,overallEndDate:M}},Vt=(e,t)=>{const n={type:e,description:t,timestamp:new Date().toISOString()};return O2(n)},by="releaseManager_hourLimit",ex=100,qR=()=>{try{const e=localStorage.getItem(by);if(e){const t=parseInt(e,10);return isNaN(t)?ex:t}}catch(e){console.error("Could not read hour limit from localStorage:",e)}return ex},KR=e=>{try{typeof e=="number"&&!isNaN(e)&&localStorage.setItem(by,String(e))}catch(t){console.error("Could not save hour limit to localStorage:",t)}},qe=({children:e,variant:t="primary",size:n="md",className:r="",...i})=>{const s="rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",o={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-500 border border-gray-300",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},u={sm:"px-3 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3"};return y.jsx("button",{className:`${s} ${u[n]} ${o[t]} ${r}`,...i,children:e})},St=({label:e,className:t,...n})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),y.jsx("input",{className:`w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-gray-900 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400 read-only:bg-gray-100 read-only:cursor-not-allowed ${t||""}`,...n})]}),sr=({isOpen:e,onClose:t,title:n,children:r})=>e?y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 transition-opacity",children:y.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl m-4",onClick:i=>i.stopPropagation(),children:[y.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[y.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n}),y.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-700 text-2xl leading-none",children:"×"})]}),y.jsx("div",{className:"p-6 text-gray-700",children:r})]})}):null,mr=({label:e,children:t,...n})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),y.jsx("select",{className:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-gray-900 focus:ring-blue-500 focus:border-blue-500 transition",...n,children:t})]}),JR=({isOpen:e,onClose:t,onSave:n,releases:r,targetReleaseId:i})=>{const[s,o]=pe.useState(""),[u,d]=pe.useState(""),[h,m]=pe.useState("");pe.useEffect(()=>{e&&(o(""),m(""),d(i?String(i):""))},[e,i]);const x=()=>{if(s.trim()&&h){const v=u===""?null:Number(u);n(v,s,new Date(h).toISOString()),t()}};return y.jsx(sr,{isOpen:e,onClose:t,title:"Dodaj nową paczkę releasową",children:y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(St,{label:"Nazwa paczki",value:s,onChange:v=>o(v.target.value),placeholder:"np. Paczka Q3 2024",required:!0}),y.jsxs(mr,{label:"Wydanie (opcjonalnie)",value:u,onChange:v=>d(v.target.value),disabled:r.length===0,children:[y.jsx("option",{value:"",children:"(Brak przypisania)"}),r.map(v=>y.jsx("option",{value:v.id,children:v.name},v.id))]})]}),y.jsx(St,{label:"Data Go-Live",type:"date",value:h,onChange:v=>m(v.target.value),required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:x,disabled:!s||!h,children:"Zapisz paczkę"})]})]})})},Ei=({label:e,...t})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),y.jsx("textarea",{className:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-gray-900 focus:ring-blue-500 focus:border-blue-500 transition placeholder-gray-400",rows:3,...t})]}),XR=({isOpen:e,onClose:t,onSave:n})=>{const[r,i]=pe.useState(""),[s,o]=pe.useState(""),u=()=>{r.trim()&&s.trim()&&(n(r,s),i(""),o(""),t())};return y.jsx(sr,{isOpen:e,onClose:t,title:"Dodaj nowe wydanie",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(St,{label:"Nazwa wydania",value:r,onChange:d=>i(d.target.value),placeholder:"np. Q4 2024"}),y.jsx(Ei,{label:"Szczegóły wydania",value:s,onChange:d=>o(d.target.value),placeholder:"np. Zmiany DPD, Formalno-prawne, tylko NSKM, lub SAP",required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:u,disabled:!r.trim()||!s.trim(),children:"Zapisz wydanie"})]})]})})},YR=({isOpen:e,onClose:t,onSave:n,releaseToEdit:r})=>{const[i,s]=pe.useState(""),[o,u]=pe.useState("");pe.useEffect(()=>{r&&(s(r.name),u(r.details||""))},[r]);const d=()=>{if(i.trim()&&o.trim()&&r){const h={...r,name:i,details:o};n(h),t()}};return r?y.jsx(sr,{isOpen:e,onClose:t,title:"Edytuj wydanie",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(St,{label:"Nazwa wydania",value:i,onChange:h=>s(h.target.value),placeholder:"np. Q4 2024"}),y.jsx(Ei,{label:"Szczegóły wydania",value:o,onChange:h=>u(h.target.value),placeholder:"np. Zmiany DPD, Formalno-prawne, tylko NSKM, lub SAP",required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:d,disabled:!i.trim()||!o.trim(),children:"Zapisz zmiany"})]})]})}):null},ZR=({isOpen:e,onClose:t,onSave:n,packageToEdit:r,releases:i,roadmapItems:s,releaseHourLimit:o})=>{const[u,d]=pe.useState(""),[h,m]=pe.useState("planning"),[x,v]=pe.useState(""),[_,k]=pe.useState(""),T=pe.useMemo(()=>{if(!r)return[];const A=s.filter(M=>M.packageName===r.name).reduce((M,P)=>M+(P.totalHours||0),0),I=s.some(M=>M.packageName===r.name),C=Gu.indexOf(r.status),D=["ready","inProgress","completed"];return Gu.filter((M,P)=>M===r.status||P<C?!0:P===C+1?!(D.includes(M)&&(!I||M==="ready"&&A<o)):!1)},[r,s,o]);pe.useEffect(()=>{r&&(d(r.name),m(r.status),v(r.releaseId===null?"":String(r.releaseId)),k(new Date(r.currentGoLiveDate).toISOString().split("T")[0]))},[r]);const E=()=>{if(u.trim()&&r){const A={...r,name:u,status:h,releaseId:x===""?null:Number(x),currentGoLiveDate:new Date(_).toISOString()};n(A)}};return r?y.jsx(sr,{isOpen:e,onClose:t,title:"Edytuj paczkę",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(St,{label:"Nazwa paczki",value:u,onChange:A=>d(A.target.value),placeholder:"np. Paczka Q3 2024"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(mr,{label:"Status paczki",value:h,onChange:A=>m(A.target.value),children:T.map(A=>y.jsx("option",{value:A,children:wi[A]},A))}),y.jsxs(mr,{label:"Wydanie",value:x,onChange:A=>v(A.target.value),children:[y.jsx("option",{value:"",children:"(Brak wydania)"}),i.map(A=>y.jsx("option",{value:A.id,children:A.name},A.id))]})]}),y.jsx(St,{label:"Prognozowane Go-Live",type:"date",value:_,onChange:A=>k(A.target.value)}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:E,children:"Zapisz zmiany"})]})]})}):null},On=({children:e,className:t=""})=>y.jsx("div",{className:`bg-white border border-gray-200 rounded-lg shadow-sm p-6 ${t}`,children:e}),QR=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),Qd=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),eD=({packages:e,releases:t,backlogItems:n,roadmapItems:r,alerts:i,setView:s})=>{const o=e.reduce((m,x)=>(m[x.status]=(m[x.status]||0)+1,m),{}),u=o.inProgress||0,d=e.length,h=({title:m,value:x,description:v,onClick:_})=>y.jsxs("div",{className:`bg-gray-50 p-4 rounded-lg flex-1 transition-colors ${_?"cursor-pointer hover:bg-gray-100":""}`,onClick:_,children:[y.jsx("p",{className:"text-sm text-gray-500",children:m}),y.jsx("p",{className:"text-3xl font-bold text-gray-900",children:x}),y.jsx("p",{className:"text-xs text-gray-500",children:v})]});return y.jsxs("div",{className:"h-full overflow-y-auto",children:[y.jsxs("div",{className:"mb-8",children:[y.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Pulpit"}),y.jsx("p",{className:"text-gray-500 mt-1",children:"Oto przegląd bieżącego stanu prac i kluczowych wskaźników."})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[y.jsxs(On,{className:"lg:col-span-4",children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-900",children:"W skrócie"}),y.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[y.jsx(h,{title:"Aktywne Wydania",value:t.length,description:"Wszystkie zdefiniowane wydania",onClick:()=>s("releases")}),y.jsx(h,{title:"Paczki w toku",value:u,description:`z ${d} wszystkich paczek`,onClick:()=>s("releases")}),y.jsx(h,{title:"Elementy w Backlogu",value:n.length,description:"Oczekujące na analizę i decyzję",onClick:()=>s("backlog")}),y.jsx(h,{title:"Pozycje na Roadmapie",value:r.length,description:"Zaplanowane prace i estymacje",onClick:()=>s("roadmap")})]})]}),y.jsxs(On,{className:`lg:col-span-3 ${i.length>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}`,children:[y.jsxs("div",{className:"flex items-center mb-4",children:[i.length>0?y.jsx(QR,{className:"w-6 h-6 mr-3 text-yellow-500 flex-shrink-0"}):y.jsx(Qd,{className:"w-6 h-6 mr-3 text-green-500 flex-shrink-0"}),y.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Powiadomienia i Alerty"})]}),i.length>0?y.jsxs("ul",{className:"space-y-2 max-h-40 overflow-y-auto",children:[i.slice(0,5).map(m=>y.jsx("li",{className:"text-sm text-gray-700 bg-white/50 p-2 rounded-md border border-gray-200",children:m.message},m.id)),i.length>5&&y.jsxs("li",{className:"text-xs text-center text-gray-500 pt-2",children:["... i ",i.length-5," więcej."]})]}):y.jsx("p",{className:"text-gray-500",children:"Brak alertów. Wszystko jest w porządku!"})]}),y.jsxs(On,{className:"lg:col-span-1",children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-900",children:"Status Paczek"}),y.jsxs("div",{className:"space-y-3",children:[(Object.keys(o).length>0?Gu:[]).map(m=>{const x=o[m]||0;if(x===0&&m!=="inProgress")return null;const v=d>0?x/d*100:0;return y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[y.jsx("span",{className:"text-sm font-medium text-gray-600",children:wi[m]}),y.jsx("span",{className:"text-sm font-semibold text-gray-900",children:x})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:y.jsx("div",{className:`${E1[m].split(" ")[0]} h-2 rounded-full`,style:{width:`${v}%`}})})]},m)}),d===0&&y.jsx("p",{className:"text-gray-500 text-sm",children:"Brak paczek do wyświetlenia."})]})]}),y.jsxs(On,{className:"lg:col-span-2",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Ostatnie w Backlogu"}),y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>s("backlog"),children:"Zobacz cały"})]}),n.length>0?y.jsx("ul",{className:"space-y-2",children:n.slice(-4).reverse().map(m=>y.jsxs("li",{className:"flex justify-between items-center p-2 bg-gray-50 rounded-md transition hover:bg-gray-100 border border-gray-200",children:[y.jsx("span",{className:"truncate pr-4 text-gray-700",title:m.description,children:m.description||"Brak opisu"}),y.jsx("span",{className:"text-xs text-gray-600 flex-shrink-0 px-2 py-1 bg-gray-200 rounded",children:m.status||"Brak statusu"})]},m.internalId))}):y.jsx("p",{className:"text-gray-500",children:"Backlog jest pusty."})]}),y.jsxs(On,{className:"lg:col-span-2",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Ostatnie na Roadmapie"}),y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>s("roadmap"),children:"Zobacz całą"})]}),r.length>0?y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-sm",children:[y.jsx("thead",{className:"text-left text-gray-500",children:y.jsxs("tr",{className:"border-b border-gray-200",children:[y.jsx("th",{className:"p-2 font-semibold",children:"Jira"}),y.jsx("th",{className:"p-2 font-semibold",children:"Nazwa"}),y.jsx("th",{className:"p-2 font-semibold",children:"Paczka"}),y.jsx("th",{className:"p-2 font-semibold text-right",children:"Suma (h)"})]})}),y.jsx("tbody",{children:r.slice(-4).reverse().map(m=>y.jsxs("tr",{className:"border-b border-gray-100 last:border-0 hover:bg-gray-50",children:[y.jsx("td",{className:"p-2 font-semibold text-gray-800",children:m.jira||"-"}),y.jsx("td",{className:"p-2 truncate text-gray-700",title:m.orderName,children:m.orderName||"Brak nazwy"}),y.jsx("td",{className:"p-2 text-gray-500",children:m.packageName||"Brak paczki"}),y.jsxs("td",{className:"p-2 text-right font-bold text-gray-800",children:[m.totalHours||"0","h"]})]},m.id))})]})}):y.jsx("p",{className:"text-gray-500",children:"Roadmapa jest pusta."})]})]})]})},yl=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),wl=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 19.07a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.862 4.487zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),_l=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),_c=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),tD=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.572a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})}),Us=({options:e,selectedOptions:t,onSelectionChange:n,title:r})=>{const[i,s]=pe.useState(!1),o=pe.useRef(null);pe.useEffect(()=>{const x=v=>{o.current&&!o.current.contains(v.target)&&s(!1)};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[o]);const u=x=>{const v=t.includes(x)?t.filter(_=>_!==x):[...t,x];n(v)},d=()=>{t.length===e.length?n([]):n([...e])},h=()=>{n([])},m=t.length>0;return y.jsxs("div",{ref:o,className:"relative inline-block ml-2",children:[y.jsx("button",{onClick:()=>s(!i),className:"p-1 rounded-md hover:bg-gray-200",children:y.jsx(tD,{className:`w-5 h-5 transition-colors ${m?"text-blue-600":"text-gray-500 hover:text-gray-700"}`})}),i&&y.jsx("div",{className:"absolute z-20 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-xl right-0 origin-top-right",children:y.jsxs("div",{className:"p-3",children:[y.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:r}),y.jsxs("div",{className:"flex justify-between items-center mb-2",children:[y.jsx("button",{onClick:d,className:"text-xs text-blue-600 hover:underline",children:t.length===e.length?"Odznacz wszystko":"Zaznacz wszystko"}),y.jsx("button",{onClick:h,disabled:!m,className:"text-xs text-red-600 hover:underline disabled:opacity-50 disabled:cursor-not-allowed",children:"Wyczyść"})]}),y.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1 pr-2",children:e.map(x=>y.jsxs("label",{className:"flex items-center p-1 rounded-md hover:bg-gray-100 cursor-pointer",children:[y.jsx("input",{type:"checkbox",checked:t.includes(x),onChange:()=>u(x),className:"h-4 w-4 rounded bg-gray-100 border-gray-300 text-blue-600 focus:ring-blue-500"}),y.jsx("span",{className:"ml-3 text-sm text-gray-700 truncate",children:x})]},x))})]})})]})},Vy=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})}),Hy=({pkg:e,ordersCount:t,totalHoursSum:n,totalItHours:r,totalLfHours:i,hourLimit:s,onEdit:o,onDelete:u,onOpenApproveModal:d,onStartRealization:h})=>{const m=wi[e.status],x=E1[e.status],v=e.status==="ready"&&!e.isScheduleApproved,_=e.status==="ready"&&e.isScheduleApproved,k=s>0?Math.min(n/s*100,100):0,T=n>s,E=T?"bg-red-500":"bg-green-500";return y.jsxs("div",{className:`bg-white border ${v?"border-yellow-300":"border-gray-200"} rounded-lg transition-shadow hover:shadow-md`,children:[y.jsxs("div",{className:"p-3",children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{className:"flex-grow min-w-0",children:[y.jsx("p",{className:"font-bold text-gray-800 truncate",children:e.name}),y.jsxs("div",{className:"flex items-center mt-1 flex-wrap gap-x-3 gap-y-1",children:[y.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${x}`,children:m}),y.jsxs("span",{className:"text-xs text-gray-500",children:[t," zleceń"]}),y.jsxs("span",{className:"text-xs text-gray-500 font-semibold",children:["IT: ",y.jsxs("span",{className:"font-bold text-gray-700",children:[r,"h"]})]}),y.jsxs("span",{className:"text-xs text-gray-500 font-semibold",children:["LF: ",y.jsxs("span",{className:"font-bold text-gray-700",children:[i,"h"]})]}),e.isScheduleApproved&&y.jsxs("span",{className:"flex items-center text-xs text-green-600 font-semibold",title:`Zatwierdzony przez ${e.scheduleApprover} dnia ${new Date(e.scheduleApprovedAt).toLocaleDateString()}`,children:[y.jsx(Qd,{className:"w-4 h-4 mr-1"}),"Harmonogram Zatwierdzony"]})]})]}),y.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 ml-4",children:[_&&y.jsx(qe,{size:"sm",onClick:()=>h(e.id),className:"bg-green-600 hover:bg-green-700",children:"Rozpocznij realizację"}),y.jsx(qe,{size:"sm",variant:"secondary",onClick:()=>o(e),title:"Edytuj paczkę",children:y.jsx(wl,{className:"w-4 h-4"})}),y.jsx(qe,{size:"sm",variant:"danger",onClick:()=>u(e.id),title:"Usuń paczkę",children:y.jsx(_l,{className:"w-4 h-4"})})]})]}),s>0&&(e.status==="todo"||e.status==="planning")&&y.jsxs("div",{className:"mt-3",children:[y.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[y.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Postęp do progu gotowości"}),y.jsxs("span",{className:`text-xs font-semibold ${T?"text-red-600":"text-gray-700"}`,children:[n," / ",s,"h"]})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:y.jsx("div",{className:`${E} h-2 rounded-full transition-all duration-500`,style:{width:`${k}%`}})})]})]}),v&&y.jsxs("div",{className:"bg-yellow-50 border-t border-yellow-200 px-3 py-4",children:[y.jsx("h4",{className:"font-semibold text-yellow-800",children:"Oczekiwanie na akceptację"}),y.jsx("p",{className:"text-sm text-yellow-700 mt-1 mb-3",children:'Harmonogram bazowy został utworzony. Zatwierdź go, aby umożliwić rozpoczęcie prac i zmianę statusu na "W realizacji".'}),y.jsx(qe,{size:"sm",onClick:()=>d(e),className:"bg-yellow-400 hover:bg-yellow-500 text-yellow-900 font-semibold",children:"Podejrzyj i zatwierdź harmonogram"})]})]})},nD=({release:e,packages:t,hourLimit:n,onAddPackage:r,onEditRelease:i,onDeleteRelease:s,onEditPackage:o,onDeletePackage:u,onOpenApproveModal:d,onStartRealization:h})=>{const[m,x]=pe.useState(!0);return y.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg mb-4",children:[y.jsxs("div",{className:"flex justify-between items-center p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>x(!m),children:[y.jsxs("div",{className:"flex items-center flex-grow min-w-0",children:[y.jsx(Vy,{className:`w-5 h-5 mr-3 text-gray-500 transition-transform flex-shrink-0 ${m?"":"transform -rotate-90"}`}),y.jsxs("div",{className:"flex-grow min-w-0",children:[y.jsx("h3",{className:"text-xl font-bold text-gray-800 truncate",title:e.name,children:e.name}),y.jsx("p",{className:"text-sm text-gray-500 mt-1 truncate",title:e.details,children:e.details})]}),y.jsxs("span",{className:"ml-3 bg-gray-200 text-gray-700 text-xs font-semibold px-2 py-1 rounded-full flex-shrink-0",children:[t.length," pacz."]})]}),y.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 pl-4",onClick:v=>v.stopPropagation(),children:[y.jsxs(qe,{size:"sm",variant:"secondary",onClick:()=>r(e.id),children:[y.jsx(yl,{className:"w-4 h-4 mr-1"})," Dodaj paczkę"]}),y.jsx(qe,{size:"sm",variant:"secondary",onClick:()=>i(e),title:"Edytuj wydanie",children:y.jsx(wl,{className:"w-4 h-4"})}),y.jsx(qe,{size:"sm",variant:"danger",onClick:()=>s(e.id),title:"Usuń wydanie",children:y.jsx(_l,{className:"w-4 h-4"})})]})]}),m&&y.jsx("div",{className:"p-4 border-t border-gray-200 space-y-3",children:t.length>0?t.map(v=>y.jsx(Hy,{pkg:v,ordersCount:v.ordersCount,totalHoursSum:v.totalHoursSum,totalItHours:v.totalItHours,totalLfHours:v.totalLfHours,hourLimit:n,onEdit:o,onDelete:u,onOpenApproveModal:d,onStartRealization:h},v.id)):y.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Brak paczek w tym wydaniu."})})]})},rD=e=>{const{releases:t,packages:n,roadmapItems:r,onAddRelease:i,releaseHourLimit:s,onSaveHourLimit:o,...u}=e,[d,h]=pe.useState(""),[m,x]=pe.useState([]),[v,_]=pe.useState(s),k=pe.useMemo(()=>Gu.map(P=>wi[P]),[]),T=pe.useMemo(()=>wi,[]),E=pe.useMemo(()=>Object.entries(wi).reduce((P,[F,q])=>(P[q]=F,P),{}),[]),A=P=>{const F=P.map(q=>E[q]);x(F)},I=pe.useMemo(()=>n.map(P=>{const F=r.filter(Q=>Q.packageName===P.name),q=F.reduce((Q,Y)=>Q+(Y.totalHours||0),0),z=F.reduce((Q,Y)=>Q+(Y.analysisHours||0)+(Y.devITHours||0)+(Y.testingHours||0)+(Y.deploymentHours||0),0),te=F.reduce((Q,Y)=>Q+(Y.workLFHours||0),0);return{...P,ordersCount:F.length,totalHoursSum:q,totalItHours:z,totalLfHours:te}}),[n,r]),C=pe.useMemo(()=>{let P=[...I];m.length>0&&(P=P.filter(q=>m.includes(q.status)));const F=d.toLowerCase();return F&&(P=P.filter(q=>q.name.toLowerCase().includes(F))),P},[I,d,m]),D=pe.useMemo(()=>C.filter(P=>P.releaseId===null),[C]),M=pe.useMemo(()=>C.reduce((P,F)=>(F.releaseId&&(P[F.releaseId]||(P[F.releaseId]=[]),P[F.releaseId].push(F)),P),{}),[C]);return y.jsxs("div",{className:"h-full flex flex-col overflow-y-auto",children:[y.jsx(On,{className:"mb-6 flex-shrink-0",children:y.jsxs("div",{className:"flex items-center gap-6",children:[y.jsxs("div",{className:"flex-grow",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Próg Gotowości Paczki"}),y.jsx("p",{className:"text-sm text-gray-500",children:'Ustaw minimalną sumę godzin wszystkich zleceń w paczce, po której osiągnięciu będzie można zmienić jej status na "Gotowa do realizacji".'})]}),y.jsxs("div",{className:"flex items-center gap-2 w-48",children:[y.jsx(St,{label:"",type:"number",value:v,onChange:P=>_(Number(P.target.value)),className:"text-center font-bold"}),y.jsx(qe,{size:"md",onClick:()=>o(v),children:"Zapisz"})]})]})}),y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4 flex-shrink-0",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Zarządzanie Wydaniami"}),y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(_c,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Filtruj paczki po nazwie...",value:d,onChange:P=>h(P.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsx(Us,{title:"Filtruj po statusie",options:k,selectedOptions:m.map(P=>T[P]),onSelectionChange:A}),y.jsxs(qe,{onClick:i,children:[y.jsx(yl,{className:"w-5 h-5 mr-2 inline"}),"Nowe Wydanie"]})]})]}),y.jsxs("div",{className:"flex-grow",children:[D.length>0&&y.jsxs("div",{className:"mb-8 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-700",children:"Paczki bez przypisania"}),y.jsx("div",{className:"space-y-3",children:D.map(P=>y.jsx(Hy,{pkg:P,ordersCount:P.ordersCount,totalHoursSum:P.totalHoursSum,totalItHours:P.totalItHours,totalLfHours:P.totalLfHours,hourLimit:s,onEdit:u.onEditPackage,onDelete:u.onDeletePackage,onOpenApproveModal:u.onOpenApproveModal,onStartRealization:u.onStartRealization},P.id))})]}),y.jsx("div",{children:t.map(P=>{const F=M[P.id]||[];return F.length===0&&(d||m.length>0)?null:y.jsx(nD,{release:P,packages:F,hourLimit:s,...u},P.id)})}),t.length===0&&D.length===0&&y.jsxs("div",{className:"text-center py-16 text-gray-500",children:[y.jsx("p",{children:"Brak wydań i paczek."}),y.jsx("p",{children:"Zacznij od dodania nowego wydania."})]})]})]})},Wy=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"})}),Gy=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})}),jy=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5L7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})}),iD=({items:e,onAddItem:t,onEditItem:n,onDeleteItem:r,onAddToRoadmap:i})=>{const[s,o]=pe.useState(""),[u,d]=pe.useState([]),[h,m]=pe.useState([]),[x,v]=pe.useState([]),[_,k]=pe.useState({key:"internalId",direction:"descending"}),T=pe.useMemo(()=>{let C=[...e];u.length>0&&(C=C.filter(M=>M.status&&u.includes(M.status))),h.length>0&&(C=C.filter(M=>M.foz&&h.includes(M.foz))),x.length>0&&(C=C.filter(M=>M.decision&&x.includes(M.decision)));const D=s.toLowerCase();return D&&(C=C.filter(M=>{var P,F,q,z,te,Q;return((P=M.ticketId)==null?void 0:P.toLowerCase().includes(D))||M.description.toLowerCase().includes(D)||((F=M.foz)==null?void 0:F.toLowerCase().includes(D))||((q=M.analyst)==null?void 0:q.toLowerCase().includes(D))||((z=M.status)==null?void 0:z.toLowerCase().includes(D))||((te=M.decision)==null?void 0:te.toLowerCase().includes(D))||((Q=M.comment)==null?void 0:Q.toLowerCase().includes(D))})),_!==null&&C.sort((M,P)=>{const F=M[_.key],q=P[_.key];if(F==null&&q==null)return 0;if(F==null)return 1;if(q==null)return-1;let z=0;return _.key==="plannedDate"?z=new Date(F).getTime()-new Date(q).getTime():_.key==="internalId"?z=F-q:typeof F=="string"&&typeof q=="string"?z=F.localeCompare(q):(F<q&&(z=-1),F>q&&(z=1)),_.direction==="ascending"?z:-z}),C},[e,s,_,u,h,x]),E=C=>{let D="ascending";_&&_.key===C&&_.direction==="ascending"&&(D="descending"),k({key:C,direction:D})},A=C=>!_||_.key!==C?y.jsx(jy,{className:"w-4 h-4 ml-1 text-gray-400 group-hover:text-gray-600"}):_.direction==="ascending"?y.jsx(Wy,{className:"w-4 h-4 ml-1 text-blue-600"}):y.jsx(Gy,{className:"w-4 h-4 ml-1 text-blue-600"}),I=({sortKey:C,children:D,filterComponent:M})=>y.jsx("th",{className:"p-2 text-left",children:y.jsxs("div",{className:"flex items-center",children:[y.jsxs("button",{onClick:()=>E(C),className:"group flex items-center font-semibold text-gray-600 hover:text-gray-900 transition-colors",children:[D,A(C)]}),M]})});return y.jsx("div",{className:"h-full overflow-y-auto",children:y.jsxs(On,{className:"h-full flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Backlog"}),y.jsxs("div",{className:"flex items-center gap-4 flex-grow justify-end",children:[y.jsxs("div",{className:"relative flex-grow max-w-xs",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(_c,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Wyszukaj w backlogu...",value:s,onChange:C=>o(C.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsxs(qe,{onClick:t,children:[y.jsx(yl,{className:"w-5 h-5 mr-2 inline"}),"Dodaj wpis"]})]})]}),y.jsx("div",{className:"overflow-x-auto flex-grow",children:y.jsxs("table",{className:"min-w-full text-sm",children:[y.jsx("thead",{className:"text-left bg-gray-50 sticky top-0",children:y.jsxs("tr",{children:[y.jsx(I,{sortKey:"ticketId",children:"ID Zgłoszenia"}),y.jsx(I,{sortKey:"description",children:"Opis"}),y.jsx(I,{sortKey:"foz",filterComponent:y.jsx(Us,{title:"Filtruj FOZ",options:A1,selectedOptions:h,onSelectionChange:C=>m(C)}),children:"FOZ"}),y.jsx(I,{sortKey:"plannedDate",children:"Data"}),y.jsx(I,{sortKey:"analyst",children:"Analityk"}),y.jsx(I,{sortKey:"status",filterComponent:y.jsx(Us,{title:"Filtruj Status",options:I1,selectedOptions:u,onSelectionChange:C=>d(C)}),children:"Status"}),y.jsx(I,{sortKey:"decision",filterComponent:y.jsx(Us,{title:"Filtruj Decyzję",options:N1,selectedOptions:x,onSelectionChange:C=>v(C)}),children:"Decyzja"}),y.jsx("th",{className:"p-2 font-semibold text-gray-600 text-left",children:"Komentarz"}),y.jsx("th",{className:"p-2 text-right font-semibold text-gray-600",children:"Akcje"})]})}),y.jsx("tbody",{children:T.map(C=>y.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-200",children:[y.jsx("td",{className:"p-2 font-medium text-gray-800",children:C.ticketId||"-"}),y.jsx("td",{className:"p-2 whitespace-pre-wrap text-gray-700",children:C.description}),y.jsx("td",{className:"p-2 text-gray-700",children:C.foz}),y.jsx("td",{className:"p-2 whitespace-nowrap text-gray-700",children:C.plannedDate?new Date(C.plannedDate).toLocaleDateString("pl-PL"):""}),y.jsx("td",{className:"p-2 text-gray-700",children:C.analyst}),y.jsx("td",{className:"p-2",children:C.status&&y.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full leading-tight ${x2[C.status]||"bg-gray-100 text-gray-800"}`,children:C.status})}),y.jsx("td",{className:"p-2",children:C.decision&&y.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full leading-tight ${v2[C.decision]||"bg-gray-100 text-gray-800"}`,children:C.decision})}),y.jsx("td",{className:"p-2 whitespace-pre-wrap text-gray-700",children:C.comment}),y.jsx("td",{className:"p-2 text-right",children:y.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[C.decision==="GO"&&y.jsx(qe,{variant:"primary",size:"sm",onClick:()=>i(C),title:"Dodaj do roadmapy",className:"bg-green-600 hover:bg-green-700 focus:ring-green-500",children:"Dodaj do roadmapy"}),y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>n(C),title:"Edytuj wpis",children:y.jsx(wl,{className:"w-4 h-4"})}),y.jsx(qe,{variant:"danger",size:"sm",onClick:()=>r(C.internalId),title:"Usuń wpis",children:y.jsx(_l,{className:"w-4 h-4"})})]})})]},C.internalId))})]})}),T.length===0&&y.jsx("div",{className:"text-center py-10 text-gray-500",children:s||u.length>0||h.length>0||x.length>0?y.jsx("p",{children:"Nie znaleziono wpisów pasujących do wybranych kryteriów."}):y.jsxs(y.Fragment,{children:[y.jsx("p",{children:"Brak wpisów w backlogu."}),y.jsx("p",{children:"Zacznij od dodania nowego wpisu."})]})})]})})},aD=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z"})}),sD=({item:e,onOpenReEstimation:t,onOpenWithdrawal:n})=>{const[r,i]=pe.useState(!1),s=P0.useRef(null);return P0.useEffect(()=>{const o=u=>{s.current&&!s.current.contains(u.target)&&i(!1)};return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[s]),y.jsxs("div",{className:"relative",ref:s,children:[y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>i(!r),title:"Akcje",children:y.jsx(aD,{className:"w-4 h-4"})}),r&&y.jsx("div",{className:"absolute z-10 right-0 mt-2 w-56 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:y.jsxs("div",{className:"py-1",children:[y.jsx("button",{onClick:()=>{t(e),i(!1)},className:"w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Wniosek o zmianę estymat"}),y.jsx("button",{onClick:()=>{n(e),i(!1)},className:"w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Wniosek o wycofanie z wersji"})]})})]})},oD=({items:e,packages:t,onAddItem:n,onEditItem:r,onDeleteItem:i,onOpenReEstimationModal:s,onOpenWithdrawalModal:o})=>{const[u,d]=pe.useState(""),[h,m]=pe.useState([]),[x,v]=pe.useState({key:"id",direction:"descending"}),_=pe.useMemo(()=>{const I=new Set(e.map(C=>C.packageName).filter(Boolean));return Array.from(I).sort()},[e]),k=pe.useMemo(()=>{let I=[...e];h.length>0&&(I=I.filter(D=>D.packageName&&h.includes(D.packageName)));const C=u.toLowerCase();return C&&(I=I.filter(D=>{var M,P,F,q;return String(D.id||"").toLowerCase().includes(C)||((M=D.jira)==null?void 0:M.toLowerCase().includes(C))||((P=D.orderName)==null?void 0:P.toLowerCase().includes(C))||((F=D.packageName)==null?void 0:F.toLowerCase().includes(C))||((q=D.comment)==null?void 0:q.toLowerCase().includes(C))})),x!==null&&I.sort((D,M)=>{const P=D[x.key],F=M[x.key];if(P==null&&F==null)return 0;if(P==null)return 1;if(F==null)return-1;let q=0;return typeof P=="number"&&typeof F=="number"?q=P-F:typeof P=="string"&&typeof F=="string"?q=P.localeCompare(F):(P<F&&(q=-1),P>F&&(q=1)),x.direction==="ascending"?q:-q}),I},[e,u,x,h]),T=I=>{let C="ascending";x&&x.key===I&&x.direction==="ascending"&&(C="descending"),v({key:I,direction:C})},E=I=>!x||x.key!==I?y.jsx(jy,{className:"w-4 h-4 ml-1 text-gray-400 group-hover:text-gray-600"}):x.direction==="ascending"?y.jsx(Wy,{className:"w-4 h-4 ml-1 text-blue-600"}):y.jsx(Gy,{className:"w-4 h-4 ml-1 text-blue-600"}),A=({sortKey:I,children:C,filterComponent:D})=>y.jsx("th",{className:"p-2 text-left",children:y.jsxs("div",{className:"flex items-center",children:[y.jsxs("button",{onClick:()=>T(I),className:"group flex items-center font-semibold text-gray-600 hover:text-gray-900 transition-colors",children:[C,E(I)]}),D]})});return y.jsx("div",{className:"h-full overflow-y-auto",children:y.jsxs(On,{className:"h-full flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Roadmapa"}),y.jsxs("div",{className:"flex items-center gap-4 flex-grow justify-end",children:[y.jsxs("div",{className:"relative flex-grow max-w-xs",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(_c,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Wyszukaj w roadmapie...",value:u,onChange:I=>d(I.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsxs(qe,{onClick:n,children:[y.jsx(yl,{className:"w-5 h-5 mr-2 inline"}),"Dodaj wpis"]})]})]}),y.jsx("div",{className:"overflow-x-auto flex-grow",children:y.jsxs("table",{className:"min-w-full text-sm whitespace-nowrap",children:[y.jsx("thead",{className:"text-left bg-gray-50 sticky top-0",children:y.jsxs("tr",{children:[y.jsx(A,{sortKey:"id",children:"ID"}),y.jsx(A,{sortKey:"jira",children:"Jira"}),y.jsx(A,{sortKey:"orderName",children:"Nazwa Zlecenia"}),y.jsx(A,{sortKey:"packageName",filterComponent:y.jsx(Us,{title:"Filtruj po paczce",options:_,selectedOptions:h,onSelectionChange:m}),children:"Paczka"}),y.jsx(A,{sortKey:"analysisHours",children:"Analiza (h)"}),y.jsx(A,{sortKey:"devITHours",children:"PROGR. IT (h)"}),y.jsx(A,{sortKey:"devLFHours",children:"PROGR. LF (h)"}),y.jsx(A,{sortKey:"testingHours",children:"Testy (h)"}),y.jsx(A,{sortKey:"deploymentHours",children:"Wdrożenie (h)"}),y.jsx(A,{sortKey:"stabilizationLFHours",children:"STAB. LF (h)"}),y.jsx(A,{sortKey:"totalITHoursWithBuffer",children:"CZAS. IT+Buff (h)"}),y.jsx(A,{sortKey:"workLFHours",children:"PRACE LF (h)"}),y.jsx(A,{sortKey:"totalHours",children:"Suma (h)"}),y.jsx("th",{className:"p-2 font-semibold text-gray-600 text-left",children:"Komentarz"}),y.jsx("th",{className:"p-2 text-right font-semibold text-gray-600",children:"Akcje"})]})}),y.jsx("tbody",{children:k.map(I=>{const C=t.find(M=>M.name===I.packageName),D=C&&(C.status==="inProgress"||C.status==="completed");return y.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-200",children:[y.jsx("td",{className:"p-2 font-medium",children:I.id}),y.jsx("td",{className:"p-2",children:I.jira}),y.jsx("td",{className:"p-2",children:I.orderName}),y.jsx("td",{className:"p-2",children:I.packageName}),y.jsx("td",{className:"p-2",children:I.analysisHours}),y.jsx("td",{className:"p-2",children:I.devITHours}),y.jsx("td",{className:"p-2",children:I.devLFHours}),y.jsx("td",{className:"p-2",children:I.testingHours}),y.jsx("td",{className:"p-2",children:I.deploymentHours}),y.jsx("td",{className:"p-2",children:I.stabilizationLFHours}),y.jsx("td",{className:"p-2",children:I.totalITHoursWithBuffer}),y.jsx("td",{className:"p-2",children:I.workLFHours}),y.jsx("td",{className:"p-2",children:I.totalHours}),y.jsx("td",{className:"p-2 whitespace-pre-wrap",children:I.comment}),y.jsx("td",{className:"p-2 text-right",children:y.jsx("div",{className:"flex items-center justify-end space-x-2",children:D?y.jsx(sD,{item:I,onOpenReEstimation:s,onOpenWithdrawal:o}):y.jsxs(y.Fragment,{children:[y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>r(I),title:"Edytuj wpis",children:y.jsx(wl,{className:"w-4 h-4"})}),y.jsx(qe,{variant:"danger",size:"sm",onClick:()=>i(I.id),title:"Usuń wpis",children:y.jsx(_l,{className:"w-4 h-4"})})]})})})]},I.id)})})]})}),k.length===0&&y.jsx("div",{className:"text-center py-10 text-gray-500",children:u||h.length>0?y.jsx("p",{children:"Nie znaleziono wpisów pasujących do wybranych kryteriów."}):y.jsxs(y.Fragment,{children:[y.jsx("p",{children:"Brak wpisów w roadmapie."}),y.jsx("p",{children:"Zacznij od dodania nowego wpisu."})]})})]})})},tx=()=>({description:"",status:"Nowy",ticketId:""}),lD=({isOpen:e,onClose:t,onSave:n,itemToEdit:r})=>{var d;const[i,s]=pe.useState(tx());pe.useEffect(()=>{if(e)if(r){const h=r.plannedDate?new Date(r.plannedDate).toISOString().slice(0,10):"";s({...r,plannedDate:h})}else s(tx())},[r,e]);const o=(h,m)=>{s(x=>({...x,[h]:m}))},u=()=>{var m;if(!((m=i.description)!=null&&m.trim())){alert('Pole "Opis" jest wymagane.');return}const h={...i,plannedDate:i.plannedDate?new Date(i.plannedDate).toISOString():void 0};n(h)};return y.jsx(sr,{isOpen:e,onClose:t,title:r?"Edytuj wpis w backlogu":"Dodaj wpis do backlogu",children:y.jsxs("div",{className:"space-y-4",children:[y.jsx(St,{label:"ID Zgłoszenia (opcjonalne)",type:"text",value:i.ticketId||"",onChange:h=>o("ticketId",h.target.value),placeholder:"np. JIRA-123"}),y.jsx(Ei,{label:"Opis (wymagane)",value:i.description||"",onChange:h=>o("description",h.target.value),required:!0,rows:4}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(mr,{label:"FOZ",value:i.foz||"brak",onChange:h=>o("foz",h.target.value),children:A1.map(h=>y.jsx("option",{value:h,children:h},h))}),y.jsx(St,{label:"Data",type:"date",value:i.plannedDate||"",onChange:h=>o("plannedDate",h.target.value)})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[y.jsx(St,{label:"Analityk",value:i.analyst||"",onChange:h=>o("analyst",h.target.value)}),y.jsx(mr,{label:"Status",value:i.status||"Nowy",onChange:h=>o("status",h.target.value),children:I1.map(h=>y.jsx("option",{value:h,children:h},h))}),y.jsxs(mr,{label:"Decyzja",value:i.decision||"",onChange:h=>o("decision",h.target.value),children:[y.jsx("option",{value:"",children:"(Brak decyzji)"}),N1.map(h=>y.jsx("option",{value:h,children:h},h))]})]}),y.jsx(Ei,{label:"Komentarz",value:i.comment||"",onChange:h=>o("comment",h.target.value)}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:u,disabled:!((d=i.description)!=null&&d.trim()),children:"Zapisz"})]})]})})},uD=e=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),cD=({isOpen:e,onClose:t,onSave:n,itemToEdit:r,packages:i,reEstimations:s,onViewHistory:o})=>{const[u,d]=pe.useState({}),[h,m]=pe.useState(!1),x=pe.useMemo(()=>{if(!r||!r.packageName)return!1;const A=i.find(I=>I.name===r.packageName);return A?A.status==="inProgress"||A.status==="completed":!1},[r,i]),v=pe.useMemo(()=>!r||!r.id?[]:s.filter(A=>A.roadmapItemId===r.id).sort((A,I)=>new Date(I.createdAt).getTime()-new Date(A.createdAt).getTime()),[r,s]);pe.useEffect(()=>{d(r||{})},[r,e]),pe.useEffect(()=>{if(x)return;const A=u.analysisHours||0,I=u.devITHours||0,C=u.testingHours||0,D=u.deploymentHours||0,M=A+I+C+D,P=M*.1,F=Math.round(M+P);F!==u.totalITHoursWithBuffer&&d(q=>({...q,totalITHoursWithBuffer:F}))},[u.analysisHours,u.devITHours,u.testingHours,u.deploymentHours,u.totalITHoursWithBuffer,x]),pe.useEffect(()=>{if(x)return;const A=u.totalITHoursWithBuffer||0,I=u.workLFHours||0,C=A+I;C!==u.totalHours&&d(D=>({...D,totalHours:C}))},[u.totalITHoursWithBuffer,u.workLFHours,u.totalHours,x]);const _=pe.useMemo(()=>i.map(A=>{const I=A.status==="todo"||A.status==="planning",C=(r==null?void 0:r.packageName)===A.name,D=!I&&!C,M=D?`${A.name} (${wi[A.status]})`:A.name;return{value:A.name,label:M,disabled:D,key:A.id}}),[i,r]),k=(A,I)=>{d(C=>({...C,[A]:I}))},T=(A,I)=>{const C=I===""?void 0:parseFloat(I);d(D=>{const M={...D,[A]:C};return A==="workLFHours"&&!x&&(C!==void 0&&!isNaN(C)?(M.devLFHours=Math.round(C*.8718),M.stabilizationLFHours=Math.round(C*.1282)):(M.devLFHours=void 0,M.stabilizationLFHours=void 0)),M})},E=()=>{x||n(u)};return y.jsx(sr,{isOpen:e,onClose:t,title:r?"Edytuj wpis w roadmapie":"Dodaj wpis do roadmapy",children:y.jsxs("div",{className:"space-y-4",children:[x&&y.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-md text-sm",children:[y.jsx("strong",{children:"Informacja:"}),' To zlecenie jest częścią paczki, która jest w realizacji. Edycja estymat jest zablokowana. Użyj menu "Akcje" w widoku roadmapy, aby zawnioskować o zmianę.']}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(St,{label:"Jira",value:u.jira||"",onChange:A=>k("jira",A.target.value),readOnly:x}),y.jsxs(mr,{label:"Paczka",value:u.packageName||"",onChange:A=>k("packageName",A.target.value),disabled:x,children:[y.jsx("option",{value:"",children:"(Brak przypisania)"}),_.map(A=>y.jsx("option",{value:A.value,disabled:A.disabled,children:A.label},A.key))]})]}),y.jsx(Ei,{label:"Nazwa Zlecenia",value:u.orderName||"",onChange:A=>k("orderName",A.target.value),rows:2,readOnly:x}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[y.jsx(St,{label:"Analiza (h)",type:"number",value:u.analysisHours||"",onChange:A=>T("analysisHours",A.target.value),readOnly:x}),y.jsx(St,{label:"PROGR. IT (h)",type:"number",value:u.devITHours||"",onChange:A=>T("devITHours",A.target.value),readOnly:x}),y.jsx(St,{label:"Testy (h)",type:"number",value:u.testingHours||"",onChange:A=>T("testingHours",A.target.value),readOnly:x}),y.jsx(St,{label:"Wdrożenie (h)",type:"number",value:u.deploymentHours||"",onChange:A=>T("deploymentHours",A.target.value),readOnly:x}),y.jsx(St,{label:"PRACE LF (h)",type:"number",value:u.workLFHours||"",onChange:A=>T("workLFHours",A.target.value),readOnly:x}),y.jsx(St,{label:"PROGR. LF (h)",readOnly:!0,value:u.devLFHours||""}),y.jsx(St,{label:"STAB. LF (h)",readOnly:!0,value:u.stabilizationLFHours||""})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[y.jsx(St,{label:"CZAS. IT+Buff (h)",readOnly:!0,value:u.totalITHoursWithBuffer||""}),y.jsx("div",{className:"md:col-start-4",children:y.jsx(St,{label:"Suma (h)",type:"number",readOnly:!0,value:u.totalHours||""})})]}),y.jsx(Ei,{label:"Komentarz",value:u.comment||"",onChange:A=>k("comment",A.target.value),readOnly:x}),v.length>0&&y.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[y.jsxs("button",{onClick:()=>m(!h),className:"flex justify-between items-center w-full text-left font-semibold text-gray-700 hover:text-gray-900",children:["Historia Zmian Estymat (",v.length,")",y.jsx(Vy,{className:`w-5 h-5 transition-transform ${h?"rotate-180":""}`})]}),h&&y.jsx("div",{className:"mt-2 space-y-2",children:v.map(A=>y.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-md flex justify-between items-center",children:[y.jsxs("div",{children:[y.jsxs("p",{className:"text-sm font-medium text-gray-800",children:["Zmiana z dnia: ",new Date(A.createdAt).toLocaleString("pl-PL")]}),y.jsxs("p",{className:"text-xs text-gray-500",children:["Powód: ",A.reason," | Zatwierdził(a): ",A.approver]})]}),y.jsxs(qe,{size:"sm",variant:"secondary",onClick:()=>o(A),children:[y.jsx(uD,{className:"w-4 h-4 mr-1"}),"Zobacz podgląd"]})]},A.id))})]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:x?"Zamknij":"Anuluj"}),!x&&y.jsx(qe,{onClick:E,children:"Zapisz"})]})]})})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let fD,dD;function hD(){return{geminiUrl:fD,vertexUrl:dD}}function pD(e,t,n,r){var i,s;if(!(e!=null&&e.baseUrl)){const o=hD();return t?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Za{}function We(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const u=o.slice(0,-2);if(!(u in e))if(Array.isArray(n))e[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[u])){const d=e[u];if(Array.isArray(n))for(let h=0;h<d.length;h++){const m=d[h];f(m,t.slice(s+1),n[h])}else for(const h of d)f(h,t.slice(s+1),n)}return}else if(o.endsWith("[0]")){const u=o.slice(0,-3);u in e||(e[u]=[{}]);const d=e[u];f(d[0],t.slice(s+1),n);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=n}function c(e,t){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return;const r=t[n];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in e){const s=e[i];return Array.isArray(s)?s.map(o=>c(o,t.slice(n+1))):void 0}else return}else e=e[r]}return e}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y0(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var nx;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(nx||(nx={}));var rx;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(rx||(rx={}));var Nr;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(Nr||(Nr={}));var ix;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(ix||(ix={}));var ax;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(ax||(ax={}));var sx;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(sx||(sx={}));var ox;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(ox||(ox={}));var lx;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(lx||(lx={}));var ux;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(ux||(ux={}));var cx;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(cx||(cx={}));var fx;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(fx||(fx={}));var dx;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(dx||(dx={}));var hx;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(hx||(hx={}));var px;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(px||(px={}));var mx;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(mx||(mx={}));var gx;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(gx||(gx={}));var sc;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(sc||(sc={}));var xx;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(xx||(xx={}));var Z0;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Z0||(Z0={}));var vx;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(vx||(vx={}));var yx;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(yx||(yx={}));var wx;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(wx||(wx={}));var _x;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(_x||(_x={}));var Tx;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(Tx||(Tx={}));var Sx;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Sx||(Sx={}));var kx;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(kx||(kx={}));var Ex;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Ex||(Ex={}));var Cx;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Cx||(Cx={}));var Ax;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ax||(Ax={}));var Ix;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ix||(Ix={}));var Nx;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Nx||(Nx={}));var Fx;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(Fx||(Fx={}));var Rx;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Rx||(Rx={}));var Dx;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(Dx||(Dx={}));var Px;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Px||(Px={}));var Mx;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Mx||(Mx={}));var Lx;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Lx||(Lx={}));var Ox;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Ox||(Ox={}));var Bx;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Bx||(Bx={}));var Ux;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(Ux||(Ux={}));var zx;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(zx||(zx={}));var bx;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(bx||(bx={}));var Ps;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Ps||(Ps={}));class Q0{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class Bo{get text(){var t,n,r,i,s,o,u,d;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",m=!1;const x=[];for(const v of(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[_,k]of Object.entries(v))_!=="text"&&_!=="thought"&&(k!==null||k!==void 0)&&x.push(_);if(typeof v.text=="string"){if(typeof v.thought=="boolean"&&v.thought)continue;m=!0,h+=v.text}}return x.length>0&&console.warn(`there are non-text parts ${x} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?h:void 0}get data(){var t,n,r,i,s,o,u,d;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const m=[];for(const x of(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[v,_]of Object.entries(x))v!=="inlineData"&&(_!==null||_!==void 0)&&m.push(v);x.inlineData&&typeof x.inlineData.data=="string"&&(h+=atob(x.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,n,r,i,s,o,u,d;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,n,r,i,s,o,u,d,h;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(x=>x.executableCode).map(x=>x.executableCode).filter(x=>x!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,n,r,i,s,o,u,d,h;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(x=>x.codeExecutionResult).map(x=>x.codeExecutionResult).filter(x=>x!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.output}}class Vx{}class Hx{}class mD{}class gD{}class xD{}class Wx{}class Gx{}class jx{}class vD{}class $x{}class qx{}class Kx{}class Jx{}class yD{}class wD{}class _D{}class Xx{}class TD{get text(){var t,n,r;let i="",s=!1;const o=[];for(const u of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,h]of Object.entries(u))d!=="text"&&d!=="thought"&&h!==null&&o.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;s=!0,i+=u.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,n,r;let i="";const s=[];for(const o of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(o))u!=="inlineData"&&d!==null&&s.push(u);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class oc{_fromAPIResponse({apiResponse:t,isVertexAI:n}){const r=new oc;if(r.name=t.name,r.metadata=t.metadata,r.done=t.done,r.error=t.error,n){const i=t.response;if(i){const s=new $x,o=i.videos;s.generatedVideos=o==null?void 0:o.map(u=>({video:{uri:u.gcsUri,videoBytes:u.bytesBase64Encoded?Y0(u.bytesBase64Encoded):void 0,mimeType:u.mimeType}})),s.raiMediaFilteredCount=i.raiMediaFilteredCount,s.raiMediaFilteredReasons=i.raiMediaFilteredReasons,r.response=s}}else{const i=t.response;if(i){const s=new $x,o=i.generateVideoResponse,u=o==null?void 0:o.generatedSamples;s.generatedVideos=u==null?void 0:u.map(d=>{const h=d.video;return{video:{uri:h==null?void 0:h.uri,videoBytes:h!=null&&h.encodedVideo?Y0(h==null?void 0:h.encodedVideo):void 0,mimeType:d.encoding}}}),s.raiMediaFilteredCount=o==null?void 0:o.raiMediaFilteredCount,s.raiMediaFilteredReasons=o==null?void 0:o.raiMediaFilteredReasons,r.response=s}}return r}}class SD{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yt(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function $y(e,t){const n=yt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function qy(e){return Array.isArray(e)?e.map(t=>lc(t)):[lc(e)]}function lc(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Ky(e){const t=lc(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Jy(e){const t=lc(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Yx(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function Xy(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Yx(t)):[Yx(e)]}function ed(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function Zx(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function Qx(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Bn(e){if(e==null)throw new Error("ContentUnion is required");return ed(e)?e:{role:"user",parts:Xy(e)}}function Yy(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Bn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Bn(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Bn(n)):[Bn(t)]}function Rr(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Zx(e)||Qx(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Bn(e)]}const t=[],n=[],r=ed(e[0]);for(const i of e){const s=ed(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(Zx(i)||Qx(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:Xy(n)}),t}function kD(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(Nr).includes(n[0].toUpperCase())?n[0].toUpperCase():Nr.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(Nr).includes(r.toUpperCase())?r.toUpperCase():Nr.TYPE_UNSPECIFIED})}}function zs(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&kD(e.type,t);for(const[o,u]of Object.entries(e))if(u!=null)if(o=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;t.type=Object.values(Nr).includes(u.toUpperCase())?u.toUpperCase():Nr.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=zs(u);else if(r.includes(o)){const d=[];for(const h of u){if(h.type=="null"){t.nullable=!0;continue}d.push(zs(h))}t[o]=d}else if(i.includes(o)){const d={};for(const[h,m]of Object.entries(u))d[h]=zs(m);t[o]=d}else{if(o==="additionalProperties")continue;t[o]=u}return t}function eh(e){return zs(e)}function th(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function nh(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Js(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=zs(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=zs(t.response));return e}function Xs(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function ED(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function Ni(e,t){if(typeof t!="string")throw new Error("name must be a string");return ED(e,t,"cachedContents")}function Zy(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Qa(e){return Y0(e)}function CD(e){return e!=null&&typeof e=="object"&&"name"in e}function AD(e){return e!=null&&typeof e=="object"&&"video"in e}function ID(e){return e!=null&&typeof e=="object"&&"uri"in e}function Qy(e){var t;let n;if(CD(e)&&(n=e.name),!(ID(e)&&(n=e.uri,n===void 0))&&!(AD(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ew(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function tw(e){for(const t of["models","tunedModels","publisherModels"])if(ND(e,t))return e[t];return[]}function ND(e,t){return e!==null&&typeof e=="object"&&t in e}function FD(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function RD(e,t={}){const n=[],r=new Set;for(const i of e){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=FD(i,t);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function nw(e,t){if(typeof t!="string"&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function DD(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function Ys(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function rw(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PD(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function MD(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function LD(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function OD(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],PD(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],MD(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],LD(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function iw(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>OD(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function BD(e){const t={},n=c(e,["anyOf"]);n!=null&&f(t,["anyOf"],n);const r=c(e,["default"]);r!=null&&f(t,["default"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["enum"]);s!=null&&f(t,["enum"],s);const o=c(e,["example"]);o!=null&&f(t,["example"],o);const u=c(e,["format"]);u!=null&&f(t,["format"],u);const d=c(e,["items"]);d!=null&&f(t,["items"],d);const h=c(e,["maxItems"]);h!=null&&f(t,["maxItems"],h);const m=c(e,["maxLength"]);m!=null&&f(t,["maxLength"],m);const x=c(e,["maxProperties"]);x!=null&&f(t,["maxProperties"],x);const v=c(e,["maximum"]);v!=null&&f(t,["maximum"],v);const _=c(e,["minItems"]);_!=null&&f(t,["minItems"],_);const k=c(e,["minLength"]);k!=null&&f(t,["minLength"],k);const T=c(e,["minProperties"]);T!=null&&f(t,["minProperties"],T);const E=c(e,["minimum"]);E!=null&&f(t,["minimum"],E);const A=c(e,["nullable"]);A!=null&&f(t,["nullable"],A);const I=c(e,["pattern"]);I!=null&&f(t,["pattern"],I);const C=c(e,["properties"]);C!=null&&f(t,["properties"],C);const D=c(e,["propertyOrdering"]);D!=null&&f(t,["propertyOrdering"],D);const M=c(e,["required"]);M!=null&&f(t,["required"],M);const P=c(e,["title"]);P!=null&&f(t,["title"],P);const F=c(e,["type"]);return F!=null&&f(t,["type"],F),t}function UD(e){const t={};if(c(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(e,["category"]);n!=null&&f(t,["category"],n);const r=c(e,["threshold"]);return r!=null&&f(t,["threshold"],r),t}function zD(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function bD(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function VD(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],bD(n)),t}function HD(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function WD(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],HD(n)),t}function GD(){return{}}function jD(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>zD(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],VD(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],WD(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],GD());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function $D(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function qD(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function KD(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],qD(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function JD(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],$D(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],KD(r)),t}function XD(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function aw(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],XD(n)),t}function YD(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],aw(r)),t}function ZD(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>YD(i))),f(t,["speakerVoiceConfigs"],r)}return t}function QD(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],aw(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],ZD(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function eP(e){const t={},n=c(e,["includeThoughts"]);n!=null&&f(t,["includeThoughts"],n);const r=c(e,["thinkingBudget"]);return r!=null&&f(t,["thinkingBudget"],r),t}function tP(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],iw(Bn(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const u=c(t,["topK"]);u!=null&&f(r,["topK"],u);const d=c(t,["candidateCount"]);d!=null&&f(r,["candidateCount"],d);const h=c(t,["maxOutputTokens"]);h!=null&&f(r,["maxOutputTokens"],h);const m=c(t,["stopSequences"]);m!=null&&f(r,["stopSequences"],m);const x=c(t,["responseLogprobs"]);x!=null&&f(r,["responseLogprobs"],x);const v=c(t,["logprobs"]);v!=null&&f(r,["logprobs"],v);const _=c(t,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const k=c(t,["frequencyPenalty"]);k!=null&&f(r,["frequencyPenalty"],k);const T=c(t,["seed"]);T!=null&&f(r,["seed"],T);const E=c(t,["responseMimeType"]);E!=null&&f(r,["responseMimeType"],E);const A=c(t,["responseSchema"]);A!=null&&f(r,["responseSchema"],BD(eh(A)));const I=c(t,["responseJsonSchema"]);if(I!=null&&f(r,["responseJsonSchema"],I),c(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=c(t,["safetySettings"]);if(n!==void 0&&C!=null){let Q=C;Array.isArray(Q)&&(Q=Q.map(Y=>UD(Y))),f(n,["safetySettings"],Q)}const D=c(t,["tools"]);if(n!==void 0&&D!=null){let Q=Xs(D);Array.isArray(Q)&&(Q=Q.map(Y=>jD(Js(Y)))),f(n,["tools"],Q)}const M=c(t,["toolConfig"]);if(n!==void 0&&M!=null&&f(n,["toolConfig"],JD(M)),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=c(t,["cachedContent"]);n!==void 0&&P!=null&&f(n,["cachedContent"],Ni(e,P));const F=c(t,["responseModalities"]);F!=null&&f(r,["responseModalities"],F);const q=c(t,["mediaResolution"]);q!=null&&f(r,["mediaResolution"],q);const z=c(t,["speechConfig"]);if(z!=null&&f(r,["speechConfig"],QD(th(z))),c(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=c(t,["thinkingConfig"]);return te!=null&&f(r,["thinkingConfig"],eP(te)),r}function nP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["request","model"],yt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Rr(i);Array.isArray(o)&&(o=o.map(u=>iw(u))),f(n,["request","contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["request","generationConfig"],tP(e,s,n)),n}function rP(e,t){const n={};if(c(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(t,["fileName"]);r!=null&&f(n,["fileName"],r);const i=c(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>nP(e,o))),f(n,["requests","requests"],s)}return n}function iP(e,t){const n={},r=c(e,["displayName"]);if(t!==void 0&&r!=null&&f(t,["batch","displayName"],r),c(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function aP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["src"]);i!=null&&f(n,["batch","inputConfig"],rP(e,nw(e,i)));const s=c(t,["config"]);return s!=null&&f(n,["config"],iP(s,n)),n}function sP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ys(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function oP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ys(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function lP(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);if(t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),c(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function uP(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],lP(n,t)),t}function cP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ys(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function fP(e){const t={},n=c(e,["format"]);n!=null&&f(t,["instancesFormat"],n);const r=c(e,["gcsUri"]);r!=null&&f(t,["gcsSource","uris"],r);const i=c(e,["bigqueryUri"]);if(i!=null&&f(t,["bigquerySource","inputUri"],i),c(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function dP(e){const t={},n=c(e,["format"]);n!=null&&f(t,["predictionsFormat"],n);const r=c(e,["gcsUri"]);r!=null&&f(t,["gcsDestination","outputUriPrefix"],r);const i=c(e,["bigqueryUri"]);if(i!=null&&f(t,["bigqueryDestination","outputUri"],i),c(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function hP(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["dest"]);return t!==void 0&&i!=null&&f(t,["outputConfig"],dP(DD(i))),n}function pP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],yt(e,r));const i=c(t,["src"]);i!=null&&f(n,["inputConfig"],fP(nw(e,i)));const s=c(t,["config"]);return s!=null&&f(n,["config"],hP(s,n)),n}function mP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ys(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function gP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ys(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function xP(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);t!==void 0&&i!=null&&f(t,["_query","pageToken"],i);const s=c(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),n}function vP(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],xP(n,t)),t}function yP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ys(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function wP(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function _P(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function TP(e){const t={},n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function SP(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],wP(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],_P(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],TP(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function kP(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>SP(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function EP(e){const t={},n=c(e,["citationSources"]);return n!=null&&f(t,["citations"],n),t}function CP(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function AP(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>CP(i))),f(t,["urlMetadata"],r)}return t}function IP(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],kP(n));const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],EP(r));const i=c(e,["tokenCount"]);i!=null&&f(t,["tokenCount"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["urlContextMetadata"]);o!=null&&f(t,["urlContextMetadata"],AP(o));const u=c(e,["avgLogprobs"]);u!=null&&f(t,["avgLogprobs"],u);const d=c(e,["groundingMetadata"]);d!=null&&f(t,["groundingMetadata"],d);const h=c(e,["index"]);h!=null&&f(t,["index"],h);const m=c(e,["logprobsResult"]);m!=null&&f(t,["logprobsResult"],m);const x=c(e,["safetyRatings"]);return x!=null&&f(t,["safetyRatings"],x),t}function NP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>IP(h))),f(t,["candidates"],d)}const i=c(e,["modelVersion"]);i!=null&&f(t,["modelVersion"],i);const s=c(e,["promptFeedback"]);s!=null&&f(t,["promptFeedback"],s);const o=c(e,["responseId"]);o!=null&&f(t,["responseId"],o);const u=c(e,["usageMetadata"]);return u!=null&&f(t,["usageMetadata"],u),t}function sw(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["code"]);r!=null&&f(t,["code"],r);const i=c(e,["message"]);return i!=null&&f(t,["message"],i),t}function FP(e){const t={},n=c(e,["response"]);n!=null&&f(t,["response"],NP(n));const r=c(e,["error"]);return r!=null&&f(t,["error"],sw(r)),t}function RP(e){const t={},n=c(e,["responsesFile"]);n!=null&&f(t,["fileName"],n);const r=c(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>FP(s))),f(t,["inlinedResponses"],i)}return t}function td(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata","displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["metadata","state"]);i!=null&&f(t,["state"],rw(i));const s=c(e,["metadata","createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["metadata","endTime"]);o!=null&&f(t,["endTime"],o);const u=c(e,["metadata","updateTime"]);u!=null&&f(t,["updateTime"],u);const d=c(e,["metadata","model"]);d!=null&&f(t,["model"],d);const h=c(e,["metadata","output"]);return h!=null&&f(t,["dest"],RP(h)),t}function DP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>td(o))),f(t,["batchJobs"],s)}return t}function PP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);return s!=null&&f(t,["error"],sw(s)),t}function ow(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["code"]);r!=null&&f(t,["code"],r);const i=c(e,["message"]);return i!=null&&f(t,["message"],i),t}function MP(e){const t={},n=c(e,["instancesFormat"]);n!=null&&f(t,["format"],n);const r=c(e,["gcsSource","uris"]);r!=null&&f(t,["gcsUri"],r);const i=c(e,["bigquerySource","inputUri"]);return i!=null&&f(t,["bigqueryUri"],i),t}function LP(e){const t={},n=c(e,["predictionsFormat"]);n!=null&&f(t,["format"],n);const r=c(e,["gcsDestination","outputUriPrefix"]);r!=null&&f(t,["gcsUri"],r);const i=c(e,["bigqueryDestination","outputUri"]);return i!=null&&f(t,["bigqueryUri"],i),t}function nd(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["state"]);i!=null&&f(t,["state"],rw(i));const s=c(e,["error"]);s!=null&&f(t,["error"],ow(s));const o=c(e,["createTime"]);o!=null&&f(t,["createTime"],o);const u=c(e,["startTime"]);u!=null&&f(t,["startTime"],u);const d=c(e,["endTime"]);d!=null&&f(t,["endTime"],d);const h=c(e,["updateTime"]);h!=null&&f(t,["updateTime"],h);const m=c(e,["model"]);m!=null&&f(t,["model"],m);const x=c(e,["inputConfig"]);x!=null&&f(t,["src"],MP(x));const v=c(e,["outputConfig"]);return v!=null&&f(t,["dest"],LP(v)),t}function OP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>nd(o))),f(t,["batchJobs"],s)}return t}function BP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);return s!=null&&f(t,["error"],ow(s)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ja;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(ja||(ja={}));class Tl{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UP extends Za{constructor(t){super(),this.apiClient=t,this.create=async n=>{if(this.apiClient.isVertexAI()){const i=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${i}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new Tl(ja.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=pP(this.apiClient,t);return u=We("batchPredictionJobs",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>nd(m))}else{const h=aP(this.apiClient,t);return u=We("{model}:batchGenerateContent",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>td(m))}}async get(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=mP(this.apiClient,t);return u=We("batchPredictionJobs/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>nd(m))}else{const h=sP(this.apiClient,t);return u=We("batches/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>td(m))}}async cancel(t){var n,r,i,s;let o="",u={};if(this.apiClient.isVertexAI()){const d=gP(this.apiClient,t);o=We("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=oP(this.apiClient,t);o=We("batches/{name}:cancel",d._url),u=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=vP(t);return u=We("batchPredictionJobs",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=OP(m),v=new Xx;return Object.assign(v,x),v})}else{const h=uP(t);return u=We("batches",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=DP(m),v=new Xx;return Object.assign(v,x),v})}}async delete(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=yP(this.apiClient,t);return u=We("batchPredictionJobs/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>BP(m))}else{const h=cP(this.apiClient,t);return u=We("batches/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>PP(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zP(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function bP(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function VP(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function HP(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],zP(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],bP(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],VP(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function e1(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>HP(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function WP(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function GP(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function jP(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],GP(n)),t}function $P(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function qP(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],$P(n)),t}function KP(){return{}}function JP(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>WP(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],jP(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],qP(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],KP());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function XP(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function YP(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function ZP(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],YP(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function QP(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],XP(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],ZP(r)),t}function eM(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);t!==void 0&&i!=null&&f(t,["expireTime"],i);const s=c(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const o=c(e,["contents"]);if(t!==void 0&&o!=null){let m=Rr(o);Array.isArray(m)&&(m=m.map(x=>e1(x))),f(t,["contents"],m)}const u=c(e,["systemInstruction"]);t!==void 0&&u!=null&&f(t,["systemInstruction"],e1(Bn(u)));const d=c(e,["tools"]);if(t!==void 0&&d!=null){let m=d;Array.isArray(m)&&(m=m.map(x=>JP(x))),f(t,["tools"],m)}const h=c(e,["toolConfig"]);if(t!==void 0&&h!=null&&f(t,["toolConfig"],QP(h)),c(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function tM(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],$y(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],eM(i,n)),n}function nM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function rM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function iM(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);return t!==void 0&&i!=null&&f(t,["expireTime"],i),n}function aM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],iM(i,n)),n}function sM(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function oM(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],sM(n,t)),t}function lM(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function uM(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function cM(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function fM(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],lM(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],uM(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],cM(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function t1(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>fM(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function dM(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const u=c(e,["responseJsonSchema"]);return u!=null&&f(t,["responseJsonSchema"],u),t}function hM(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function pM(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],hM(n)),t}function mM(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function gM(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],mM(n)),t}function xM(){return{}}function vM(e){const t={},n=c(e,["apiKeyString"]);return n!=null&&f(t,["apiKeyString"],n),t}function yM(e){const t={},n=c(e,["apiKeyConfig"]);n!=null&&f(t,["apiKeyConfig"],vM(n));const r=c(e,["authType"]);r!=null&&f(t,["authType"],r);const i=c(e,["googleServiceAccountConfig"]);i!=null&&f(t,["googleServiceAccountConfig"],i);const s=c(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const o=c(e,["oauthConfig"]);o!=null&&f(t,["oauthConfig"],o);const u=c(e,["oidcConfig"]);return u!=null&&f(t,["oidcConfig"],u),t}function wM(e){const t={},n=c(e,["authConfig"]);return n!=null&&f(t,["authConfig"],yM(n)),t}function _M(){return{}}function TM(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>dM(v))),f(t,["functionDeclarations"],x)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearch"]);i!=null&&f(t,["googleSearch"],pM(i));const s=c(e,["googleSearchRetrieval"]);s!=null&&f(t,["googleSearchRetrieval"],gM(s)),c(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],xM());const u=c(e,["googleMaps"]);u!=null&&f(t,["googleMaps"],wM(u)),c(e,["urlContext"])!=null&&f(t,["urlContext"],_M());const h=c(e,["codeExecution"]);h!=null&&f(t,["codeExecution"],h);const m=c(e,["computerUse"]);return m!=null&&f(t,["computerUse"],m),t}function SM(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function kM(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function EM(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],kM(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function CM(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],SM(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],EM(r)),t}function AM(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);t!==void 0&&i!=null&&f(t,["expireTime"],i);const s=c(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const o=c(e,["contents"]);if(t!==void 0&&o!=null){let x=Rr(o);Array.isArray(x)&&(x=x.map(v=>t1(v))),f(t,["contents"],x)}const u=c(e,["systemInstruction"]);t!==void 0&&u!=null&&f(t,["systemInstruction"],t1(Bn(u)));const d=c(e,["tools"]);if(t!==void 0&&d!=null){let x=d;Array.isArray(x)&&(x=x.map(v=>TM(v))),f(t,["tools"],x)}const h=c(e,["toolConfig"]);t!==void 0&&h!=null&&f(t,["toolConfig"],CM(h));const m=c(e,["kmsKeyName"]);return t!==void 0&&m!=null&&f(t,["encryption_spec","kmsKeyName"],m),n}function IM(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],$y(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],AM(i,n)),n}function NM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function FM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function RM(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);return t!==void 0&&i!=null&&f(t,["expireTime"],i),n}function DM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],RM(i,n)),n}function PM(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function MM(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],PM(n,t)),t}function Vu(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["model"]);i!=null&&f(t,["model"],i);const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["updateTime"]);o!=null&&f(t,["updateTime"],o);const u=c(e,["expireTime"]);u!=null&&f(t,["expireTime"],u);const d=c(e,["usageMetadata"]);return d!=null&&f(t,["usageMetadata"],d),t}function LM(){return{}}function OM(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Vu(o))),f(t,["cachedContents"],s)}return t}function Hu(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["model"]);i!=null&&f(t,["model"],i);const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["updateTime"]);o!=null&&f(t,["updateTime"],o);const u=c(e,["expireTime"]);u!=null&&f(t,["expireTime"],u);const d=c(e,["usageMetadata"]);return d!=null&&f(t,["usageMetadata"],d),t}function BM(){return{}}function UM(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Hu(o))),f(t,["cachedContents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zM extends Za{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Tl(ja.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=IM(this.apiClient,t);return u=We("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Hu(m))}else{const h=tM(this.apiClient,t);return u=We("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Vu(m))}}async get(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=NM(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Hu(m))}else{const h=nM(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Vu(m))}}async delete(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=FM(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=BM(),x=new Kx;return Object.assign(x,m),x})}else{const h=rM(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(()=>{const m=LM(),x=new Kx;return Object.assign(x,m),x})}}async update(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=DM(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Hu(m))}else{const h=aM(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Vu(m))}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=MM(t);return u=We("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=UM(m),v=new Jx;return Object.assign(v,x),v})}else{const h=oM(t);return u=We("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=OM(m),v=new Jx;return Object.assign(v,x),v})}}}function n1(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pt(e){return this instanceof Pt?(this.v=e,this):new Pt(e)}function bs(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(k){return Promise.resolve(k).then(_,x)}}function u(_,k){r[_]&&(i[_]=function(T){return new Promise(function(E,A){s.push([_,T,E,A])>1||d(_,T)})},k&&(i[_]=k(i[_])))}function d(_,k){try{h(r[_](k))}catch(T){v(s[0][3],T)}}function h(_){_.value instanceof Pt?Promise.resolve(_.value.v).then(m,x):v(s[0][2],_)}function m(_){d("next",_)}function x(_){d("throw",_)}function v(_,k){_(k),s.shift(),s.length&&d(s[0][0],s[0][1])}}function Jo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof n1=="function"?n1(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(u,d){o=e[s](o),i(u,d,o.done,o.value)})}}function i(s,o,u,d){Promise.resolve(d).then(function(h){s({value:h,done:u})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bM(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:lw(n)}function lw(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function VM(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function r1(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let s=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),s&&!lw(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}class HM{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new WM(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class WM{constructor(t,n,r,i={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),VM(s)}async sendMessage(t){var n;await this.sendPromise;const r=Bn(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,u;const d=await i,h=(o=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,m=d.automaticFunctionCallingHistory,x=this.getHistory(!0).length;let v=[];m!=null&&(v=(u=m.slice(x))!==null&&u!==void 0?u:[]);const _=h?[h]:[];this.recordHistory(r,_,v)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=Bn(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(t=!1){const n=t?r1(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return bs(this,arguments,function*(){var o,u,d,h;const m=[];try{for(var x=!0,v=Jo(t),_;_=yield Pt(v.next()),o=_.done,!o;x=!0){h=_.value,x=!1;const k=h;if(bM(k)){const T=(i=(r=k.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;T!==void 0&&m.push(T)}yield yield Pt(k)}}catch(k){u={error:k}}finally{try{!x&&!o&&(d=v.return)&&(yield Pt(d.call(v)))}finally{if(u)throw u.error}}this.recordHistory(n,m)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...r1(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tc extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Tc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GM(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function jM(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],GM(n,t)),t}function $M(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["message"]);r!=null&&f(t,["message"],r);const i=c(e,["code"]);return i!=null&&f(t,["code"],i),t}function qM(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["mimeType"]);i!=null&&f(t,["mimeType"],i);const s=c(e,["sizeBytes"]);s!=null&&f(t,["sizeBytes"],s);const o=c(e,["createTime"]);o!=null&&f(t,["createTime"],o);const u=c(e,["expirationTime"]);u!=null&&f(t,["expirationTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["sha256Hash"]);h!=null&&f(t,["sha256Hash"],h);const m=c(e,["uri"]);m!=null&&f(t,["uri"],m);const x=c(e,["downloadUri"]);x!=null&&f(t,["downloadUri"],x);const v=c(e,["state"]);v!=null&&f(t,["state"],v);const _=c(e,["source"]);_!=null&&f(t,["source"],_);const k=c(e,["videoMetadata"]);k!=null&&f(t,["videoMetadata"],k);const T=c(e,["error"]);return T!=null&&f(t,["error"],$M(T)),t}function KM(e){const t={},n=c(e,["file"]);n!=null&&f(t,["file"],qM(n));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function JM(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","file"],Qy(n));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function XM(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","file"],Qy(n));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function YM(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["message"]);r!=null&&f(t,["message"],r);const i=c(e,["code"]);return i!=null&&f(t,["code"],i),t}function rd(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["mimeType"]);i!=null&&f(t,["mimeType"],i);const s=c(e,["sizeBytes"]);s!=null&&f(t,["sizeBytes"],s);const o=c(e,["createTime"]);o!=null&&f(t,["createTime"],o);const u=c(e,["expirationTime"]);u!=null&&f(t,["expirationTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["sha256Hash"]);h!=null&&f(t,["sha256Hash"],h);const m=c(e,["uri"]);m!=null&&f(t,["uri"],m);const x=c(e,["downloadUri"]);x!=null&&f(t,["downloadUri"],x);const v=c(e,["state"]);v!=null&&f(t,["state"],v);const _=c(e,["source"]);_!=null&&f(t,["source"],_);const k=c(e,["videoMetadata"]);k!=null&&f(t,["videoMetadata"],k);const T=c(e,["error"]);return T!=null&&f(t,["error"],YM(T)),t}function ZM(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>rd(o))),f(t,["files"],s)}return t}function QM(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function e8(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t8 extends Za{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Tl(ja.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>rd(n))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=jM(t);return s=We("files",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=ZM(d),m=new yD;return Object.assign(m,h),m})}}async createInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=KM(t);return s=We("upload/v1beta/files",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const h=QM(d),m=new wD;return Object.assign(m,h),m})}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=JM(t);return s=We("files/{file}",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>rd(d))}}async delete(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=XM(t);return s=We("files/{file}",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(()=>{const d=e8(),h=new _D;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n8(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function uw(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],n8(n)),t}function r8(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],uw(r)),t}function i8(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>r8(i))),f(t,["speakerVoiceConfigs"],r)}return t}function a8(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],uw(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],i8(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function s8(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function o8(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function l8(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function u8(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],s8(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],o8(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],l8(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function c8(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>u8(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function f8(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function d8(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function h8(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],d8(n)),t}function p8(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function m8(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],p8(n)),t}function g8(){return{}}function x8(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>f8(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],h8(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],m8(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],g8());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function v8(e){const t={},n=c(e,["handle"]);if(n!=null&&f(t,["handle"],n),c(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function i1(){return{}}function y8(e){const t={},n=c(e,["disabled"]);n!=null&&f(t,["disabled"],n);const r=c(e,["startOfSpeechSensitivity"]);r!=null&&f(t,["startOfSpeechSensitivity"],r);const i=c(e,["endOfSpeechSensitivity"]);i!=null&&f(t,["endOfSpeechSensitivity"],i);const s=c(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const o=c(e,["silenceDurationMs"]);return o!=null&&f(t,["silenceDurationMs"],o),t}function w8(e){const t={},n=c(e,["automaticActivityDetection"]);n!=null&&f(t,["automaticActivityDetection"],y8(n));const r=c(e,["activityHandling"]);r!=null&&f(t,["activityHandling"],r);const i=c(e,["turnCoverage"]);return i!=null&&f(t,["turnCoverage"],i),t}function _8(e){const t={},n=c(e,["targetTokens"]);return n!=null&&f(t,["targetTokens"],n),t}function T8(e){const t={},n=c(e,["triggerTokens"]);n!=null&&f(t,["triggerTokens"],n);const r=c(e,["slidingWindow"]);return r!=null&&f(t,["slidingWindow"],_8(r)),t}function S8(e){const t={},n=c(e,["proactiveAudio"]);return n!=null&&f(t,["proactiveAudio"],n),t}function k8(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const u=c(e,["topK"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","topK"],u);const d=c(e,["maxOutputTokens"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","maxOutputTokens"],d);const h=c(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=c(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const x=c(e,["speechConfig"]);t!==void 0&&x!=null&&f(t,["setup","generationConfig","speechConfig"],a8(nh(x)));const v=c(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=c(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],c8(Bn(_)));const k=c(e,["tools"]);if(t!==void 0&&k!=null){let M=Xs(k);Array.isArray(M)&&(M=M.map(P=>x8(Js(P)))),f(t,["setup","tools"],M)}const T=c(e,["sessionResumption"]);t!==void 0&&T!=null&&f(t,["setup","sessionResumption"],v8(T));const E=c(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&f(t,["setup","inputAudioTranscription"],i1());const A=c(e,["outputAudioTranscription"]);t!==void 0&&A!=null&&f(t,["setup","outputAudioTranscription"],i1());const I=c(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&f(t,["setup","realtimeInputConfig"],w8(I));const C=c(e,["contextWindowCompression"]);t!==void 0&&C!=null&&f(t,["setup","contextWindowCompression"],T8(C));const D=c(e,["proactivity"]);return t!==void 0&&D!=null&&f(t,["setup","proactivity"],S8(D)),n}function E8(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],k8(i,n)),n}function C8(){return{}}function A8(){return{}}function I8(e){const t={},n=c(e,["media"]);n!=null&&f(t,["mediaChunks"],qy(n));const r=c(e,["audio"]);r!=null&&f(t,["audio"],Jy(r));const i=c(e,["audioStreamEnd"]);i!=null&&f(t,["audioStreamEnd"],i);const s=c(e,["video"]);s!=null&&f(t,["video"],Ky(s));const o=c(e,["text"]);return o!=null&&f(t,["text"],o),c(e,["activityStart"])!=null&&f(t,["activityStart"],C8()),c(e,["activityEnd"])!=null&&f(t,["activityEnd"],A8()),t}function cw(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["weight"]);return r!=null&&f(t,["weight"],r),t}function N8(e){const t={},n=c(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>cw(i))),f(t,["weightedPrompts"],r)}return t}function fw(e){const t={},n=c(e,["temperature"]);n!=null&&f(t,["temperature"],n);const r=c(e,["topK"]);r!=null&&f(t,["topK"],r);const i=c(e,["seed"]);i!=null&&f(t,["seed"],i);const s=c(e,["guidance"]);s!=null&&f(t,["guidance"],s);const o=c(e,["bpm"]);o!=null&&f(t,["bpm"],o);const u=c(e,["density"]);u!=null&&f(t,["density"],u);const d=c(e,["brightness"]);d!=null&&f(t,["brightness"],d);const h=c(e,["scale"]);h!=null&&f(t,["scale"],h);const m=c(e,["muteBass"]);m!=null&&f(t,["muteBass"],m);const x=c(e,["muteDrums"]);x!=null&&f(t,["muteDrums"],x);const v=c(e,["onlyBassAndDrums"]);v!=null&&f(t,["onlyBassAndDrums"],v);const _=c(e,["musicGenerationMode"]);return _!=null&&f(t,["musicGenerationMode"],_),t}function F8(e){const t={},n=c(e,["musicGenerationConfig"]);return n!=null&&f(t,["musicGenerationConfig"],fw(n)),t}function dw(e){const t={},n=c(e,["model"]);return n!=null&&f(t,["model"],n),t}function hw(e){const t={},n=c(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>cw(i))),f(t,["weightedPrompts"],r)}return t}function id(e){const t={},n=c(e,["setup"]);n!=null&&f(t,["setup"],dw(n));const r=c(e,["clientContent"]);r!=null&&f(t,["clientContent"],hw(r));const i=c(e,["musicGenerationConfig"]);i!=null&&f(t,["musicGenerationConfig"],fw(i));const s=c(e,["playbackControl"]);return s!=null&&f(t,["playbackControl"],s),t}function R8(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function D8(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],R8(n)),t}function P8(e){const t={},n=c(e,["voiceConfig"]);if(n!=null&&f(t,["voiceConfig"],D8(n)),c(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function M8(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function L8(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function O8(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function B8(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],M8(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],L8(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],O8(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function U8(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>B8(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function z8(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const u=c(e,["responseJsonSchema"]);return u!=null&&f(t,["responseJsonSchema"],u),t}function b8(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function V8(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],b8(n)),t}function H8(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function W8(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],H8(n)),t}function G8(){return{}}function j8(e){const t={},n=c(e,["apiKeyString"]);return n!=null&&f(t,["apiKeyString"],n),t}function $8(e){const t={},n=c(e,["apiKeyConfig"]);n!=null&&f(t,["apiKeyConfig"],j8(n));const r=c(e,["authType"]);r!=null&&f(t,["authType"],r);const i=c(e,["googleServiceAccountConfig"]);i!=null&&f(t,["googleServiceAccountConfig"],i);const s=c(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const o=c(e,["oauthConfig"]);o!=null&&f(t,["oauthConfig"],o);const u=c(e,["oidcConfig"]);return u!=null&&f(t,["oidcConfig"],u),t}function q8(e){const t={},n=c(e,["authConfig"]);return n!=null&&f(t,["authConfig"],$8(n)),t}function K8(){return{}}function J8(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>z8(v))),f(t,["functionDeclarations"],x)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearch"]);i!=null&&f(t,["googleSearch"],V8(i));const s=c(e,["googleSearchRetrieval"]);s!=null&&f(t,["googleSearchRetrieval"],W8(s)),c(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],G8());const u=c(e,["googleMaps"]);u!=null&&f(t,["googleMaps"],q8(u)),c(e,["urlContext"])!=null&&f(t,["urlContext"],K8());const h=c(e,["codeExecution"]);h!=null&&f(t,["codeExecution"],h);const m=c(e,["computerUse"]);return m!=null&&f(t,["computerUse"],m),t}function X8(e){const t={},n=c(e,["handle"]);n!=null&&f(t,["handle"],n);const r=c(e,["transparent"]);return r!=null&&f(t,["transparent"],r),t}function a1(){return{}}function Y8(e){const t={},n=c(e,["disabled"]);n!=null&&f(t,["disabled"],n);const r=c(e,["startOfSpeechSensitivity"]);r!=null&&f(t,["startOfSpeechSensitivity"],r);const i=c(e,["endOfSpeechSensitivity"]);i!=null&&f(t,["endOfSpeechSensitivity"],i);const s=c(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const o=c(e,["silenceDurationMs"]);return o!=null&&f(t,["silenceDurationMs"],o),t}function Z8(e){const t={},n=c(e,["automaticActivityDetection"]);n!=null&&f(t,["automaticActivityDetection"],Y8(n));const r=c(e,["activityHandling"]);r!=null&&f(t,["activityHandling"],r);const i=c(e,["turnCoverage"]);return i!=null&&f(t,["turnCoverage"],i),t}function Q8(e){const t={},n=c(e,["targetTokens"]);return n!=null&&f(t,["targetTokens"],n),t}function eL(e){const t={},n=c(e,["triggerTokens"]);n!=null&&f(t,["triggerTokens"],n);const r=c(e,["slidingWindow"]);return r!=null&&f(t,["slidingWindow"],Q8(r)),t}function tL(e){const t={},n=c(e,["proactiveAudio"]);return n!=null&&f(t,["proactiveAudio"],n),t}function nL(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const u=c(e,["topK"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","topK"],u);const d=c(e,["maxOutputTokens"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","maxOutputTokens"],d);const h=c(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=c(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const x=c(e,["speechConfig"]);t!==void 0&&x!=null&&f(t,["setup","generationConfig","speechConfig"],P8(nh(x)));const v=c(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=c(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],U8(Bn(_)));const k=c(e,["tools"]);if(t!==void 0&&k!=null){let M=Xs(k);Array.isArray(M)&&(M=M.map(P=>J8(Js(P)))),f(t,["setup","tools"],M)}const T=c(e,["sessionResumption"]);t!==void 0&&T!=null&&f(t,["setup","sessionResumption"],X8(T));const E=c(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&f(t,["setup","inputAudioTranscription"],a1());const A=c(e,["outputAudioTranscription"]);t!==void 0&&A!=null&&f(t,["setup","outputAudioTranscription"],a1());const I=c(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&f(t,["setup","realtimeInputConfig"],Z8(I));const C=c(e,["contextWindowCompression"]);t!==void 0&&C!=null&&f(t,["setup","contextWindowCompression"],eL(C));const D=c(e,["proactivity"]);return t!==void 0&&D!=null&&f(t,["setup","proactivity"],tL(D)),n}function rL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],nL(i,n)),n}function iL(){return{}}function aL(){return{}}function sL(e){const t={},n=c(e,["media"]);n!=null&&f(t,["mediaChunks"],qy(n));const r=c(e,["audio"]);r!=null&&f(t,["audio"],Jy(r));const i=c(e,["audioStreamEnd"]);i!=null&&f(t,["audioStreamEnd"],i);const s=c(e,["video"]);s!=null&&f(t,["video"],Ky(s));const o=c(e,["text"]);return o!=null&&f(t,["text"],o),c(e,["activityStart"])!=null&&f(t,["activityStart"],iL()),c(e,["activityEnd"])!=null&&f(t,["activityEnd"],aL()),t}function oL(){return{}}function lL(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function uL(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function cL(e){const t={},n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function fL(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],lL(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],uL(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],cL(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function dL(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>fL(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function s1(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["finished"]);return r!=null&&f(t,["finished"],r),t}function hL(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function pL(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>hL(i))),f(t,["urlMetadata"],r)}return t}function mL(e){const t={},n=c(e,["modelTurn"]);n!=null&&f(t,["modelTurn"],dL(n));const r=c(e,["turnComplete"]);r!=null&&f(t,["turnComplete"],r);const i=c(e,["interrupted"]);i!=null&&f(t,["interrupted"],i);const s=c(e,["groundingMetadata"]);s!=null&&f(t,["groundingMetadata"],s);const o=c(e,["generationComplete"]);o!=null&&f(t,["generationComplete"],o);const u=c(e,["inputTranscription"]);u!=null&&f(t,["inputTranscription"],s1(u));const d=c(e,["outputTranscription"]);d!=null&&f(t,["outputTranscription"],s1(d));const h=c(e,["urlContextMetadata"]);return h!=null&&f(t,["urlContextMetadata"],pL(h)),t}function gL(e){const t={},n=c(e,["id"]);n!=null&&f(t,["id"],n);const r=c(e,["args"]);r!=null&&f(t,["args"],r);const i=c(e,["name"]);return i!=null&&f(t,["name"],i),t}function xL(e){const t={},n=c(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>gL(i))),f(t,["functionCalls"],r)}return t}function vL(e){const t={},n=c(e,["ids"]);return n!=null&&f(t,["ids"],n),t}function Uu(e){const t={},n=c(e,["modality"]);n!=null&&f(t,["modality"],n);const r=c(e,["tokenCount"]);return r!=null&&f(t,["tokenCount"],r),t}function yL(e){const t={},n=c(e,["promptTokenCount"]);n!=null&&f(t,["promptTokenCount"],n);const r=c(e,["cachedContentTokenCount"]);r!=null&&f(t,["cachedContentTokenCount"],r);const i=c(e,["responseTokenCount"]);i!=null&&f(t,["responseTokenCount"],i);const s=c(e,["toolUsePromptTokenCount"]);s!=null&&f(t,["toolUsePromptTokenCount"],s);const o=c(e,["thoughtsTokenCount"]);o!=null&&f(t,["thoughtsTokenCount"],o);const u=c(e,["totalTokenCount"]);u!=null&&f(t,["totalTokenCount"],u);const d=c(e,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["promptTokensDetails"],v)}const h=c(e,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["cacheTokensDetails"],v)}const m=c(e,["responseTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["responseTokensDetails"],v)}const x=c(e,["toolUsePromptTokensDetails"]);if(x!=null){let v=x;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["toolUsePromptTokensDetails"],v)}return t}function wL(e){const t={},n=c(e,["timeLeft"]);return n!=null&&f(t,["timeLeft"],n),t}function _L(e){const t={},n=c(e,["newHandle"]);n!=null&&f(t,["newHandle"],n);const r=c(e,["resumable"]);r!=null&&f(t,["resumable"],r);const i=c(e,["lastConsumedClientMessageIndex"]);return i!=null&&f(t,["lastConsumedClientMessageIndex"],i),t}function TL(e){const t={};c(e,["setupComplete"])!=null&&f(t,["setupComplete"],oL());const r=c(e,["serverContent"]);r!=null&&f(t,["serverContent"],mL(r));const i=c(e,["toolCall"]);i!=null&&f(t,["toolCall"],xL(i));const s=c(e,["toolCallCancellation"]);s!=null&&f(t,["toolCallCancellation"],vL(s));const o=c(e,["usageMetadata"]);o!=null&&f(t,["usageMetadata"],yL(o));const u=c(e,["goAway"]);u!=null&&f(t,["goAway"],wL(u));const d=c(e,["sessionResumptionUpdate"]);return d!=null&&f(t,["sessionResumptionUpdate"],_L(d)),t}function SL(){return{}}function kL(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["weight"]);return r!=null&&f(t,["weight"],r),t}function EL(e){const t={},n=c(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>kL(i))),f(t,["weightedPrompts"],r)}return t}function CL(e){const t={},n=c(e,["temperature"]);n!=null&&f(t,["temperature"],n);const r=c(e,["topK"]);r!=null&&f(t,["topK"],r);const i=c(e,["seed"]);i!=null&&f(t,["seed"],i);const s=c(e,["guidance"]);s!=null&&f(t,["guidance"],s);const o=c(e,["bpm"]);o!=null&&f(t,["bpm"],o);const u=c(e,["density"]);u!=null&&f(t,["density"],u);const d=c(e,["brightness"]);d!=null&&f(t,["brightness"],d);const h=c(e,["scale"]);h!=null&&f(t,["scale"],h);const m=c(e,["muteBass"]);m!=null&&f(t,["muteBass"],m);const x=c(e,["muteDrums"]);x!=null&&f(t,["muteDrums"],x);const v=c(e,["onlyBassAndDrums"]);v!=null&&f(t,["onlyBassAndDrums"],v);const _=c(e,["musicGenerationMode"]);return _!=null&&f(t,["musicGenerationMode"],_),t}function AL(e){const t={},n=c(e,["clientContent"]);n!=null&&f(t,["clientContent"],EL(n));const r=c(e,["musicGenerationConfig"]);return r!=null&&f(t,["musicGenerationConfig"],CL(r)),t}function IL(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);r!=null&&f(t,["mimeType"],r);const i=c(e,["sourceMetadata"]);return i!=null&&f(t,["sourceMetadata"],AL(i)),t}function NL(e){const t={},n=c(e,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>IL(i))),f(t,["audioChunks"],r)}return t}function FL(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["filteredReason"]);return r!=null&&f(t,["filteredReason"],r),t}function RL(e){const t={};c(e,["setupComplete"])!=null&&f(t,["setupComplete"],SL());const r=c(e,["serverContent"]);r!=null&&f(t,["serverContent"],NL(r));const i=c(e,["filteredPrompt"]);return i!=null&&f(t,["filteredPrompt"],FL(i)),t}function DL(e){const t={},n=c(e,["sessionId"]);return n!=null&&f(t,["sessionId"],n),t}function PL(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function ML(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function LL(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function OL(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],PL(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],ML(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],LL(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function BL(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>OL(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function o1(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["finished"]);return r!=null&&f(t,["finished"],r),t}function UL(e){const t={},n=c(e,["modelTurn"]);n!=null&&f(t,["modelTurn"],BL(n));const r=c(e,["turnComplete"]);r!=null&&f(t,["turnComplete"],r);const i=c(e,["interrupted"]);i!=null&&f(t,["interrupted"],i);const s=c(e,["groundingMetadata"]);s!=null&&f(t,["groundingMetadata"],s);const o=c(e,["generationComplete"]);o!=null&&f(t,["generationComplete"],o);const u=c(e,["inputTranscription"]);u!=null&&f(t,["inputTranscription"],o1(u));const d=c(e,["outputTranscription"]);return d!=null&&f(t,["outputTranscription"],o1(d)),t}function zL(e){const t={},n=c(e,["args"]);n!=null&&f(t,["args"],n);const r=c(e,["name"]);return r!=null&&f(t,["name"],r),t}function bL(e){const t={},n=c(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>zL(i))),f(t,["functionCalls"],r)}return t}function VL(e){const t={},n=c(e,["ids"]);return n!=null&&f(t,["ids"],n),t}function zu(e){const t={},n=c(e,["modality"]);n!=null&&f(t,["modality"],n);const r=c(e,["tokenCount"]);return r!=null&&f(t,["tokenCount"],r),t}function HL(e){const t={},n=c(e,["promptTokenCount"]);n!=null&&f(t,["promptTokenCount"],n);const r=c(e,["cachedContentTokenCount"]);r!=null&&f(t,["cachedContentTokenCount"],r);const i=c(e,["candidatesTokenCount"]);i!=null&&f(t,["responseTokenCount"],i);const s=c(e,["toolUsePromptTokenCount"]);s!=null&&f(t,["toolUsePromptTokenCount"],s);const o=c(e,["thoughtsTokenCount"]);o!=null&&f(t,["thoughtsTokenCount"],o);const u=c(e,["totalTokenCount"]);u!=null&&f(t,["totalTokenCount"],u);const d=c(e,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(k=>zu(k))),f(t,["promptTokensDetails"],_)}const h=c(e,["cacheTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(k=>zu(k))),f(t,["cacheTokensDetails"],_)}const m=c(e,["candidatesTokensDetails"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(k=>zu(k))),f(t,["responseTokensDetails"],_)}const x=c(e,["toolUsePromptTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(k=>zu(k))),f(t,["toolUsePromptTokensDetails"],_)}const v=c(e,["trafficType"]);return v!=null&&f(t,["trafficType"],v),t}function WL(e){const t={},n=c(e,["timeLeft"]);return n!=null&&f(t,["timeLeft"],n),t}function GL(e){const t={},n=c(e,["newHandle"]);n!=null&&f(t,["newHandle"],n);const r=c(e,["resumable"]);r!=null&&f(t,["resumable"],r);const i=c(e,["lastConsumedClientMessageIndex"]);return i!=null&&f(t,["lastConsumedClientMessageIndex"],i),t}function jL(e){const t={},n=c(e,["setupComplete"]);n!=null&&f(t,["setupComplete"],DL(n));const r=c(e,["serverContent"]);r!=null&&f(t,["serverContent"],UL(r));const i=c(e,["toolCall"]);i!=null&&f(t,["toolCall"],bL(i));const s=c(e,["toolCallCancellation"]);s!=null&&f(t,["toolCallCancellation"],VL(s));const o=c(e,["usageMetadata"]);o!=null&&f(t,["usageMetadata"],HL(o));const u=c(e,["goAway"]);u!=null&&f(t,["goAway"],WL(u));const d=c(e,["sessionResumptionUpdate"]);return d!=null&&f(t,["sessionResumptionUpdate"],GL(d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $L(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function qL(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function KL(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function JL(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],$L(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],qL(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],KL(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Sc(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>JL(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function XL(e){const t={},n=c(e,["anyOf"]);n!=null&&f(t,["anyOf"],n);const r=c(e,["default"]);r!=null&&f(t,["default"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["enum"]);s!=null&&f(t,["enum"],s);const o=c(e,["example"]);o!=null&&f(t,["example"],o);const u=c(e,["format"]);u!=null&&f(t,["format"],u);const d=c(e,["items"]);d!=null&&f(t,["items"],d);const h=c(e,["maxItems"]);h!=null&&f(t,["maxItems"],h);const m=c(e,["maxLength"]);m!=null&&f(t,["maxLength"],m);const x=c(e,["maxProperties"]);x!=null&&f(t,["maxProperties"],x);const v=c(e,["maximum"]);v!=null&&f(t,["maximum"],v);const _=c(e,["minItems"]);_!=null&&f(t,["minItems"],_);const k=c(e,["minLength"]);k!=null&&f(t,["minLength"],k);const T=c(e,["minProperties"]);T!=null&&f(t,["minProperties"],T);const E=c(e,["minimum"]);E!=null&&f(t,["minimum"],E);const A=c(e,["nullable"]);A!=null&&f(t,["nullable"],A);const I=c(e,["pattern"]);I!=null&&f(t,["pattern"],I);const C=c(e,["properties"]);C!=null&&f(t,["properties"],C);const D=c(e,["propertyOrdering"]);D!=null&&f(t,["propertyOrdering"],D);const M=c(e,["required"]);M!=null&&f(t,["required"],M);const P=c(e,["title"]);P!=null&&f(t,["title"],P);const F=c(e,["type"]);return F!=null&&f(t,["type"],F),t}function YL(e){const t={};if(c(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(e,["category"]);n!=null&&f(t,["category"],n);const r=c(e,["threshold"]);return r!=null&&f(t,["threshold"],r),t}function ZL(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function QL(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function e6(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],QL(n)),t}function t6(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function n6(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],t6(n)),t}function r6(){return{}}function i6(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>ZL(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],e6(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],n6(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],r6());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function a6(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function s6(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function o6(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],s6(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function l6(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],a6(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],o6(r)),t}function u6(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function pw(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],u6(n)),t}function c6(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],pw(r)),t}function f6(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>c6(i))),f(t,["speakerVoiceConfigs"],r)}return t}function d6(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],pw(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],f6(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function h6(e){const t={},n=c(e,["includeThoughts"]);n!=null&&f(t,["includeThoughts"],n);const r=c(e,["thinkingBudget"]);return r!=null&&f(t,["thinkingBudget"],r),t}function p6(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Sc(Bn(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const u=c(t,["topK"]);u!=null&&f(r,["topK"],u);const d=c(t,["candidateCount"]);d!=null&&f(r,["candidateCount"],d);const h=c(t,["maxOutputTokens"]);h!=null&&f(r,["maxOutputTokens"],h);const m=c(t,["stopSequences"]);m!=null&&f(r,["stopSequences"],m);const x=c(t,["responseLogprobs"]);x!=null&&f(r,["responseLogprobs"],x);const v=c(t,["logprobs"]);v!=null&&f(r,["logprobs"],v);const _=c(t,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const k=c(t,["frequencyPenalty"]);k!=null&&f(r,["frequencyPenalty"],k);const T=c(t,["seed"]);T!=null&&f(r,["seed"],T);const E=c(t,["responseMimeType"]);E!=null&&f(r,["responseMimeType"],E);const A=c(t,["responseSchema"]);A!=null&&f(r,["responseSchema"],XL(eh(A)));const I=c(t,["responseJsonSchema"]);if(I!=null&&f(r,["responseJsonSchema"],I),c(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=c(t,["safetySettings"]);if(n!==void 0&&C!=null){let Q=C;Array.isArray(Q)&&(Q=Q.map(Y=>YL(Y))),f(n,["safetySettings"],Q)}const D=c(t,["tools"]);if(n!==void 0&&D!=null){let Q=Xs(D);Array.isArray(Q)&&(Q=Q.map(Y=>i6(Js(Y)))),f(n,["tools"],Q)}const M=c(t,["toolConfig"]);if(n!==void 0&&M!=null&&f(n,["toolConfig"],l6(M)),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=c(t,["cachedContent"]);n!==void 0&&P!=null&&f(n,["cachedContent"],Ni(e,P));const F=c(t,["responseModalities"]);F!=null&&f(r,["responseModalities"],F);const q=c(t,["mediaResolution"]);q!=null&&f(r,["mediaResolution"],q);const z=c(t,["speechConfig"]);if(z!=null&&f(r,["speechConfig"],d6(th(z))),c(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const te=c(t,["thinkingConfig"]);return te!=null&&f(r,["thinkingConfig"],h6(te)),r}function l1(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Rr(i);Array.isArray(o)&&(o=o.map(u=>Sc(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["generationConfig"],p6(e,s,n)),n}function m6(e,t){const n={},r=c(e,["taskType"]);t!==void 0&&r!=null&&f(t,["requests[]","taskType"],r);const i=c(e,["title"]);t!==void 0&&i!=null&&f(t,["requests[]","title"],i);const s=c(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&f(t,["requests[]","outputDimensionality"],s),c(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function g6(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["contents"]);i!=null&&f(n,["requests[]","content"],Yy(e,i));const s=c(t,["config"]);s!=null&&f(n,["config"],m6(s,n));const o=c(t,["model"]);return o!==void 0&&f(n,["requests[]","model"],yt(e,o)),n}function x6(e,t){const n={};if(c(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(e,["numberOfImages"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["aspectRatio"]);t!==void 0&&i!=null&&f(t,["parameters","aspectRatio"],i);const s=c(e,["guidanceScale"]);if(t!==void 0&&s!=null&&f(t,["parameters","guidanceScale"],s),c(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&f(t,["parameters","safetySetting"],o);const u=c(e,["personGeneration"]);t!==void 0&&u!=null&&f(t,["parameters","personGeneration"],u);const d=c(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&f(t,["parameters","includeSafetyAttributes"],d);const h=c(e,["includeRaiReason"]);t!==void 0&&h!=null&&f(t,["parameters","includeRaiReason"],h);const m=c(e,["language"]);t!==void 0&&m!=null&&f(t,["parameters","language"],m);const x=c(e,["outputMimeType"]);t!==void 0&&x!=null&&f(t,["parameters","outputOptions","mimeType"],x);const v=c(e,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&f(t,["parameters","outputOptions","compressionQuality"],v),c(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const _=c(e,["imageSize"]);if(t!==void 0&&_!=null&&f(t,["parameters","sampleImageSize"],_),c(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function v6(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["config"]);return s!=null&&f(n,["config"],x6(s,n)),n}function y6(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function w6(e,t,n){const r={},i=c(t,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(t,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(t,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const u=c(t,["queryBase"]);return n!==void 0&&u!=null&&f(n,["_url","models_url"],ew(e,u)),r}function _6(e,t){const n={},r=c(t,["config"]);return r!=null&&f(n,["config"],w6(e,r,n)),n}function T6(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);t!==void 0&&i!=null&&f(t,["description"],i);const s=c(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),n}function S6(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],T6(i,n)),n}function k6(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function E6(e){const t={};if(c(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function C6(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Rr(i);Array.isArray(o)&&(o=o.map(u=>Sc(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["config"],E6(s)),n}function A6(e){const t={};if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(e,["imageBytes"]);n!=null&&f(t,["bytesBase64Encoded"],Qa(n));const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function I6(e,t){const n={},r=c(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r),c(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(e,["durationSeconds"]);if(t!==void 0&&i!=null&&f(t,["parameters","durationSeconds"],i),c(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(e,["aspectRatio"]);if(t!==void 0&&s!=null&&f(t,["parameters","aspectRatio"],s),c(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const o=c(e,["personGeneration"]);if(t!==void 0&&o!=null&&f(t,["parameters","personGeneration"],o),c(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=c(e,["negativePrompt"]);t!==void 0&&u!=null&&f(t,["parameters","negativePrompt"],u);const d=c(e,["enhancePrompt"]);if(t!==void 0&&d!=null&&f(t,["parameters","enhancePrompt"],d),c(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(c(e,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(c(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function N6(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["image"]);if(s!=null&&f(n,["instances[0]","image"],A6(s)),c(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const o=c(t,["config"]);return o!=null&&f(n,["config"],I6(o,n)),n}function F6(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function R6(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function D6(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function P6(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],F6(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],R6(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],D6(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Zs(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>P6(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function M6(e){const t={},n=c(e,["anyOf"]);n!=null&&f(t,["anyOf"],n);const r=c(e,["default"]);r!=null&&f(t,["default"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["enum"]);s!=null&&f(t,["enum"],s);const o=c(e,["example"]);o!=null&&f(t,["example"],o);const u=c(e,["format"]);u!=null&&f(t,["format"],u);const d=c(e,["items"]);d!=null&&f(t,["items"],d);const h=c(e,["maxItems"]);h!=null&&f(t,["maxItems"],h);const m=c(e,["maxLength"]);m!=null&&f(t,["maxLength"],m);const x=c(e,["maxProperties"]);x!=null&&f(t,["maxProperties"],x);const v=c(e,["maximum"]);v!=null&&f(t,["maximum"],v);const _=c(e,["minItems"]);_!=null&&f(t,["minItems"],_);const k=c(e,["minLength"]);k!=null&&f(t,["minLength"],k);const T=c(e,["minProperties"]);T!=null&&f(t,["minProperties"],T);const E=c(e,["minimum"]);E!=null&&f(t,["minimum"],E);const A=c(e,["nullable"]);A!=null&&f(t,["nullable"],A);const I=c(e,["pattern"]);I!=null&&f(t,["pattern"],I);const C=c(e,["properties"]);C!=null&&f(t,["properties"],C);const D=c(e,["propertyOrdering"]);D!=null&&f(t,["propertyOrdering"],D);const M=c(e,["required"]);M!=null&&f(t,["required"],M);const P=c(e,["title"]);P!=null&&f(t,["title"],P);const F=c(e,["type"]);return F!=null&&f(t,["type"],F),t}function L6(e){const t={},n=c(e,["featureSelectionPreference"]);return n!=null&&f(t,["featureSelectionPreference"],n),t}function O6(e){const t={},n=c(e,["method"]);n!=null&&f(t,["method"],n);const r=c(e,["category"]);r!=null&&f(t,["category"],r);const i=c(e,["threshold"]);return i!=null&&f(t,["threshold"],i),t}function B6(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const u=c(e,["responseJsonSchema"]);return u!=null&&f(t,["responseJsonSchema"],u),t}function U6(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function z6(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],U6(n)),t}function b6(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function V6(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],b6(n)),t}function H6(){return{}}function W6(e){const t={},n=c(e,["apiKeyString"]);return n!=null&&f(t,["apiKeyString"],n),t}function G6(e){const t={},n=c(e,["apiKeyConfig"]);n!=null&&f(t,["apiKeyConfig"],W6(n));const r=c(e,["authType"]);r!=null&&f(t,["authType"],r);const i=c(e,["googleServiceAccountConfig"]);i!=null&&f(t,["googleServiceAccountConfig"],i);const s=c(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const o=c(e,["oauthConfig"]);o!=null&&f(t,["oauthConfig"],o);const u=c(e,["oidcConfig"]);return u!=null&&f(t,["oidcConfig"],u),t}function j6(e){const t={},n=c(e,["authConfig"]);return n!=null&&f(t,["authConfig"],G6(n)),t}function $6(){return{}}function mw(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>B6(v))),f(t,["functionDeclarations"],x)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearch"]);i!=null&&f(t,["googleSearch"],z6(i));const s=c(e,["googleSearchRetrieval"]);s!=null&&f(t,["googleSearchRetrieval"],V6(s)),c(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],H6());const u=c(e,["googleMaps"]);u!=null&&f(t,["googleMaps"],j6(u)),c(e,["urlContext"])!=null&&f(t,["urlContext"],$6());const h=c(e,["codeExecution"]);h!=null&&f(t,["codeExecution"],h);const m=c(e,["computerUse"]);return m!=null&&f(t,["computerUse"],m),t}function q6(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function K6(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function J6(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],K6(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function X6(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],q6(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],J6(r)),t}function Y6(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function Z6(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],Y6(n)),t}function Q6(e){const t={},n=c(e,["voiceConfig"]);if(n!=null&&f(t,["voiceConfig"],Z6(n)),c(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function e5(e){const t={},n=c(e,["includeThoughts"]);n!=null&&f(t,["includeThoughts"],n);const r=c(e,["thinkingBudget"]);return r!=null&&f(t,["thinkingBudget"],r),t}function t5(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Zs(Bn(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const u=c(t,["topK"]);u!=null&&f(r,["topK"],u);const d=c(t,["candidateCount"]);d!=null&&f(r,["candidateCount"],d);const h=c(t,["maxOutputTokens"]);h!=null&&f(r,["maxOutputTokens"],h);const m=c(t,["stopSequences"]);m!=null&&f(r,["stopSequences"],m);const x=c(t,["responseLogprobs"]);x!=null&&f(r,["responseLogprobs"],x);const v=c(t,["logprobs"]);v!=null&&f(r,["logprobs"],v);const _=c(t,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const k=c(t,["frequencyPenalty"]);k!=null&&f(r,["frequencyPenalty"],k);const T=c(t,["seed"]);T!=null&&f(r,["seed"],T);const E=c(t,["responseMimeType"]);E!=null&&f(r,["responseMimeType"],E);const A=c(t,["responseSchema"]);A!=null&&f(r,["responseSchema"],M6(eh(A)));const I=c(t,["responseJsonSchema"]);I!=null&&f(r,["responseJsonSchema"],I);const C=c(t,["routingConfig"]);C!=null&&f(r,["routingConfig"],C);const D=c(t,["modelSelectionConfig"]);D!=null&&f(r,["modelConfig"],L6(D));const M=c(t,["safetySettings"]);if(n!==void 0&&M!=null){let we=M;Array.isArray(we)&&(we=we.map(Fe=>O6(Fe))),f(n,["safetySettings"],we)}const P=c(t,["tools"]);if(n!==void 0&&P!=null){let we=Xs(P);Array.isArray(we)&&(we=we.map(Fe=>mw(Js(Fe)))),f(n,["tools"],we)}const F=c(t,["toolConfig"]);n!==void 0&&F!=null&&f(n,["toolConfig"],X6(F));const q=c(t,["labels"]);n!==void 0&&q!=null&&f(n,["labels"],q);const z=c(t,["cachedContent"]);n!==void 0&&z!=null&&f(n,["cachedContent"],Ni(e,z));const te=c(t,["responseModalities"]);te!=null&&f(r,["responseModalities"],te);const Q=c(t,["mediaResolution"]);Q!=null&&f(r,["mediaResolution"],Q);const Y=c(t,["speechConfig"]);Y!=null&&f(r,["speechConfig"],Q6(th(Y)));const xe=c(t,["audioTimestamp"]);xe!=null&&f(r,["audioTimestamp"],xe);const De=c(t,["thinkingConfig"]);return De!=null&&f(r,["thinkingConfig"],e5(De)),r}function u1(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Rr(i);Array.isArray(o)&&(o=o.map(u=>Zs(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["generationConfig"],t5(e,s,n)),n}function n5(e,t){const n={},r=c(e,["taskType"]);t!==void 0&&r!=null&&f(t,["instances[]","task_type"],r);const i=c(e,["title"]);t!==void 0&&i!=null&&f(t,["instances[]","title"],i);const s=c(e,["outputDimensionality"]);t!==void 0&&s!=null&&f(t,["parameters","outputDimensionality"],s);const o=c(e,["mimeType"]);t!==void 0&&o!=null&&f(t,["instances[]","mimeType"],o);const u=c(e,["autoTruncate"]);return t!==void 0&&u!=null&&f(t,["parameters","autoTruncate"],u),n}function r5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["contents"]);i!=null&&f(n,["instances[]","content"],Yy(e,i));const s=c(t,["config"]);return s!=null&&f(n,["config"],n5(s,n)),n}function i5(e,t){const n={},r=c(e,["outputGcsUri"]);t!==void 0&&r!=null&&f(t,["parameters","storageUri"],r);const i=c(e,["negativePrompt"]);t!==void 0&&i!=null&&f(t,["parameters","negativePrompt"],i);const s=c(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const o=c(e,["aspectRatio"]);t!==void 0&&o!=null&&f(t,["parameters","aspectRatio"],o);const u=c(e,["guidanceScale"]);t!==void 0&&u!=null&&f(t,["parameters","guidanceScale"],u);const d=c(e,["seed"]);t!==void 0&&d!=null&&f(t,["parameters","seed"],d);const h=c(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const m=c(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const x=c(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&f(t,["parameters","includeSafetyAttributes"],x);const v=c(e,["includeRaiReason"]);t!==void 0&&v!=null&&f(t,["parameters","includeRaiReason"],v);const _=c(e,["language"]);t!==void 0&&_!=null&&f(t,["parameters","language"],_);const k=c(e,["outputMimeType"]);t!==void 0&&k!=null&&f(t,["parameters","outputOptions","mimeType"],k);const T=c(e,["outputCompressionQuality"]);t!==void 0&&T!=null&&f(t,["parameters","outputOptions","compressionQuality"],T);const E=c(e,["addWatermark"]);t!==void 0&&E!=null&&f(t,["parameters","addWatermark"],E);const A=c(e,["imageSize"]);t!==void 0&&A!=null&&f(t,["parameters","sampleImageSize"],A);const I=c(e,["enhancePrompt"]);return t!==void 0&&I!=null&&f(t,["parameters","enhancePrompt"],I),n}function a5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["config"]);return s!=null&&f(n,["config"],i5(s,n)),n}function Qs(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["imageBytes"]);r!=null&&f(t,["bytesBase64Encoded"],Qa(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function s5(e){const t={},n=c(e,["maskMode"]);n!=null&&f(t,["maskMode"],n);const r=c(e,["segmentationClasses"]);r!=null&&f(t,["maskClasses"],r);const i=c(e,["maskDilation"]);return i!=null&&f(t,["dilation"],i),t}function o5(e){const t={},n=c(e,["controlType"]);n!=null&&f(t,["controlType"],n);const r=c(e,["enableControlImageComputation"]);return r!=null&&f(t,["computeControl"],r),t}function l5(e){const t={},n=c(e,["styleDescription"]);return n!=null&&f(t,["styleDescription"],n),t}function u5(e){const t={},n=c(e,["subjectType"]);n!=null&&f(t,["subjectType"],n);const r=c(e,["subjectDescription"]);return r!=null&&f(t,["subjectDescription"],r),t}function c5(e){const t={},n=c(e,["referenceImage"]);n!=null&&f(t,["referenceImage"],Qs(n));const r=c(e,["referenceId"]);r!=null&&f(t,["referenceId"],r);const i=c(e,["referenceType"]);i!=null&&f(t,["referenceType"],i);const s=c(e,["maskImageConfig"]);s!=null&&f(t,["maskImageConfig"],s5(s));const o=c(e,["controlImageConfig"]);o!=null&&f(t,["controlImageConfig"],o5(o));const u=c(e,["styleImageConfig"]);u!=null&&f(t,["styleImageConfig"],l5(u));const d=c(e,["subjectImageConfig"]);return d!=null&&f(t,["subjectImageConfig"],u5(d)),t}function f5(e,t){const n={},r=c(e,["outputGcsUri"]);t!==void 0&&r!=null&&f(t,["parameters","storageUri"],r);const i=c(e,["negativePrompt"]);t!==void 0&&i!=null&&f(t,["parameters","negativePrompt"],i);const s=c(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const o=c(e,["aspectRatio"]);t!==void 0&&o!=null&&f(t,["parameters","aspectRatio"],o);const u=c(e,["guidanceScale"]);t!==void 0&&u!=null&&f(t,["parameters","guidanceScale"],u);const d=c(e,["seed"]);t!==void 0&&d!=null&&f(t,["parameters","seed"],d);const h=c(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const m=c(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const x=c(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&f(t,["parameters","includeSafetyAttributes"],x);const v=c(e,["includeRaiReason"]);t!==void 0&&v!=null&&f(t,["parameters","includeRaiReason"],v);const _=c(e,["language"]);t!==void 0&&_!=null&&f(t,["parameters","language"],_);const k=c(e,["outputMimeType"]);t!==void 0&&k!=null&&f(t,["parameters","outputOptions","mimeType"],k);const T=c(e,["outputCompressionQuality"]);t!==void 0&&T!=null&&f(t,["parameters","outputOptions","compressionQuality"],T);const E=c(e,["addWatermark"]);t!==void 0&&E!=null&&f(t,["parameters","addWatermark"],E);const A=c(e,["editMode"]);t!==void 0&&A!=null&&f(t,["parameters","editMode"],A);const I=c(e,["baseSteps"]);return t!==void 0&&I!=null&&f(t,["parameters","editConfig","baseSteps"],I),n}function d5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["referenceImages"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>c5(d))),f(n,["instances[0]","referenceImages"],u)}const o=c(t,["config"]);return o!=null&&f(n,["config"],f5(o,n)),n}function h5(e,t){const n={},r=c(e,["includeRaiReason"]);t!==void 0&&r!=null&&f(t,["parameters","includeRaiReason"],r);const i=c(e,["outputMimeType"]);t!==void 0&&i!=null&&f(t,["parameters","outputOptions","mimeType"],i);const s=c(e,["outputCompressionQuality"]);t!==void 0&&s!=null&&f(t,["parameters","outputOptions","compressionQuality"],s);const o=c(e,["enhanceInputImage"]);t!==void 0&&o!=null&&f(t,["parameters","upscaleConfig","enhanceInputImage"],o);const u=c(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&f(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const d=c(e,["numberOfImages"]);t!==void 0&&d!=null&&f(t,["parameters","sampleCount"],d);const h=c(e,["mode"]);return t!==void 0&&h!=null&&f(t,["parameters","mode"],h),n}function p5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["image"]);i!=null&&f(n,["instances[0]","image"],Qs(i));const s=c(t,["upscaleFactor"]);s!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(t,["config"]);return o!=null&&f(n,["config"],h5(o,n)),n}function m5(e){const t={},n=c(e,["productImage"]);return n!=null&&f(t,["image"],Qs(n)),t}function g5(e,t){const n={},r=c(e,["prompt"]);t!==void 0&&r!=null&&f(t,["instances[0]","prompt"],r);const i=c(e,["personImage"]);t!==void 0&&i!=null&&f(t,["instances[0]","personImage","image"],Qs(i));const s=c(e,["productImages"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>m5(u))),f(t,["instances[0]","productImages"],o)}return n}function x5(e,t){const n={},r=c(e,["numberOfImages"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["baseSteps"]);t!==void 0&&i!=null&&f(t,["parameters","editConfig","baseSteps"],i);const s=c(e,["outputGcsUri"]);t!==void 0&&s!=null&&f(t,["parameters","storageUri"],s);const o=c(e,["seed"]);t!==void 0&&o!=null&&f(t,["parameters","seed"],o);const u=c(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&f(t,["parameters","safetySetting"],u);const d=c(e,["personGeneration"]);t!==void 0&&d!=null&&f(t,["parameters","personGeneration"],d);const h=c(e,["outputMimeType"]);t!==void 0&&h!=null&&f(t,["parameters","outputOptions","mimeType"],h);const m=c(e,["outputCompressionQuality"]);t!==void 0&&m!=null&&f(t,["parameters","outputOptions","compressionQuality"],m);const x=c(e,["enhancePrompt"]);return t!==void 0&&x!=null&&f(t,["parameters","enhancePrompt"],x),n}function v5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["source"]);i!=null&&f(n,["config"],g5(i,n));const s=c(t,["config"]);return s!=null&&f(n,["config"],x5(s,n)),n}function y5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function w5(e,t,n){const r={},i=c(t,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(t,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(t,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const u=c(t,["queryBase"]);return n!==void 0&&u!=null&&f(n,["_url","models_url"],ew(e,u)),r}function _5(e,t){const n={},r=c(t,["config"]);return r!=null&&f(n,["config"],w5(e,r,n)),n}function T5(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);t!==void 0&&i!=null&&f(t,["description"],i);const s=c(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),n}function S5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],T5(i,n)),n}function k5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function E5(e,t){const n={},r=c(e,["systemInstruction"]);t!==void 0&&r!=null&&f(t,["systemInstruction"],Zs(Bn(r)));const i=c(e,["tools"]);if(t!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(u=>mw(u))),f(t,["tools"],o)}const s=c(e,["generationConfig"]);return t!==void 0&&s!=null&&f(t,["generationConfig"],s),n}function C5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Rr(i);Array.isArray(o)&&(o=o.map(u=>Zs(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["config"],E5(s,n)),n}function A5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Rr(i);Array.isArray(o)&&(o=o.map(u=>Zs(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["config"],s),n}function I5(e){const t={},n=c(e,["uri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["videoBytes"]);r!=null&&f(t,["bytesBase64Encoded"],Qa(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function N5(e,t){const n={},r=c(e,["numberOfVideos"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["outputGcsUri"]);t!==void 0&&i!=null&&f(t,["parameters","storageUri"],i);const s=c(e,["fps"]);t!==void 0&&s!=null&&f(t,["parameters","fps"],s);const o=c(e,["durationSeconds"]);t!==void 0&&o!=null&&f(t,["parameters","durationSeconds"],o);const u=c(e,["seed"]);t!==void 0&&u!=null&&f(t,["parameters","seed"],u);const d=c(e,["aspectRatio"]);t!==void 0&&d!=null&&f(t,["parameters","aspectRatio"],d);const h=c(e,["resolution"]);t!==void 0&&h!=null&&f(t,["parameters","resolution"],h);const m=c(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const x=c(e,["pubsubTopic"]);t!==void 0&&x!=null&&f(t,["parameters","pubsubTopic"],x);const v=c(e,["negativePrompt"]);t!==void 0&&v!=null&&f(t,["parameters","negativePrompt"],v);const _=c(e,["enhancePrompt"]);t!==void 0&&_!=null&&f(t,["parameters","enhancePrompt"],_);const k=c(e,["generateAudio"]);t!==void 0&&k!=null&&f(t,["parameters","generateAudio"],k);const T=c(e,["lastFrame"]);t!==void 0&&T!=null&&f(t,["instances[0]","lastFrame"],Qs(T));const E=c(e,["compressionQuality"]);return t!==void 0&&E!=null&&f(t,["parameters","compressionQuality"],E),n}function F5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],yt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["image"]);s!=null&&f(n,["instances[0]","image"],Qs(s));const o=c(t,["video"]);o!=null&&f(n,["instances[0]","video"],I5(o));const u=c(t,["config"]);return u!=null&&f(n,["config"],N5(u,n)),n}function R5(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function D5(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function P5(e){const t={},n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function M5(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],R5(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],D5(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],P5(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function L5(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>M5(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function O5(e){const t={},n=c(e,["citationSources"]);return n!=null&&f(t,["citations"],n),t}function B5(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function U5(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>B5(i))),f(t,["urlMetadata"],r)}return t}function z5(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],L5(n));const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],O5(r));const i=c(e,["tokenCount"]);i!=null&&f(t,["tokenCount"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["urlContextMetadata"]);o!=null&&f(t,["urlContextMetadata"],U5(o));const u=c(e,["avgLogprobs"]);u!=null&&f(t,["avgLogprobs"],u);const d=c(e,["groundingMetadata"]);d!=null&&f(t,["groundingMetadata"],d);const h=c(e,["index"]);h!=null&&f(t,["index"],h);const m=c(e,["logprobsResult"]);m!=null&&f(t,["logprobsResult"],m);const x=c(e,["safetyRatings"]);return x!=null&&f(t,["safetyRatings"],x),t}function c1(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>z5(h))),f(t,["candidates"],d)}const i=c(e,["modelVersion"]);i!=null&&f(t,["modelVersion"],i);const s=c(e,["promptFeedback"]);s!=null&&f(t,["promptFeedback"],s);const o=c(e,["responseId"]);o!=null&&f(t,["responseId"],o);const u=c(e,["usageMetadata"]);return u!=null&&f(t,["usageMetadata"],u),t}function b5(e){const t={},n=c(e,["values"]);return n!=null&&f(t,["values"],n),t}function V5(){return{}}function H5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>b5(o))),f(t,["embeddings"],s)}return c(e,["metadata"])!=null&&f(t,["metadata"],V5()),t}function W5(e){const t={},n=c(e,["bytesBase64Encoded"]);n!=null&&f(t,["imageBytes"],Qa(n));const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function gw(e){const t={},n=c(e,["safetyAttributes","categories"]);n!=null&&f(t,["categories"],n);const r=c(e,["safetyAttributes","scores"]);r!=null&&f(t,["scores"],r);const i=c(e,["contentType"]);return i!=null&&f(t,["contentType"],i),t}function G5(e){const t={},n=c(e,["_self"]);n!=null&&f(t,["image"],W5(n));const r=c(e,["raiFilteredReason"]);r!=null&&f(t,["raiFilteredReason"],r);const i=c(e,["_self"]);return i!=null&&f(t,["safetyAttributes"],gw(i)),t}function j5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>G5(o))),f(t,["generatedImages"],s)}const i=c(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],gw(i)),t}function $5(e){const t={},n=c(e,["baseModel"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["createTime"]);r!=null&&f(t,["createTime"],r);const i=c(e,["updateTime"]);return i!=null&&f(t,["updateTime"],i),t}function ad(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["version"]);s!=null&&f(t,["version"],s);const o=c(e,["_self"]);o!=null&&f(t,["tunedModelInfo"],$5(o));const u=c(e,["inputTokenLimit"]);u!=null&&f(t,["inputTokenLimit"],u);const d=c(e,["outputTokenLimit"]);d!=null&&f(t,["outputTokenLimit"],d);const h=c(e,["supportedGenerationMethods"]);return h!=null&&f(t,["supportedActions"],h),t}function q5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["_self"]);if(i!=null){let s=tw(i);Array.isArray(s)&&(s=s.map(o=>ad(o))),f(t,["models"],s)}return t}function K5(){return{}}function J5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["totalTokens"]);r!=null&&f(t,["totalTokens"],r);const i=c(e,["cachedContentTokenCount"]);return i!=null&&f(t,["cachedContentTokenCount"],i),t}function X5(e){const t={},n=c(e,["video","uri"]);n!=null&&f(t,["uri"],n);const r=c(e,["video","encodedVideo"]);r!=null&&f(t,["videoBytes"],Qa(r));const i=c(e,["encoding"]);return i!=null&&f(t,["mimeType"],i),t}function Y5(e){const t={},n=c(e,["_self"]);return n!=null&&f(t,["video"],X5(n)),t}function Z5(e){const t={},n=c(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Y5(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function Q5(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response","generateVideoResponse"]);return o!=null&&f(t,["response"],Z5(o)),t}function eO(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function tO(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function nO(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function rO(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],eO(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],tO(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],nO(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function iO(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>rO(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function aO(e){const t={},n=c(e,["citations"]);return n!=null&&f(t,["citations"],n),t}function sO(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function oO(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>sO(i))),f(t,["urlMetadata"],r)}return t}function lO(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],iO(n));const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],aO(r));const i=c(e,["finishMessage"]);i!=null&&f(t,["finishMessage"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["urlContextMetadata"]);o!=null&&f(t,["urlContextMetadata"],oO(o));const u=c(e,["avgLogprobs"]);u!=null&&f(t,["avgLogprobs"],u);const d=c(e,["groundingMetadata"]);d!=null&&f(t,["groundingMetadata"],d);const h=c(e,["index"]);h!=null&&f(t,["index"],h);const m=c(e,["logprobsResult"]);m!=null&&f(t,["logprobsResult"],m);const x=c(e,["safetyRatings"]);return x!=null&&f(t,["safetyRatings"],x),t}function f1(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(m=>lO(m))),f(t,["candidates"],h)}const i=c(e,["createTime"]);i!=null&&f(t,["createTime"],i);const s=c(e,["modelVersion"]);s!=null&&f(t,["modelVersion"],s);const o=c(e,["promptFeedback"]);o!=null&&f(t,["promptFeedback"],o);const u=c(e,["responseId"]);u!=null&&f(t,["responseId"],u);const d=c(e,["usageMetadata"]);return d!=null&&f(t,["usageMetadata"],d),t}function uO(e){const t={},n=c(e,["truncated"]);n!=null&&f(t,["truncated"],n);const r=c(e,["token_count"]);return r!=null&&f(t,["tokenCount"],r),t}function cO(e){const t={},n=c(e,["values"]);n!=null&&f(t,["values"],n);const r=c(e,["statistics"]);return r!=null&&f(t,["statistics"],uO(r)),t}function fO(e){const t={},n=c(e,["billableCharacterCount"]);return n!=null&&f(t,["billableCharacterCount"],n),t}function dO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>cO(o))),f(t,["embeddings"],s)}const i=c(e,["metadata"]);return i!=null&&f(t,["metadata"],fO(i)),t}function hO(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["bytesBase64Encoded"]);r!=null&&f(t,["imageBytes"],Qa(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function xw(e){const t={},n=c(e,["safetyAttributes","categories"]);n!=null&&f(t,["categories"],n);const r=c(e,["safetyAttributes","scores"]);r!=null&&f(t,["scores"],r);const i=c(e,["contentType"]);return i!=null&&f(t,["contentType"],i),t}function kc(e){const t={},n=c(e,["_self"]);n!=null&&f(t,["image"],hO(n));const r=c(e,["raiFilteredReason"]);r!=null&&f(t,["raiFilteredReason"],r);const i=c(e,["_self"]);i!=null&&f(t,["safetyAttributes"],xw(i));const s=c(e,["prompt"]);return s!=null&&f(t,["enhancedPrompt"],s),t}function pO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>kc(o))),f(t,["generatedImages"],s)}const i=c(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],xw(i)),t}function mO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>kc(s))),f(t,["generatedImages"],i)}return t}function gO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>kc(s))),f(t,["generatedImages"],i)}return t}function xO(e){const t={},n=c(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>kc(i))),f(t,["generatedImages"],r)}return t}function vO(e){const t={},n=c(e,["endpoint"]);n!=null&&f(t,["name"],n);const r=c(e,["deployedModelId"]);return r!=null&&f(t,["deployedModelId"],r),t}function yO(e){const t={},n=c(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["createTime"]);r!=null&&f(t,["createTime"],r);const i=c(e,["updateTime"]);return i!=null&&f(t,["updateTime"],i),t}function wO(e){const t={},n=c(e,["checkpointId"]);n!=null&&f(t,["checkpointId"],n);const r=c(e,["epoch"]);r!=null&&f(t,["epoch"],r);const i=c(e,["step"]);return i!=null&&f(t,["step"],i),t}function sd(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["versionId"]);s!=null&&f(t,["version"],s);const o=c(e,["deployedModels"]);if(o!=null){let x=o;Array.isArray(x)&&(x=x.map(v=>vO(v))),f(t,["endpoints"],x)}const u=c(e,["labels"]);u!=null&&f(t,["labels"],u);const d=c(e,["_self"]);d!=null&&f(t,["tunedModelInfo"],yO(d));const h=c(e,["defaultCheckpointId"]);h!=null&&f(t,["defaultCheckpointId"],h);const m=c(e,["checkpoints"]);if(m!=null){let x=m;Array.isArray(x)&&(x=x.map(v=>wO(v))),f(t,["checkpoints"],x)}return t}function _O(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["_self"]);if(i!=null){let s=tw(i);Array.isArray(s)&&(s=s.map(o=>sd(o))),f(t,["models"],s)}return t}function TO(){return{}}function SO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["totalTokens"]);return r!=null&&f(t,["totalTokens"],r),t}function kO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["tokensInfo"]);return r!=null&&f(t,["tokensInfo"],r),t}function EO(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["uri"],n);const r=c(e,["bytesBase64Encoded"]);r!=null&&f(t,["videoBytes"],Qa(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function CO(e){const t={},n=c(e,["_self"]);return n!=null&&f(t,["video"],EO(n)),t}function AO(e){const t={},n=c(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>CO(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function IO(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response"]);return o!=null&&f(t,["response"],AO(o)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NO="Content-Type",FO="X-Server-Timeout",RO="User-Agent",od="x-goog-api-client",DO="1.13.0",PO=`google-genai-sdk/${DO}`,MO="v1beta1",LO="v1beta",d1=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class OO{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:MO,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:LO,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[o,u]of Object.entries(t.queryParams))i.searchParams.append(o,String(u));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),t.signal=s}return n&&n.extraBody!==null&&BO(t,n.extraBody),t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await h1(i),new Q0(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await h1(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return bs(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:u,value:d}=yield Pt(i.read());if(u){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=s.decode(d,{stream:!0});try{const x=JSON.parse(h);if("error"in x){const v=JSON.parse(JSON.stringify(x.error)),_=v.status,k=v.code,T=`got status: ${_}. ${JSON.stringify(x)}`;if(k>=400&&k<600)throw new Tc({message:T,status:k})}}catch(x){if(x.name==="ApiError")throw x}o+=h;let m=o.match(d1);for(;m;){const x=m[1];try{const v=new Response(x,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Pt(new Q0(v)),o=o.slice(m[0].length),m=o.match(d1)}catch(v){throw new Error(`exception parsing stream chunk ${x}. ${v}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=PO+" "+this.clientOptions.userAgentExtra;return t[RO]=n,t[od]=n,t[NO]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[r,i]of Object.entries(t.headers))n.append(r,i);t.timeout&&t.timeout>0&&n.append(FO,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(t);i.sizeBytes=String(o.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const d=await this.fetchUploadUrl(i,n);return s.upload(t,d,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const s={file:t},o=await this.request({path:We("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function h1(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Tc({message:i,status:n}):new Error(i)}}function BO(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const u=Object.assign({},s);for(const d in o)if(Object.prototype.hasOwnProperty.call(o,d)){const h=o[d],m=u[d];h&&typeof h=="object"&&!Array.isArray(h)&&m&&typeof m=="object"&&!Array.isArray(m)?u[d]=r(m,h):(m&&h&&typeof m!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof m}, New type: ${typeof h}. Overwriting.`),u[d]=h)}return u}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UO="mcp_used/unknown";let zO=!1;function vw(e){for(const t of e)if(bO(t)||typeof t=="object"&&"inputSchema"in t)return!0;return zO}function yw(e){var t;const n=(t=e[od])!==null&&t!==void 0?t:"";e[od]=(n+` ${UO}`).trimStart()}function bO(e){return e!==null&&typeof e=="object"&&e instanceof rh}function VO(e,t=100){return bs(this,arguments,function*(){let r,i=0;for(;i<t;){const s=yield Pt(e.listTools({cursor:r}));for(const o of s.tools)yield yield Pt(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class rh{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new rh(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const m of this.mcpClients)try{for(var u=!0,d=(n=void 0,Jo(VO(m))),h;h=await d.next(),t=h.done,!t;u=!0){i=h.value,u=!1;const x=i;o.push(x);const v=x.name;if(s[v])throw new Error(`Duplicate function name ${v} found in MCP tools. Please ensure function names are unique.`);s[v]=m}}catch(x){n={error:x}}finally{try{!u&&!t&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),RD(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function HO(e,t,n){const r=new SD;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data);const s=RL(i);Object.assign(r,s),t(r)}class WO{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=$O(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${u}`;let h=()=>{};const m=new Promise(C=>{h=C}),x=t.callbacks,v=function(){h({})},_=this.apiClient,k={onopen:v,onmessage:C=>{HO(_,x.onmessage,C)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(C){}},T=this.webSocketFactory.create(d,jO(o),k);T.connect(),await m;const E=yt(this.apiClient,t.model),A=dw({model:E}),I=id({setup:A});return T.send(JSON.stringify(I)),new GO(T,this.apiClient)}}class GO{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=N8(t),r=hw(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=F8(t),r=id(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const n=id({playbackControl:t});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ps.PLAY)}pause(){this.sendPlaybackControl(Ps.PAUSE)}stop(){this.sendPlaybackControl(Ps.STOP)}resetContext(){this.sendPlaybackControl(Ps.RESET_CONTEXT)}close(){this.conn.close()}}function jO(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function $O(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qO="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function KO(e,t,n){const r=new TD;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(e.isVertexAI()){const o=jL(s);Object.assign(r,o)}else{const o=TL(s);Object.assign(r,o)}t(r)}class JO{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new WO(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,s,o,u;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let m;const x=this.apiClient.getHeaders();t.config&&t.config.tools&&vw(t.config.tools)&&yw(x);const v=QO(x);if(this.apiClient.isVertexAI())m=`${d}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(v);else{const z=this.apiClient.getApiKey();let te="BidiGenerateContent",Q="key";z!=null&&z.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),te="BidiGenerateContentConstrained",Q="access_token"),m=`${d}/ws/google.ai.generativelanguage.${h}.GenerativeService.${te}?${Q}=${z}`}let _=()=>{};const k=new Promise(z=>{_=z}),T=t.callbacks,E=function(){var z;(z=T==null?void 0:T.onopen)===null||z===void 0||z.call(T),_({})},A=this.apiClient,I={onopen:E,onmessage:z=>{KO(A,T.onmessage,z)},onerror:(n=T==null?void 0:T.onerror)!==null&&n!==void 0?n:function(z){},onclose:(r=T==null?void 0:T.onclose)!==null&&r!==void 0?r:function(z){}},C=this.webSocketFactory.create(m,ZO(v),I);C.connect(),await k;let D=yt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const z=this.apiClient.getProject(),te=this.apiClient.getLocation();D=`projects/${z}/locations/${te}/`+D}let M={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[sc.AUDIO]}:t.config.responseModalities=[sc.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const P=(u=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&u!==void 0?u:[],F=[];for(const z of P)if(this.isCallableTool(z)){const te=z;F.push(await te.tool())}else F.push(z);F.length>0&&(t.config.tools=F);const q={model:D,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?M=rL(this.apiClient,q):M=E8(this.apiClient,q),delete M.config,C.send(JSON.stringify(M)),new YO(C,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const XO={turnComplete:!0};class YO{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Rr(n.turns),t.isVertexAI()?r=r.map(i=>Zs(i)):r=r.map(i=>Sc(i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(qO)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},XO),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:sL(t)}:n={realtimeInput:I8(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function ZO(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function QO(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p1=10;function m1(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const o of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Vs(o)){i=!0;break}if(!i)return!0;const s=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Vs(e){return"callTool"in e&&typeof e.callTool=="function"}function eB(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>Vs(i)))!==null&&r!==void 0?r:!1}function tB(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>!Vs(i)))!==null&&r!==void 0?r:!1}function g1(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nB extends Za{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,s,o,u;const d=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!eB(n)||m1(n.config))return await this.generateContentInternal(d);if(tB(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,m;const x=Rr(d.contents),v=(s=(i=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:p1;let _=0;for(;_<v&&(h=await this.generateContentInternal(d),!(!h.functionCalls||h.functionCalls.length===0));){const k=h.candidates[0].content,T=[];for(const E of(u=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&u!==void 0?u:[])if(Vs(E)){const I=await E.callTool(h.functionCalls);T.push(...I)}_++,m={role:"user",parts:T},d.contents=Rr(d.contents),d.contents.push(k),d.contents.push(m),g1(d.config)&&(x.push(k),x.push(m))}return g1(d.config)&&(h.automaticFunctionCallingHistory=x),h},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),m1(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:o.push(d);let u;return s?u={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:u={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},u}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Tl(ja.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>await this.generateVideosInternal(n)}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const o=await Promise.all(s.map(async d=>Vs(d)?await d.tool():d)),u={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:o})};if(u.config.tools=o,t.config&&t.config.tools&&vw(t.config.tools)){const d=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let h=Object.assign({},d);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),yw(h),u.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return u}async initAfcToolsMap(t){var n,r,i;const s=new Map;for(const o of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Vs(o)){const u=o,d=await u.tool();for(const h of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!h.name)throw new Error("Function declaration name is required.");if(s.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);s.set(h.name,u)}}return s}async processAfcStream(t){var n,r,i;const s=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:p1;let o=!1,u=0;const d=await this.initAfcToolsMap(t);return function(h,m,x){var v,_;return bs(this,arguments,function*(){for(var k,T,E,A;u<s;){o&&(u++,o=!1);const M=yield Pt(h.processParamsMaybeAddMcpUsage(x)),P=yield Pt(h.generateContentStreamInternal(M)),F=[],q=[];try{for(var I=!0,C=(T=void 0,Jo(P)),D;D=yield Pt(C.next()),k=D.done,!k;I=!0){A=D.value,I=!1;const z=A;if(yield yield Pt(z),z.candidates&&(!((v=z.candidates[0])===null||v===void 0)&&v.content)){q.push(z.candidates[0].content);for(const te of(_=z.candidates[0].content.parts)!==null&&_!==void 0?_:[])if(u<s&&te.functionCall){if(!te.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(te.functionCall.name)){const Q=yield Pt(m.get(te.functionCall.name).callTool([te.functionCall]));F.push(...Q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${te.functionCall.name}`)}}}}catch(z){T={error:z}}finally{try{!I&&!k&&(E=C.return)&&(yield Pt(E.call(C)))}finally{if(T)throw T.error}}if(F.length>0){o=!0;const z=new Bo;z.candidates=[{content:{role:"user",parts:F}}],yield yield Pt(z);const te=[];te.push(...q),te.push({role:"user",parts:F});const Q=Rr(x.contents).concat(te);x.contents=Q}else break}})}(this,d,t)}async generateContentInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=u1(this.apiClient,t);return u=We("{model}:generateContent",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=f1(m),v=new Bo;return Object.assign(v,x),v})}else{const h=l1(this.apiClient,t);return u=We("{model}:generateContent",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=c1(m),v=new Bo;return Object.assign(v,x),v})}}async generateContentStreamInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=u1(this.apiClient,t);return u=We("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(x){return bs(this,arguments,function*(){var v,_,k,T;try{for(var E=!0,A=Jo(x),I;I=yield Pt(A.next()),v=I.done,!v;E=!0){T=I.value,E=!1;const C=T,D=f1(yield Pt(C.json()));D.sdkHttpResponse={headers:C.headers};const M=new Bo;Object.assign(M,D),yield yield Pt(M)}}catch(C){_={error:C}}finally{try{!E&&!v&&(k=A.return)&&(yield Pt(k.call(A)))}finally{if(_)throw _.error}}})})}else{const h=l1(this.apiClient,t);return u=We("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(x){return bs(this,arguments,function*(){var v,_,k,T;try{for(var E=!0,A=Jo(x),I;I=yield Pt(A.next()),v=I.done,!v;E=!0){T=I.value,E=!1;const C=T,D=c1(yield Pt(C.json()));D.sdkHttpResponse={headers:C.headers};const M=new Bo;Object.assign(M,D),yield yield Pt(M)}}catch(C){_={error:C}}finally{try{!E&&!v&&(k=A.return)&&(yield Pt(k.call(A)))}finally{if(_)throw _.error}}})})}}async embedContent(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=r5(this.apiClient,t);return u=We("{model}:predict",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=dO(m),v=new Vx;return Object.assign(v,x),v})}else{const h=g6(this.apiClient,t);return u=We("{model}:batchEmbedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=H5(m),v=new Vx;return Object.assign(v,x),v})}}async generateImagesInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=a5(this.apiClient,t);return u=We("{model}:predict",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=pO(m),v=new Hx;return Object.assign(v,x),v})}else{const h=v6(this.apiClient,t);return u=We("{model}:predict",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=j5(m),v=new Hx;return Object.assign(v,x),v})}}async editImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=d5(this.apiClient,t);return s=We("{model}:predict",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=mO(d),m=new mD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=p5(this.apiClient,t);return s=We("{model}:predict",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=gO(d),m=new gD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=v5(this.apiClient,t);return s=We("{model}:predict",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const h=xO(d),m=new xD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=y5(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>sd(m))}else{const h=y6(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>ad(m))}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=_5(this.apiClient,t);return u=We("{models_url}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=_O(m),v=new Wx;return Object.assign(v,x),v})}else{const h=_6(this.apiClient,t);return u=We("{models_url}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=q5(m),v=new Wx;return Object.assign(v,x),v})}}async update(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=S5(this.apiClient,t);return u=We("{model}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>sd(m))}else{const h=S6(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>ad(m))}}async delete(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=k5(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=TO(),x=new Gx;return Object.assign(x,m),x})}else{const h=k6(this.apiClient,t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(()=>{const m=K5(),x=new Gx;return Object.assign(x,m),x})}}async countTokens(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=C5(this.apiClient,t);return u=We("{model}:countTokens",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=SO(m),v=new jx;return Object.assign(v,x),v})}else{const h=C6(this.apiClient,t);return u=We("{model}:countTokens",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=J5(m),v=new jx;return Object.assign(v,x),v})}}async computeTokens(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=A5(this.apiClient,t);return s=We("{model}:computeTokens",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=kO(d),m=new vD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=F5(this.apiClient,t);return u=We("{model}:predictLongRunning",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const x=IO(m),v=new oc;return Object.assign(v,x),v})}else{const h=N6(this.apiClient,t);return u=We("{model}:predictLongRunning",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const x=Q5(m),v=new oc;return Object.assign(v,x),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rB(e){const t={},n=c(e,["operationName"]);n!=null&&f(t,["_url","operationName"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function iB(e){const t={},n=c(e,["operationName"]);n!=null&&f(t,["_url","operationName"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function aB(e){const t={},n=c(e,["operationName"]);n!=null&&f(t,["operationName"],n);const r=c(e,["resourceName"]);r!=null&&f(t,["_url","resourceName"],r);const i=c(e,["config"]);return i!=null&&f(t,["config"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sB extends Za{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=iB(t);return u=We("{operationName}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o}else{const h=rB(t);return u=We("{operationName}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o}}async fetchPredictVideosOperationInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=aB(t);return s=We("{resourceName}:fetchPredictOperation",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oB(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function ww(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],oB(n)),t}function lB(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],ww(r)),t}function uB(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>lB(i))),f(t,["speakerVoiceConfigs"],r)}return t}function cB(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],ww(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],uB(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function fB(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function dB(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function hB(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function pB(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],fB(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],dB(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],hB(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function mB(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>pB(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function gB(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function xB(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function vB(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],xB(n)),t}function yB(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function wB(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],yB(n)),t}function _B(){return{}}function TB(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>gB(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],vB(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],wB(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],_B());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function SB(e){const t={},n=c(e,["handle"]);if(n!=null&&f(t,["handle"],n),c(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function x1(){return{}}function kB(e){const t={},n=c(e,["disabled"]);n!=null&&f(t,["disabled"],n);const r=c(e,["startOfSpeechSensitivity"]);r!=null&&f(t,["startOfSpeechSensitivity"],r);const i=c(e,["endOfSpeechSensitivity"]);i!=null&&f(t,["endOfSpeechSensitivity"],i);const s=c(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const o=c(e,["silenceDurationMs"]);return o!=null&&f(t,["silenceDurationMs"],o),t}function EB(e){const t={},n=c(e,["automaticActivityDetection"]);n!=null&&f(t,["automaticActivityDetection"],kB(n));const r=c(e,["activityHandling"]);r!=null&&f(t,["activityHandling"],r);const i=c(e,["turnCoverage"]);return i!=null&&f(t,["turnCoverage"],i),t}function CB(e){const t={},n=c(e,["targetTokens"]);return n!=null&&f(t,["targetTokens"],n),t}function AB(e){const t={},n=c(e,["triggerTokens"]);n!=null&&f(t,["triggerTokens"],n);const r=c(e,["slidingWindow"]);return r!=null&&f(t,["slidingWindow"],CB(r)),t}function IB(e){const t={},n=c(e,["proactiveAudio"]);return n!=null&&f(t,["proactiveAudio"],n),t}function NB(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const u=c(e,["topK"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","topK"],u);const d=c(e,["maxOutputTokens"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","maxOutputTokens"],d);const h=c(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=c(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const x=c(e,["speechConfig"]);t!==void 0&&x!=null&&f(t,["setup","generationConfig","speechConfig"],cB(nh(x)));const v=c(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=c(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],mB(Bn(_)));const k=c(e,["tools"]);if(t!==void 0&&k!=null){let M=Xs(k);Array.isArray(M)&&(M=M.map(P=>TB(Js(P)))),f(t,["setup","tools"],M)}const T=c(e,["sessionResumption"]);t!==void 0&&T!=null&&f(t,["setup","sessionResumption"],SB(T));const E=c(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&f(t,["setup","inputAudioTranscription"],x1());const A=c(e,["outputAudioTranscription"]);t!==void 0&&A!=null&&f(t,["setup","outputAudioTranscription"],x1());const I=c(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&f(t,["setup","realtimeInputConfig"],EB(I));const C=c(e,["contextWindowCompression"]);t!==void 0&&C!=null&&f(t,["setup","contextWindowCompression"],AB(C));const D=c(e,["proactivity"]);return t!==void 0&&D!=null&&f(t,["setup","proactivity"],IB(D)),n}function FB(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],yt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],NB(i,n)),n}function RB(e,t,n){const r={},i=c(t,["expireTime"]);n!==void 0&&i!=null&&f(n,["expireTime"],i);const s=c(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&f(n,["newSessionExpireTime"],s);const o=c(t,["uses"]);n!==void 0&&o!=null&&f(n,["uses"],o);const u=c(t,["liveConnectConstraints"]);n!==void 0&&u!=null&&f(n,["bidiGenerateContentSetup"],FB(e,u));const d=c(t,["lockAdditionalFields"]);return n!==void 0&&d!=null&&f(n,["fieldMask"],d),r}function DB(e,t){const n={},r=c(t,["config"]);return r!=null&&f(n,["config"],RB(e,r,n)),n}function PB(e){const t={},n=c(e,["name"]);return n!=null&&f(t,["name"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MB(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);t.push(...i)}else t.push(n)}return t.join(",")}function LB(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=MB(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(h=>o.includes(h)?`generationConfig.${h}`:h));const d=[];s&&d.push(s),u.length>0&&d.push(...u),d.length>0?e.fieldMask=d.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class OB extends Za{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=DB(this.apiClient,t);s=We("auth_tokens",u._url),o=u._query,delete u.config,delete u._url,delete u._query;const d=LB(u,t.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>PB(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BB(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","name"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function UB(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);t!==void 0&&i!=null&&f(t,["_query","pageToken"],i);const s=c(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),n}function zB(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],UB(n,t)),t}function bB(e){const t={},n=c(e,["textInput"]);n!=null&&f(t,["textInput"],n);const r=c(e,["output"]);return r!=null&&f(t,["output"],r),t}function VB(e){const t={};if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=c(e,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>bB(i))),f(t,["examples","examples"],r)}return t}function HB(e,t){const n={};if(c(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&f(t,["displayName"],r),c(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(e,["epochCount"]);t!==void 0&&i!=null&&f(t,["tuningTask","hyperparameters","epochCount"],i);const s=c(e,["learningRateMultiplier"]);if(s!=null&&f(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=c(e,["batchSize"]);t!==void 0&&o!=null&&f(t,["tuningTask","hyperparameters","batchSize"],o);const u=c(e,["learningRate"]);return t!==void 0&&u!=null&&f(t,["tuningTask","hyperparameters","learningRate"],u),n}function WB(e){const t={},n=c(e,["baseModel"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["trainingDataset"]);r!=null&&f(t,["tuningTask","trainingData"],VB(r));const i=c(e,["config"]);return i!=null&&f(t,["config"],HB(i,t)),t}function GB(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","name"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function jB(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);t!==void 0&&i!=null&&f(t,["_query","pageToken"],i);const s=c(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),n}function $B(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],jB(n,t)),t}function qB(e,t){const n={},r=c(e,["gcsUri"]);t!==void 0&&r!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],r);const i=c(e,["vertexDatasetResource"]);if(t!==void 0&&i!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],i),c(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function KB(e,t){const n={},r=c(e,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const i=c(e,["vertexDatasetResource"]);return t!==void 0&&i!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],i),n}function JB(e,t){const n={},r=c(e,["validationDataset"]);t!==void 0&&r!=null&&f(t,["supervisedTuningSpec"],KB(r,n));const i=c(e,["tunedModelDisplayName"]);t!==void 0&&i!=null&&f(t,["tunedModelDisplayName"],i);const s=c(e,["description"]);t!==void 0&&s!=null&&f(t,["description"],s);const o=c(e,["epochCount"]);t!==void 0&&o!=null&&f(t,["supervisedTuningSpec","hyperParameters","epochCount"],o);const u=c(e,["learningRateMultiplier"]);t!==void 0&&u!=null&&f(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=c(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&f(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=c(e,["adapterSize"]);if(t!==void 0&&h!=null&&f(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),c(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function XB(e){const t={},n=c(e,["baseModel"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["trainingDataset"]);r!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],qB(r,t));const i=c(e,["config"]);return i!=null&&f(t,["config"],JB(i,t)),t}function YB(e){const t={},n=c(e,["name"]);n!=null&&f(t,["model"],n);const r=c(e,["name"]);return r!=null&&f(t,["endpoint"],r),t}function _w(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["state"]);i!=null&&f(t,["state"],Zy(i));const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["tuningTask","startTime"]);o!=null&&f(t,["startTime"],o);const u=c(e,["tuningTask","completeTime"]);u!=null&&f(t,["endTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["description"]);h!=null&&f(t,["description"],h);const m=c(e,["baseModel"]);m!=null&&f(t,["baseModel"],m);const x=c(e,["_self"]);x!=null&&f(t,["tunedModel"],YB(x));const v=c(e,["distillationSpec"]);v!=null&&f(t,["distillationSpec"],v);const _=c(e,["experiment"]);_!=null&&f(t,["experiment"],_);const k=c(e,["labels"]);k!=null&&f(t,["labels"],k);const T=c(e,["pipelineJob"]);T!=null&&f(t,["pipelineJob"],T);const E=c(e,["satisfiesPzi"]);E!=null&&f(t,["satisfiesPzi"],E);const A=c(e,["satisfiesPzs"]);A!=null&&f(t,["satisfiesPzs"],A);const I=c(e,["serviceAccount"]);I!=null&&f(t,["serviceAccount"],I);const C=c(e,["tunedModelDisplayName"]);return C!=null&&f(t,["tunedModelDisplayName"],C),t}function ZB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>_w(o))),f(t,["tuningJobs"],s)}return t}function QB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["metadata"]);i!=null&&f(t,["metadata"],i);const s=c(e,["done"]);s!=null&&f(t,["done"],s);const o=c(e,["error"]);return o!=null&&f(t,["error"],o),t}function e7(e){const t={},n=c(e,["checkpointId"]);n!=null&&f(t,["checkpointId"],n);const r=c(e,["epoch"]);r!=null&&f(t,["epoch"],r);const i=c(e,["step"]);i!=null&&f(t,["step"],i);const s=c(e,["endpoint"]);return s!=null&&f(t,["endpoint"],s),t}function t7(e){const t={},n=c(e,["model"]);n!=null&&f(t,["model"],n);const r=c(e,["endpoint"]);r!=null&&f(t,["endpoint"],r);const i=c(e,["checkpoints"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>e7(o))),f(t,["checkpoints"],s)}return t}function ld(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["state"]);i!=null&&f(t,["state"],Zy(i));const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["startTime"]);o!=null&&f(t,["startTime"],o);const u=c(e,["endTime"]);u!=null&&f(t,["endTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["error"]);h!=null&&f(t,["error"],h);const m=c(e,["description"]);m!=null&&f(t,["description"],m);const x=c(e,["baseModel"]);x!=null&&f(t,["baseModel"],x);const v=c(e,["tunedModel"]);v!=null&&f(t,["tunedModel"],t7(v));const _=c(e,["supervisedTuningSpec"]);_!=null&&f(t,["supervisedTuningSpec"],_);const k=c(e,["tuningDataStats"]);k!=null&&f(t,["tuningDataStats"],k);const T=c(e,["encryptionSpec"]);T!=null&&f(t,["encryptionSpec"],T);const E=c(e,["partnerModelTuningSpec"]);E!=null&&f(t,["partnerModelTuningSpec"],E);const A=c(e,["distillationSpec"]);A!=null&&f(t,["distillationSpec"],A);const I=c(e,["experiment"]);I!=null&&f(t,["experiment"],I);const C=c(e,["labels"]);C!=null&&f(t,["labels"],C);const D=c(e,["pipelineJob"]);D!=null&&f(t,["pipelineJob"],D);const M=c(e,["satisfiesPzi"]);M!=null&&f(t,["satisfiesPzi"],M);const P=c(e,["satisfiesPzs"]);P!=null&&f(t,["satisfiesPzs"],P);const F=c(e,["serviceAccount"]);F!=null&&f(t,["serviceAccount"],F);const q=c(e,["tunedModelDisplayName"]);return q!=null&&f(t,["tunedModelDisplayName"],q),t}function n7(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ld(o))),f(t,["tuningJobs"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r7 extends Za{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Tl(ja.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let i="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?i=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(i=r.name.split("/operations/")[0]),{name:i,state:Z0.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=GB(t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>ld(m))}else{const h=BB(t);return u=We("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>_w(m))}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=$B(t);return u=We("tuningJobs",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=n7(m),v=new qx;return Object.assign(v,x),v})}else{const h=zB(t);return u=We("tunedModels",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=ZB(m),v=new qx;return Object.assign(v,x),v})}}async tuneInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=XB(t);return s=We("tuningJobs",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>ld(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=WB(t);return s=We("tunedModels",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>QB(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i7{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const a7=1024*1024*8,s7=3,o7=1e3,l7=2,D0="x-goog-upload-status";async function u7(e,t,n){var r,i,s;let o=0,u=0,d=new Q0(new Response),h="upload";for(o=e.size;u<o;){const x=Math.min(a7,o-u),v=e.slice(u,u+x);u+x>=o&&(h+=", finalize");let _=0,k=o7;for(;_<s7&&(d=await n.request({path:"",body:v,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(u),"Content-Length":String(x)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[D0]));)_++,await f7(k),k=k*l7;if(u+=x,((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[D0])!=="active")break;if(o<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const m=await(d==null?void 0:d.json());if(((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[D0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return m.file}async function c7(e){return{size:e.size,type:e.type}}function f7(e){return new Promise(t=>setTimeout(t,e))}class d7{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await u7(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await c7(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h7{create(t,n,r){return new p7(t,n,r)}}class p7{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const v1="x-goog-api-key";class m7{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(v1)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(v1,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const g7="gl-node/";class x7{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=pD(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new m7(this.apiKey);this.apiClient=new OO({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:g7+"web",uploader:new d7,downloader:new i7}),this.models=new nB(this.apiClient),this.live=new JO(this.apiClient,i,new h7),this.batches=new UP(this.apiClient),this.chats=new HM(this.models,this.apiClient),this.caches=new zM(this.apiClient),this.files=new t8(this.apiClient),this.operations=new sB(this.apiClient),this.authTokens=new OB(this.apiClient),this.tunings=new r7(this.apiClient)}}const v7=new x7({apiKey:"PLACEHOLDER_API_KEY"}),y7=async(e,t)=>{const r=`Działając jako starszy kierownik projektu, wygeneruj zwięzłą listę kontrolną (checklistę) do przeglądu etapu (gate review) dla fazy "${ra[t]}" w projekcie o nazwie "${e}". Lista powinna być w języku polskim. Skup się na kluczowych rezultatach i kryteriach akceptacji dla tej fazy. Zwróć maksymalnie 10 najważniejszych punktów.`;try{const s=(await v7.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:{type:Nr.OBJECT,properties:{checklist:{type:Nr.ARRAY,description:"Lista punktów kontrolnych do przeglądu etapu.",items:{type:Nr.OBJECT,properties:{text:{type:Nr.STRING,description:"Pojedynczy punkt kontrolny na liście."}},required:["text"]}}},required:["checklist"]}}})).text.trim(),o=JSON.parse(s);return o.checklist&&Array.isArray(o.checklist)?o.checklist.map(u=>({text:u.text,checked:!1})):[]}catch(i){return console.error("Error generating checklist with Gemini API:",i),[{text:"Weryfikacja celu etapu.",checked:!1},{text:"Sprawdzenie zgodności z wymaganiami.",checked:!1},{text:"Ocena zidentyfikowanych ryzyk.",checked:!1}]}},w7=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.31-2.31L12.602 18l1.178-.398a3.375 3.375 0 002.31-2.31L16.5 14.25l.398 1.178a3.375 3.375 0 002.31 2.31L20.398 18l-1.178.398a3.375 3.375 0 00-2.31 2.31z"})}),_7=({isOpen:e,onClose:t,onSave:n,pkg:r,stage:i,existingReview:s})=>{const[o,u]=pe.useState([]),[d,h]=pe.useState(""),[m,x]=pe.useState("Not Reviewed"),[v,_]=pe.useState(!1);pe.useEffect(()=>{e&&(s?(u(s.checklist),h(s.comments),x(s.status)):(u([]),h(""),x("Not Reviewed")))},[s,e]);const k=async()=>{_(!0);const A=await y7(r.name,i);u(A),_(!1)},T=A=>{const I=[...o];I[A].checked=!I[A].checked,u(I)},E=async()=>{if(m==="Not Reviewed"){alert("Proszę wybrać status przeglądu (Zaliczony, Niezaliczony, etc.).");return}const A={id:s==null?void 0:s.id,packageId:r.id,stage:i,status:m,checklist:o,comments:d,createdAt:(s==null?void 0:s.createdAt)||new Date().toISOString()};await n(A),t()};return y.jsx(sr,{isOpen:e,onClose:t,title:`Przegląd: ${ra[i]}`,children:y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-bold text-gray-900",children:r.name}),y.jsx("p",{className:"text-gray-500",children:"Proszę przejść przez listę kontrolną, dodać komentarze i ustawić status końcowy."})]}),y.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("h4",{className:"font-semibold text-lg text-gray-900",children:"Lista kontrolna"}),y.jsxs(qe,{onClick:k,disabled:v,variant:"primary",children:[y.jsx(w7,{className:"w-5 h-5 mr-2 inline"}),v?"Generowanie...":"Generuj listę z AI"]})]}),v&&y.jsx("div",{className:"text-center text-gray-500 py-4",children:"Chwileczkę, AI przygotowuje punkty..."}),o.length>0?y.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:o.map((A,I)=>y.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-gray-100 cursor-pointer transition-colors",children:[y.jsx("input",{type:"checkbox",checked:A.checked,onChange:()=>T(I),className:"h-4 w-4 rounded bg-gray-200 border-gray-300 text-blue-600 focus:ring-blue-500"}),y.jsx("span",{className:`ml-3 text-sm text-gray-700 ${A.checked?"line-through text-gray-400":""}`,children:A.text})]},I))}):!v&&y.jsx("div",{className:"text-center text-gray-500 text-sm py-4",children:'Kliknij "Generuj listę z AI", aby rozpocząć.'})]}),y.jsx(Ei,{label:"Komentarze",value:d,onChange:A=>h(A.target.value),rows:4,placeholder:"Dodaj ogólne uwagi, warunki, lub uzasadnienie decyzji."}),y.jsx(mr,{label:"Status końcowy przeglądu",value:m,onChange:A=>x(A.target.value),children:m2.map(A=>y.jsx("option",{value:A,children:C1[A]},A))}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:E,disabled:v,children:"Zapisz przegląd"})]})]})})},y1=e=>e.toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"}),Tw=({schedule:e})=>e.length===0?y.jsxs("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg border border-dashed border-gray-300 text-center text-gray-500",children:[y.jsx("p",{children:"Brak danych z roadmapy do wygenerowania harmonogramu."}),y.jsx("p",{className:"text-sm",children:"Upewnij się, że ta paczka jest powiązana z pozycją na roadmapie i ma zdefiniowane estymacje godzinowe."})]}):y.jsxs(On,{className:"mt-6 bg-white",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Planowany Harmonogram (wg estymat)"}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"min-w-full text-sm text-left",children:[y.jsx("thead",{className:"text-gray-600 bg-gray-50",children:y.jsxs("tr",{className:"border-b border-gray-200",children:[y.jsx("th",{className:"p-3 font-semibold",children:"Etap"}),y.jsx("th",{className:"p-3 font-semibold",children:"Planowany Start"}),y.jsx("th",{className:"p-3 font-semibold",children:"Planowany Stop"}),y.jsx("th",{className:"p-3 font-semibold text-center",children:"Dni Robocze"}),y.jsx("th",{className:"p-3 font-semibold text-center",children:"Godziny"})]})}),y.jsx("tbody",{className:"text-gray-700",children:e.map(t=>y.jsxs("tr",{className:"border-b border-gray-100 last:border-0 hover:bg-gray-50",children:[y.jsx("td",{className:"p-3 font-medium text-gray-800",children:t.name}),y.jsx("td",{className:"p-3",children:y1(t.startDate)}),y.jsx("td",{className:"p-3",children:y1(t.stopDate)}),y.jsx("td",{className:"p-3 text-center font-semibold",children:t.durationDays}),y.jsx("td",{className:"p-3 text-center",children:t.key==="development"?y.jsxs("span",{className:"text-xs",children:["IT: ",t.itHours,"h / LF: ",t.lfHours,"h"]}):`${t.durationHours}h`})]},t.name))})]})})]}),w1=(e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n},Xo=(e,t)=>{const n=new Date(e);n.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const i=n.getTime()-r.getTime();return Math.round(i/(1e3*60*60*24))},_1=e=>e.toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"}),T1=({row:e,chartStartDate:t,gridRow:n,isProposed:r=!1})=>{const i=Xo(e.startDate,t)+1,s=Math.max(1,Xo(e.stopDate,e.startDate)+1),o=e.key.startsWith("development")?"development":e.key,u=p2[o]||"bg-gray-400",d="text-white",h={gridColumn:`${i} / span ${s}`,gridRow:n};return y.jsx("div",{style:h,title:`${e.name}: ${_1(e.startDate)} - ${_1(e.stopDate)} (${e.durationDays} dni)`,className:`flex items-center rounded h-6 text-xs font-semibold px-2 overflow-hidden shadow-sm ${u} ${d} ${r?"opacity-70 border-2 border-dashed border-white/50":""}`,children:y.jsx("span",{className:"truncate",children:e.name})})},ih=({scheduleData:e,proposedScheduleData:t=null,goLiveDate:n})=>{const r=[e.schedule,t==null?void 0:t.schedule].filter(Boolean);if(r.length===0||r.every(C=>C.length===0))return null;const i=r.flat().map(C=>C.startDate),s=r.flat().map(C=>C.stopDate),o=new Date(Math.min(...i.map(C=>C.getTime()))),u=new Date(Math.max(...s.map(C=>C.getTime()))),d=new Date(o.getFullYear(),o.getMonth(),1),h=new Date(u.getFullYear(),u.getMonth()+1,0);h.setHours(23,59,59,999);const m=Xo(h,d)+1,x=[],v=[];let _=new Date(d),k=-1;for(let C=1;C<=m;C++){const D=_.getMonth();D!==k&&(x.push({name:_.toLocaleString("pl-PL",{month:"long"}),year:_.getFullYear().toString().slice(-2),daySpan:0,startDayIndex:C}),k=D),x[x.length-1].daySpan++,_.getDay()===1&&v.push({day:_.getDate().toString().padStart(2,"0"),startDayIndex:C}),_=w1(_,1)}const T=new Date;T.setHours(0,0,0,0);const E=T>=d&&T<=h?Xo(T,d)+1:null,A=n?new Date(n):null;A&&A.setHours(0,0,0,0);const I=A&&A>=d&&A<=h?Xo(A,d)+1:null;return y.jsxs(On,{className:"mt-6 bg-white",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Oś Czasu Projektu"}),y.jsx("div",{className:"overflow-x-auto pb-4",children:y.jsxs("div",{className:"relative grid gap-y-2 pt-16",style:{gridTemplateColumns:`repeat(${m}, minmax(1.5rem, 1fr))`,gridTemplateRows:"auto auto repeat(4, 1.75rem)",minWidth:`${m*1.5}rem`},children:[x.map(C=>y.jsx("div",{className:"text-center py-1 border-b-2 border-gray-300 sticky top-0 bg-white/80 backdrop-blur-sm z-20",style:{gridColumn:`${C.startDayIndex} / span ${C.daySpan}`,gridRow:1},children:y.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[C.name," '",C.year]})},`${C.name}-${C.year}`)),v.map(C=>y.jsx("div",{className:"text-center text-xs text-gray-500 sticky top-8 bg-white/80 backdrop-blur-sm z-20 pt-1",style:{gridColumn:C.startDayIndex,gridRow:2},children:C.day},`week-${C.startDayIndex}`)),Array.from({length:m}).map((C,D)=>{const P=w1(d,D).getDay()===1;return y.jsx("div",{className:`border-r ${P?"border-gray-300":"border-gray-100"}`,style:{gridColumn:D+1,gridRow:"3 / -1"}},`grid-${D}`)}),I&&y.jsxs("div",{style:{gridColumn:I,gridRow:"3 / -1"},className:"relative z-10",children:[y.jsx("div",{className:"w-px h-full bg-green-500 mx-auto"}),y.jsx("span",{className:"absolute -top-14 left-1/2 -translate-x-1/2 bg-green-100 text-green-700 text-xs font-bold px-2 py-0.5 rounded-full whitespace-nowrap",children:"Go-Live"})]}),E&&y.jsxs("div",{style:{gridColumn:E,gridRow:"3 / -1"},className:"relative z-10",children:[y.jsx("div",{className:"w-px h-full bg-red-500 mx-auto"}),y.jsx("span",{className:"absolute -top-14 left-1/2 -translate-x-1/2 bg-red-100 text-red-700 text-xs font-bold px-2 py-0.5 rounded-full",children:"Dziś"})]}),e.schedule.map(C=>y.jsx(T1,{row:C,chartStartDate:d,gridRow:t?3:4},`orig-${C.key}`)),t==null?void 0:t.schedule.map(C=>y.jsx(T1,{row:C,chartStartDate:d,gridRow:4,isProposed:!0},`prop-${C.key}`)),t&&y.jsxs("div",{style:{gridColumn:`1 / span ${m}`,gridRow:6},className:"flex items-center space-x-4 mt-4 pt-2 border-t border-gray-200",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"w-3 h-3 rounded-sm bg-gray-500 mr-2 border border-gray-600"}),y.jsx("span",{className:"text-xs text-gray-600",children:"Oryginalny harmonogram"})]}),y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"w-3 h-3 rounded-sm bg-gray-500 opacity-70 border border-dashed border-gray-700 mr-2"}),y.jsx("span",{className:"text-xs text-gray-600",children:"Proponowany harmonogram"})]})]})]})})]})},T7=({packages:e,reviews:t,onSaveReview:n,roadmapItems:r})=>{const[i,s]=pe.useState(""),[o,u]=pe.useState(!1),[d,h]=pe.useState(null),m=pe.useMemo(()=>e.map(D=>({value:D.id,label:D.name})),[e]),x=pe.useMemo(()=>i&&e.find(D=>D.id===i)||null,[i,e]),v=pe.useMemo(()=>i?t.filter(D=>D.packageId===i):[],[t,i]),{scheduleData:_,totalItHours:k,totalLfHours:T,ordersCount:E}=pe.useMemo(()=>{if(!x)return{scheduleData:{schedule:[],overallStartDate:null,overallEndDate:null},totalItHours:0,totalLfHours:0,ordersCount:0};const D=r.filter(z=>z.packageName===x.name),M=D.reduce((z,te)=>z+(te.analysisHours||0)+(te.devITHours||0)+(te.testingHours||0)+(te.deploymentHours||0),0),P=D.reduce((z,te)=>z+(te.workLFHours||0),0),F=D[0];return{scheduleData:ac(x,F),totalItHours:M,totalLfHours:P,ordersCount:D.length}},[x,r]),A=(D,M)=>{h({pkg:D,stage:M}),u(!0)},I=()=>{u(!1),h(null)},C=D=>{const M=v.slice().sort((P,F)=>new Date(F.createdAt).getTime()-new Date(P.createdAt).getTime()).find(P=>P.stage===D);return M?M.status:"Not Reviewed"};return y.jsxs("div",{className:"h-full overflow-y-auto",children:[y.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Przeglądy Paczek"}),y.jsx(On,{className:"mb-6",children:y.jsx("div",{className:"max-w-md",children:y.jsxs(mr,{label:"Wybierz paczkę do przeglądu",value:i,onChange:D=>s(D.target.value?Number(D.target.value):""),children:[y.jsx("option",{value:"",children:"-- Wybierz paczkę --"}),m.map(D=>y.jsx("option",{value:D.value,children:D.label},D.value))]})})}),x?y.jsxs(On,{children:[y.jsxs("div",{className:"flex justify-between items-baseline",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:x.name}),y.jsxs("div",{className:"flex items-center space-x-4",children:[y.jsxs("span",{className:"text-sm text-gray-500 font-semibold",children:["Zlecenia: ",y.jsx("span",{className:"font-bold text-gray-700",children:E})]}),y.jsxs("span",{className:"text-sm text-gray-500 font-semibold",children:["IT: ",y.jsxs("span",{className:"font-bold text-gray-700",children:[k,"h"]})]}),y.jsxs("span",{className:"text-sm text-gray-500 font-semibold",children:["LF: ",y.jsxs("span",{className:"font-bold text-gray-700",children:[T,"h"]})]})]})]}),y.jsx("p",{className:"text-gray-500 mb-1",children:"Status przeglądów dla poszczególnych etapów."}),y.jsx(Tw,{schedule:_.schedule}),y.jsx(ih,{scheduleData:_,goLiveDate:x.currentGoLiveDate}),y.jsx("h3",{className:"text-xl font-semibold text-gray-900 mt-8 mb-4",children:"Bramki Przeglądowe"}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:cd.map(D=>{const M=C(D),P=g2[M],F=C1[M];return y.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm flex flex-col justify-between",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-lg text-gray-900",children:ra[D]}),y.jsx("span",{className:`mt-2 inline-block px-2 py-1 text-xs font-semibold rounded-full ${P}`,children:F})]}),y.jsx(qe,{className:"mt-4 w-full",onClick:()=>A(x,D),variant:"secondary",children:M==="Not Reviewed"?"Rozpocznij przegląd":"Zobacz / Edytuj"})]},D)})})]}):y.jsx("div",{className:"flex items-center justify-center h-full -mt-24",children:y.jsxs("div",{className:"text-center",children:[y.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:y.jsx("path",{vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),y.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-800",children:"Brak wybranej paczki"}),y.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Wybierz paczkę, aby zobaczyć status jej przeglądów."})]})}),d&&y.jsx(_7,{isOpen:o,onClose:I,onSave:n,pkg:d.pkg,stage:d.stage,existingReview:v.slice().sort((D,M)=>new Date(M.createdAt).getTime()-new Date(D.createdAt).getTime()).find(D=>D.stage===d.stage)||null})]})},S7=()=>{const e=({title:t,children:n})=>y.jsxs("div",{className:"mb-8",children:[y.jsx("h3",{className:"text-xl font-bold text-blue-600 mb-3 border-b border-gray-200 pb-2",children:t}),y.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:n})]});return y.jsx("div",{className:"h-full overflow-y-auto",children:y.jsxs(On,{children:[y.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Centrum Pomocy"}),y.jsx("p",{className:"mb-10 text-gray-500",children:"W tej sekcji znajdziesz wszystkie potrzebne informacje dotyczące uruchamiania, udostępniania i technicznych aspektów działania aplikacji."}),y.jsxs("div",{className:"mb-12",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b-2 border-blue-500",children:"Instrukcja Uruchomienia Aplikacji na Innym Komputerze"}),y.jsx("p",{className:"mb-8 text-gray-500",children:'Ten przewodnik krok po kroku wyjaśnia, jak uruchomić aplikację "Menedżer Releasów" na innym komputerze. Aplikacja działa w całości w przeglądarce internetowej i nie wymaga skomplikowanego procesu instalacyjnego.'}),y.jsxs(e,{title:"Krok 1: Przygotowanie plików do przeniesienia",children:[y.jsx("p",{children:"Pierwszym krokiem jest spakowanie wszystkich plików aplikacji do jednego archiwum."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Zlokalizuj folder, w którym znajdują się pliki tej aplikacji na Twoim komputerze."}),y.jsx("li",{children:'Kliknij prawym przyciskiem myszy na ten folder, a następnie z menu kontekstowego wybierz opcję "Wyślij do" > "Folder skompresowany (zip)".'}),y.jsxs("li",{children:["System utworzy nowy plik z rozszerzeniem `.zip`. Możesz nadać mu dowolną nazwę, np. ",y.jsx("strong",{children:"Menedzer-Releasow.zip"}),"."]})]})]}),y.jsxs(e,{title:"Krok 2: Przeniesienie plików na nowy komputer",children:[y.jsx("p",{children:"Przenieś utworzony plik `.zip` na docelowy komputer. Możesz do tego użyć dowolnej, wygodnej dla Ciebie metody:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Pamięć USB (pendrive)."}),y.jsx("li",{children:"Wysłanie pliku jako załącznik w wiadomości e-mail."}),y.jsx("li",{children:"Umieszczenie pliku w chmurze (np. Dysk Google, Dropbox, OneDrive) i pobranie go na drugim komputerze."})]})]}),y.jsxs(e,{title:"Krok 3: Rozpakowanie plików na nowym komputerze",children:[y.jsx("p",{children:"Gdy plik `.zip` znajdzie się na nowym komputerze, należy go rozpakować."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Znajdź przeniesiony plik `.zip`."}),y.jsx("li",{children:'Kliknij na niego prawym przyciskiem myszy i wybierz opcję "Wyodrębnij wszystkie..." lub "Rozpakuj tutaj".'}),y.jsx("li",{children:"Wybierz miejsce, gdzie chcesz zapisać pliki aplikacji, na przykład na Pulpicie lub w folderze Moje Dokumenty."})]})]}),y.jsxs(e,{title:"Krok 4: Uruchomienie aplikacji",children:[y.jsx("p",{children:"To ostatni i najważniejszy krok."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Otwórz folder, do którego przed chwilą zostały wypakowane wszystkie pliki."}),y.jsxs("li",{children:["Znajdź w nim plik o nazwie ",y.jsx("strong",{children:"index.html"}),"."]}),y.jsxs("li",{className:"font-semibold text-yellow-700 bg-yellow-50 p-2 rounded-md",children:['Ważne: Kliknij prawym przyciskiem myszy na plik `index.html`, wybierz opcję "Otwórz za pomocą", a następnie wskaż nowoczesną przeglądarkę internetową, taką jak ',y.jsx("strong",{children:"Google Chrome"})," lub ",y.jsx("strong",{children:"Mozilla Firefox"}),". Zwykłe dwukrotne kliknięcie może nie zadziałać poprawnie."]}),y.jsx("li",{children:"Aplikacja powinna otworzyć się w nowej karcie przeglądarki i być gotowa do użycia."})]})]})]}),y.jsx("hr",{className:"my-12 border-gray-200"}),y.jsxs("div",{className:"mb-12",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b-2 border-blue-500",children:"Instrukcja Przygotowania Wersji Produkcyjnej"}),y.jsx("p",{className:"mb-8 text-gray-500",children:'"Wersja produkcyjna" w kontekście tej aplikacji to po prostu paczka ze wszystkimi jej plikami, gotowa do przekazania innej osobie. Ten przewodnik pokazuje, jak ją przygotować.'}),y.jsxs(e,{title:"Krok 1: Zlokalizuj i spakuj pliki aplikacji",children:[y.jsx("p",{children:"Aby przekazać aplikację, musisz najpierw zebrać wszystkie jej pliki w jedno archiwum `.zip`."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Odszukaj na swoim komputerze główny folder zawierający pliki aplikacji (np. `index.html`, `App.tsx` itd.)."}),y.jsx("li",{children:"Kliknij prawym przyciskiem myszy na ten folder."}),y.jsx("li",{children:'Z menu kontekstowego wybierz opcję, która pozwoli Ci skompresować folder. Zazwyczaj nazywa się ona "Wyślij do" > "Folder skompresowany (zip)" w systemie Windows lub "Kompresuj" w systemie macOS.'}),y.jsxs("li",{children:["Po wykonaniu tej czynności powstanie nowy plik z rozszerzeniem `.zip`, np. ",y.jsx("strong",{children:"Menedzer-Releasow.zip"}),'. Ten plik to Twoja "wersja produkcyjna".']})]})]}),y.jsxs(e,{title:"Krok 2: Przekaż paczkę nowemu użytkownikowi",children:[y.jsx("p",{children:"Utworzony plik `.zip` możesz teraz przekazać innej osobie. Możesz to zrobić na wiele sposobów:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Wysyłając go jako załącznik e-mail."}),y.jsx("li",{children:"Kopiując na nośnik USB (pendrive)."}),y.jsx("li",{children:"Udostępniając przez dysk chmurowy (np. Dysk Google, OneDrive)."})]})]}),y.jsxs("div",{className:"mt-8 border-t-2 border-red-500 pt-6",children:[y.jsx("h3",{className:"text-2xl font-bold text-red-600 mb-3",children:"Bardzo Ważne: Kwestia Danych"}),y.jsxs("ul",{className:"list-disc list-inside space-y-3 pl-4",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Dane nie są przenoszone!"}),' Przygotowany plik `.zip` zawiera wyłącznie pliki aplikacji (jej "silnik" i wygląd), ale ',y.jsx("strong",{children:"NIE ZAWIERA żadnych danych"}),", które wprowadziłeś/aś (wydań, paczek, zadań itp.)."]}),y.jsxs("li",{children:["Nowy użytkownik po otwarciu aplikacji zobaczy ",y.jsx("strong",{children:"czysty program"})," z domyślnymi danymi startowymi, a nie Twoje wpisy."]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Dlaczego tak się dzieje?"})," Aplikacja zapisuje wszystkie dane lokalnie, w pamięci przeglądarki (technologia IndexedDB) na Twoim komputerze. Dane te nie są częścią plików aplikacji i nie można ich w ten sposób skopiować."]})]})]})]}),y.jsx("hr",{className:"my-12 border-gray-200"}),y.jsxs("div",{className:"mb-12",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b-2 border-blue-500",children:'Przewodnik po "Buildzie" Aplikacji'}),y.jsx("p",{className:"mb-8 text-gray-500",children:'Zadałeś/aś świetne pytanie o "build". To fundamentalny koncept w tworzeniu nowoczesnych stron internetowych. Ten przewodnik wyjaśni, czym jest "build", dlaczego ta aplikacja go nie potrzebuje i jak mimo to można ją udostępniać.'}),y.jsxs(e,{title:"1. Czym jest proces 'buildu' w tworzeniu aplikacji?",children:[y.jsxs("p",{children:["W większości profesjonalnych projektów kod pisany przez deweloperów (np. pliki `.tsx` z Reactem) nie jest bezpośrednio uruchamiany w przeglądarce. Zamiast tego przechodzi przez proces zwany ",y.jsx("strong",{children:'"buildem"'})," (budowaniem)."]}),y.jsx("p",{children:"Proces ten, realizowany przez narzędzia takie jak Vite, Webpack czy Parcel, wykonuje kilka kluczowych zadań:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Kompilacja:"})," Zamienia nowoczesny kod (JSX, TypeScript) na standardowy JavaScript, zrozumiały dla wszystkich przeglądarek."]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Bundling (Łączenie):"})," Łączy dziesiątki, a nawet setki małych plików JavaScript w jeden lub kilka większych, zoptymalizowanych plików. Redukuje to liczbę zapytań do serwera i przyspiesza ładowanie strony."]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Minifikacja:"})," Usuwa z kodu wszystkie niepotrzebne znaki (spacje, komentarze) i skraca nazwy zmiennych, aby pliki wynikowe były jak najmniejsze."]})]}),y.jsxs("p",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("strong",{children:"W skrócie:"}),' "Build" to proces tworzenia zoptymalizowanej, produkcyjnej wersji aplikacji z kodu źródłowego.']})]}),y.jsxs(e,{title:"2. Dlaczego ta aplikacja NIE MA tradycyjnego procesu 'buildu'?",children:[y.jsxs("p",{children:["Ta aplikacja została stworzona z myślą o ",y.jsx("strong",{children:"maksymalnej prostocie"})," i transparentności. Zamiast używać skomplikowanych narzędzi do budowania, wykorzystuje nowoczesne funkcje samych przeglądarek:"]}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"ES Modules (ESM):"}),' Plik `index.html` wczytuje bezpośrednio plik `index.tsx` za pomocą `type="module"`. Przeglądarka sama potrafi analizować zależności (`import`) i wczytywać kolejne pliki.']}),y.jsxs("li",{children:[y.jsx("strong",{children:"CDN (Content Delivery Network):"})," Biblioteka React nie jest dołączona do plików aplikacji, ale jest ładowana dynamicznie z szybkiej, zewnętrznej sieci (esm.sh)."]})]}),y.jsxs("p",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-800",children:[y.jsx("strong",{children:"Zaleta tego podejścia:"})," Nie musisz instalować żadnych dodatkowych narzędzi (Node.js, npm) ani uruchamiać żadnych komend, aby zobaczyć działającą aplikację lub wprowadzić w niej zmiany. Wystarczy edytować pliki i odświeżyć przeglądarkę."]})]})]})]})})},k7=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),S1={releases:{name:"Wydania (Releasy)",headers:["name","details","releaseDate"]},roadmap:{name:"Roadmapa",headers:["jira","orderName","packageName","analysisHours","devITHours","devLFHours","testingHours","deploymentHours","stabilizationLFHours","totalITHoursWithBuffer","workLFHours","totalHours","comment"]},backlog:{name:"Backlog",headers:["ticketId","description","foz","plannedDate","analyst","status","decision","comment"]}},E7=({isOpen:e,onClose:t,onImport:n,isLoading:r,error:i})=>{const[s,o]=pe.useState("releases"),[u,d]=pe.useState(null),h=pe.useMemo(()=>S1[s],[s]),m=v=>{v.target.files&&v.target.files.length>0?d(v.target.files[0]):d(null)},x=async()=>{if(!u){alert("Proszę wybrać plik do importu.");return}await n(s,u)};return pe.useEffect(()=>{e||d(null)},[e]),y.jsx(sr,{isOpen:e,onClose:t,title:"Importuj dane z pliku Excel (.xlsx)",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(mr,{label:"Co chcesz zaimportować?",value:s,onChange:v=>o(v.target.value),disabled:r,children:Object.entries(S1).map(([v,_])=>y.jsx("option",{value:v,children:_.name},v))}),y.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Instrukcja formatowania pliku Excel"}),y.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Wybierz plik `.xlsx`. Upewnij się, że pierwszy arkusz zawiera dane, pierwszy wiersz to nagłówki, a kolumny są w następującej kolejności:"}),y.jsx("code",{className:"block text-xs bg-gray-100 p-2 rounded-md text-blue-800 overflow-x-auto",children:h.headers.join(", ")}),y.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Komórki z datami (`releaseDate`, `plannedDate`) powinny być sformatowane jako data w Excelu."})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wybierz plik .xlsx"}),y.jsx("div",{className:"mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:y.jsxs("div",{className:"space-y-1 text-center",children:[y.jsx(k7,{className:"mx-auto h-12 w-12 text-gray-400"}),y.jsxs("div",{className:"flex text-sm text-gray-600",children:[y.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-offset-gray-100 focus-within:ring-blue-500 px-1",children:[y.jsx("span",{children:"Prześlij plik"}),y.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls",onChange:m,disabled:r})]}),y.jsx("p",{className:"pl-1",children:"lub przeciągnij i upuść"})]}),u?y.jsx("p",{className:"text-sm text-green-600",children:u.name}):y.jsx("p",{className:"text-xs text-gray-500",children:"Tylko pliki .xlsx i .xls"})]})})]}),i&&y.jsxs("div",{className:"p-3 bg-red-100 border border-red-300 text-red-800 rounded-md text-sm",children:[y.jsx("p",{className:"font-semibold mb-1",children:"Błąd importu:"}),y.jsx("p",{className:"whitespace-pre-wrap",children:i})]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,disabled:r,children:"Anuluj"}),y.jsx(qe,{onClick:x,disabled:r||!u,children:r?"Importowanie...":"Rozpocznij Import"})]})]})})},C7={releases:{name:"Wydania (Releasy)"},roadmap:{name:"Roadmapa"},backlog:{name:"Backlog"}},A7=({isOpen:e,onClose:t,onExport:n})=>{const[r,i]=pe.useState("releases"),s=()=>{n(r)};return y.jsx(sr,{isOpen:e,onClose:t,title:"Eksportuj dane do pliku Excel (.xlsx)",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(mr,{label:"Co chcesz wyeksportować?",value:r,onChange:o=>i(o.target.value),children:Object.entries(C7).map(([o,u])=>y.jsx("option",{value:o,children:u.name},o))}),y.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Informacje"}),y.jsxs("p",{className:"text-sm text-gray-600",children:["Ta operacja wyeksportuje ",y.jsx("strong",{children:"wszystkie"})," dane z wybranej kategorii do pliku Excela (`.xlsx`). Format pliku będzie zgodny z wymaganiami dla funkcji importu."]})]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:s,children:"Eksportuj"})]})]})})},I7=e=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 105 28",height:"28",...e,children:[y.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        .grupa-text { font-family: 'Inter', sans-serif; font-size: 14px; fill: #6b7280; letter-spacing: 0.5px; }
        .neuca-text { font-family: 'Inter', sans-serif; font-size: 14px; fill: #374151; font-weight: 700; letter-spacing: 0.5px;}
      `}),y.jsx("text",{x:"0",y:"19",className:"grupa-text",children:"GRUPA"}),y.jsx("text",{x:"48",y:"19",className:"neuca-text",children:"NEUCA"})]}),N7=({isOpen:e,onClose:t,onAssign:n,packages:r})=>{const[i,s]=pe.useState(""),o=pe.useMemo(()=>r.filter(d=>d.status==="todo"||d.status==="planning"),[r]);pe.useEffect(()=>{e&&(o.length>0?s(o[0].name):s(""))},[e,o]);const u=()=>{i?n(i):alert("Proszę wybrać paczkę.")};return y.jsx(sr,{isOpen:e,onClose:t,title:"Przypisz do paczki",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:"Wybierz paczkę, do której chcesz przypisać to zlecenie. Spowoduje to otwarcie formularza estymacji na roadmapie."}),o.length>0?y.jsx(mr,{label:"Dostępne paczki",value:i,onChange:d=>s(d.target.value),children:o.map(d=>y.jsx("option",{value:d.name,children:d.name},d.id))}):y.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-center text-yellow-800",children:'Brak dostępnych paczek w statusie "Do zaplanowania" lub "W planowaniu".'}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:u,disabled:!i,children:"Dalej"})]})]})})},F7=({isOpen:e,onClose:t,onApprove:n,pkg:r,roadmapItems:i})=>{const[s,o]=pe.useState(""),u=pe.useMemo(()=>{if(!r)return{schedule:[],overallStartDate:null,overallEndDate:null};const h=i.find(m=>m.packageName===r.name);return ac(r,h)},[r,i]),d=()=>{if(!s.trim()){alert("Proszę podać imię i nazwisko osoby zatwierdzającej.");return}r!=null&&r.id&&n(r.id,s.trim())};return!e||!r?null:y.jsx(sr,{isOpen:e,onClose:t,title:`Zatwierdzenie Harmonogramu: ${r.name}`,children:y.jsx("div",{className:"max-h-[85vh] overflow-y-auto pr-2",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:"Poniżej znajduje się harmonogram bazowy wyliczony na podstawie estymat. Zweryfikuj go, a następnie podpisz, aby zatwierdzić i umożliwić rozpoczęcie prac."}),y.jsx(Tw,{schedule:u.schedule}),y.jsx(ih,{scheduleData:u,goLiveDate:r.currentGoLiveDate}),y.jsx("div",{className:"pt-6 border-t border-gray-200",children:y.jsx(St,{label:"Podpis (Imię i Nazwisko)",value:s,onChange:h=>o(h.target.value),placeholder:"Wpisz swoje imię i nazwisko",required:!0})}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:d,disabled:!s.trim(),children:"Zatwierdź i podpisz"})]})]})})})},R7=({isOpen:e,onClose:t,onSave:n,itemToReEstimate:r})=>{const[i,s]=pe.useState("Niedoszacowane"),[o,u]=pe.useState(""),[d,h]=pe.useState({});pe.useEffect(()=>{e&&r&&(h({analysisHours:r.analysisHours,devITHours:r.devITHours,workLFHours:r.workLFHours,testingHours:r.testingHours,deploymentHours:r.deploymentHours}),u(""),s("Niedoszacowane"))},[e,r]);const m=(v,_)=>{const k=_===""?void 0:parseFloat(_);h(T=>({...T,[v]:k}))},x=()=>{if(!o.trim()){alert("Uzasadnienie jest wymagane.");return}n(i,o,d)};return r?y.jsx(sr,{isOpen:e,onClose:t,title:`Wniosek o reestymację: ${r.orderName||"Zlecenie"}`,children:y.jsxs("div",{className:"max-h-[85vh] overflow-y-auto pr-2 space-y-6",children:[y.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Oryginalne estymaty (h)"}),y.jsxs("div",{className:"grid grid-cols-3 gap-x-6 gap-y-2 text-sm",children:[y.jsxs("span",{children:["Analiza: ",y.jsx("strong",{className:"text-gray-900",children:r.analysisHours||0})]}),y.jsxs("span",{children:["Progr. IT: ",y.jsx("strong",{className:"text-gray-900",children:r.devITHours||0})]}),y.jsxs("span",{children:["Testy: ",y.jsx("strong",{className:"text-gray-900",children:r.testingHours||0})]}),y.jsxs("span",{children:["Wdrożenie: ",y.jsx("strong",{className:"text-gray-900",children:r.deploymentHours||0})]}),y.jsxs("span",{children:["Prace LF: ",y.jsx("strong",{className:"text-gray-900",children:r.workLFHours||0})]})]})]}),y.jsx(mr,{label:"Powód zmiany estymaty",value:i,onChange:v=>s(v.target.value),children:y2.map(v=>y.jsx("option",{value:v,children:v},v))}),y.jsx(Ei,{label:"Uzasadnienie (w tym analiza wpływu na inne paczki)",value:o,onChange:v=>u(v.target.value),rows:4,required:!0}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Nowe estymaty (h)"}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[y.jsx(St,{label:"Nowa Analiza",type:"number",value:d.analysisHours||"",onChange:v=>m("analysisHours",v.target.value)}),y.jsx(St,{label:"Nowe Progr. IT",type:"number",value:d.devITHours||"",onChange:v=>m("devITHours",v.target.value)}),y.jsx(St,{label:"Nowe Testy",type:"number",value:d.testingHours||"",onChange:v=>m("testingHours",v.target.value)}),y.jsx(St,{label:"Nowe Wdrożenie",type:"number",value:d.deploymentHours||"",onChange:v=>m("deploymentHours",v.target.value)}),y.jsx(St,{label:"Nowe Prace LF",type:"number",value:d.workLFHours||"",onChange:v=>m("workLFHours",v.target.value)})]})]}),y.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-md text-sm",children:[y.jsx("strong",{children:"Uwaga:"})," Zmiana estymat spowoduje automatyczne przeliczenie harmonogramu i może wpłynąć na datę Go-Live paczki."]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:x,disabled:!o.trim(),children:"Zobacz podgląd i zatwierdź"})]})]})}):null},D7=({isOpen:e,onClose:t,onApprove:n,context:r,packages:i,isReadOnly:s=!1})=>{const[o,u]=pe.useState("");pe.useEffect(()=>{var A;e&&u(((A=r==null?void 0:r.historicalReEstimation)==null?void 0:A.approver)||"")},[e,r]);const{originalSchedule:d,proposedSchedule:h,oldGoLive:m,newGoLive:x,goLiveShiftDays:v}=pe.useMemo(()=>{const A={originalSchedule:null,proposedSchedule:null,oldGoLive:null,newGoLive:null,goLiveShiftDays:0};if(!r)return A;const I=i.find(H=>H.name===r.roadmapItem.packageName);if(!I)return A;const C=r.roadmapItem,D=ac(I,C),M={...C,...r.newEstimates},P=C.totalITHoursWithBuffer||0,F=C.workLFHours||0,q=(M.analysisHours||0)+(M.devITHours||0)+(M.testingHours||0)+(M.deploymentHours||0),z=Math.round(q*1.1),te=M.workLFHours||0,Q=ic(P,z),Y=ic(F,te),xe=Math.max(Q,Y),De=new Date(I.currentGoLiveDate);let we=new Date(De),Fe=Math.abs(xe);const Ce=xe>0?1:-1;for(;Fe>0;)we.setDate(we.getDate()+Ce),we.getDay()!==0&&we.getDay()!==6&&Fe--;const Se={...I,currentGoLiveDate:we.toISOString()},Z=ac(Se,M);return{originalSchedule:D,proposedSchedule:Z,oldGoLive:De,newGoLive:we,goLiveShiftDays:xe}},[r,i]),_=()=>{if(!o.trim()){alert("Proszę podać imię i nazwisko osoby zatwierdzającej.");return}n(o.trim())};if(!e||!r)return null;const k=v>0?`Opóźnienie o ${v} dni`:v<0?`Przyspieszenie o ${Math.abs(v)} dni`:"Brak zmiany",T=v>0?"text-red-600":v<0?"text-green-600":"text-gray-600",E=s?"Podgląd Historycznej Zmiany":`Podgląd wpływu reestymacji: ${r.roadmapItem.orderName}`;return y.jsx(sr,{isOpen:e,onClose:t,title:E,children:y.jsxs("div",{className:"max-h-[85vh] overflow-y-auto pr-2 space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:s?"Poniżej znajduje się archiwalny zapis wpływu zmiany na harmonogram.":"Poniżej znajduje się wizualizacja wpływu proponowanej zmiany na harmonogram. Sprawdź prognozę i podpisz, aby ostatecznie zatwierdzić zmianę."}),r.historicalReEstimation&&y.jsxs(On,{children:[y.jsx("h4",{className:"font-semibold text-lg text-gray-800 mb-3",children:"Szczegóły historycznej zmiany"}),y.jsxs("div",{className:"text-sm space-y-1",children:[y.jsxs("p",{children:[y.jsx("span",{className:"font-semibold text-gray-600",children:"Data zmiany:"})," ",new Date(r.historicalReEstimation.createdAt).toLocaleString("pl-PL")]}),y.jsxs("p",{children:[y.jsx("span",{className:"font-semibold text-gray-600",children:"Powód:"})," ",r.historicalReEstimation.reason]}),y.jsxs("p",{children:[y.jsx("span",{className:"font-semibold text-gray-600",children:"Uzasadnienie:"})," ",r.historicalReEstimation.justification]})]})]}),y.jsxs(On,{children:[y.jsx("h4",{className:"font-semibold text-lg text-gray-800 mb-3",children:"Podsumowanie zmiany Go-Live"}),y.jsxs("div",{className:"flex justify-around items-center text-center",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-500",children:"Poprzednia data"}),y.jsx("p",{className:"font-bold text-lg text-gray-800",children:m==null?void 0:m.toLocaleDateString("pl-PL")})]}),y.jsx("div",{className:"text-xl font-light text-gray-400",children:"→"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-500",children:"Nowa prognozowana data"}),y.jsx("p",{className:"font-bold text-lg text-gray-800",children:x==null?void 0:x.toLocaleDateString("pl-PL")})]}),y.jsxs("div",{className:"pl-4 ml-4 border-l border-gray-200",children:[y.jsx("p",{className:"text-sm text-gray-500",children:"Wpływ na termin"}),y.jsx("p",{className:`font-bold text-lg ${T}`,children:k})]})]})]}),d&&y.jsx(ih,{scheduleData:d,proposedScheduleData:h,goLiveDate:m==null?void 0:m.toISOString()}),!s&&y.jsx("div",{className:"pt-6 border-t border-gray-200",children:y.jsx(St,{label:"Podpis zatwierdzający (Imię i Nazwisko)",value:o,onChange:A=>u(A.target.value),placeholder:"Wpisz swoje imię i nazwisko",required:!0})}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:s?"Zamknij":"Anuluj"}),!s&&y.jsx(qe,{onClick:_,disabled:!o.trim(),children:"Zatwierdź zmianę"})]})]})})},P7=({isOpen:e,onClose:t,onConfirm:n,itemToWithdraw:r})=>{const[i,s]=pe.useState(""),o=()=>{if(!i.trim()){alert("Proszę podać powód wycofania zlecenia.");return}n(i)};return r?y.jsx(sr,{isOpen:e,onClose:t,title:`Wycofanie zlecenia: ${r.orderName}`,children:y.jsxs("div",{className:"space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:'Ta operacja usunie zlecenie z roadmapy i przeniesie je z powrotem do backlogu ze statusem "z roadmapy". Operacja zostanie zarejestrowana w historii.'}),y.jsx(Ei,{label:"Powód wycofania (wymagany)",value:i,onChange:u=>s(u.target.value),rows:4,required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{variant:"danger",onClick:o,disabled:!i.trim(),children:"Potwierdź wycofanie"})]})]})}):null},M7=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}),L7=e=>{switch(e){case"create":return y.jsx(yl,{className:"w-5 h-5 text-green-500"});case"update":return y.jsx(wl,{className:"w-5 h-5 text-blue-500"});case"delete":return y.jsx(_l,{className:"w-5 h-5 text-red-500"});case"approve":case"start":return y.jsx(Qd,{className:"w-5 h-5 text-green-600"});default:return y.jsx(M7,{className:"w-5 h-5 text-gray-500"})}},O7=({events:e})=>{const[t,n]=pe.useState(""),[r,i]=pe.useState([]),[s,o]=pe.useState(""),[u,d]=pe.useState(""),h=pe.useMemo(()=>Object.values(p0),[]),m=pe.useMemo(()=>Object.entries(p0).reduce((v,[_,k])=>(v[k]=_,v),{}),[]),x=pe.useMemo(()=>{let v=[...e];const _=t.toLowerCase();if(_&&(v=v.filter(E=>E.description.toLowerCase().includes(_))),r.length>0){const E=r.map(A=>m[A]);v=v.filter(A=>E.includes(A.type))}const k=s?new Date(s).getTime():0,T=u?new Date(u).getTime()+(1440*60*1e3-1):1/0;return(k||T!==1/0)&&(v=v.filter(E=>{const A=new Date(E.timestamp).getTime();return A>=k&&A<=T})),v},[e,t,r,s,u,m]);return y.jsxs(On,{className:"h-full flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Dziennik Zdarzeń"}),y.jsxs("div",{className:"flex items-center gap-4 flex-grow justify-end",children:[y.jsxs("div",{className:"relative flex-grow max-w-xs",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(_c,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Wyszukaj w opisie...",value:t,onChange:v=>n(v.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsx(Us,{title:"Filtruj po typie",options:h,selectedOptions:r,onSelectionChange:i}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(St,{label:"Od",type:"date",value:s,onChange:v=>o(v.target.value),className:"py-1.5"}),y.jsx(St,{label:"Do",type:"date",value:u,onChange:v=>d(v.target.value),className:"py-1.5"})]})]})]}),y.jsxs("div",{className:"overflow-y-auto flex-grow",children:[y.jsxs("table",{className:"min-w-full text-sm",children:[y.jsx("thead",{className:"bg-gray-50 sticky top-0",children:y.jsxs("tr",{children:[y.jsx("th",{className:"p-3 text-left font-semibold text-gray-600 w-12",children:"Typ"}),y.jsx("th",{className:"p-3 text-left font-semibold text-gray-600",children:"Opis Zdarzenia"}),y.jsx("th",{className:"p-3 text-left font-semibold text-gray-600 whitespace-nowrap",children:"Data i Czas"})]})}),y.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(v=>y.jsxs("tr",{className:"hover:bg-gray-50",children:[y.jsx("td",{className:"p-3",children:y.jsx("div",{title:p0[v.type],children:L7(v.type)})}),y.jsx("td",{className:"p-3 text-gray-800",children:v.description}),y.jsx("td",{className:"p-3 text-gray-500 whitespace-nowrap",children:new Date(v.timestamp).toLocaleString("pl-PL")})]},v.id))})]}),x.length===0&&y.jsx("div",{className:"text-center py-16 text-gray-500",children:y.jsx("p",{children:"Brak zdarzeń pasujących do kryteriów."})})]})]})},B7={dashboard:"Pulpit",releases:"Wydania",backlog:"Backlog",roadmap:"Roadmapa",reviews:"Przeglądy",help:"Pomoc",eventLog:"Dziennik Zdarzeń"},U7=()=>{const[e,t]=pe.useState("dashboard"),[n,r]=pe.useState([]),[i,s]=pe.useState([]),[o,u]=pe.useState([]),[d,h]=pe.useState([]),[m,x]=pe.useState([]),[v,_]=pe.useState([]),[k,T]=pe.useState([]),[E,A]=pe.useState([]),[I,C]=pe.useState(!0),[D,M]=pe.useState(100),[P,F]=pe.useState(!1),[q,z]=pe.useState(!1),[te,Q]=pe.useState(!1),[Y,xe]=pe.useState(!1),[De,we]=pe.useState(!1),[Fe,Ce]=pe.useState(!1),[Se,Z]=pe.useState(!1),[H,ue]=pe.useState(!1),[O,J]=pe.useState(!1),[j,K]=pe.useState(!1),[le,ye]=pe.useState(!1),[ve,_e]=pe.useState(!1),[Ie,Je]=pe.useState(!1),[G,ut]=pe.useState(null),[it,ht]=pe.useState(null),[et,Oe]=pe.useState(null),[At,Jt]=pe.useState(null),[Xt,Ft]=pe.useState(null),[yn,$n]=pe.useState(null),[fn,qn]=pe.useState(null),[sn,Kn]=pe.useState(null),[gt,wn]=pe.useState(null),[Qe,xt]=pe.useState(!1),[Cn,It]=pe.useState(null),vt=pe.useCallback(async()=>{const[ne,ae,he,Ue,lt,tt,Ct,Lr]=await Promise.all([Um(),bm(),N2(),R2(),C2(),P2(),B2(),GR()]);r(ne),s(ae),h(he),x(Ue),u(lt),_(tt),T(Ct.sort((Jn,Xn)=>new Date(Xn.timestamp).getTime()-new Date(Jn.timestamp).getTime())),A(Lr)},[]),es=pe.useCallback(async(ne,ae,he,Ue=!0)=>{const tt={releaseId:ne,name:ae,status:"todo",createdAt:new Date().toISOString(),baselineGoLiveDate:he,currentGoLiveDate:he,isScheduleApproved:!1};await zm(tt),await Vt("create",`Utworzono nową paczkę: "${ae}".`),Ue&&await vt()},[vt]),Fi=pe.useCallback(async()=>{C(!0),await w2();const[ne,ae]=await Promise.all([Um(),bm()]);if(M(qR()),ae.length===0&&ne.length===0){const he=await m0({name:"Q4 2024",details:"Wdrożenie nowego interfejsu użytkownika oraz modułu raportowego."});await Vt("create",'Utworzono wydanie startowe: "Q4 2024".');const Ue=new Date("2024-10-31").toISOString(),lt={releaseId:he,name:"Wdrożenie nowego UI",status:"planning",createdAt:new Date().toISOString(),baselineGoLiveDate:Ue,currentGoLiveDate:Ue,isScheduleApproved:!1};await zm(lt),await Vt("create",'Utworzono paczkę startową: "Wdrożenie nowego UI".')}await vt(),C(!1)},[vt]);pe.useEffect(()=>{Fi()},[Fi]);const ha=async(ne,ae)=>{await m0({name:ne,details:ae}),await Vt("create",`Utworzono wydanie: "${ne}".`),await vt()},Ri=ne=>{ht(ne),Q(!0)},Di=async ne=>{await _2(ne),await Vt("update",`Zaktualizowano wydanie: "${ne.name}".`),await vt()},Pi=async ne=>{const ae=n.find(he=>he.id===ne);ae&&window.confirm("Czy na pewno chcesz usunąć to wydanie? Spowoduje to również usunięcie wszystkich powiązanych z nim paczek. Tej operacji nie można cofnąć.")&&(await T2(ne),await Vt("delete",`Usunięto wydanie: "${ae.name}".`),await vt())},qr=ne=>{ut(ne),F(!0)},Kr=()=>{F(!1),ut(null)},oi=ne=>{Oe(ne),xe(!0)},ts=async ne=>{if(!et)return;if(ne.status!==et.status){const he=wi[et.status],Ue=wi[ne.status];await Vt("status_change",`Paczka "${ne.name}" zmieniła status z "${he}" na "${Ue}".`)}else await Vt("update",`Zaktualizowano paczkę: "${ne.name}".`);const ae={...ne};await Lo(ae),await vt(),xe(!1)},ns=ne=>{qn(ne),K(!0)},rs=async(ne,ae)=>{const he=i.find(Ue=>Ue.id===ne);if(he){const Ue={...he,isScheduleApproved:!0,scheduleApprover:ae,scheduleApprovedAt:new Date().toISOString()};await Lo(Ue),await Vt("approve",`Harmonogram dla paczki "${he.name}" został zatwierdzony przez ${ae}.`),await vt(),K(!1)}},is=async ne=>{const ae=i.find(he=>he.id===ne);if(ae&&ae.status==="ready"&&ae.isScheduleApproved){const he={...ae,status:"inProgress"};await Lo(he),await Vt("start",`Rozpoczęto realizację paczki "${ae.name}".`),await vt()}else alert("Błąd: Nie można rozpocząć realizacji. Paczka musi być gotowa i mieć zatwierdzony harmonogram.")},pa=async ne=>{const ae=i.find(he=>he.id===ne);ae&&window.confirm("Czy na pewno chcesz usunąć tę paczkę? Tej operacji nie można cofnąć.")&&(await k2(ne),await Vt("delete",`Usunięto paczkę: "${ae.name}".`),await vt())},as=async ne=>{KR(ne),M(ne),await Vt("update",`Zmieniono próg gotowości paczki na ${ne} godzin.`)},li=async ne=>{if(ne.id)await I2(ne);else{const{id:ae,...he}=ne;await A2(he)}await vt()},ma=async ne=>{try{if(ne.internalId)await F2(ne),await Vt("update",`Zaktualizowano element w backlogu: "${ne.description.substring(0,50)}...".`);else{const{internalId:ae,...he}=ne;await g0(he),await Vt("create",`Dodano nowy element do backlogu: "${ne.description.substring(0,50)}...".`)}await vt(),we(!1),Jt(null)}catch(ae){console.error("Failed to save backlog item:",ae)}},Mr=ne=>{Jt(ne),we(!0)},eo=async ne=>{const ae=d.find(he=>he.internalId===ne);ae&&window.confirm("Czy na pewno chcesz usunąć ten wpis z backlogu?")&&(await Vm(ne),await Vt("delete",`Usunięto element z backlogu: "${ae.description.substring(0,50)}...".`),await vt())},ui=ne=>{$n(ne),J(!0)},Mi=ne=>{if(!yn)return;const ae={orderName:yn.description,jira:yn.ticketId,packageName:ne};Ft(ae),J(!1),Ce(!0)},R=async ne=>{if(ne.id?(await Wm(ne),await Vt("update",`Zaktualizowano zlecenie na roadmapie: "${ne.orderName}".`)):(await Hm(ne),await Vt("create",`Dodano nowe zlecenie na roadmapie: "${ne.orderName}".`),yn&&yn.internalId&&(await Vm(yn.internalId),await Vt("delete",`Przeniesiono z backlogu na roadmapę: "${yn.description.substring(0,50)}...".`),$n(null))),ne.packageName){const ae=i.find(he=>he.name===ne.packageName);if(ae&&ae.status==="todo"){const he={...ae,status:"planning"};await Lo(he),await Vt("status_change",`Paczka "${ae.name}" automatycznie zmieniła status na "W planowaniu".`)}}await vt(),Ce(!1),Ft(null)},U=ne=>{Ft(ne),Ce(!0)},L=async ne=>{const ae=m.find(he=>he.id===ne);ae&&window.confirm("Czy na pewno chcesz usunąć ten wpis z roadmapy?")&&(await Gm(ne),await Vt("delete",`Usunięto zlecenie z roadmapy: "${ae.orderName}".`),await vt())},B=ne=>{Ft(ne),ye(!0)},b=(ne,ae,he)=>{Xt&&(Kn({roadmapItem:Xt,newEstimates:he,reason:ne,justification:ae}),ye(!1),_e(!0))},V=ne=>{const ae=m.find(Ue=>Ue.id===ne.roadmapItemId);if(!ae){alert("Nie można znaleźć powiązanego zlecenia.");return}const he={...ae,...ne.previousEstimates};Kn({roadmapItem:he,newEstimates:ne.newEstimates,historicalReEstimation:ne}),_e(!0)},se=async ne=>{if(!sn||!sn.reason)return;const{roadmapItem:ae,newEstimates:he,reason:Ue,justification:lt}=sn,tt={...ae,...he},Ct=tt.workLFHours||0;tt.devLFHours=Math.round(Ct*.8718),tt.stabilizationLFHours=Math.round(Ct*.1282);const Lr=(tt.analysisHours||0)+(tt.devITHours||0)+(tt.testingHours||0)+(tt.deploymentHours||0);tt.totalITHoursWithBuffer=Math.round(Lr*1.1),tt.totalHours=tt.totalITHoursWithBuffer+Ct,await Wm(tt);const Jn=i.find(Gt=>Gt.name===ae.packageName);if(Jn){const Gt=ae.totalITHoursWithBuffer||0,ga=ae.workLFHours||0,Ut=tt.totalITHoursWithBuffer,Ec=tt.workLFHours||0,Cc=ic(Gt,Ut),Ac=ic(ga,Ec),xa=Math.max(Cc,Ac),va=new Date(Jn.currentGoLiveDate);let Li=new Date(va),Jr=new Date(va),Sl=Math.abs(xa);for(;Sl>0;)Jr.setDate(Jr.getDate()+(xa>0?1:-1)),Jr.getDay()!==0&&Jr.getDay()!==6&&Sl--;Li=Jr;const Ic={...Jn,currentGoLiveDate:Li.toISOString()};await Lo(Ic)}const Xn={roadmapItemId:ae.id,reason:Ue,justification:lt,previousEstimates:{analysisHours:ae.analysisHours,devITHours:ae.devITHours,workLFHours:ae.workLFHours,testingHours:ae.testingHours,deploymentHours:ae.deploymentHours},newEstimates:he,createdAt:new Date().toISOString(),approver:ne};await D2(Xn),await Vt("re_estimate",`Zatwierdzono reestymację dla zlecenia "${ae.orderName}" z powodu: ${Ue}. Zatwierdził(a): ${ne}.`),await vt(),_e(!1),Kn(null),Ft(null)},ge=ne=>{wn(ne),Je(!0)},ie=async ne=>{if(!gt)return;const ae={ticketId:gt.jira,description:gt.orderName||"Brak opisu",status:"z roadmapy",comment:`Wycofane z paczki: ${gt.packageName}. Powód: ${ne}`};await g0(ae);const he={roadmapItemId:gt.id,roadmapItemName:gt.orderName||"Brak nazwy",reason:ne,createdAt:new Date().toISOString()};await L2(he),await Vt("withdraw",`Wycofano zlecenie "${gt.orderName}" z roadmapy. Powód: ${ne}.`),await Gm(gt.id),await vt(),Je(!1),wn(null)},ce=async(ne,ae)=>{xt(!0),It(null);try{const he=await VR(ae,ne);switch(ne){case"releases":for(const Ue of he)await m0(Ue);break;case"roadmap":for(const Ue of he)await Hm(Ue);break;case"backlog":for(const Ue of he)await g0(Ue);break}await Vt("update",`Zaimportowano ${he.length} rekordów do sekcji ${ne}.`),alert(`Pomyślnie zaimportowano ${he.length} rekordów.`),Z(!1),await vt()}catch(he){console.error("Import error:",he),It(he.message||"Wystąpił nieznany błąd podczas importu.")}finally{xt(!1)}},fe=ne=>{try{switch(ne){case"releases":R0({filename:"releases.xlsx",headers:[{key:"name",label:"name"},{key:"details",label:"details"}],data:n});break;case"roadmap":R0({filename:"roadmap.xlsx",headers:[{key:"jira",label:"jira"},{key:"orderName",label:"orderName"},{key:"packageName",label:"packageName"},{key:"analysisHours",label:"analysisHours"},{key:"devITHours",label:"devITHours"},{key:"devLFHours",label:"devLFHours"},{key:"testingHours",label:"testingHours"},{key:"deploymentHours",label:"deploymentHours"},{key:"stabilizationLFHours",label:"stabilizationLFHours"},{key:"totalITHoursWithBuffer",label:"totalITHoursWithBuffer"},{key:"workLFHours",label:"workLFHours"},{key:"totalHours",label:"totalHours"},{key:"comment",label:"comment"}],data:m});break;case"backlog":R0({filename:"backlog.xlsx",headers:[{key:"ticketId",label:"ticketId"},{key:"description",label:"description"},{key:"foz",label:"foz"},{key:"plannedDate",label:"plannedDate"},{key:"analyst",label:"analyst"},{key:"status",label:"status"},{key:"decision",label:"decision"},{key:"comment",label:"comment"}],data:d});break}ue(!1)}catch(ae){console.error("Export failed:",ae),alert("Eksport nie powiódł się. Sprawdź konsolę, aby uzyskać więcej informacji.")}},ke=({targetView:ne,children:ae})=>y.jsx("button",{onClick:()=>t(ne),className:`px-3 py-1.5 rounded-md font-medium text-sm transition-colors ${e===ne?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-blue-600"}`,children:ae}),Le=()=>{if(I)return y.jsx("div",{className:"flex items-center justify-center h-full",children:y.jsx("p",{className:"text-xl",children:"Wczytywanie danych..."})});switch(e){case"dashboard":return y.jsx(eD,{packages:i,releases:n,backlogItems:d,roadmapItems:m,alerts:E,setView:t});case"releases":return y.jsx(rD,{releases:n,packages:i,roadmapItems:m,onAddRelease:()=>z(!0),onEditRelease:Ri,onDeleteRelease:Pi,onEditPackage:oi,onDeletePackage:pa,onAddPackage:qr,onOpenApproveModal:ns,onStartRealization:is,releaseHourLimit:D,onSaveHourLimit:as});case"reviews":return y.jsx(T7,{packages:i,reviews:o,onSaveReview:li,roadmapItems:m});case"backlog":return y.jsx(iD,{items:d,onAddItem:()=>{Jt(null),we(!0)},onEditItem:Mr,onDeleteItem:eo,onAddToRoadmap:ui});case"roadmap":return y.jsx(oD,{items:m,packages:i,onAddItem:()=>{Ft(null),Ce(!0)},onEditItem:U,onDeleteItem:L,onOpenReEstimationModal:B,onOpenWithdrawalModal:ge});case"help":return y.jsx(S7,{});case"eventLog":return y.jsx(O7,{events:k});default:return null}};return y.jsxs("div",{className:"min-h-screen h-screen flex flex-col bg-gray-100 text-gray-800",children:[y.jsxs("header",{className:"bg-white shadow-sm p-4 flex justify-between items-center border-b border-gray-200 flex-shrink-0",children:[y.jsxs("div",{className:"flex items-center space-x-8",children:[y.jsx(I7,{className:"h-8"}),y.jsxs("nav",{className:"flex items-center space-x-2",children:[y.jsx(ke,{targetView:"dashboard",children:"Pulpit"}),y.jsx(ke,{targetView:"releases",children:"Wydania"}),y.jsx(ke,{targetView:"backlog",children:"Backlog"}),y.jsx(ke,{targetView:"roadmap",children:"Roadmapa"}),y.jsx(ke,{targetView:"reviews",children:"Przeglądy"}),y.jsx(ke,{targetView:"eventLog",children:"Dziennik Zdarzeń"}),y.jsx(ke,{targetView:"help",children:"Pomoc"})]})]}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx(qe,{onClick:()=>Z(!0),variant:"secondary",size:"sm",children:" Importuj "}),y.jsx(qe,{onClick:()=>ue(!0),variant:"secondary",size:"sm",children:" Eksportuj "})]})]}),y.jsx("div",{className:"p-6",children:y.jsxs("div",{className:"text-sm text-gray-500",children:[y.jsx("span",{className:"text-blue-600 font-medium",children:"Menedżer Releasów"})," / ",B7[e]]})}),y.jsx("main",{className:"flex-grow overflow-y-hidden px-6 pb-6",children:Le()}),y.jsx(JR,{isOpen:P,onClose:Kr,onSave:es,releases:n,targetReleaseId:G}),y.jsx(XR,{isOpen:q,onClose:()=>z(!1),onSave:ha}),y.jsx(YR,{isOpen:te,onClose:()=>Q(!1),onSave:Di,releaseToEdit:it}),y.jsx(ZR,{isOpen:Y,onClose:()=>xe(!1),onSave:ts,packageToEdit:et,releases:n,roadmapItems:m,releaseHourLimit:D}),y.jsx(lD,{isOpen:De,onClose:()=>{we(!1),Jt(null)},onSave:ma,itemToEdit:At}),y.jsx(cD,{isOpen:Fe,onClose:()=>{Ft(null),Ce(!1)},onSave:R,itemToEdit:Xt,packages:i,reEstimations:v,onViewHistory:V}),y.jsx(E7,{isOpen:Se,onClose:()=>{Z(!1),It(null)},onImport:ce,isLoading:Qe,error:Cn}),y.jsx(A7,{isOpen:H,onClose:()=>ue(!1),onExport:fe}),y.jsx(N7,{isOpen:O,onClose:()=>J(!1),onAssign:Mi,packages:i}),y.jsx(F7,{isOpen:j,onClose:()=>K(!1),onApprove:rs,pkg:fn,roadmapItems:m}),y.jsx(R7,{isOpen:le,onClose:()=>{ye(!1),Ft(null)},onSave:b,itemToReEstimate:Xt}),y.jsx(D7,{isOpen:ve,onClose:()=>{_e(!1),Kn(null)},onApprove:se,context:sn,packages:i,isReadOnly:!!(sn!=null&&sn.historicalReEstimation)}),y.jsx(P7,{isOpen:Ie,onClose:()=>{Je(!1),wn(null)},onConfirm:ie,itemToWithdraw:gt})]})},Sw=document.getElementById("root");if(!Sw)throw new Error("Could not find root element to mount to");const z7=d2.createRoot(Sw);z7.render(y.jsx(P0.StrictMode,{children:y.jsx(U7,{})}));
